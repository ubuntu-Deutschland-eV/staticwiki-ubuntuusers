<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Lokale_Paketquellen/Apt-Cacher-ng › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../lokale_paketquellen/apt-cacher-ng.html">Apt-Cacher-ng</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Lokale_Paketquellen/Apt-Cacher-ng">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../lokale_paketquellen/apt-cacher-ng/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../lokale_paketquellen/apt-cacher-ng/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../lokale_paketquellen/apt-cacher-ng/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../lokale_paketquellen/apt-cacher-ng/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../lokale_paketquellen/apt-cacher-ng/a/backlinks.html">Apt-Cacher-ng</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../paketinstallation_deb.html">Ein einzelnes Paket manuell installieren</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../paketverwaltung.html">Paketverwaltung</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../sources.list.html">sources.list</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation-von-Apt-Cacher-ng-auf-dem-Server">Installation von Apt-Cacher-ng auf dem Ser...</a><ol class="arabic"><li><a class="crosslink" href="#Aus-den-Ubuntu-Quellen">Aus den Ubuntu-Quellen
</a></li><li><a class="crosslink" href="#Aus-den-Debian-Quellen">Aus den Debian-Quellen
</a></li></ol></li><li><a class="crosslink" href="#Konfiguration-von-Apt-Cacher-ng-auf-dem-Server">Konfiguration von Apt-Cacher-ng auf dem Se...</a><ol class="arabic"><li><a class="crosslink" href="#etc-apt-cacher-ng-ubuntu-mirrors">/etc/apt-cacher-ng/ubuntu_mirrors
</a></li><li><a class="crosslink" href="#etc-apt-cacher-ng-acng-conf">/etc/apt-cacher-ng/acng.conf
</a></li></ol></li><li><a class="crosslink" href="#Client-Konfiguration">Client-Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#sources-list-bearbeiten">sources.list bearbeiten
</a><ol class="arabic"><li><a class="crosslink" href="#Beispiel">Beispiel
</a></li></ol></li><li><a class="crosslink" href="#Apt-fuer-Nutzung-eines-Proxys-konfigurieren">Apt für Nutzung eines Proxys konfigurier...</a></li><li><a class="crosslink" href="#Konfiguration-ueber-GUI">Konfiguration über GUI
</a></li><li><a class="crosslink" href="#Einrichtung-ueber-Proxy">Einrichtung über Proxy
</a></li></ol></li><li><a class="crosslink" href="#Weitere-Moeglichkeiten-mit-Apt-Cacher-ng">Weitere Möglichkeiten mit Apt-Cacher-ng
</a><ol class="arabic"><li><a class="crosslink" href="#Import-der-bereits-heruntergeladenen-Archive">Import der bereits heruntergeladenen Arc...</a></li><li><a class="crosslink" href="#Bereinigung-des-Caches">Bereinigung des Caches
</a></li><li><a class="crosslink" href="#Distkill">Distkill
</a></li><li><a class="crosslink" href="#Remapping-Symbolische-Namen">Remapping/Symbolische Namen
</a><ol class="arabic"><li><a class="crosslink" href="#Beispiel-Remapping">Beispiel Remapping
</a></li></ol></li></ol></li><li><a class="crosslink" href="#Externe-Links-Quellen">Externe Links/Quellen
</a></li></ol></div><p><a class="external" href="http://www.unix-ag.uni-kl.de/~bloch/acng/" rel="nofollow">Apt-Cacher-ng</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein Programm, welches die Belastung der Internetanbindung durch Updates verringert, sobald zwei oder mehr Debian-basierte (also auch Ubuntu und Derivate) Rechner über diesen Zwischenspeicher (Cache) auf die gleichen Paketquellen zugreifen. So werden Debian-Pakete die auf beiden (allen) Rechnern benötigt werden nur einmal aus dem Internet heruntergeladen.</p><p>Apt-Cacher-ng ist in C++ implementiert und liefert auch auf schwachen Rechnern gute Performance. 
Apt-Cacher-ng ist von der Funktionalität sehr nahe an <a class="internal" href="../lokale_paketquellen/apt-cacher.html">apt-cacher</a>. Im Gegensatz zu apt-cacher ist Apt-Cacher-ng <span class="underline">nicht</span> auf einen Webserver (z.B. Apache2) angewiesen.</p><p>Dieser Artikel bezieht sich auf die Versionen aus den Ubuntu-Quellen. Neuere Versionen sind z.B. über <a class="external" href="http://packages.debian.org/sid/apt-cacher-ng" rel="nofollow">debian.org</a> <img alt="{dl}" src="../_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> verfügbar.</p><p>Ähnliche Programme unter: <a class="internal" href="../lokale_paketquellen.html">Lokale Paketquellen</a></p><div class="section_1"><h2 id="Installation-von-Apt-Cacher-ng-auf-dem-Server">Installation von Apt-Cacher-ng auf dem Server<a class="headerlink" href="#Installation-von-Apt-Cacher-ng-auf-dem-Server">¶</a></h2><p>
</p><div class="section_2"><h3 id="Aus-den-Ubuntu-Quellen">Aus den Ubuntu-Quellen<a class="headerlink" href="#Aus-den-Ubuntu-Quellen">¶</a></h3><p>
Zu installierende Pakete <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>apt-cacher-ng</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install apt-cacher-ng </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install apt-cacher-ng </pre></div></div><p>
</p></div></div><p><img alt="acng_report.png" class="image-right" src="../_/f431517b6b2d8a18a0c07cdb37427f55313601be.png"/></p><p>Nach der Installation ist Apt-Cacher-ng über einen Browser erreichbar: <code class="notranslate">http://localhost:3142/acng-report.html</code> (bzw. von einem anderen Rechner über die IP des Hosts, auf dem Apt-Cacher-ng ausgeführt wird, oder bei funktionierendem DNS über dessen Namen). Beispiel siehe Abbildung rechts.</p></div><div class="section_2"><h3 id="Aus-den-Debian-Quellen">Aus den Debian-Quellen<a class="headerlink" href="#Aus-den-Debian-Quellen">¶</a></h3><p>
</p><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
<a class="internal" href="../fremdquellen.html">Fremdpakete</a> können das System gefährden. 
</p><hr/><p><strong>Anmerkung:</strong> Die Debian-Seite ist gleichzeitig der Downloadbereich des Projekts!
</p></div></div><p>Z.B. auf <a class="external" href="http://ftp.debian.org/debian/pool/main/a/apt-cacher-ng/" rel="nofollow">debian.org</a> <img alt="{dl}" src="../_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/></p><p>Nach dem Download installiert man dieses Paket <sup><a href="#source-2">[2]</a></sup>. Diese Variante ist interessant für alle, die eine veraltete Version aus den Ubuntu-Quellen angeboten bekommen.</p></div></div><div class="section_1"><h2 id="Konfiguration-von-Apt-Cacher-ng-auf-dem-Server">Konfiguration von Apt-Cacher-ng auf dem Server<a class="headerlink" href="#Konfiguration-von-Apt-Cacher-ng-auf-dem-Server">¶</a></h2><p>
Nach jeder Änderung der Konfiguration ist Apt-Cacher-ng mit folgendem Befehl neu zu starten:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/apt-cacher-ng restart </pre></div></div><div class="section_2"><h3 id="etc-apt-cacher-ng-ubuntu-mirrors">/etc/apt-cacher-ng/ubuntu_mirrors<a class="headerlink" href="#etc-apt-cacher-ng-ubuntu-mirrors">¶</a></h3><p>
Hierbei handelt es sich um eine Datei des "Standard-Remappings". Alle 219 in dieser Datei aufgezählten Quellen werden im Unterordner <strong>uburep</strong> gesammelt (bei 0.5.14 unter Maverick sind in dieser Datei 594 Einträge).</p></div><div class="section_2"><h3 id="etc-apt-cacher-ng-acng-conf">/etc/apt-cacher-ng/acng.conf<a class="headerlink" href="#etc-apt-cacher-ng-acng-conf">¶</a></h3><p>
Dies ist die Haupt-Konfigurationsdatei. Sie kann mit einem beliebigen Editor<sup><a href="#source-3">[3]</a></sup> mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> bearbeitet werden.</p><pre class="notranslate">CacheDir: /var/cache/apt-cacher-ng</pre><p>Legt das Verzeichnis für den Cache fest.</p><pre class="notranslate">LogDir: /var/log/apt-cacher-ng</pre><p>Legt das Verzeichnis für Log-Dateien fest (Fehlerlog: <strong>apt-cacher.err</strong>, Zugriffslog: <strong>apt-cacher.log</strong> - mit IP des zugreifenden Rechners)</p><pre class="notranslate">Port:3142</pre><p>Legt den Port der Anwendung fest (wichtig für Client-Konfiguration und Webinterface).</p><pre class="notranslate">VerboseLog: 1</pre><p>Umfang der Log-Dateien: <code class="notranslate">0</code> Typ, Zeit und Dateigröße werden erfasst, <code class="notranslate">1</code> zusätzlich Client-IP und relative lokale Pfade werden erfasst.</p><pre class="notranslate">ReportPage: acng-report.html</pre><p>Seitenname der Statusseite (<code class="notranslate">http://SERVER:PORT/ReportPage</code> , Standard:<code class="notranslate">http://SERVER:PORT/acng-report.html</code> )</p><pre class="notranslate">SocketPath:/var/run/apt-cacher-ng/socket</pre><p>Socket-Datei, um über einen lokalen UNIX-Socket anstelle über TCP zuzugreifen.</p><pre class="notranslate">Verbose: 0
Debug:3
ForeGround: 0</pre><p>Für Fehlersuche/-Diagnose interessante Optionen.</p><pre class="notranslate">PidFile: /var/run/apt-cacher-ng/pid</pre><p>Legt fest, in welcher Datei die Prozess-ID des Programms hinterlegt wird (am besten nicht ändern).</p><pre class="notranslate">offlinemode:0</pre><p>Im Offline-Modus können nur bereits vorhandene Dateien verteilt werden.</p><pre class="notranslate">ForceManaged: 0</pre><p>Verbieten von Downloads von nicht konfigurierten Quellen. 0: Alle Quellen erlaubt, 1: Nur konfigurierte erlaubt</p><pre class="notranslate">Proxy: http://www-proxy.example.net:80
proxy: http://username:proxypassword@proxy.example.net:3128</pre><p>legt Proxy-Einstellungen fest (bei Bedarf, Ungenutztes auskommentieren)</p><pre class="notranslate">ExTreshold: 10</pre><p>Tage, bevor ein Paket, welches aus keiner Paketquelle verfügbar ist, gelöscht wird.</p><pre class="notranslate">StupidFs: 0</pre><p>Falls Apt-Cacher-ng den Cache auf einer NTFS- oder FAT-Partition hat, können hiermit Fehler vermieden werden (in diesem Fall auf <strong>1</strong> setzen).</p><pre class="notranslate">Remap-debrep: file:deb_mirror*.gz /debian ; file:backends_debian
Remap-uburep: file:ubuntu_mirrors /ubuntu ; file:backends_ubuntu</pre><p>Standard-Remapping. Nähere Informationen im Abschnitt <a class="crosslink" href="#Remapping-Symbolische-Namen">Remapping/Symbolische Namen</a></p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Es wird empfohlen, die Client-Konfiguration ebenfalls auf dem Rechner durchzuführen, auf dem Apt-Cacher-ng ausgeführt wird.
</p></div></div></div></div><div class="section_1"><h2 id="Client-Konfiguration">Client-Konfiguration<a class="headerlink" href="#Client-Konfiguration">¶</a></h2><p>
Für die Konfiguration der Clients (zugreifende Rechner) sind vier Möglichkeiten bekannt. Es müssen jeweils <span class="underline">anschließend</span> die Paketlisten erneuert werden (gilt nicht für die Einrichtung über Proxy) <sup><a href="#source-5">[5]</a></sup>.</p><div class="section_2"><h3 id="sources-list-bearbeiten">sources.list bearbeiten<a class="headerlink" href="#sources-list-bearbeiten">¶</a></h3><p>
Man ändert die Einträge in der <strong>sources.list</strong> <sup><a href="#source-6">[6]</a></sup> wie folgt ab:</p><p>Man schreibt zwischen "http://" und der darauf folgenden Adresse <code class="notranslate">SERVER</code>:<code class="notranslate">PORT</code>. <code class="notranslate">SERVER</code> kann die IP des Hosts von Apt-Cacher-ng sein, ein Rechner-Name (bei funktionierender Namensauflösung im LAN -&gt; DNS), oder (wenn der Server auf dem gleichem Rechner läuft) <code class="notranslate">localhost</code> (bzw. 127.0.0.1). Für <code class="notranslate">PORT</code> trägt man den Port der Anwendung auf dem Host ein (Standard: Apt-Cacher-ng <code class="notranslate">3142</code>).</p><div class="section_3"><h4 id="Beispiel">Beispiel<a class="headerlink" href="#Beispiel">¶</a></h4><p>
Aus:</p><pre class="notranslate">deb http://de.archive.ubuntu.com/ubuntu/ precise universe</pre><p>wird (<span class="underline">Annahme:</span> Apt-Cacher-ng läuft auf dem Rechner mit der IP: 192.168.0.4 mit dem Port:3142):</p><pre class="notranslate">deb http://192.168.0.4:3142/de.archive.ubuntu.com/ubuntu/ precise universe</pre><p>bzw. wenn der symbolische Name (ubuntu_de de.archive.ubuntu.com/ubuntu/) verwendet wird (siehe <a class="crosslink" href="#Remapping-Symbolische-Namen">Remapping/Symbolische Namen</a>):</p><pre class="notranslate">deb http://192.168.0.4:3142/ubuntu_de/ubuntu precise universe</pre></div></div><div class="section_2"><h3 id="Apt-fuer-Nutzung-eines-Proxys-konfigurieren">Apt für Nutzung eines Proxys konfigurieren<a class="headerlink" href="#Apt-fuer-Nutzung-eines-Proxys-konfigurieren">¶</a></h3><p>
Der schnellste Weg, die Clients für die Nutzung eines Caches/Proxies zu konfigurieren ist einen Proxy für <strong>apt</strong> festzulegen. Dazu muss in einer Datei in <strong>/etc/apt/apt.conf.d/</strong> (z.B. <strong>01proxy</strong>, Datei muss ggf. angelegt werden) folgendes eingetragen werden:</p><pre class="notranslate">Acquire::http { Proxy "http://SERVER:PORT"; };</pre><p>Falls https Repositories benutzt werden, sollte folgendes in die Datei, da apt-get bei einem Proxy für https Fehler werfen wird:</p><pre class="notranslate">Acquire::http { Proxy "http://SERVER:PORT"; };
Acquire::https { Proxy "https://"; };</pre><p><code class="notranslate">SERVER</code> kann die IP des Hosts von Apt-Cacher-ng sein, ein Rechner-Name (bei funktionierender Namensauflösung im LAN -&gt; DNS), oder (wenn der Server auf dem selben Rechner läuft) localhost (bzw. 127.0.0.1). Für <code class="notranslate">PORT</code> trägt man den Port der Anwendung auf dem Host ein (Standard Apt-Cacher-ng <code class="notranslate">3142</code>). Es können zusätzlich symbolische Namen in der <strong>sources.list</strong> <sup><a href="#source-6">[6]</a></sup> verwendet werden.</p><p>Wenn der Proxy aus der <strong>apt</strong>-Konfiguration entfernt werden soll muss die Zeile auskommentiert (<strong>#</strong> voranstellen) oder gelöscht werden. Das Auskommentieren ist der bequemere Weg für z.B. Laptop-Benutzer die häufig in unterschiedlichen Netzwerken unterwegs sind.</p></div><div class="section_2"><h3 id="Konfiguration-ueber-GUI">Konfiguration über GUI<a class="headerlink" href="#Konfiguration-ueber-GUI">¶</a></h3><p>
An dieser Stelle wird auf die Wikiseiten zu den verschiedenen Paketmanagern verwiesen (<a class="internal" href="../synaptic.html">Synaptic</a>, <a class="internal" href="../softwareverwaltung_kde.html">Softwareverwaltung KDE</a>,...). Grundsätzlich sind die selben Operationen wie beim manuellen Bearbeiten der <strong>sources.list</strong> <sup><a href="#source-6">[6]</a></sup> möglich.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Verschiedene Nutzer haben berichtet eine Einrichtung über Synaptic würde nicht funktionieren.
</p></div></div></div><div class="section_2"><h3 id="Einrichtung-ueber-Proxy">Einrichtung über Proxy<a class="headerlink" href="#Einrichtung-ueber-Proxy">¶</a></h3><p>
Wer in seinem Netzwerk einen Proxyserver (z.b. <a class="internal" href="../squid.html">Squid</a>) betreibt, kann die Einrichtung elegant über einen "Redirect" erledigen. Hierzu werden die entsprechenden URLs (z.B. <code class="notranslate">http://de.archive.ubuntu.com</code>) gefiltert und an den Server umgeleitet.</p><p>Diese Art der Konfiguration ist vor allem für Laptops, die in verschiedenen (W-)LANs eingesetzt werden von Vorteil und erspart in großen Netzwerken ( &gt; 20 Teilnehmer) Konfigurationsaufwand.</p><p>Eine Konfiguration auf den einzelnen Clients ist <span class="underline">nicht</span> erforderlich.</p><p>Siehe hierzu: <a class="external" href="http://www.squid-handbuch.de/hb/" rel="nofollow">Squid-Handbuch</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> -&gt; 6.2 Routing-Optionen zu anderen Proxys -&gt; cache_peer_domain</p></div></div><div class="section_1"><h2 id="Weitere-Moeglichkeiten-mit-Apt-Cacher-ng">Weitere Möglichkeiten mit Apt-Cacher-ng<a class="headerlink" href="#Weitere-Moeglichkeiten-mit-Apt-Cacher-ng">¶</a></h2><p>
</p><div class="section_2"><h3 id="Import-der-bereits-heruntergeladenen-Archive">Import der bereits heruntergeladenen Archive<a class="headerlink" href="#Import-der-bereits-heruntergeladenen-Archive">¶</a></h3><p>
<img alt="acng_import.png" class="image-right" src="../_/dae8c80eec5a774127012072a4d81d795791c737.png"/></p><p>Man kann bereits heruntergeladene Archive auf dem Rechner, der als Server dient, importieren. Hierzu führt man folgende Schritte aus:</p><ol class="arabic"><li><p>Zuerst auf dem lokalen Rechner (Server) den Proxy eintragen (siehe oben) und einmal <code class="notranslate">sudo apt-get update</code> ausführen, damit der Paketindex der lokalen Pakete von apt-cacher-ng bekannt ist</p></li><li><p>Dann den apt Zwischenspeicher um veraltete Pakete erleichtern</p></li><li><p>Dann im Cache-Verzeichnis den Unterordner <strong>_import</strong> anlegen, in den die Archive kopiert werden</p></li><li><p>Der Ordner und die Dateien werden dem Benutzer "apt-cacher-ng" zugeordnet (übertragen)</p></li><li><p>Über den Button <em>"Import"</em> auf dem Webinterface von Apt-Cacher-ng (Standard: <code class="notranslate">http://localhost:3142/acng-report.html</code>) kann der Importvorgang gestartet werden</p></li><li><p>Nachdem der Import abgeschlossen ist, kann der Unterordner <strong>_import</strong> wieder gelöscht werden</p></li></ol><p>
Üblicherweise wird der Importvorgang so eingeleitet:</p><p>Als Beispiel der Import des Caches, der von apt unter <strong>/var/cache/apt/archives/</strong> angelegt wurde (ohne <code class="notranslate">sudo -s</code> wird die Befehlszeile des cp-Befehls bei vielen Dateien zu lang und <code class="notranslate">sudo</code> fuehrt das Kommando nicht aus):</p><div class="bash"><div class="contents"><pre class="notranslate">sudo -s
apt-get update
apt-get autoclean
mkdir -p /var/cache/apt-cacher-ng/_import
chown apt-cacher-ng /var/cache/apt-cacher-ng/_import
cp -al /var/cache/apt/archives/* /var/cache/apt-cacher-ng/_import/
exit </pre></div></div><p>Nach dem Anklicken des <em>"Start Import"</em>-Buttons auf dem Webinterface startet der Vorgang. Nachdem dieser im Web-Interface abgeschlossen wurde, entfernt man den Ordner wieder:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rm -rf /var/cache/apt-cacher-ng/_import </pre></div></div></div><div class="section_2"><h3 id="Bereinigung-des-Caches">Bereinigung des Caches<a class="headerlink" href="#Bereinigung-des-Caches">¶</a></h3><p>
<img alt="acng_expiration.png" class="image-right" src="../_/b5ae4f9af8757d074bcc0353f173403485e036c5.png"/></p><p>Über den Button <em>"Start Expiration"</em> auf dem Webinterface kann die Bereinigung manuell gestartet werden. Das Ergebnis sieht etwa wie nebenstehend aus.</p></div><div class="section_2"><h3 id="Distkill">Distkill<a class="headerlink" href="#Distkill">¶</a></h3><p>
Wenn der Cache von Apt-Cacher-ng durch lange Benutzung (oder viele Distributionen) zu groß wird, gibt es mit Distkill einen Weg ganze Releases (bzw. deren Komponenten zu löschen). Ein Aufruf von:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /usr/lib/apt-cacher-ng/distkill.pl </pre></div></div><p>
Gibt eine Liste der zwischengespeicherten Distributionen/Komponenten aus:
</p><pre class="notranslate">Scanning /var/cache/apt-cacher-ng, please wait...
Found distributions:
        1. karmic (102 index files)
        2. maverick-backports (32 index files)
        3. karmic-security (35 index files)
        4. karmic-backports (64 index files)
        5. maverick-security (32 index files)
        6. maverick-updates (34 index files)
        7. maverick (54 index files)
        8. lucid-proposed (3 index files)
        9. lucid-updates (42 index files)
        10. karmic-proposed (3 index files)
        11. jaunty-updates (32 index files)
        12. lucid (71 index files)
        13. jaunty-security (64 index files)
        14. lucid-backports (43 index files)
        15. jaunty (88 index files)
        16. lucid-security (46 index files)
        17. jaunty-backports (32 index files)
        18. karmic-updates (60 index files)

WARNING: The removal action would wipe out whole directories containing
         index files. Select d to see detailed list.

Which distribution to remove? (Number, 0 to exit, d for details): </pre><p>
Durch Eingabe einer Nummer werden die Index-Dateien der gewählten Komponente gelöscht. Führt man nun eine <a class="internal" href="../lokale_paketquellen/apt-cacher-ng.html#Bereinigung-des-Caches">Bereinigung des Caches</a>, ohne erneutes herunterladen der Indexdateien, aus, so werden die entsprechenden Pakete (je nach Einstellung - ExTreshold) bald vom System entfernt.</p><p>Nähere Informationen hierzu findet man unter: <a class="external" href="http://www.unix-ag.uni-kl.de/~bloch/acng/html/howtos.html#cache-overview" rel="nofollow" title="http://www.unix-ag.uni-kl.de/~bloch/acng/html/howtos.html#cache-overview">http://www.unix-ag.uni-kl.de/~bloch/acng/html/howtos.html#cache-overview</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></div><div class="section_2"><h3 id="Remapping-Symbolische-Namen">Remapping/Symbolische Namen<a class="headerlink" href="#Remapping-Symbolische-Namen">¶</a></h3><p>
</p><pre class="notranslate">Remap-&lt;repository_name&gt;: /basepath/ ; backendhost/dir</pre><p>Remapping (Symbolische Namen). Legt symbolische Namen für die Backends (Ubuntu- und Debian-Repositories) fest, bzw. in welchen Dateien diese gespeichert sind. <span class="underline">Achtung:</span> Das Remapping funktioniert nur, wenn die <strong>sources.list</strong> angepasst wird!</p><p>Für <code class="notranslate">&lt;repository_name&gt;</code> wird ein frei gewählter Name eingesetzt (einzelnes Wort, darf nicht mit einem Unterstrich <strong>"_"</strong> beginnen und nicht <code class="notranslate">apt-cacher</code> sein). Möglich sind z.B.: <code class="notranslate">project_foo_mirrors</code> oder <code class="notranslate">ubuntu_stuff</code>. Legt den Unterordner im Cache fest.</p><p><code class="notranslate">/basepath/</code> ist der Name, den ein Client für das Repository verwendet (<strong>sources.list</strong><sup><a href="#source-2">[2]</a></sup>  Z.B.: <code class="notranslate">de.archive.ubuntu.com</code>). Wenn hier ein Symbolischer Name steht, muss <code class="notranslate">backendhost</code> das gewünschte Repository angeben (kann ansonsten entfallen).</p><p>Dies wäre bereits die einfachste Form des Remapping. Für umfangreiche Konfigurationen kann das Remapping in die angegebenen Dateien ausgelagert werden:</p><pre class="notranslate">Remap-&lt;repository_name&gt;: file:list.txt ; file:where.txt</pre><div class="section_3"><h4 id="Beispiel-Remapping">Beispiel Remapping<a class="headerlink" href="#Beispiel-Remapping">¶</a></h4><p>
</p><pre class="notranslate">Remap-ubuntu_ger: ubuntu_de ; http://de.archive.ubuntu.com/ubuntu/
Remap-fremdes_repo: kenne_ich_nicht ; http://packages.medibuntu.org/</pre><p>Nun könnte in der <strong>sources.list</strong> eines Clients stehen:</p><pre class="notranslate">deb http://ubuntu_de/ubuntu precise-security restricted main multiverse universe
deb http://kenne_ich_nicht precise free non-free
...</pre><p>Die Dateien aus <strong>de.archive.ubuntu.com</strong> würden in dem Unterordner <strong>ubuntu_ger</strong> gespeichert, die aus <strong>packages.medibuntu.org</strong> im Unterordner <strong>fremdes_repo</strong>.</p></div></div></div><div class="section_1"><h2 id="Externe-Links-Quellen">Externe Links/Quellen<a class="headerlink" href="#Externe-Links-Quellen">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://ubuntuforums.org/showthread.php?t=981085" rel="nofollow">Thread</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> auf ubuntuforums.org</p></li><li><p><a class="external" href="http://www.unix-ag.uni-kl.de/~bloch/acng/" rel="nofollow">Vorschau</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> auf das Webinterface, Link zur neuesten Version (Quelltext, sowie Debian-Pakete)</p></li><li><p><a class="external" href="http://alioth.debian.org/projects/apt-cacher-ng/" rel="nofollow">Projektseite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p>Handbuch Apt-Cacher-ng <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (nach der Installation lokal unter /usr/share/doc/apt-cacher-ng/html/index.html erreichbar)</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../lokale_paketquellen/apt-cacher-ng/a/revision/946194.html">Diese Revision</a> wurde am 12. Januar 2018 15:30 von <a href="https://ubuntuusers.de/user/BillMaier/">BillMaier</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../lokale_paketquellen.html">Lokale Paketquellen</a></li>
<li><a href="../lokale_paketquellen/apt-cacher-ng.html">Apt-Cacher-ng</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>