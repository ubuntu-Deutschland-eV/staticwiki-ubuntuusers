<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Howto/Aufsetzen_eines_Gastro-Kassensystems_mit_OrderSprinter › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter.html">Aufsetzen eines Gastro-Kassensystems mit OrderSprinter</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Howto/Aufsetzen_eines_Gastro-Kassensystems_mit_OrderSprinter">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/backlinks.html">Aufsetzen eines Gastro-Kassensystems mit OrderSprinter</a></h1>
<div id="page"><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die Verwendung dieses Howto geschieht auf eigene Gefahr. Bei Problemen mit der Anleitung melde dies bitte in der dazugehörigen Diskussion und wende dich zusätzlich an den Verfasser des Howtos.
</p></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Diese Howto-Anleitung wurde zuletzt von <a class="crosslink user" href="https://ubuntuusers.de/user/Zauberfee/">Zauberfee</a> am 30.07.2017 unter <strong>Ubuntu Zesty</strong> erfolgreich getestet.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../programme_starten.html">Starten von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../sudo.html">Root-Rechte</a></p></li></ol></div></div><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Anforderungen-an-Kassensysteme">Anforderungen an Kassensysteme
</a></li><li><a class="crosslink" href="#Linux-als-Betriebssystem-fuer-ein-Kassensystem">Linux als Betriebssystem für ein Kassensys...</a></li><li><a class="crosslink" href="#Verfuegbare-Software">Verfügbare Software
</a></li><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Ersteinrichtung">Ersteinrichtung
</a></li><li><a class="crosslink" href="#Druckerserver">Druckerserver
</a></li><li><a class="crosslink" href="#Test">Test
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Dieses Howto beschreibt die Installation und Ersteinrichtung der Software OrderSprinter zum Aufbau eines Gastro-POS auf einem aktuellen Ubuntu.</p><p>Zu Beginn wird eine Einordnung in den Kontext vorgenommen: Warum sollte man ein Kassensystem unter Linux aufsetzen, welche Anforderungen gelten an Kassensysteme und welche Programme sind dem Autor bekannt, die diese Anforderungen für Deutschland umsetzen?</p><div class="section_1"><h2 id="Anforderungen-an-Kassensysteme">Anforderungen an Kassensysteme<a class="headerlink" href="#Anforderungen-an-Kassensysteme">¶</a></h2><p>
Ein Kassensystem (auch als POS abgekürzt: Point-of-Sales bzw. Point-of-Service) unterstützt im Handel und der Gastronomie den Verkäufer bei der Abwicklung eines Verkaufsvorgangs.</p><p>In der Gastronomie muss ein Kassensystem besondere Anforderungen erfüllen, die weit über die Funktionalität einer reinen elektronischen Registrierkasse hinausgehen:
</p><ul><li><p>Bestellungen müssen auf Tische buchbar sein, die Zuweisung muss jederzeit veränderbar sein (Tischwechsel)</p></li><li><p>Bestellungen müssen gegebenenfalls zusätzlich auf konkrete Kunden oder Zimmer buchbar sein (Hotelbetrieb)</p></li><li><p>Teilabrechnungen von Bestellvorgängen (Gäste eines Tisches zahlen einzeln)</p></li><li><p>Produktvariationen (Pommes mit Ketchup und/oder Majo) mit Preisen je nach gewählten Optionen</p></li><li><p>Ausgabe von Bewirtungsbelegen</p></li><li><p>Arbeitsbons oder digitale Workflowanzeigen (Produkte müssen schließlich zubereitet werden)</p></li><li><p>Verteilung von Bons (Arbeitsbons, Kassenbons) auf Bondrucker an unterschiedlichen Locations</p></li></ul><p>
Gastronomische Betriebe in Europa unterliegen vielen rechtlichen Auflagen, die von Land zu Land stark variieren. Neben Hygienevorschriften und baulichen Vorgaben (Fluchtwege, Toiletten usw.) sind es vor allem die steuerrechtlichen Regelungen, deren Umsetzung mitnichten trivial ist. In Deutschland gilt die GoBD (Grundsätze zur ordnungsmäßigen Führung und Aufbewahrung von Büchern, Aufzeichnungen und Unterlagen in elektronischer Form sowie zum Datenzugriff), die aus der GdPdU (Grundsätze zum Datenzugriff und zur Prüfbarkeit digitaler Unterlagen) hervorgegangen ist.</p><p>Neben den harten Anforderungen gibt es verschiedene weiche Kriterien, die ein gutes Kassensystem ausmachen:
</p><ul><li><p>Skalierbarkeit: Je nach Wochentag und Uhrzeit wechselt das Gästeaufkommen. Insbesondere während der Spitzenzeiten muss ein System performant arbeiten.</p></li><li><p>mobile Bestellaufnahme: Kann eine Bestellung direkt beim Gast aufgenommen werden, bei der anschließend ein Arbeitsbon in der Küche gedruckt wird, spart das Zeit und Personalkosten.</p></li><li><p>Exportmöglichkeiten: Ein Gastronom ist verpflichtet, alle umsatzrelevanten Daten über einen Zeitraum von zehn Jahren aufzubewahren.</p></li><li><p>intuitive Benutzeroberfläche: In der Gastronomie wechseln die Bediener sehr häufig. Zeit für eine ausführliche Einarbeitung von Teilzeitkräften ist oft nicht vorhanden.</p></li><li><p>abgestuftes Rechtemanagement: GoBD und BMF-Schreiben fordern z.B. eine Dokumentation, welche Bediener Stornierungsvorgänge wann durchführen konnten.</p></li></ul><p>
</p></div><div class="section_1"><h2 id="Linux-als-Betriebssystem-fuer-ein-Kassensystem">Linux als Betriebssystem für ein Kassensystem<a class="headerlink" href="#Linux-als-Betriebssystem-fuer-ein-Kassensystem">¶</a></h2><p>
Ein Linux-System als Grundlage für ein Kassensystem bietet sich aus den oben genannten Gründen an:
</p><ul><li><p>Updates sind besser planbar: Kellner wollen nicht warten, wenn ein Windows 10 Kassensystem entschieden hat, nun erst einmal Updates zu installieren und vielleicht sogar neu gestartet werden möchte.</p></li><li><p>Ein Linux-System kann so aufgesetzt werden, dass nur die relevanten Komponenten installiert sind: Das macht das Gesamtsystem schneller und sicherer.</p></li><li><p>Im Gegensatz zu vielen Cloud-Diensten bleiben die sensiblen Umsatzdaten lokal beim Gastronomen.</p></li><li><p>Kosten: Da keine Lizenzkosten für ein kommerzielles Betriebssystem anfallen und auch ältere Hardware noch benutzt werden kann, fallen die TCO (Total Cost of Ownership) geringer aus.</p></li></ul><p>
</p></div><div class="section_1"><h2 id="Verfuegbare-Software">Verfügbare Software<a class="headerlink" href="#Verfuegbare-Software">¶</a></h2><p>
In Deutschland (nicht in Österreich, hier gilt die RKSV!) hat der Gastronom die Auswahl aus drei nicht-kommerziellen Kassensystemen, die die oben aufgeführten Anforderungen erfüllen:</p><ul><li><p><em>OpenBravo POS</em>: OpenBravo POS ist eine Rich-Client-Software und benötigt eine Java VM und eine Oracle-, PostgreSQL-, MySQL- oder HSQLDB-Datenbank. Die Integration mit OpenBravo ERP ist bei Betrieben von Vorteil, die alle Ressourcen (Personal, Lager, Betriebsmittel, Kapital) per Software verwalten wollen. Allerdings ist das System nicht für die Anbindung von mobilen Endgeräten konzipiert.</p></li><li><p><em>POSPer:</em> POSper ist ebenso eine Rich-Client-Software und verwendet Java und Hibernate als Zwischenschicht zur Datenbank (MySql, PostGreSQL, Oracle, HSQLDB und andere). Die Oberfläche ist in viele Sprachen übersetzt worden, so dass sich der Einsatz des Programms besonders für Betriebe eignet, die ausländisches Bedienpersonal beschäftigen. POSper ist gut auf stationären großen Touchpanels bedienbar.</p></li><li><p><em>OrderSprinter:</em> Die Kernkomponente ist eine Webapplikation mit PHP und einer Datenbank MySQL/MariaDB. Es werden bis zu 6 Kassenbon- und 4 Arbeitsbondrucker unterstützt, die auf Linux-Systemen mit den in der Software enthaltenen Java-Druckserver angebunden werden können. Die Bestelloberfläche ist sowohl in einer PC-geeigneten als auch mobilen Ansicht programmiert. Da es sich im Grunde um eine Webapplikation handelt, ist eine Bedienung mit handelsüblichen Smartphones möglich. </p></li></ul></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Dieser Artikel bezieht sich auf die Installation von <strong>OrderSprinter</strong> auf einem Ubuntu-System. Am Ende dieses HowTos steht ein Gesamtsystem bestehend aus einem OrderSprinter-Server und einem Druckerserver für einen lokal angeschlossenen Bondrucker.</p><div class="section_2"><h3 id="Vorbereitung">Vorbereitung<a class="headerlink" href="#Vorbereitung">¶</a></h3><p>
Benötigte Hardware:
</p><ul><li><p>Computer mit frisch installiertem Ubuntu (wurden bereits Änderungen am System vorgenommen, ist die Installation möglicherweise anzupassen)</p></li><li><p>WLAN-Router</p></li><li><p>mobiles Endgerät (Smartphone, Tablet etc.)</p></li><li><p>USB-Bondrucker (muss das ESC/POS-Protokoll beherrschen, aber das ist i.d.R. immer der Fall bei Bondruckern)</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Installation-2">Installation<a class="headerlink" href="#Installation-2">¶</a></h3><p>
Die Installation besteht aus folgenden Schritte:
</p><ol class="arabic"><li><p>Installation der richtigen Umgebung (Webserver, Datenbank, PHP mit den richtigen Extensions)</p></li><li><p>Installation der Webapplikation</p></li><li><p>Installation des Druckservers (Einbau als Service)</p></li></ol><p>
</p><div class="section_3"><h4 id="Installation-der-Umgebung">Installation der Umgebung<a class="headerlink" href="#Installation-der-Umgebung">¶</a></h4><p>
Beim hier vorgestellten Installationsweg soll ein LAMP-System (Linux-Apache-MariaDB-PHP) aufgesetzt werden. Alternativ zu Apache könnte man auch Nginx oder lighttpd verwenden. Als PHP-Version soll die Version 7 verwendet werden. Der OrderSprinter-Autor testet seine Software zwar mit PHP 5.6, aber PHP 7 ist neuer und schneller in der Abarbeitung. Als Datenbank kann man MariaDb den Vorzug vor MySql geben, weil der OrderSprinter-Entwickler MariaDb für seine Tests verwendet und beide Datenbanken funktionell gleichwertig sind. Je näher man die Umgebung nachbildet, in der eine Software programmiert wird, desto besser ist vermutlich die Kompatibilität gewährleistet. Zusätzlich sind einige php-Erweiterungen zu installieren, die von OrderSprinter später benötigt werden. Die Installation von Java wird für den Druckerserver benötigt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install apache2
sudo apt-get install libapache2-mod-php7.0
sudo apt-get install php7.0 php7.0-mysql
sudo apt-get install mariadb-server
sudo apt-get install php-gd php-curl php-zip
sudo service apache2 restart
sudo apt-get install openjdk-8-jre </pre></div></div><p>Die Installation des Datenbank-Servers installiert den Client automatisch mit. Die Datenbank hat nun noch kein Passwort und es ist einfach möglich, als root darin zu arbeiten:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mysql -u root -p </pre></div></div><p>Die Eingabeaufforderung für das Passwort kann man mit Return bestätigen. Wie man anschließend sieht, kann die DB nun bedient werden. Es ist sicherlich eine gute Idee, ein Passwort zu setzen und die DB weiter abzusichern. Dieses Howto hat jedoch nicht den Schwerpunkt auf Datenbanksicherkeit, deswegen sei hierzu auf die Howtos zu MySql und MariaDB verwiesen.</p><p>OrderSprinter benötigt eine Datenbank, also soll sie nun vorbereitet werden:</p><div class="bash"><div class="contents"><pre class="notranslate">CREATE DATABASE ordersprinter DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci; </pre></div></div><p>Anschließend wird ein Benutzer definiert, der alle Rechte in der Datenbank besitzt:</p><div class="bash"><div class="contents"><pre class="notranslate">GRANT ALL ON ordersprinter.* TO os@localhost IDENTIFIED BY "secret"; </pre></div></div><p>Auch hier kann man sich überlegen, ob nicht alle Rechte vergeben werden sollen.</p></div><div class="section_3"><h4 id="Installation-der-Webapplikation">Installation der Webapplikation<a class="headerlink" href="#Installation-der-Webapplikation">¶</a></h4><p>
OrderSprinter lässt sich von <a class="external" href="http://www.ordersprinter.de" rel="nofollow" title="http://www.ordersprinter.de">http://www.ordersprinter.de</a> auf der Unterseite "Download" herunterladen.</p><p>Wenn man das Downloadpaket von OrderSprinter entpackt (<code class="notranslate">unzip</code>), so sieht man mehrere Unterverzeichnisse:
</p><ul><li><p><em>webapp:</em> die Kernkomponente</p></li><li><p><em>printserver:</em> der Windows-Printserver (für eine Installation auf Ubuntu nicht interessant)</p></li><li><p><em>javaprinter:</em> der Java-Printserver, der später auf dem Ubuntu-System den Bondrucker bedienen soll</p></li><li><p><em>scripts:</em> Beispiel-Skripte für eine Datensicherung auf einem Memory-Stick</p></li></ul><p>
Hat man Apache wie oben beschrieben installiert, so liefert er standardmäßig die Dateien unter <code class="notranslate">/var/www/html</code> an anfragende Webclients aus. Da die Kernkomponente eine Webapplikation ist, muss diese nun nach <code class="notranslate">html</code> verschoben werden. Dazu wechselt man in das Verzeichnis des entpackten OrderSprinter-Downloads und kopiert die Dateien des webapp-Verzeichnisses in den Webspace:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mv webapp/* /var/www/html/ </pre></div></div><p>Damit die Installation funktioniert, müssen während der Installation das Unterverzeichnis php und die darin enthaltene Datei config.php vom Webserver beschreibbar sein. Der Account und die Gruppe, unter der Apache standardmäßig läuft, ist www-data. Daher sollte zunächst der Eigentümer der Dateien geschrieben werden. Wird das chown-Kommando mit dem R-Flag aufgerufen, so werden die Verzeichnis rekursiv durchlaufen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chown -R www-data:www-data /var/www/html </pre></div></div><p>Anschließend gibt man der Gruppe und dem Benutzer der Dateien Schreibrechte auf das Verzeichnis <em>php</em> und die darin enthaltene Datei <em>config.php</em>. Das Verzeichnis <em>php</em> muss dazu auch Execute-Rechte besitzen, damit das Installationsskript auf den Inhalt zugreifen kann:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod 774 /var/www/html/php
sudo chmod 664 /var/www/html/php/config.php </pre></div></div><p>Die Systemumgebung ist nun eingerichtet, so dass im nächsten Schritt die Installation von OrderSprinter vorgenommen werden kann.</p></div></div></div><div class="section_1"><h2 id="Ersteinrichtung">Ersteinrichtung<a class="headerlink" href="#Ersteinrichtung">¶</a></h2><p>
Die Ersteinrichtung besteht aus folgenden Schritten:
</p><ol class="arabic"><li><p>Aufruf der Installationsseite von OrderSprinter und Wahl geeigneter Startparameter</p></li><li><p>Grundlegende Konfiguration, so dass der Druckerservice die Jobs beim OrderSprinter abholen kann.</p></li><li><p>Beispielspeisekarte, Raumplan, Benutzer</p></li></ol><p>
</p><div class="section_2"><h3 id="Installation-der-Webapplikation-2">Installation der Webapplikation<a class="headerlink" href="#Installation-der-Webapplikation-2">¶</a></h3><p>
Öffnet man den Webbrowser (z.B. Firefox, denn damit testet auch der OrderSprinter-Autor) und ruft die URL <a class="external" href="http://localhost" rel="nofollow" title="http://localhost">http://localhost</a> auf, sollte man die Installationsseite sehen. Erscheint stattdessen die Ubuntu-Informationsseite, wird Inhalt aus dem Cache dargestellt. In diesem Fall hilft ein Reload der Webseite.</p><p>Im ersten Schritt muss man sich für die Sprache entscheiden. Zur Auswahl stehen Deutsch, Englisch und Spanisch. Die gewählte Sprache wird nicht nur für die Installation verwendet, sondern auch den Beispielbenutzern automatisch zugewiesen (kann aber später geändert werden).</p><p>Anschließend wird die Zeitzone abgefragt. Die Zeitzone ist wichtig, damit die Zeitangaben auf den Kassenbons später korrekt sind.</p><p>Danach erreicht man die wichtigste Einstellungsseite:</p><p><img alt="installationsseite.png" class="image-default" src="../_/3769b0bc957b7187d0decc8c4ac7bb1700786042.png"/></p><p>Im Bereich Datenbank sind die Einstellungen für Datenbank-Name, -Benutzer und -Passwort vorzunehmen, die im vorangegangenen Abschnitt beim Anlegen der Datenbank festgelegt wurden (<code class="notranslate">ordersprinter, os, secret</code>). Ein Tabellenpräfix kann frei gewählt werden. Das Präfix ist nur dann interessant, wenn mehrere Applikationen die gleiche Datenbank verwenden sollen. Das ist für die Installation in kommerziellen Webpaketen interessant. In einem selbst verwalteten Ubuntu-System kann man sich beliebig viele Datenbanken anlegen, so dass die Einstellung hier irrelevant ist.
Drückt man nun den Button <code class="notranslate">Teste DB-Zugriff</code>, sollte eine mögliche Fehlermeldung durch ein <code class="notranslate">OK</code> ersetzt werden.</p><p>Wurden die Schreibrechte richtig gesetzt, so wird auch dies angezeigt.</p><p>Fehlen php-Erweiterungen, so würden die fehlenden Erweiterungen hier angezeigt.</p><p>Bevor die Installation startet, muss man ein Administrator-Passwort festlegen.</p><p>Die Installation startet, wenn man den Button <code class="notranslate">Starte Installation</code> anklickt. Dabei werden die Tabellen in der Datenbank angelegt, gewisse Voreinstellungen vorgenommen und die Konfigurationsdatei <em>config.php</em>, die die Zugangsparameter für die Datenbank enthält, beschrieben. Dieser Vorgang kann einige Sekunden in Anspruch nehmen.</p><p>Anschließend muss man sich für einen Arbeitsablauf entscheiden:</p><ul><li><p><em>Digital:</em> Verzicht auf Arbeitsbons. Bestellungen werden in einer Küchen- und Baransicht aufgeführt.</p></li><li><p><em>Arbeitsbons:</em> Bestellungen werden auf Arbeitsbons ausgedruckt (klassischer Ablauf in Gastronomiebetrieben)</p></li><li><p><em>Arbeitsbons und Digital</em>: Der Kellner kann sich bei der Bestellaufnahme entscheiden, welchen Arbeitsablauf er für die jeweilige Bestellung wünscht.</p></li></ul><p> 
Hat man noch keine Erfahrung mit der Software gemacht, bietet sich die letzte Einstellung an, da man alle Optionen austesten kann.</p><p>In einem abschließenden Schritt kann wählen, ob neben einem obligatorisch angelegten Admin-Benutzer weitere Benutzer, eine Beispielspeisekarte und ein Musterraumplan angelegt werden sollen. Auch hier sollte man zum Einstieg die letzte Option wählen, denn Löschen und Überschreiben von Einstellungen sind jederzeit möglich.</p><p><img alt="beispieldaten.png" class="image-default" src="../_/340aec531533b8e11a83cb2fde2c1d68a6b98c4c.png"/></p><p>Hat man sich entschieden, neben dem Admin weitere Benutzer anzulegen, bekommen diese Benutzer ebenso das im vorangegangenen Schritt eingegebene Passwort zugewiesen.</p><p>Die Installation ist abgeschlossen, wenn folgende Meldung erscheint:</p><p><img alt="installationfertig.png" class="image-default" src="../_/ba7b5d1a4f37f76b7da392d4a9dc58524c099d7e.png"/></p><p>Bestätigt man diese Meldung, so wird man zur Anmelde-Seite weitergeleitet.</p><p>In einem produktiven System sollte man das Unterverzeichnis <code class="notranslate">install</code> löschen.</p></div><div class="section_2"><h3 id="Grundlegende-Konfiguration">Grundlegende Konfiguration<a class="headerlink" href="#Grundlegende-Konfiguration">¶</a></h3><p>
In der Grundkonfiguration müssen Basisdaten festgelegt werden, damit der Druckserver z.B. später die Druckjobs abrufen darf. Dazu wählt man den  <em>admin</em> als Benutzer aus, gibt das während der Installation gewählte Passwort ein und drückt beherzt auf den Anmelden-Button:</p><p><img alt="einloggenadmin.png" class="image-default" src="../_/f446723396cbe82d31bd70b7fb4a18d7812ad469.png"/></p><p>Die erste Seite zeigt beim Erstmaligen Anmelden eines Benutzers stets die persönlichen Einstellungen an, so dass man hier die Möglichkeit hat, die Sprache gegebenenfalls zu ändern. Als Admin wählt man über das Hauptmenü nun die Ansicht Verwaltung aus.</p><p>Dort befinden sich viele aufklappbare Bereiche. Im Panel <em>Konfiguration</em> muss nun ein Printcode zugewiesen werden. Dieser dient später dazu, dass sich der Druckservice mit der Webapplikation über eine REST-Schnittstelle die Printjobs abholen darf. Als Beispiel sei hier der Printcode 123 eingegeben. Am Ende des Panels befindet sich ein Ändern-Button, nach dessen Anklicken die Einstellung übernommen wird.</p><p><img alt="printcode.png" class="image-default" src="../_/b50e6f996c659e4679e1019672d2b203da359769.png"/></p><p>Im Konfigurationsbereich können noch viele andere Einstellungen vorgenommen werden, die meisten sind jedoch erst für den produktiven Betrieb relevant (z.B. Betriebsinformation für den Kassenbon).</p><p>Neben den während der Installation angelegten Beispielbenutzern können im aufklappbaren Bereich <strong>Benutzer</strong> weitere Benutzer angelegt werden. Beim Anlegen kann man festlegen, welche Rechte der Benutzer haben soll. In den benutzerspezifischen Einstellungen kann jeder Benutzer das ihm zugewiesene Passwort ändern sowie weitere Präferenzen einstellen.</p><p>Im Bereich Datenbank kann man den Beispiel Raumplan überschreiben und ein oder mehrere Räume mit Tischen anlegen. Wird nur ein Raum angelegt, so wird später bei der Bestellaufnahme und in der Kassenansicht die Raumauswahl übersprungen.</p></div></div><div class="section_1"><h2 id="Druckerserver">Druckerserver<a class="headerlink" href="#Druckerserver">¶</a></h2><p>
Der Javaprintserver ist speziell für den Einsatz auf einem Linux-System programmiert worden. Wenn man den OrderSprinter-Download entpackt, befindet er sich im Unterverzeichnis javaprinter. Der Programmautor empfiehlt, den javaprinter in ein Systemverzeichnis zu kopieren und entweder unter Root-Rechten zu starten oder mit einem Account, dem man Berechtigungen für einen Schreibzugriff auf den USB-Port gegeben hat:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cp -Ra javaprinter/* /usr/local/bin </pre></div></div><p>Im nächsten Schritt sollte die VendorID und ProductID des Bondruckers ermittelt werden. Da möglicherweise viele weitere Geräte am USB-Port hängen, kann man sich die Arbeit erleichtern, wenn man das lsusb-Kommando vor und nach dem Anstecken des Druckers ausführt und die Differenz der Ausgaben betrachtet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lsusb -v &gt; /tmp/ohne-drucker.txt
# nun schließt man den Drucker an und schaltet ihn ein
sudo lsusb -v &gt; /tmp/mit-drucker.txt
diff /tmp/ohne-drucker.txt /tmp/mit-drucker.txt
rm /tmp/*-drucker.txt </pre></div></div><p>Die Werte für VendorID und ProductID sollte man sich notieren.</p><p>Damit der Druckserver eine Verbindung zum Drucker aufnehmen kann, muss die Konfigurationsdatei in /usr/local/bin/config.json bearbeitet werden.</p><ul><li><p>printersize: Für einen 58mm-Drucker ist ein Wert von 32, für einen 80mm-Drucker von 40 optimal. Der Wert stellt die Anzahl der Zeichen pro Zeile dar und kann von Drucker zu Drucker leicht variieren.</p></li><li><p>printcode: Hier ist der Printcode einzugeben, der zuvor in der Konfiguration festgelegt wurde (im angegebenen Beispiel war es <code class="notranslate">123</code>).</p></li></ul><p>
Die restlichen Eingaben sollen zunächst ignoriert werden. Damit sieht die Datei für einen 58mm-Drucker beispielsweise so aus:</p><pre class="notranslate">{
   "instance" : 1,
   "vendorid" : "4348",
   "productid" : "5584",
   "printersize" : 32,
   "printcode" : "123",
   "baseurl":"http://localhost",
   "baseusername" : "",
   "basepass" : "",
   "escinits" : [ 27, 64, 27, 116, 0 ],
   "escposts" : [ 29, 86, 66, 10, 27, 64],
   "useeveryprintdevice" : 1,
   "verbose_closing_summary" : 1,
   "smallformat" : 0,
   "logoscale" : 1.0
}</pre><p>Ein erster Test lässt sich so durchführen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo java -jar /usr/local/bin/javaprinter.jar /usr/local/bin/config.json </pre></div></div><p>Wenn der Druckerserver sich mit der OrderSprinter-Webapplikation verbinden kann, sieht man folgende Ausgabe:</p><div class="bash"><div class="contents"><pre class="notranslate">fee@feeserver:~$ sudo java -jar /usr/local/bin/javaprinter.jar /usr/local/bin/config.json 
Read: /usr/local/bin/config.json
Instance: 1
Config: Config [printersize=32, vendorid=4348, productid=5584, currency=Euro, decpoint=,, companyinfo=Musterrestaurant
Beispielstrasse 123
12345 Musterort, escinits=[27, 64, 27, 116, 0], escposts=[29, 86, 66, 10, 27, 64], printcode=123, baseurl=http://localhost, baseusername=, basepass=, verbose_closing_summary=1]
Scaled from 640 to width: 384 by scale 0.6 </pre></div></div><p>Nun ist es an der Zeit, den ersten Druckjob zu generieren. In der Weboberfläche kann man sich als <em>normaler</em> Benutzer einloggen (ein Admin hat in der Standardeinstellung keinen Zugriff auf die Bestellansicht), ein Produkt in der Bestellansicht auswählen und auf den Button <strong>Arbeitsbon</strong> klicken.</p><p>Möglicherweise sieht man in der Ausgabe des Druckerservers nun eine Fehlermeldung, die sich über einen nicht gefundenen Drucker beschwert:</p><div class="bash"><div class="contents"><pre class="notranslate">Print Work Job: 1
Cannot find a receipt printer - cannot print </pre></div></div><p>In diesem Fall hat sich der Drucker am USB-Port nicht als Drucker angemeldet. Zu diesem Zweck wurde die <em>VendorId</em> und <em>ProductID</em> vorher ermittelt. Die Werte müssen dann in die <em>config.json</em> eingetragen werden und zusätzlich der Parameter <code class="notranslate">useeveryprintdevice</code> auf <code class="notranslate">0</code> gesetzt werden.</p><p>Startet man den Druckerserver erneut, sollte die Fehlermeldung verschwinden und ein Arbeitsbon gedruckt werden.</p><p>Nun soll der Druckerserver jedoch bei jedem Systemstart automatisch starten. Ubuntu nutzt in 17.04 systemd. Dazu muss der javaprinter als Service konfiguriert werden.</p><p>Im ersten Schritt legt man eine Datei /usr/local/bin/javaprinter.bat mit folgendem Inhalt an:</p><pre class="notranslate">#!/bin/sh 
/usr/bin/java -jar /usr/local/bin/javaprinter.jar /usr/local/bin/config.json &amp;</pre><p>Die Datei muss ausführbar sein:</p><div class="bash"><div class="contents"><pre class="notranslate">chmod +x javaprinter </pre></div></div><p>Nun muss man eine Service-Beschreibung erstellen. Dazu wird eine Datei /etc/systemd/system/javaprinter.service mit folgendem Inhalt angelegt:</p><pre class="notranslate">[Unit]
Description=OrderSprinter-Javaprinter

[Service]
Type=forking
ExecStart=/usr/local/bin/javaprinter.bat

[Install]
WantedBy=multi-user.target</pre><p>Nachdem der Service beschrieben wurde, muss er aktiviert und gestartet werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl enable javaprinter.service
sudo systemctl start javaprinter </pre></div></div><p>Hiermit ist die Installation eines Grundsystems abgeschlossen. Wer mehr aus der Software herausholen möchte, sei auf die Dokumentation auf der Homepage des Programms verwiesen.</p></div><div class="section_1"><h2 id="Test">Test<a class="headerlink" href="#Test">¶</a></h2><p>
Die Installation ist abgeschlossen. Meldet man sich mit der Option <em>Desktop</em> auf dem PC an, so sollte die Kellneransicht wie folgt aussehen:</p><p><img alt="kellneransicht.png" class="image-default" src="../_/5f6a5acd2b1d8ae24d61bbdbef2464dc16f12cbc.png"/></p><p>Ein wichtiger Test ist auch der Zugriff über ein Smartphone auf die Weboberfläche. Meldet man sich als Kellner an, wählt aber die Option Mobil, so sieht man eine für Mobilgeräte optimierte Webseite. Im Fall einer Installation mit Musterdaten sieht die Seite so aus:</p><p><img alt="mobilebestellansicht.png" class="image-default" src="../_/528031858d98269bb603c620b0adfae4919c5693.png"/></p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
Dieses Howto sollte die Installation von OrderSprinter auf einem frischen Standard 17.04-Ubuntu beschreiben. Ist das System jedoch nicht frisch aufgesetzt worden, oder soll OrderSprinter auf einer anderen Ubuntu-Version installiert werden, mögen die Annahmen über die Umgebung nicht zutreffen. In diesem Fall sollen hier einige Hilfestellungen gegeben werden.</p><p>Bei Änderungen, die den Webserver oder die PHP-Konfiguration betreffen, muss im Anschluss der Webserver neu gestartet werden, damit die Änderungen wirksam werden (sudo apache2ctl restart).</p><div class="section_2"><h3 id="Nicht-vorhandenene-PHP-Erweiterungen">Nicht vorhandenene PHP-Erweiterungen<a class="headerlink" href="#Nicht-vorhandenene-PHP-Erweiterungen">¶</a></h3><p>
Um alle Funktionen der Software nutzen zu können, muss PHP mit folgenden Extensions installiert sein:
</p><ul><li><p>gd</p></li><li><p>mysqli</p></li><li><p>openssl</p></li><li><p>pdo_mysql</p></li><li><p>PDO</p></li><li><p>session</p></li><li><p>zlib</p></li><li><p>curl</p></li><li><p>zip</p></li><li><p>ftp</p></li></ul><p>
Eine Installation kann auch ohne alle diese Erweiterungen durchgeführt werden, jedoch können viele Funktionen dann zu Fehlern führen. Über den Aufruf <code class="notranslate">http://localhost/install/phpinfo.php</code> kann man sich die PHP-Konfiguration ausgeben lassen, wenn man das Install-Verzeichnis noch nicht gelöscht hat.</p></div><div class="section_2"><h3 id="berschreitung-des-Zeitlimits-auf-langsamen-Servern">Überschreitung des Zeitlimits auf langsamen Servern<a class="headerlink" href="#berschreitung-des-Zeitlimits-auf-langsamen-Servern">¶</a></h3><p>
In der Datei php.ini (deren Speicherort man ebenso über einen Aufruf von <code class="notranslate">http://localhost/install/phpinfo.php</code> ermitteln kann, sind gewisse Vorgaben für die maximal erlaubte Ausführungszeit eines PHP-Skripts enthalten, die für die meisten Systemen passen. Ist der Rechner jedoch sehr langsam, ist eine Erhöhung der <code class="notranslate">max_execution_time</code> ratsam.</p></div><div class="section_2"><h3 id="Zuweisung-des-Memory-Limits">Zuweisung des Memory-Limits<a class="headerlink" href="#Zuweisung-des-Memory-Limits">¶</a></h3><p>
Wenn nach ausgiebigem Test bestimmte Funktionen nicht mehr funktionieren (Backup, Restore, PDF-Reports), kann es sein, dass die Datenmenge so groß geworden ist, dass der für PHP zugewiesene Speicher nicht ausreicht. In diesem Fall sollte der Wert memory_limit in der php.ini vergrößert werden.</p></div><div class="section_2"><h3 id="Upload-von-Dateien-funktioniert-nicht">Upload von Dateien funktioniert nicht<a class="headerlink" href="#Upload-von-Dateien-funktioniert-nicht">¶</a></h3><p>
In der php.ini lässt sich einstellen, wie groß die maximale Größe einer hochladbaren Datei sein darf. Die zu ändernde Variable lautet <code class="notranslate">max_post_size</code>.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.ordersprinter.de" rel="nofollow" title="http://www.ordersprinter.de">http://www.ordersprinter.de</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - OrderSprinter-Homepage</p></li><li><p><a class="external" href="https://de.wikibooks.org/wiki/POSper_Handbuch" rel="nofollow" title="https://de.wikibooks.org/wiki/POSper_Handbuch">https://de.wikibooks.org/wiki/POSper_Handbuch</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - POSper-Handbuch</p></li><li><p><a class="external" href="http://www.openbravo.com" rel="nofollow" title="http://www.openbravo.com">http://www.openbravo.com</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Offizielle Seite von OpenBravo POS und OpenBravo ERP</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter/a/revision/944729.html">Diese Revision</a> wurde am 6. November 2017 10:09 von <a href="https://ubuntuusers.de/user/noisefloor/">noisefloor</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../howto.html">Howto</a></li>
<li><a href="../howto/aufsetzen_eines_gastro-kassensystems_mit_ordersprinter.html">Aufsetzen eines Gastro-Kassensystems mit OrderSprinter</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>