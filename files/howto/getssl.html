<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Howto/getssl › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../howto/getssl.html">getssl</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Howto/getssl">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../howto/getssl/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../howto/getssl/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../howto/getssl/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../howto/getssl/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../howto/getssl/a/backlinks.html">getssl</a></h1>
<div id="page"><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die Verwendung dieses Howto geschieht auf eigene Gefahr. Bei Problemen mit der Anleitung melde dies bitte in der dazugehörigen Diskussion und wende dich zusätzlich an den Verfasser des Howtos.
</p></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Diese Howto-Anleitung wurde zuletzt von <a class="crosslink user" href="https://ubuntuusers.de/user/VolkerRaschek/">VolkerRaschek</a> am 29.11.2016 unter <strong>Ubuntu 14.04</strong> und <strong> Ubuntu 16.04</strong> erfolgreich getestet.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../dns-server_bind.html">DNS Records richtig setzen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../apache_2.4.html">Aliase definieren</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../git.html">Quellcode von git herunterladen</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../cron.html">Ein Cronjob anlegen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Vorwort">Vorwort
</a></li><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Anlegen-eines-Aliases-unter-Apache2">Anlegen eines Aliases unter Apache2
</a></li><li><a class="crosslink" href="#Herunterladen-von-getSSL-via-git">Herunterladen von getSSL via git
</a></li></ol></li><li><a class="crosslink" href="#getSSL-Einrichten">getSSL Einrichten
</a><ol class="arabic"><li><a class="crosslink" href="#getSSL-und-seine-Parameter">getSSL und seine Parameter
</a></li><li><a class="crosslink" href="#Konfigurationsverzeichnis-erzeugen">Konfigurationsverzeichnis erzeugen
</a></li><li><a class="crosslink" href="#Konfiguration-anpassen">Konfiguration anpassen
</a></li><li><a class="crosslink" href="#Beispiel-Konfiguration-fuer-die-Domain-example-com">Beispiel Konfiguration für die Domain ex...</a></li><li><a class="crosslink" href="#Zertifikate-erzeugen">Zertifikate erzeugen
</a></li></ol></li><li><a class="crosslink" href="#Automatische-Aktualisierung-mittels-Cronjob">Automatische Aktualisierung mittels Cronjo...</a></li></ol></div><p>
</p><div class="section_1"><h2 id="Vorwort">Vorwort<a class="headerlink" href="#Vorwort">¶</a></h2><p>
In diesem Artikel wird beschrieben, wie man mithilfe des Scripts <a class="external" href="https://github.com/srvrco/getssl" rel="nofollow">getSSL</a> von Let's Encrypt allgemein gültige Zertifikate erzeugen lassen kann. Dies ist eine Alternative zu <a class="external" href="https://certbot.eff.org/" rel="nofollow">certbot</a> und bietet dem Nutzer mehr Kontrolle und Flexibilität. Dazu gibt es zwei verschiedene Verfahren die Zertifikate von Let's Encrypt validieren zu lassen. Das erste Verfahren basiert auf DNS-Einträge, das zweite auf validierung per Verifizierungscodes die über einen Webserver veröffentlicht werden. In diesem Artikel wird letzteres beschrieben. Hierzu ist es notwendig, dass ein Webserver über das Internet erreichbar ist. Die Installation des Webservers wird vorausgesetzt. Zur validierung der Zertifikate wird Apache2 als Webserver eingesetzt. Beispielhaft sollen Zertifikate für die Domain <strong>example.com</strong> erstellt werden mit den Subdomains <strong>mail.example.com</strong>, <strong>shop.example.com</strong>, <strong>www.example.com</strong>. Dies sind ausschließlich Beispielhafte Domainnamen und sollten durch die eigenen Domains, Subdomains oder DynDNS-Adressen ersetzt werden.</p></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Alle Befehle werden als root Benutzer ausgeführt. Dazu ist es notwendig sich im Terminal als root Benutzer anzumelden. 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo -i </pre></div></div><div class="section_2"><h3 id="Anlegen-eines-Aliases-unter-Apache2">Anlegen eines Aliases unter Apache2<a class="headerlink" href="#Anlegen-eines-Aliases-unter-Apache2">¶</a></h3><p>
Als nächstes wird ein Alias definiert unter Apache2. Der Alias bewirkt, dass jeder Aufruf unabhängig von der Domain und Subdomain, soweit diese auf dem Server gehostet sind, in ein und das selbe Verzeichnis verweisen. Dazu wird eine neue Alias-Datei angelegt unter <strong>/etc/apache2/conf-available</strong>.</p><div class="bash"><div class="contents"><pre class="notranslate">echo "Alias /.well-known /var/www/letsencrypt/.well-known" &gt; /etc/apache2/conf-available/letsencrypt.conf </pre></div></div><p>Der Alias soll in das Verzeichnis <strong>/var/www/letsencrypt</strong> verweisen. Nun wird das Verzeichnis letsenctypt angelegt mit zwei Unterverzeichnissen, die später zur Verifizierung der Domains, Subdomains oder DynDNS-Adressen zuständig sein sollen. In dem Verzeichnis acme-challenge werden sobald Domains, Subdomains oder DynDNS-Adressen verifiziert werden, Verifizierungscodes automatisch abgelegt, sodass Let's Encrypt diese abrufen kann. Dazu ist es notwendig, dass ein Zugriff aus dem Internet möglich ist. Die Verifizierungscodes werden nach Abschluss der Verifizierung entfernt.
</p><div class="bash"><div class="contents"><pre class="notranslate">mkdir -p /var/www/letsencrypt/.well-known/acme-challenge/ </pre></div></div><p>Man Aktiviert das Alias unter Apache2 und starten den Dienst neu.
</p><div class="bash"><div class="contents"><pre class="notranslate">a2enconf letsencrypt
service apache2 reload </pre></div></div><p>Zum testen kann man im Browser nun die Domain <strong>example.com/.well-known</strong> oder die Subdomains mit <strong>mail.example.com/.well-known</strong>, <strong>shop.example.com/.well-known</strong> oder <strong>www.example.com/.well-known</strong> aufrufen. Alle Adressen sollten im Browser das Verzeichnis acme.challenge anzeigen.</p></div><div class="section_2"><h3 id="Herunterladen-von-getSSL-via-git">Herunterladen von getSSL via git<a class="headerlink" href="#Herunterladen-von-getSSL-via-git">¶</a></h3><p>
Nun wird das Script <a class="external" href="https://github.com/srvrco/getssl" rel="nofollow">getSSL</a> von <a class="external" href="https://github.com/" rel="nofollow">github</a> heruntergeladen in das Heimatverzeichnis von dem Benutzer root. Anschließend wird das Verzeichnis <strong>./getssl</strong> in das Verzeichnis <strong>/etc</strong> verschoben.
</p><div class="bash"><div class="contents"><pre class="notranslate">git clone https://github.com/srvrco/getssl
mv ./getssl /etc </pre></div></div></div></div><div class="section_1"><h2 id="getSSL-Einrichten">getSSL Einrichten<a class="headerlink" href="#getSSL-Einrichten">¶</a></h2><p>
</p><div class="section_2"><h3 id="getSSL-und-seine-Parameter">getSSL und seine Parameter<a class="headerlink" href="#getSSL-und-seine-Parameter">¶</a></h3><p>
Nachdem nun alle Dateien von getSSL unter <strong>/etc/getssl</strong> liegen, kann man nun mittels <code class="notranslate">/etc/getssl/getssl &lt;Parameter&gt;</code> Parameter übergeben. Hier ist eine Tabelle aller Parameter mit Bedeutung.</p><table><tr class="titel"><td colspan="5"> Parameter für getSSL </td></tr><tr class="kopf"><td style="width: 2%">Parameter </td><td style="text-align: center; width: 10%"> Bedeutung </td></tr><tr><td> -a, --all  </td><td> Überprüft alle Zertifikate auf Erneuerung  </td></tr><tr><td> -d --debug  </td><td> Gibt Informationen zum Debuggen aus  </td></tr><tr><td> -c, --create  </td><td> Erstellt Konfigurationsdateien für die zu Zertifizierende Domain </td></tr><tr><td> -f, --force  </td><td> Zwingt auf Erneuerung der Zertifikate, obwohl diese noch nicht abgelaufen sind  </td></tr><tr><td> -h, --help  </td><td> Zeigt diese Hilfe an </td></tr><tr><td> -q, --quiet </td><td> Stiller Modus, zeigt nur einen Output bei Fehlern, Bestätigung bei Erneuerung von Zertifikaten oder wenn getSSL aktualisiert wurde an </td></tr><tr><td> -Q, --mute </td><td> Das gleiche wie -q bzw. --quite, nur dass auch Benachrichtigungen über die erfolgreiche Erneuerung von SSL Zertifikaten verhindert wird </td></tr><tr><td> -r, --revoke cert key </td><td> Entzieht dem Zertifikat die Gültigkeit. Benötigt das Zertifikat als auch den Private Key </td></tr><tr><td> -u, --upgrade </td><td> Aktualisiert und überprüft die getSSL Dateien auf eine neuere Version </td></tr><tr><td> -U, --nocheck </td><td> Aktualisiert und überprüft nicht die getSSL Dateien auf eine neuere Version </td></tr><tr><td> -w, --working_dir </td><td> Legt das Arbeitsverzeichnis fest </td></tr></table><p>
</p></div><div class="section_2"><h3 id="Konfigurationsverzeichnis-erzeugen">Konfigurationsverzeichnis erzeugen<a class="headerlink" href="#Konfigurationsverzeichnis-erzeugen">¶</a></h3><p>
Als nächstes legt man für die Domain <strong>example.com</strong> eine neues Konfigurationsverzeichnis an. Dies wird ohne den Parameter <strong>-w</strong> Standardmäßig in das Heimatverzeichnis des aktuellen Benutzers erzeugt unter <strong>~/.getssl/&lt;domain&gt;</strong>. Dieses Verzeichnis wird auch <strong>Arbeitsverzeichnis</strong> oder <strong>working dir</strong> genannt.
</p><div class="bash"><div class="contents"><pre class="notranslate">/etc/getssl/getssl -c example.com </pre></div></div></div><div class="section_2"><h3 id="Konfiguration-anpassen">Konfiguration anpassen<a class="headerlink" href="#Konfiguration-anpassen">¶</a></h3><p>
Die Datei <strong>~/.getssl/example.com/getssl.cfg</strong> wird bearbeitet
</p><div class="bash"><div class="contents"><pre class="notranslate">nano ~/.getssl/example.com/getssl.cfg </pre></div></div><p>Zu beginn der Konfigurationsdatei für die Domain example.com findet man Einstellungen für einen Server. Hier gibt es zwei Varianten. Einmal den staging Server, der Zertifikate ausstellt zum testen der Einstellungen. Die hierdurch erzeugten Zertifikate sind fake Zertifikate oder auch nicht vertrauenswürdige Zertifikate. Man kommentiert die Einstellung des Servers entsprechend ein oder aus nach unseren Bedürfnissen. Es ist jedoch Sinnvoll erst alles durch zu testen, weswegen auch der staging Server ein kommentiert ist.</p><pre class="notranslate"># The staging server is best for testing
CA="https://acme-staging.api.letsencrypt.org"
# This server issues full certificates, however has rate limits
#CA="https://acme-v01.api.letsencrypt.org"</pre><p>In dem nächsten Block wird definiert, welche E-Mail Adresse in den Zertifikaten hinterlegt wird. Welche Bit-Stärke der Primary-Key besitzen soll, wo er gespeichert wird und welches Verfahren angewendet wird. Dieser Private Key wird auch bei getSSL <strong>Account-Key</strong> genannt. Der Pfad zum Account-Key kann angepasst werden.
</p><pre class="notranslate"># Set an email address associated with your account - generally set at account level rather than domain.
ACCOUNT_EMAIL="webmaster@example.com"
ACCOUNT_KEY_LENGTH=4096
ACCOUNT_KEY="/etc/ssl/private/ca/ca.key"
PRIVATE_KEY_ALG="rsa"</pre><p>Im nächsten Absatz wird definiert, welche Subdomains zu dem Zertifikat hinzugefügt werden sollen. Jede aufgelistete Subdomain muss später unter der Webadresse <a class="external" href="http://&lt;subdomain&gt;.&lt;domain&gt;.&lt;tld&gt;/.well-known" rel="nofollow" title="http://&lt;subdomain&gt;.&lt;domain&gt;.&lt;tld&gt;/.well-known">http://&lt;subdomain&gt;.&lt;domain&gt;.&lt;tld&gt;/.well-known</a> verifiziert werden können.
</p><pre class="notranslate"># Additional domains - this could be multiple domains / subdomains in a comma separated list
# Note: this is Additional domains - so should not include the primary domain.
SANS=mail.example.com,shop.example.com,www.example.com</pre><p>Nun kommt der wichtigste Block. Die Einstellung, wie Let's Encrypt die Domains für die Zertifikate erzeugt werden sollen überprüfen kann. 
Dazu erzeugt das Skript Verifizierungscodes. Diese sind öffentlich abrufbar. Die Gegenstelle, also die Server von Let's Encrypt überprüfen somit, ob die Domain für die Zertifikate erzeugt werden sollen auch existiert und identisch sind mit denen, die auf den eigenen Servern von Let's Encrypt für die Domain vorgehalten sind. Diese Codes können auch auf andere Server ausgelagert werden sofern die Domain auf einen anderen Server zeigt per DNS Record.</p><p>Der erste ACL Eintrag gilt für die Domain. In dem Beispiel für <strong>example.com</strong>. Der zweite Eintrag in ACL würde für die Subdomain <strong>mail.example.com</strong> gelten, der dritte Eintrag in ACL für die Subdomain <strong>shop.example.com</strong>. So kann für jede Domain ein individueller Pfad angegeben werden wo die Verifizierungscode gespeichert werden sollen damit eine Verifizierung möglich ist. Sollen die Codes auf einen externen Server gespeichert werden, kann man das auch per SSH oder FTP einrichten.</p><p>Da der Server in diesem Beispiel alle Domains hostest wäre es ja unschön für jede Subdomain den gleichen Pfad (<strong>/var/www/letsencrypt/.well-known/acme-challenge</strong>) an zu geben. Dazu bietet uns das Skript die Möglichkeit ein Pfad für alle Domains, Subdomains und DynDNS-Adressen an zu geben. Hier bietet sich die Option USE_SINGLE_ACL an.</p><pre class="notranslate"># Acme Challenge Location. The first line for the domain, the following ones for each additional domain.
# If these start with ssh: then the next variable is assumed to be the hostname and the rest the location.
# An ssh key will be needed to provide you with access to the remote server.
# If these start with ftp: then the next variables are ftpuserid:ftppassword:servername:ACL_location
# These should be of the form "/path/to/your/website/folder/.well-known/acme-challenge"
# where "/path/to/your/website/folder/" is the path, on your web server, to the web root for your domain.
#ACL=('/var/www/example.com/web/.well-known/acme-challenge'
#     'ssh:server5:/var/www/example.com/web/.well-known/acme-challenge'
#     'ftp:ftpuserid:ftppassword:example.com:/web/.well-known/acme-challenge')

ACL=('/var/www/letsencrypt/.well-known/acme-challenge')

#Enable use of a single ACL for all checks
USE_SINGLE_ACL="true"</pre><p>Sobald Let's Encrypt die Domains verifizieren konnte, kann man optional angeben wo die Zertifikate gespeichert werden sollen. Hier werden die Zertifikate nur kopiert, da sie in Wirklichkeit im Arbeitsverzeichnis erstellt werden. In dem Arbeitsverzeichnis befindet sich auch das Archiv. Dort werden alle alten Zertifikate abgelegt. Das Arbeitsverzeichnis ist unter <strong>~/.getssl/example.com</strong> für die Domain <strong>example.com</strong> zu finden sofern das Verzeichnis mit dem Parameter <strong>-w</strong> nicht angepasst wurde.
</p><pre class="notranslate"># Location for all your certs, these can either be on the server (so full path name) or using ssh as for the ACL
DOMAIN_CERT_LOCATION="/etc/ssl/public/example.com/domain.crt"
DOMAIN_KEY_LOCATION="/etc/ssl/private/example.com/domain.key"
CA_CERT_LOCATION="/etc/ssl/public/example.com/chain.crt"
#DOMAIN_CHAIN_LOCATION="" # this is the domain cert and CA cert
#DOMAIN_KEY_CERT_LOCATION="" # this is the domain_key and domain cert
#DOMAIN_PEM_LOCATION="" # this is the domain_key. domain cert and CA cert</pre><p>Nun kommt der letzte Absatz. Indem eingestellt werden kann, wie viel Tage vor Ablauf der Zertifikate die Gültigkeit erneuert wird. Hierzu dient die Option RENEW_ALLOW. Die auf 30 Tage vor Ablauf der Gültigkeit eingestellt ist. Werden neue Zertifikate generiert bzw. die Gültigkeit erneuert, kann man über RELOAD_CMD Dienste neu starten, damit diese die neuen Zertifikate aufnehmen. Im Beispiel wird der Webserver Apache2 neu gestartet. 
</p><pre class="notranslate"># The command needed to reload apache / nginx or whatever you use
RELOAD_CMD="service apache2 reload"
# The time period within which you want to allow renewal of a certificate
#  this prevents hitting some of the rate limits.
RENEW_ALLOW="30"</pre></div><div class="section_2"><h3 id="Beispiel-Konfiguration-fuer-die-Domain-example-com">Beispiel Konfiguration für die Domain example.com<a class="headerlink" href="#Beispiel-Konfiguration-fuer-die-Domain-example-com">¶</a></h3><p>
Nun noch einmal die ganze Konfiguration für die Domain example.com.</p><pre class="notranslate"># Uncomment and modify any variables you need
# see https://github.com/srvrco/getssl/wiki/Config-variables for details
#
# The staging server is best for testing
CA="https://acme-staging.api.letsencrypt.org"
# This server issues full certificates, however has rate limits
#CA="https://acme-v01.api.letsencrypt.org"

#AGREEMENT="https://letsencrypt.org/documents/LE-SA-v1.1.1-August-1-2016.pdf"

# Set an email address associated with your account - generally set at account level rather than domain.
ACCOUNT_EMAIL="webmaster@cexample.com"
ACCOUNT_KEY_LENGTH=4096
ACCOUNT_KEY="/etc/ssl/private/ca/ca.key"
PRIVATE_KEY_ALG="rsa"

# Additional domains - this could be multiple domains / subdomains in a comma separated list
# Note: this is Additional domains - so should not include the primary domain.
SANS=mail.example.com,shop.example.com,www.example.com

# Acme Challenge Location. The first line for the domain, the following ones for each additional domain.
# If these start with ssh: then the next variable is assumed to be the hostname and the rest the location.
# An ssh key will be needed to provide you with access to the remote server.
# If these start with ftp: then the next variables are ftpuserid:ftppassword:servername:ACL_location
# These should be of the form "/path/to/your/website/folder/.well-known/acme-challenge"
# where "/path/to/your/website/folder/" is the path, on your web server, to the web root for your domain.
#ACL=('/var/www/example.com/web/.well-known/acme-challenge'
#     'ssh:server5:/var/www/example.com/web/.well-known/acme-challenge'
#     'ftp:ftpuserid:ftppassword:example.com:/web/.well-known/acme-challenge')

ACL=('/var/www/letsencrypt/.well-known/acme-challenge')

#Enable use of a single ACL for all checks
USE_SINGLE_ACL="true"

# Location for all your certs, these can either be on the server (so full path name) or using ssh as for the ACL
DOMAIN_CERT_LOCATION="/etc/ssl/public/example.com/domain.crt"
DOMAIN_KEY_LOCATION="/etc/ssl/private/example.com/domain.key"
CA_CERT_LOCATION="/etc/ssl/public/example.com/chain.crt"
#DOMAIN_CHAIN_LOCATION="" # this is the domain cert and CA cert
#DOMAIN_KEY_CERT_LOCATION="" # this is the domain_key and domain cert
#DOMAIN_PEM_LOCATION="" # this is the domain_key. domain cert and CA cert

# The command needed to reload apache / nginx or whatever you use
RELOAD_CMD="service apache2 reload"
# The time period within which you want to allow renewal of a certificate
#  this prevents hitting some of the rate limits.
RENEW_ALLOW="30"</pre></div><div class="section_2"><h3 id="Zertifikate-erzeugen">Zertifikate erzeugen<a class="headerlink" href="#Zertifikate-erzeugen">¶</a></h3><p>
Nachdem nun die Konfiguration für eine Domain abgeschlossen wurde kann man sich von getSSL die Zertifikate erzeugen lassen. Dazu verwendet man folgenden Befehl.
</p><div class="bash"><div class="contents"><pre class="notranslate">/etc/getssl/getssl -f example.com </pre></div></div><p>Ähnliche Meldungen sollten im Terminal zu sehen sein. Der Output wurde generiert für eine Domain, deren Zertifikate noch gültig waren, allerdings einer Erneuerung erzwungen wurde.
</p><pre class="notranslate">Registering account
Verify each domain
Verifying example.com
example.com is already validated
Verifying mail.example.com
mail.example.comis already validated
Verifying shop.example.com
shop.example.com is already validated
Verifying www.example.com
www.example.com is already validated
Verification completed, obtaining certificate.
Certificate saved in /root/.getssl/example.com/example.com.crt
The intermediate CA cert is in /root/.getssl/example.com/chain.crt
copying domain certificate to /etc/ssl/public/example.com/domain.crt
copying private key to /etc/ssl/private/example.com/domain.key
copying CA certificate to /etc/ssl/public/example.com/chain.crt
reloading SSL services
example.com - certificate installed OK on server
certificate obtained for example.com</pre></div></div><div class="section_1"><h2 id="Automatische-Aktualisierung-mittels-Cronjob">Automatische Aktualisierung mittels Cronjob<a class="headerlink" href="#Automatische-Aktualisierung-mittels-Cronjob">¶</a></h2><p>
Damit von getSSL die Zertifikate automatisch auf Gültigkeit überprüft werden, schlägt das Entwicklerteam einen Cronjobeintrag vor. Dazu wird Crontab des Benutzers root geöffnet.
</p><div class="bash"><div class="contents"><pre class="notranslate">crontab -e -u root </pre></div></div><p>Anschließend wird am Ende der Datei folgender Cronjobeintrag definiert. Dieser führt das getSSL Script Täglich um Mitternacht aus und überprüft alle Zertifikate im Stillenmodus und überprüft getSSL auf updates.
</p><pre class="notranslate"># Let' Encrypt
# SSL Zertifikate auf updates prüfen, täglich um 00:00 Uhr
        0       0       *       *       *       /etc/getssl/getssl -a -q -u
</pre></div></div>
<p class="meta">
<a href="../howto/getssl/a/revision/933258.html">Diese Revision</a> wurde am 1. Februar 2017 11:25 von <a href="https://ubuntuusers.de/user/frustschieber/">frustschieber</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../howto.html">Howto</a></li>
<li><a href="../howto/getssl.html">getssl</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>