<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Kernelmodule › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./kernelmodule.html">Kernelmodule</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Kernelmodule">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./kernelmodule/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./kernelmodule/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./kernelmodule/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./kernelmodule/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./kernelmodule/a/backlinks.html">Kernelmodule</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Befehle-fuer-Module">Befehle für Module
</a><ol class="arabic"><li><a class="crosslink" href="#Geladene-Module-anzeigen-lsmod-und-kmod">Geladene Module anzeigen: lsmod und kmod...</a></li><li><a class="crosslink" href="#Information-anzeigen-modinfo">Information anzeigen: modinfo
</a></li><li><a class="crosslink" href="#Module-laden-entladen-modprobe">Module laden/entladen: modprobe
</a></li><li><a class="crosslink" href="#Abhaengigkeiten-von-Modulen-depmod">Abhängigkeiten von Modulen: depmod
</a></li></ol></li><li><a class="crosslink" href="#Module-automatisch-laden">Module automatisch laden
</a></li><li><a class="crosslink" href="#Module-mit-Optionen-laden">Module mit Optionen laden
</a></li><li><a class="crosslink" href="#Automatisches-Laden-verhindern-Blacklisting">Automatisches Laden verhindern - Blacklist...</a></li><li><a class="crosslink" href="#bersicht-ueber-alle-Module">Übersicht über alle Module
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Dieser Artikel beschreibt den Umgang mit Kernelmodulen und den Hilfsmitteln, die das System bietet, um Module zu verwalten.</p><p>Grundsätzlich besitzt der Linux-<a class="internal" href="./kernel.html">Kernel</a> einen <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Linux_(Kernel)#Architektur">monolithischen Aufbau</a>, allerdings bietet er auch die Möglichkeit, Module zur Laufzeit zu laden und entladen. Unter einem Kernelmodul versteht man im Allgemeinen einen Teil bzw. eine Erweiterung des Kernels. So sind z.B. alle Hardwaretreiber (z.B. WLAN-Karte, Soundkarte...) als Modul angelegt.</p><p>Die meisten Linux-Distributionen inklusive Ubuntu machen starken Gebrauch von Kernelmodulen, da so die bestmögliche Hardwarekompatibilität mit nur einem "allgemeinen" Kernel erreicht werden kann. In der Regel werden alle notwendigen Module beim Systemstart und falls nötig zur Laufzeit geladen, so dass der Nutzer sich nicht weiter darum kümmern muss (bzw. es oft noch nicht einmal mitbekommt).</p><p>Installiertes Werkzeug für den Umgang mit den Modulen sind <strong>kmod</strong> bzw. die <strong>module-init-tools</strong>. Etwa um 2012 wurden letztere vom Projektleiter allerdings zu einem toten Projekt erklärt  und nicht weiter verfolgt, <strong>module-init-tools</strong> wurden durch das neuere Werkzeug <a class="interwiki interwiki-github" href="https://github.com/pedrox/kmod">kmod</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ersetzt. In den noch unterstützten Versionen von Ubuntu z.B. <a class="internal" href="./trusty_tahr.html">Trusty Tahr</a> die noch <strong>module-init-tools</strong> neben <strong>kmod</strong> nutzen, sind diese als Übergangspaket zur Unterstützung von <strong>kmod</strong> implementiert. Ab Ubuntu <a class="internal" href="./xenial_xerus.html">Xenial Xerus</a> ist nur noch <strong>kmod</strong> in der Standardinstallation enthalten.</p><p>Weitere Hinweise für die Anwendung von <strong>kmod</strong> siehe 
</p><div class="bash"><div class="contents"><pre class="notranslate">man kmod </pre></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Die Programme zum Umgang mit den Modulen sind grundsätzlich in der Standardinstallation enthalten, können aber ansonsten über die Pakete</p><ul><li><p><strong>kmod</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install kmod </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install kmod </pre></div></div><p>
</p></div></div><p>bzw. bis einschließlich Precise:</p><ul><li><p><strong>module-init-tools</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install module-init-tools </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install module-init-tools </pre></div></div><p>
</p></div></div><p>installiert werden <sup><a href="#source-1">[1]</a></sup>.</p><p>Installiert man in neueren Ubuntu Versionen <strong>module-init-tools</strong>, so wird <strong>kmod</strong> als Abhängigkeit vorausgesetzt. Daraus folgt, <strong>kmod</strong> ist zwar das neuere Werkzeug, arbeitet aber auch unter <strong>module-init-tools</strong>. Grundsätzlich kann aber das Werkzeug <strong>module-init-tools</strong> bei Nutzung von <strong>kmod</strong> entfernt werden.</p></div><div class="section_1"><h2 id="Befehle-fuer-Module">Befehle für Module<a class="headerlink" href="#Befehle-fuer-Module">¶</a></h2><p>
Im Folgenden werden einige wichtige Befehle für den Umgang mit Modulen kurz vorgestellt. Alle Befehle werden im Terminal <sup><a href="#source-2">[2]</a></sup> aufgerufen. Das Laden, Entladen sowie Erstellen von Abhängigkeiten erfordert <a class="internal" href="./sudo.html">Root-Rechte</a>!</p><p><a class="crosslink anchor" href="#lsmod" id="lsmod"></a>
</p><div class="section_2"><h3 id="Geladene-Module-anzeigen-lsmod-und-kmod">Geladene Module anzeigen: lsmod und kmod<a class="headerlink" href="#Geladene-Module-anzeigen-lsmod-und-kmod">¶</a></h3><p>
Mit den Befehlen</p><div class="bash"><div class="contents"><pre class="notranslate">kmod list </pre></div></div><p>
oder
</p><div class="bash"><div class="contents"><pre class="notranslate">lsmod </pre></div></div><p>können alle aktuell geladenen Module angezeigt werden. <code class="notranslate">lsmod</code> wie auch <code class="notranslate">kmod list</code> kennen keine weiteren Optionen, die Ausgaben sind identisch. Beispielausgabe:</p><pre class="notranslate">Module                  Size  Used by
btrfs                 835954  0 
raid6_pq               97812  1 btrfs
xor                    21411  1 btrfs
ufs                    74890  0 
qnx4                   13317  0 
hfsplus               107516  0 
hfs                    54677  0 
minix                  36140  0 
ntfs                   97369  0 
msdos                  17332  0 
jfs                   181348  0 
xfs                   912173  0 
libcrc32c              12644  2 xfs,btrfs
nls_iso8859_1          12713  0 
usb_storage            62209  0 
pci_stub               12622  1 
vboxpci                23194  0 
vboxnetadp             25670  0 
vboxnetflt             27613  0 
vboxdrv               409768  3 vboxnetadp,vboxnetflt,vboxpci
bnep                   19624  2 
rfcomm                 69160  0 
bluetooth             391196  10 bnep,rfcomm
joydev                 17381  0 
fglrx                8085343  587 
kvm_amd                59987  0 
snd_hda_codec_hdmi     46254  1 
kvm                   451511  1 kvm_amd
snd_hda_codec_realtek    61438  1 
snd_hda_intel          52355  9 
edac_core              62291  0 
snd_hda_codec         192906  3 snd_hda_codec_realtek,snd_hda_codec_hdmi,snd_hda_intel
snd_seq_midi           13324  0 
k10temp                13126  0 
serio_raw              13462  0 
snd_seq_midi_event     14899  1 snd_seq_midi
snd_hwdep              13602  1 snd_hda_codec
snd_rawmidi            30144  1 snd_seq_midi
edac_mce_amd           22617  0 
snd_pcm               102099  3 snd_hda_codec_hdmi,snd_hda_codec,snd_hda_intel
snd_page_alloc         18710  2 snd_pcm,snd_hda_intel
sp5100_tco             13979  0 
snd_seq                61560  2 snd_seq_midi_event,snd_seq_midi
i2c_piix4              22155  0 
snd_seq_device         14497  3 snd_seq,snd_rawmidi,snd_seq_midi
snd_timer              29482  2 snd_pcm,snd_seq
amd_iommu_v2           19054  1 fglrx
wmi                    19177  0 
snd                    69238  29 snd_hda_codec_realtek,snd_hwdep,snd_timer,snd_hda_codec_hdmi,snd_pcm,snd_seq,snd_rawmidi,snd_hda_codec,snd_hda_intel,snd_seq_device,snd_seq_midi
mac_hid                13205  0 
soundcore              12680  1 snd
parport_pc             32701  0 
ppdev                  17671  0 
it87                   43113  0 
hwmon_vid              12783  1 it87
lp                     17759  0 
parport                42348  3 lp,ppdev,parport_pc
pata_acpi              13038  0 
hid_generic            12548  0 
usbhid                 52570  0 
hid                   106148  2 hid_generic,usbhid
psmouse               106678  0 
pata_atiixp            13271  0 
r8169                  67581  0 
ahci                   25819  6 
mii                    13934  1 r8169
libahci                32560  1 ahci</pre><p>Wie man sieht, wird in der ersten Spalte der Modulname angezeigt, in der zweiten Spalte der belegte Speicher in Bytes und in der dritten Spalte die Anzahl der Prozesse und Module, die dieses Modul benutzen, gefolgt von einer Liste der Modulnamen, die dieses Modul benutzen.</p></div><div class="section_2"><h3 id="Information-anzeigen-modinfo">Information anzeigen: modinfo<a class="headerlink" href="#Information-anzeigen-modinfo">¶</a></h3><p>
Mit Hilfe des Befehls <code class="notranslate">modinfo</code> werden Informationen zu einem bestimmten Modul angezeigt. Die allgemeine Syntax lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">modinfo MODULNAME </pre></div></div><p>wobei <code class="notranslate">MODULNAME</code> durch das entsprechende Modul ersetzt werden muss. Beispiel:</p><div class="bash"><div class="contents"><pre class="notranslate">modinfo snd </pre></div></div><p>
Ausgabe:</p><pre class="notranslate">filename:       /lib/modules/2.6.20-15-generic/kernel/sound/core/snd.ko
alias:          char-major-116-*
license:        GPL
description:    Advanced Linux Sound Architecture driver for soundcards.
author:         Jaroslav Kysela &lt;perex@suse.cz&gt;
srcversion:     3BE4E61EB0303AD5846B8A6
depends:        soundcore
vermagic:       2.6.20-15-generic SMP mod_unload 586
parm:           major:Major # for sound driver. (int)
parm:           cards_limit:Count of auto-loadable soundcards. (int)</pre><p>Wie man sieht, erfolgt die Ausgabe zeilenweise sortiert nach verschiedenen Kategorien. Diese sind für alle Module gleich. Interessant ist die Zeile "depends", da man hier sieht, von welchen Modulen dieses Modul abhängt. "Abhängt" bedeutet, dass das entsprechende Modul oder ggf. auch mehrere Module geladen sein müssen, bevor dieses Modul geladen werden kann. Dies ist besonders bei Verwendung von <a class="crosslink" href="#insmod">insmod</a> von Interesse.</p><p>modinfo kennt einige Optionen, welche in den <a class="internal" href="./man.html">Manpages</a> ausgeführt sind.</p><p><a class="crosslink anchor" href="#modprobe" id="modprobe"></a>
</p></div><div class="section_2"><h3 id="Module-laden-entladen-modprobe">Module laden/entladen: modprobe<a class="headerlink" href="#Module-laden-entladen-modprobe">¶</a></h3><p>
Mit <code class="notranslate">modprobe</code> können Module zur Laufzeit des Systems ge- und entladen werden. modprobe löst dabei automatisch Abhängigkeiten auf, d.h. wenn das zu ladende Modul andere Module voraussetzt, werden diese automatisch in der richtigen Reihenfolge mit geladen bzw. werden Module automatisch mit entfernt, welche nur aus Abhängigkeitsgründen geladen wurden. Dies setzt allerdings voraus, dass die Abhängigkeiten richtig hinterlegt sind, siehe Abschnitt <a class="crosslink" href="#depmod">depmod</a>.</p><p>Die allgemeine Syntax von modprobe lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe OPTIONEN MODULNAME(N) </pre></div></div><p>Die gängigsten Optionen sind :</p><table><tr class="titel"><td colspan="2">Optionen von modprobe</td></tr><tr class="kopf"><td> Option</td><td>Beschreibung</td></tr><tr><td><code class="notranslate">-v</code></td><td>Man erhält eine ausführliche Ausgabe der Aktionen von modprobe.</td></tr><tr class="highlight"><td><code class="notranslate">-n</code> oder <code class="notranslate">--dry-run</code></td><td> Simuliert das Laden des Moduls, lädt es aber nicht. </td></tr><tr><td><code class="notranslate">-a</code></td><td> Es werden alle in der Kommandozeile angegebenen Module geladen. Diese Option muss immer dann verwendet werden, wenn mehrere Module auf einmal geladen werden sollen. </td></tr><tr class="highlight"><td><code class="notranslate">--show-depends</code></td><td> Es werden alle Abhängigkeiten des Moduls angezeigt. </td></tr><tr><td><code class="notranslate">-r</code></td><td> die angegebenen Module werden entladen. </td></tr></table><p>
Eine vollständige Übersicht erhält man in den <a class="internal" href="./man.html">Manpages</a> zu modprobe.</p><p>Möchte man ein Modul bei jedem Systemstart laden, so muss man nicht jedes Mal modprobe ausführen, sondern <a class="crosslink" href="#start">automatisiert</a> den Vorgang.</p><p><a class="crosslink anchor" href="#insmod" id="insmod"></a>
</p><div class="section_3"><h4 id="insmod">insmod<a class="headerlink" href="#insmod">¶</a></h4><p>
Module können auch - alternativ zu <a class="crosslink" href="#modprobe">modprobe</a> - mit dem Befehl <code class="notranslate">insmod</code> geladen werden. Die Verwendung von insmod hat allerdings den Nachteil, dass eventuelle Abhängigkeiten der Module nicht automatisch aufgelöst werden. insmod lädt ein Modul nur, wenn alle Abhängigkeiten erfüllt sind bzw. vorher "von Hand" aufgelöst wurden. Daher wird insmod im täglichen Betrieb eher selten verwendet.</p><p>Die allgemeine Syntax von insmod lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo insmod MODULNAME </pre></div></div><p><a class="crosslink anchor" href="#rmmod" id="rmmod"></a>
</p></div><div class="section_3"><h4 id="rmmod">rmmod<a class="headerlink" href="#rmmod">¶</a></h4><p>
Eine zweite Möglichkeit, ein Modul aus dem Speicher zu entfernen ("entladen"), ist der Befehl <code class="notranslate">rmmod</code>. Im Gegensatz zu <code class="notranslate">modprobe -r</code> werden Module, die aus Abhängigkeitsgründen zum entfernenden Modul im Kernel geladen wurden, nicht mit entfernt.</p><p>Die allgemeine Syntax von rmmod lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rmmod OPTIONEN MODULNAME </pre></div></div><p>Für den "normalen" Betrieb benötigt man in der Regel keine Optionen. Diese sind in den <a class="internal" href="./man.html">Manpages</a> zu rmmod aufgeführt.</p><p><a class="crosslink anchor" href="#depmod" id="depmod"></a>
</p></div></div><div class="section_2"><h3 id="Abhaengigkeiten-von-Modulen-depmod">Abhängigkeiten von Modulen: depmod<a class="headerlink" href="#Abhaengigkeiten-von-Modulen-depmod">¶</a></h3><p>
Manche Module können erst genutzt bzw. geladen werden, wenn andere Module geladen sind, da sie von diesen abhängen. Diese Abhängigkeiten sind in der Datei <strong>/lib/modules/<em>&lt;Kernelversion&gt;</em>/modules.dep</strong> hinterlegt. Diese Datei mit korrekt angelegten Abhängigkeiten wird bei der Installation von Ubuntu hinterlegt, so dass keine Änderungen vorgenommen werden müssen. Installiert man zusätzliche eigene Module, so sollte die Datei <strong>modules.dep</strong> neu erstellt werden. Dies geschieht über den Befehl <code class="notranslate">depmod</code>.</p><p>Die allgemeine Syntax von depmod lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo depmod OPTIONEN </pre></div></div><p>Die zwei wichtigsten Optionen sind:</p><table><tr class="titel"><td colspan="2">Optionen von depmod</td></tr><tr class="kopf"><td>Option</td><td>Beschreibung</td></tr><tr><td><code class="notranslate">-A</code></td><td>Es wird zuerst geprüft, ob neue Module hinzugekommen sind. Wenn nicht wird keine neue Datei erstellt.</td></tr><tr><td><code class="notranslate">-n</code></td><td>Das Erstellen der neuen Datei wird simuliert, ohne die Aktionen wirklich durchzuführen.</td></tr></table><p>
Die weiteren Optionen sind in der <a class="internal" href="./man.html">Manpage</a> von depmod aufgeführt.</p><p><a class="crosslink anchor" href="#start" id="start"></a>
</p></div></div><div class="section_1"><h2 id="Module-automatisch-laden">Module automatisch laden<a class="headerlink" href="#Module-automatisch-laden">¶</a></h2><p>
Möchte man ein Modul, welches der Kernel nicht automatisch mit lädt, beim Systemstart automatisch laden, so trägt man den Modulnamen einfach in die Datei <strong>/etc/modules</strong> ein. Dazu öffnet man diese Datei mit einem Editor mit Root-Rechten <sup><a href="#source-3">[3]</a></sup> und macht die entsprechenden Einträge, wobei pro Zeile nur ein Modulname eingetragen werden darf. Ab dem nächsten Systemstart werden alle Module (zusätzlich) geladen, die dort eingetragen sind.</p><p><a class="crosslink anchor" href="#optionen" id="optionen"></a>
</p></div><div class="section_1"><h2 id="Module-mit-Optionen-laden">Module mit Optionen laden<a class="headerlink" href="#Module-mit-Optionen-laden">¶</a></h2><p>
Mögliche Optionen eines bestimmten Moduls abfragen:
</p><div class="bash"><div class="contents"><pre class="notranslate">modinfo -p MODULNAME
modinfo MODULNAME -F parm
modinfo MODULNAME | grep parm </pre></div></div><p>
Siehe auch <a class="internal" href="./grep.html">grep</a></p><p>Beispielausgabe beim Modul <strong>iwlwifi</strong>:
</p><pre class="notranslate">swcrypto:using crypto in software (default 0 [hardware]) (int)
11n_disable:disable 11n functionality, bitmap: 1: full, 2: disable agg TX, 4: disable agg RX, 8 enable agg TX (uint)
amsdu_size:amsdu size 0: 12K for multi Rx queue devices, 4K for other devices 1:4K 2:8K 3:12K (default 0) (int)
fw_restart:restart firmware in case of error (default true) (bool)
antenna_coupling:specify antenna coupling in dB (default: 0 dB) (int)
nvm_file:NVM file name (charp)
d0i3_disable:disable d0i3 functionality (default: Y) (bool)
lar_disable:disable LAR functionality (default: N) (bool)
uapsd_disable:disable U-APSD functionality bitmap 1: BSS 2: P2P Client (default: 3) (uint)
bt_coex_active:enable wifi/bt co-exist (default: enable) (bool)
led_mode:0=system default, 1=On(RF On)/Off(RF Off), 2=blinking, 3=Off (default: 0) (int)
power_save:enable WiFi power management (default: disable) (bool)
power_level:default power save level (range from 1 - 5, default: 1) (int)
fw_monitor:firmware monitor - to debug FW (default: false - needs lots of memory) (bool)
d0i3_timeout:Timeout to D0i3 entry when idle (ms) (uint)
disable_11ac:Disable VHT capabilities (default: false) (bool)</pre><p>Mögliche Werte und Konstanten:
</p><table><tr class="titel"><td colspan="2">häufige Werte/Konstanten</td></tr><tr class="kopf"><td> Option</td><td>Beschreibung</td></tr><tr><td><code class="notranslate">[bool]</code></td><td> Logischer Wert wie <strong>y</strong>(es) und <strong>n</strong>(o) oder <strong>true</strong> und <strong>false</strong> oder auch <strong>0</strong> und <strong>1</strong> (bolean)</td></tr><tr><td><code class="notranslate">[int]</code></td><td> Ganzzahliger Wert mit möglichem Vorzeichen im Bereich -2,147,483,648 bis 2,147,483,647 (32bit) </td></tr><tr><td><code class="notranslate">[uint]</code></td><td> Ganzzahliger Wert ohne Vorzeichen im Bereich 0 bis 4.294.967.295 (32bit) </td></tr><tr><td><code class="notranslate">[long]</code></td><td> Ganzzahliger Wert mit Vorzeichen im Bereich -9,223,372,036,854,775,808 bis 9,223,372,036,854,775,807 (64bit) </td></tr><tr><td><code class="notranslate">[ulong]</code></td><td> Ganzzahliger Wert ohne Vorzeichen im Bereich 0 bis 18.446.744.073.709.551.615 (64bit) </td></tr><tr><td><code class="notranslate">[ushort]</code></td><td> Ganzzahliger Wert ohne Vorzeichen im Bereich 0 bis 65.535 (16bit) </td></tr><tr><td><code class="notranslate">[charp]</code></td><td> Zeichenkette wie Dateiname o.ä. </td></tr></table><p>Oft werden die erlaubten Werte mit angegeben. Entsprechende Optionen können vorab getestet werden. Beim Laden des Moduls werden entsprechende Hinweise oder auch Fehler ausgegeben.</p><p>Beispiel:
</p><div class="bash"><div class="contents"><pre class="notranslate"># richtig
sudo modprobe -v iwlwifi bt_coex_active=1
# fehlerhafter Vorgabewert
sudo modprobe -v iwlwifi bt_coex_active=2 </pre></div></div><p>
Die dazu passenden Ausgaben lautet:
</p><pre class="notranslate"># richtig
insmod /lib/modules/4.10.0-42-generic/kernel/drivers/net/wireless/intel/iwlwifi/iwlwifi.ko bt_coex_active=1
# fehlerhaft
modprobe: ERROR: could not insert 'iwlwifi': Invalid argument</pre><p>Soll ein Modul immer mit einer bestimmten Option geladen werden, kann dies über eine entsprechenden Konfigurationsdatei in <strong>/etc/modprobe.d</strong> festgelegt werden. Diese Datei existiert nicht standardmäßig - wenn sie gebraucht wird, muss sie mit Root-Rechten <sup><a href="#source-3">[3]</a></sup> angelegt werden. Es gibt nur einen Eintrag pro Zeile. Um eine Option zu setzen, beginnt man mit einem <code class="notranslate">options</code>:</p><pre class="notranslate">options modulname_1 option1=XX
options modulname_2 option2=YY</pre><p>
Mehrere Moduloptionen setzen:
</p><pre class="notranslate">options modulname option1=XX option2=XX option3=XX</pre><p>Beispiel:
</p><pre class="notranslate">options iwlwifi 11n_disable=1 fw_restart=1</pre><p>Die benötigte Datei <strong>/etc/modprobe.d/MODULNAME_options.conf</strong> einschließlich der Optionseinträge für ein bestimmtes Kernelmodul kann sehr einfach durch eine einzige Befehlszeile im Terminal <sup><a href="#source-2">[2]</a></sup> angelegt werden.</p><p>Über einen kombinierten <a class="internal" href="./shell.html">Shell</a>-Befehl wird die Datei mit entsprechendem Inhalt erzeugt:
</p><div class="bash"><div class="contents"><pre class="notranslate">echo "options MODULNAME option1=XX option2=XX" | sudo tee /etc/modprobe.d/MODULNAME_options.conf </pre></div></div><p>
Siehe auch <a class="internal" href="./shell/umleitungen.html">Shell/Umleitungen</a></p><p>Beispiel:
</p><div class="bash"><div class="contents"><pre class="notranslate">echo "options iwlwifi 11n_disable=1 fw_restart=1" | sudo tee /etc/modprobe.d/iwlwifi_options.conf </pre></div></div><p>
Die Optionen werden nach einem Systemneustart oder manuellem entladen und erneutem laden des Moduls übernommen.</p><p><a class="crosslink anchor" href="#blacklisting" id="blacklisting"></a>
</p></div><div class="section_1"><h2 id="Automatisches-Laden-verhindern-Blacklisting">Automatisches Laden verhindern - Blacklisting<a class="headerlink" href="#Automatisches-Laden-verhindern-Blacklisting">¶</a></h2><p>
Unter bestimmten Umständen kann es sinnvoll sein, das Laden von bestimmten Modulen explizit zu verbieten. Dies geschieht durch den Eintrag des entsprechenden Moduls in eine so genannte Blacklist-Datei. Diese Dateien befinden sich im Verzeichnis <strong>/etc/modprobe.d</strong>. In der Regel sind schon einige Einträge in der <strong>/etc/modprobe.d/blacklist.conf</strong> zu finden.</p><p>Die Datei legt man mit einem Editor mit Root-Rechten an <sup><a href="#source-3">[3]</a></sup> (bzw. öffnet eine vorhandene Datei) und fügt einen Dateieintrag nach folgendem Schema hinzu, je ein Eintrag pro Zeile:</p><pre class="notranslate">blacklist modulname_1
blacklist modulname_2</pre><p>
Die Sperrlisten haben üblicherweise den Namen <strong>blacklist-Modulname.conf</strong>, d.h. der Dateiname kann frei gewählt werden, sollte aber mit dem Präfix <strong>blacklist-</strong> beginnen um direkt über die Funktion zu informieren. Darüber hinaus existiert auch eine "allgemeine" Datei, die nur den Namen <strong>blacklist.conf</strong> trägt. Diese Datei sollte man allerdings nicht komplett überschreiben, sondern bei Bedarf weitere Einträge anhängen.</p><p>Auch hier kann dies über einen kombinierten <a class="internal" href="./shell.html">Shell</a>-Befehl in einem Zug durchgeführt werden:</p><p>Eintrag an bestehende Sperrliste <strong>/etc/modprobe.d/blacklist.conf</strong> anhängen:
</p><div class="bash"><div class="contents"><pre class="notranslate">echo "blacklist prism54" | sudo tee -a /etc/modprobe.d/blacklist.conf </pre></div></div><p>Neue Sperrliste anlegen bzw. bestehende überschreiben:
</p><div class="bash"><div class="contents"><pre class="notranslate">echo "blacklist prism54" | sudo tee /etc/modprobe.d/blacklist_prism54.conf </pre></div></div><p>
Siehe auch <a class="internal" href="./shell/umleitungen.html">Shell/Umleitungen</a></p><p>Sollte ein benötigtes Modul nicht automatisch bei Systemstart geladen werden, so kann dies an einem entsprechenden Sperreintrag liegen. Bestehende Sperrlisten nach einem Eintrag mittels <a class="internal" href="./grep.html">grep</a> durchsuchen:
</p><div class="bash"><div class="contents"><pre class="notranslate">grep -i MODULNAME /etc/modprobe.d/* </pre></div></div><p>Beispiel:
</p><div class="bash"><div class="contents"><pre class="notranslate">grep -i prism54 /etc/modprobe.d/* </pre></div></div><p>Entsprechende Einträge wie oben gezeigt mittels <a class="internal" href="./grep.html">grep</a> suchen und über <a class="internal" href="./sed.html">sed</a> auskommentieren, Modul also wieder entsperren: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo sed -i "s/blacklist MODULNAME/#blacklist MODULNAME/g" $(egrep -lo 'blacklist MODULNAME' /etc/modprobe.d/*) </pre></div></div><p>Beispiel:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo sed -i "s/blacklist prism54/#blacklist prism54/g" $(egrep -lo 'blacklist prism54' /etc/modprobe.d/*) </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Manchmal kann es erforderlich sein, das <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/initramfs">initramfs</a> mit dem Befehl <code class="notranslate">update-initramfs -u</code> zu aktualisieren, wenn die Module trotz Blacklisting nach einem Neustart wieder geladen werden.
</p></div></div></div><div class="section_1"><h2 id="bersicht-ueber-alle-Module">Übersicht über alle Module<a class="headerlink" href="#bersicht-ueber-alle-Module">¶</a></h2><p>
Wer wissen möchte, welche Module auf dem eigenen Rechner verfügbar (nicht geladen!) sind, der kann sich mit dem Befehl <sup><a href="#source-2">[2]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">basename -s ".ko" $(find /lib/modules/$(uname -r) -type f -name "*.ko") </pre></div></div><p>eine komplette Liste anzeigen lassen. Allerdings ist die Liste extrem lang (der Kernel bringt mehrere hundert Module mit...), daher ist es eventuell günstiger, die Modulverzeichnisse mit einem Dateimanager zu durchforsten. Die Module liegen alle in den Unterverzeichnissen von <strong>/lib/modules/KERNELVERSION/kernel/</strong></p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="./module-assistant.html">Module-Assistant</a> - Module nachträglich erstellen und installieren </p></li><li><p><a class="internal" href="./dkms.html">DKMS</a> - Module automatisch aktualisieren</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./kernelmodule/a/revision/946216.html">Diese Revision</a> wurde am 13. Januar 2018 08:36 von <a href="https://ubuntuusers.de/user/elektronenblitz63/">elektronenblitz63</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./kernelmodule.html">Kernelmodule</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>