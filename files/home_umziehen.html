<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Home_umziehen › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./home_umziehen.html">Home umziehen</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Home_umziehen">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./home_umziehen/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./home_umziehen/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./home_umziehen/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./home_umziehen/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./home_umziehen/a/backlinks.html">Home umziehen</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./sudo.html">mit Root-Rechten arbeiten</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Vorgehensweise">Vorgehensweise
</a><ol class="arabic"><li><a class="crosslink" href="#Abmelden-von-der-grafischen-Benutzeroberflaeche">Abmelden von der grafischen Benutzerober...</a></li><li><a class="crosslink" href="#Neue-Partition-einhaengen">Neue Partition einhängen
</a></li><li><a class="crosslink" href="#Daten-kopieren">Daten kopieren
</a></li><li><a class="crosslink" href="#Neue-Home-Partition-verwenden">Neue Home-Partition verwenden
</a></li><li><a class="crosslink" href="#Zusatz-bei-verschluesseltem-Nutzerverzeichnis">Zusatz bei verschlüsseltem Nutzerverzeic...</a></li><li><a class="crosslink" href="#Abschluss">Abschluss
</a></li></ol></li><li><a class="crosslink" href="#Tipps">Tipps
</a></li><li><a class="crosslink" href="#Alternative">Alternative
</a></li></ol></div><p>Oft wird der Platz für die Daten zu eng auf der Festplatte. Ein Ausweg ist, die persönlichen Daten der einzelnen Benutzer auf eine extra Partition zu legen. Im Folgenden wird von dieser Situation ausgegangen:</p><ul><li><p>Das <strong>/home</strong>-Verzeichnis liegt auf der Systempartition, es existiert also noch keine Home-Partition. </p></li><li><p>Eine leere Partition im <a class="internal" href="./ext.html">ext4</a>-Format steht zur Verfügung. Wenn dies nicht der Fall ist, muss man zunächst eine solche <a class="internal" href="./partitionierung.html">Partition erstellen</a>. </p></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Man kann hier statt <a class="internal" href="./ext.html">ext</a> auch ein anderes Linux-Dateisystem benutzen, welches <a class="internal" href="./rechte.html">Rechte</a> unterstützt. FAT32 und NTFS sind damit explizit ausgeschlossen. 
</p></div></div><div class="section_1"><h2 id="Vorgehensweise">Vorgehensweise<a class="headerlink" href="#Vorgehensweise">¶</a></h2><p>
Als erstes sollte man ein <a class="internal" href="./sicherheit.html">Backup</a> seines <strong>/home</strong>-Verzeichnisses anlegen; sicher ist sicher. Dann sollte überprüft werden, ob die ausgewählte Partition groß genug ist, um die Benutzerdaten aufnehmen zu können. Den Platz, den das Home-Verzeichnis benötigt, kann man im Terminal <sup><a href="#source-1">[1]</a></sup> mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">du -sh /home </pre></div></div><p>Ausgabe z.B.</p><pre class="notranslate">2,5G    /home</pre><p>herausfinden. Die neue Partition muss in diesen Beispiel also mindestens 2,5 Gigabytes groß sein.</p><div class="section_2"><h3 id="Abmelden-von-der-grafischen-Benutzeroberflaeche">Abmelden von der grafischen Benutzeroberfläche<a class="headerlink" href="#Abmelden-von-der-grafischen-Benutzeroberflaeche">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Für alle, die im Umgang mit der Konsole noch nicht so sicher sind, bietet es sich an, die unten folgenden Befehle abzuschreiben oder diese Seite auszudrucken, von jetzt an muss auf der Konsole gearbeitet werden. Es ist nicht möglich, diese Aktion innerhalb der graphischen Umgebung durchzuführen!
</p></div></div><p>Um ungewollte Nebeneffekte zu vermeiden, muss man sich nun aus der grafischen Oberfläche (<a class="internal" href="./gnome.html">GNOME</a>, <a class="internal" href="./kde.html">KDE</a>, <a class="internal" href="./xfce.html">Xfce</a> etc.) abmelden, und mit 
<span class="key">Strg</span>  + 
<span class="key">Alt</span>  + 
<span class="key">F1</span>  von <a class="internal" href="./gdm.html">gdm</a>/<a class="internal" href="./kdm.html">kdm</a>/etc. zu einer Textkonsole wechseln <sup><a href="#source-1">[1]</a></sup>. Dort meldet man sich mit dem üblichen Benutzernamen und Passwort an. Da alle nun folgenden Befehle root-Rechte erfordern, verleiht man sich diese temporär durch Eingabe von</p><div class="bash"><div class="contents"><pre class="notranslate">sudo -s
cd / </pre></div></div></div><div class="section_2"><h3 id="Neue-Partition-einhaengen">Neue Partition einhängen<a class="headerlink" href="#Neue-Partition-einhaengen">¶</a></h3><p>
Mit</p><div class="bash"><div class="contents"><pre class="notranslate">fdisk -l </pre></div></div><p>erhält man eine Liste aller vorhandenen Partitionen. Hier merkt man sich die Bezeichnung der neuen Partition, etwa <strong>/dev/sda5</strong> und bindet sie mit</p><div class="bash"><div class="contents"><pre class="notranslate">mkdir /mnt/tmp
mount /dev/sda5 /mnt/tmp </pre></div></div><p>am Mountpunkt <strong>/mnt/tmp</strong> ein. Hierbei und bei allen folgenden Befehlen ist natürlich <strong>/dev/sda5</strong> durch die korrekte Bezeichnung der neuen Partition zu ersetzen.</p></div><div class="section_2"><h3 id="Daten-kopieren">Daten kopieren<a class="headerlink" href="#Daten-kopieren">¶</a></h3><p>
Mit einem der beiden folgenden Befehle startet man den Kopiervorgang. Dieser Schritt erfordert je nach Größe des Homeverzeichnisses viel Zeit.</p><div class="bash"><div class="contents"><pre class="notranslate"># rsync kopiert nicht nur die Daten, sondern überprüft zusätzlich ob die Daten korrekt geschrieben wurden.
# Dies dauert geringfügig länger, garantiert jedoch eine einwandfreie Durchführung des Kopiervorganges.
rsync -avx --progress /home/ /mnt/tmp </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei dem Aufruf von <code class="notranslate">rsync</code> <strong>muss</strong> darauf geachtet werden, dass das Zeichen <strong>/</strong> (Slash/Schrägstrich) am Ende von <code class="notranslate">/home</code><strong class="highlighted"><strong><code class="notranslate">/</code></strong></strong> steht, ansonsten wird nicht nur der Inhalt des Ordners kopiert, sondern der Ordner kopiert sich selber, dies kann unerwünschte Auswirkungen beim Kopieren haben!
</p></div></div><div class="bash"><div class="contents"><pre class="notranslate"># Soll es schnell gehen, so kann auf den Standardbefehl cp zurückgegriffen werden. Hier ist allerdings nicht
# garantiert, dass die Daten auch korrekt kopiert wurden.
cp -avx /home/* /mnt/tmp </pre></div></div><p>Danach kann die Partition testweise in das <strong>/home</strong>-Verzeichnis eingebunden werden:</p><div class="bash"><div class="contents"><pre class="notranslate">mount /dev/sda5 /home </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Durch den Mount-Befehl wird der ursprüngliche Inhalt (Original) des <strong>/home</strong>-Verzeichnisses unsichtbar und es ist nur mehr die neu gemountete Partition (Kopie) sichtbar. 
</p></div></div><p>Durch Eingabe von</p><div class="bash"><div class="contents"><pre class="notranslate">du -sh /home; mount|grep /home </pre></div></div><p>überprüft man, ob alles geklappt hat. Die Ausgabe sollte etwa so aussehen:</p><pre class="notranslate">2,5G    /home
/dev/sda5 on /home type ext4 (rw)</pre></div><div class="section_2"><h3 id="Neue-Home-Partition-verwenden">Neue Home-Partition verwenden<a class="headerlink" href="#Neue-Home-Partition-verwenden">¶</a></h3><p>
Nun kann das alte <strong>/home</strong>-Verzeichnis gelöscht werden:</p><div class="bash"><div class="contents"><pre class="notranslate">umount /home
rm -rf /home/* </pre></div></div><p>
Wichtig: Die Partition muss vorher defintiv ausgehängt sein. Dies ist der Fall, wenn nach dem <strong>umount</strong>-Befehl keine Meldungen ausgegeben werden.</p><p>Damit die neue Partition beim Systemstart eingebunden wird, ist sie in der Datei <strong>/etc/fstab</strong> einzutragen. Um dies korrekt zu machen muss die <a class="internal" href="./uuid.html">UUID</a> der neuen Partition mit <a class="internal" href="./blkid.html">blkid</a> bestimmt werden.</p><div class="bash"><div class="contents"><pre class="notranslate">blkid </pre></div></div><pre class="notranslate"> 
[...]
/dev/sda5: UUID="f72aac23-092f-4484-b35c-f222c106d716" TYPE="ext4" 
[...]</pre><p>Die so bestimmte Identifikationsnummer der Partition muss nun in die <strong>/etc/fstab</strong> eingetragen <sup><a href="#source-2">[2]</a></sup> werden.
(Siehe oben: Link: Einen Editor öffnen)
Die Position innerhalb von <em>fstab</em> ist dabei nicht so wichtig, sinnvoll ist es als letzte Zeile.</p><pre class="notranslate"># /dev/sda5
UUID=f72aac23-092f-4484-b35c-f222c106d716  /home   ext4   defaults   0 2</pre><p>Dieser Schritt kann auch schon ausgeführt werden, bevor man sich auf die Konsolenebene begibt und das Home-Verzeichnis umzieht. Da <strong>/etc/fstab</strong> bei jedem Systemstart neu eingelesen wird, kann man sie problemlos aus dem laufenden System editieren.</p><p>Man öffnet die Datei <strong>fstab</strong> in einem Editor mit Root-Rechten<sup><a href="#source-2">[2]</a></sup><sup><a href="#source-3">[3]</a></sup> und legt den Eintrag für die neue Home-Partition an. Danach macht man die Abfrage der UUID im Terminal (Befehl: <code class="notranslate">sudo blkid</code>) und fügt sie in die Datei fstab, an der passenden Stelle des neuen Eintrags für die <code class="notranslate">/home</code>, ein. fstab speichern und schließen.</p><p>Hat man /home umgezogen und den Inhalt des Home-Verzeichnisses gelöscht, befindet sich der Eintrag der neuen /home schon in der fstab und das System kann neu gestartet werden.</p></div><div class="section_2"><h3 id="Zusatz-bei-verschluesseltem-Nutzerverzeichnis">Zusatz bei verschlüsseltem Nutzerverzeichnis<a class="headerlink" href="#Zusatz-bei-verschluesseltem-Nutzerverzeichnis">¶</a></h3><p>
Ist nun nach dem Neustart das <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> auf der neuen Partition, wurde jedoch komplett neu und leer angelegt, dann war das alte Benutzerverzeichnis gegebenenfalls softwareseitig verschlüsselt. Entweder man berücksichtigt folgende Schritte gleich nach dem Umzug oder wechselt noch einmal in die Konsole, löscht die neu angelegten Inhalte und erstellt folgende symbolischen Links als Nutzer <code class="notranslate">$USER</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ln -s /home/.ecryptfs/$USER/.Private ~/.Private
sudo ln -s /home/.ecryptfs/$USER/.ecryptfs ~/.ecryptfs
sudo chown $USER:$USER ~ </pre></div></div></div><div class="section_2"><h3 id="Abschluss">Abschluss<a class="headerlink" href="#Abschluss">¶</a></h3><p>
Danach startet man das System neu.</p><div class="bash"><div class="contents"><pre class="notranslate">reboot </pre></div></div></div></div><div class="section_1"><h2 id="Tipps">Tipps<a class="headerlink" href="#Tipps">¶</a></h2><p>
* Für alle, die noch nicht so sicher mit der Konsole sind: 
Wem das mit dem Löschen aus der Konsole heraus und ohne graphische Oberfläche zu heikel ist, der löscht das alte <strong>/home</strong>-Verzeichnis einfach erst nach erfolgreichem Neustart. 
Dies ist jedoch nicht möglich, wenn die Home-Partition eingehängt ist. Also muss von einer Live-CD gebootet werden. Man hängt dann die Systempartition ein und löscht die Inhalte des <strong>home</strong>-Ordners -- aber nicht den Ordner selbst. <strong>/home</strong> muss nämlich beim Booten als Mountpunkt zur Verfügung stehen.</p><p>* Die fstab kann auch von der grafischen Oberfläche aus vom Ordner /etc in das Homeverzeichnis kopiert werden. Danach kann man ein Terminal öffnen und mit <strong>sudo fdisk -l</strong> und <strong>sudo blkid</strong> die UUID der neuen Partition herausfinden. Diese kann dann kopiert und mittels normalem Texteditor der fstab-kopie hinzugefügt werden.
Von der  konsole ohne grafische Oberfläche aus gibt man dann nach einander die folgenden Befehle ein.</p><p>zum löschen der fstab:
</p><div class="bash"><div class="contents"><pre class="notranslate">rm /etc/fstab </pre></div></div><p>Davon ausgehend, dass der Benutzername <strong>max</strong> ist:
</p><div class="bash"><div class="contents"><pre class="notranslate">cp /home/max/fstab /etc/fstab </pre></div></div><p>
um die Kopie, die nun um die neue Partition erweitert wurde an den richtigen Ort zu platzieren.</p><p>Zum Schluss zum Überprüfen:
</p><div class="bash"><div class="contents"><pre class="notranslate">cat /etc/fstab </pre></div></div><p>
Wenn die Ausgabe aussieht, wie erwartet, hat alles funktioniert und es geht wie oben beschrieben mit dem Kopieren der Daten weiter.
Es geht dann nach dem Löschen vom alten <strong>/home</strong>-Verzeichnis direkt mit dem <strong>reboot</strong> weiter.
Auf diese Weise muss die ziemlich lange UUID nicht abgeschrieben und anschließend abgetippt werden, da man sie ja markieren, kopieren und schließlich einfügen kann.</p></div><div class="section_1"><h2 id="Alternative">Alternative<a class="headerlink" href="#Alternative">¶</a></h2><p>
Möchte man nicht <strong>/home/*</strong> umziehen, sondern lediglich die Home-Verzeichnisse einzelner Benutzer (z.B. umbenennen), findet man eine entsprechende Anleitung im Artikel <a class="internal" href="./homeverzeichnis.html#Homeverzeichnis-aendern">Homeverzeichnis</a>.</p><p></p></div></div>
<p class="meta">
<a href="./home_umziehen/a/revision/919083.html">Diese Revision</a> wurde am 11. November 2016 22:29 von <a href="https://ubuntuusers.de/user/mrkramps/">mrkramps</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./home_umziehen.html">Home umziehen</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>