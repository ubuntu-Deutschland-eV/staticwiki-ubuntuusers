<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>NFSv4 › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./nfsv4.html">NFSv4</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/NFSv4">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./nfsv4/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./nfsv4/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./nfsv4/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./nfsv4/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./nfsv4/a/backlinks.html">NFSv4</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./mount.html">mount</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./fstab.html">fstab</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Vorteil-von-NFSv4">Vorteil von NFSv4
</a><ol class="arabic"><li><a class="crosslink" href="#Weitere-Unterschiede">Weitere Unterschiede
</a></li></ol></li><li><a class="crosslink" href="#Anforderung-an-die-Systemumgebung">Anforderung an die Systemumgebung
</a></li><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Server">Server
</a></li><li><a class="crosslink" href="#Client">Client
</a></li></ol></li><li><a class="crosslink" href="#Freigaben">Freigaben
</a></li><li><a class="crosslink" href="#Einhaengen-der-Freigaben-am-Client">Einhängen der Freigaben am Client
</a></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#Intern">Intern
</a></li><li><a class="crosslink" href="#Extern">Extern
</a></li></ol></li></ol></div><p><img alt="Wiki/Icons/service.png" class="image-left" src="./_/afb6c1869d3e3412cb022363511bce77dccf937a.png"/>
Dieser Artikel behandelt den Umgang mit dem <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Network_File_System">NFS</a> (Network File System) in der Version 4 und stellt die Unterschiede gegenüber der Version 2/3 heraus. Ein Artikel zu NFS im Allgemeinen (mit weiterführenden Details) findet sich in <a class="internal" href="./nfs.html">NFS</a></p><div class="section_1"><h2 id="Vorteil-von-NFSv4">Vorteil von NFSv4<a class="headerlink" href="#Vorteil-von-NFSv4">¶</a></h2><p>
Gegenüber der vorherigen Versionen bietet NFS in der Version 4 einige Verbesserungen und Vereinfachungen:</p><p>Der bemerkenswerteste Unterschied ist, dass NFSv4 mit einem einzelnen Protokoll auskommt. In früheren Varianten von NFS waren stattdessen immer mehrere Protokolle nötig, die vom sog. Portmapper bei jedem Neustart einen Port zugewiesen bekamen. Diese Neuerung macht es v.a. für die (Netzwerk-)Administration um einiges einfacher, da beispielsweise bei Firewall-Freigaben nur noch der NFS-Port 2049 berücksichtigt werden muss.</p><div class="section_2"><h3 id="Weitere-Unterschiede">Weitere Unterschiede<a class="headerlink" href="#Weitere-Unterschiede">¶</a></h3><p>
</p><ul><li><p>NFSv4 kennt UTF-8, sodass es bei Dateinamen mit Sonderzeichen keine Probleme mehr geben sollte</p></li><li><p>das Caching wurde erheblich verbessert, dadurch ist NFSv4 einiges schneller</p></li><li><p>Authentifizierung via Kerberos möglich  (Siehe separater Artikel <a class="internal" href="./kerberos/nfs_mit_kerberos_sichern.html">Kerberos/NFS mit Kerberos sichern</a>)</p></li><li><p>das Standardprotokoll ist TCP statt UDP wie bei NFSv3</p></li><li><p>das File-locking wurde verbessert. Dies bedeutet insbesondere weniger Probleme, falls ein und dieselben Ordner via <a class="internal" href="./samba.html">Samba</a> und NFS frei gegeben werden</p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Anforderung-an-die-Systemumgebung">Anforderung an die Systemumgebung<a class="headerlink" href="#Anforderung-an-die-Systemumgebung">¶</a></h2><p>
Wie in den NFS-Versionen zuvor ist es für einen reibungslosen und sicheren Betrieb von Vorteil, wenn alle Benutzer im Netzwerk eindeutige <a class="internal" href="./benutzer_und_gruppen.html#Nummerierung-der-UID-GID">UIDs</a> haben. Alternativ können ab NFSv4 die Berechtigungen auch über die Linux-Benutzernamen gesteuert werden. Zur Autorisierung wird hierfür die Kombination aus Benutzernamen und DNS-Domäne des Rechners verwendet. Falls Server und Client unterschiedlichen DNS-Domänen angehören, kann eine gemeinsame Domäne in der Datei <strong>/etc/idmapd</strong> eingetragen werden. Weiteres gibt es dazu in der Manpage des <em>idmapd</em>.</p></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Sollte NFS noch nicht vorhanden sein, lässt es nachträglich problemlos installieren. Folgende Pakete und deren Abhängigkeiten müssen über die Paketverwaltung <sup><a href="#source-1">[1]</a></sup> installiert werden.</p><div class="section_2"><h3 id="Server">Server<a class="headerlink" href="#Server">¶</a></h3><p>
Wenn der Rechner als Server dienen soll, der Dateien bereitstellt:</p><ul><li><p><strong>nfs-kernel-server</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nfs-kernel-server </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nfs-kernel-server </pre></div></div><p>
</p></div></div><p>Die unterstützten Protokollversionen des Servers können mit dem Befehl
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cat /proc/fs/nfsd/versions </pre></div></div><p>
abgefragt werden.</p></div><div class="section_2"><h3 id="Client">Client<a class="headerlink" href="#Client">¶</a></h3><p>
Wenn der Rechner nur als Client agieren soll, der auf andere Freigaben zugreift:</p><ul><li><p><strong>nfs-common</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nfs-common </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nfs-common </pre></div></div><p>
</p></div></div></div></div><div class="section_1"><h2 id="Freigaben">Freigaben<a class="headerlink" href="#Freigaben">¶</a></h2><p>
Gegenüber den Versionen 2/3 wird bei der Freigabe über NFSv4 ein sogenanntes "Pseudodateisystem" benötigt. Im Folgenden wird erklärt, was es damit auf sich hat:</p><p>Beispiel:</p><p>Als Hauptverzeichnis für die Freigaben auf dem Server soll <strong>/srv/nfsv4</strong> dienen. Dazu wird zuerst ein Verzeichnis angelegt<sup><a href="#source-2">[2]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir /srv/nfsv4 </pre></div></div><p>Dieses Verzeichnis ist das Pseudodateisystem, das als Wurzelverzeichnis für die Freigaben dient. Darin enthalten sollen nun zwei einzelne Freigaben erstellt werden.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir /srv/nfsv4/freigabe1
sudo mkdir /srv/nfsv4/freigabe2 </pre></div></div><p>Die Freigaben selbst werden wie bei NFSv2/3 durch direkte Bearbeitung der Datei <strong>/etc/exports</strong> verwaltet. Dazu muss diese Datei angelegt und/oder bearbeitet werden. Zu Beachten ist hier die Angabe des Pseudodateisystems in der ersten Zeile.</p><p>Format/Syntax des Files <strong>/etc/exports</strong>
</p><pre class="notranslate">&lt;pseudo-dateisystem&gt; &lt;computername&gt;(&lt;optionen&gt;)
&lt;pfad1&gt;   &lt;computername&gt;(&lt;optionen&gt;)
&lt;pfad2&gt;   &lt;computername&gt;(&lt;optionen&gt;)</pre><p>Um die oben angelegten Verzeichnisse frei zu geben, werden beispielsweise folgende Zeilen benötigt:</p><pre class="notranslate">/srv/nfsv4   192.168.2.0/24(rw,sync,root_squash,no_subtree_check,fsid=0)
/srv/nfsv4/freigabe1  192.168.2.0/24(rw,sync,root_squash,no_subtree_check)
/srv/nfsv4/freigabe2  192.168.2.0/24(rw,sync,root_squash,no_subtree_check)</pre><p>Nun muss der NFS-Server noch dazu veranlasst werden, die <strong>/etc/exports</strong> neu einzulesen.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service nfs-kernel-server reload </pre></div></div><p>Ein Test auf dem Server zeigt die Freigaben:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo exportfs -v </pre></div></div></div><div class="section_1"><h2 id="Einhaengen-der-Freigaben-am-Client">Einhängen der Freigaben am Client<a class="headerlink" href="#Einhaengen-der-Freigaben-am-Client">¶</a></h2><p>
Um zu testen, ob sich die Freigaben am Client fehlerfrei einbinden lassen, hängt man die Verzeichnisse einmal direkt via Kommandozeile ein. Zu beachten ist hier, dass das Pseudodateisystem das Wurzelverzeichnis der Freigabe definiert - <strong>/</strong> bei der Angabe der Freigabe entspricht also <strong>/srv/nfsv4</strong> auf dem NFS-Server.</p><p>Zuerst wird der Mountpoint für die Freigaben erstellt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir /mnt/nfsv4-test </pre></div></div><p>Dann wird die erste Freigabe in das Verzeichnis eingehängt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mount -t nfs -onfsvers=4 &lt;nfs-server&gt;:/freigabe1 /mnt/nfsv4-test </pre></div></div><p>Stattdessen kann auch das ganze Wurzelverzeichnis eingehängt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mount -t nfs -onfsvers=4 &lt;nfs-server&gt;:/ /mnt/nfsv4-test </pre></div></div><p>Wenn bis hierher alles geklappt hat, kann man sich alle Mountpoints noch mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">mount </pre></div></div><p>anzeigen lassen.</p><p>Wenn alles geklappt hat, kann man die NFS-Freigabe in die <a class="internal" href="./fstab.html">fstab</a> eintragen, z.B.</p><pre class="notranslate">&lt;nfs-server&gt;:/ /mnt/nfsv4-test nfs nfsvers=4,rw 0 0</pre><p>Wenn man eine höhere NFS-Version als 4.0 verwenden möchte, kann man dies mit der Option '-o minorversion=' angeben. Der fstab-Eintrag
</p><pre class="notranslate">&lt;nfs-server&gt;:/ /mnt/nfsv4-test nfs nfsvers=4,minorversion=2,rw 0 0</pre><p>
hängt die Freigabe mit der NFS-Version 4.2 ein.</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="Intern">Intern<a class="headerlink" href="#Intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./nfs.html">nfs</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Grundartikel zu NFS (hauptsächlich Version 2/3)</p></li><li><p><a class="internal" href="./serverdienste.html">Serverdienste</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Übersichtsartikel</p></li><li><p><a class="internal" href="./heimnetzwerk.html">Heimnetzwerk</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Einführender Artikel; betrifft vor allem einfache Anwendungen</p></li><li><p><a class="internal" href="./autofs.html">Autofs</a> – Erlaubt auch die Auswahl ("browse") und das Einbinden von NFS-Freigaben</p></li></ul></div><div class="section_2"><h3 id="Extern">Extern<a class="headerlink" href="#Extern">¶</a></h3><p>
</p><ul><li><p><a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/NFSv4Howto">NFSv4Howto</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – im Ubuntu Help Wiki</p></li><li><p><a class="external" href="http://wiki.linux-nfs.org/wiki/index.php/NFSv41_Introduction" rel="nofollow" title="http://wiki.linux-nfs.org/wiki/index.php/NFSv41_Introduction">http://wiki.linux-nfs.org/wiki/index.php/NFSv41_Introduction</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - NFSv41_Introduction</p></li><li><p><a class="external" href="https://patchwork.kernel.org/patch/9769919" rel="nofollow" title="https://patchwork.kernel.org/patch/9769919">https://patchwork.kernel.org/patch/9769919</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Eintrag aus der Mailingliste zur Angabe der Minorversion</p></li></ul><p>
</p></div></div></div>
<p class="meta">
<a href="./nfsv4/a/revision/946370.html">Diese Revision</a> wurde am 14. Januar 2018 19:44 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./nfsv4.html">NFSv4</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>