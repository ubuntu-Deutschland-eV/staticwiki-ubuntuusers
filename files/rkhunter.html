<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>rkhunter › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./rkhunter.html">rkhunter</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/rkhunter">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./rkhunter/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./rkhunter/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./rkhunter/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./rkhunter/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./rkhunter/a/backlinks.html">rkhunter</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Pakete installieren</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./paketquellen_freischalten.html">Bearbeiten von Paketquellen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Editor benutzen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./packprogramme.html">Archive entpacken</a> </p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Aus-den-Paketquellen">Aus den Paketquellen
</a></li><li><a class="crosslink" href="#Auf-neue-Version-der-rkhunter-Scan-Engine-pruefen">Auf neue Version der rkhunter-Scan-Engin...</a></li><li><a class="crosslink" href="#Manuelle-Installation">Manuelle Installation
</a></li></ol></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a></li><li><a class="crosslink" href="#Automatische-Scans-und-Signatur-Aktualisierungen-per-Cron-Job-einrichten">Automatische Scans und Signatur-Aktualisie...</a><ol class="arabic"><li><a class="crosslink" href="#Falsche-Warnungen-durch-Whitelist-Eintraege-beseitigen">Falsche Warnungen durch Whitelist-Einträ...</a></li><li><a class="crosslink" href="#cron-Job-und-E-Mail-Benachrichtigung-aktivieren">cron-Job und E-Mail-Benachrichtigung akt...</a></li><li><a class="crosslink" href="#Lokales-E-Mail-Postfach-zum-Lesen-der-rkhunter-Nachrichten-einrichten">Lokales E-Mail-Postfach zum Lesen der rk...</a></li></ol></li><li><a class="crosslink" href="#Weitere-Sicherheits-Massnahmen">Weitere Sicherheits-Maßnahmen
</a></li></ol></div><p><a class="interwiki interwiki-sourceforge2" href="http://rkhunter.sourceforge.net">rkhunter</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (Rootkit Hunter) ist ein Linux-Werkzeug, welches nach <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Rootkit">Rootkits</a>, <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Backdoor">Hintertüren</a> und möglichen lokalen <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Exploit">Exploits</a> sucht. Dabei vergleicht es vorhandene Dateien anhand von <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Message-Digest_Algorithm_5">MD5</a>-hashes mit kompromittierten Dateien, sucht nach von Rootkits angelegten Ordnern, falschen Dateirechten, versteckten Dateien, verdächtigen Strings in Kernelmodulen und führt eine Reihe weiterer Tests durch.</p><p>rkhunter richtet sich dabei an professionelle Linux-Administratoren, wobei das Programm natürlich jeder benutzen kann. Um die Ausgabe verstehen zu können, bedarf es aber mindestens Grundkenntnissen der tieferen Schichten des Betriebssystems.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="section_2"><h3 id="Aus-den-Paketquellen">Aus den Paketquellen<a class="headerlink" href="#Aus-den-Paketquellen">¶</a></h3><p>
Das Programm kann aus den Paketquellen von Ubuntu über das Paket</p><ul><li><p><strong>rkhunter</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install rkhunter </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install rkhunter </pre></div></div><p>
</p></div></div><p>installiert <sup><a href="#source-1">[1]</a></sup> werden. Danach sollte ein mandatorisches Update der <em>known-bad</em>-Hash-Datenbank von rkhunter durchgeführt werden. Dies geht von der Konsole <sup><a href="#source-3">[3]</a></sup> aus  durch den Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter --update </pre></div></div><p>Wer automatische Scan-Läufe und E-Mail-Benachrichtigungen erhalten möchte, muss noch folgendes Paket installieren:</p><ul><li><p><strong>mailutils</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mailutils </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install mailutils </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Auf-neue-Version-der-rkhunter-Scan-Engine-pruefen">Auf neue Version der rkhunter-Scan-Engine prüfen<a class="headerlink" href="#Auf-neue-Version-der-rkhunter-Scan-Engine-pruefen">¶</a></h3><p>
rkhunter ist leider nicht in der Lage, die Scan-Engine selbst zu aktualisieren (nur die Signatur-Dateien können aktualisiert werden). Die Ubuntu-Quellen sind hier leider auch nicht immer auf dem neusten Stand. Um auf eine neue rkhunter-Version der Scan-Engine zu prüfen, führt man diesen Befehl in der Konsole <sup><a href="#source-3">[3]</a></sup> aus:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter --versioncheck </pre></div></div><p>Ist die aktuell verfügbare Version ("Latest Version") neuer, muss diese leider manuell nachinstalliert werden (siehe <a class="crosslink" href="#Manuelle-Installation">Manuelle Installation</a>).</p></div><div class="section_2"><h3 id="Manuelle-Installation">Manuelle Installation<a class="headerlink" href="#Manuelle-Installation">¶</a></h3><p>
Zuerst lädt man sich das aktuelle rkhunter-Paket (Datei mit der Endung <strong>tar.gz</strong>) von <a class="interwiki interwiki-sourceforge" href="http://sourceforge.net/projects/rkhunter">Sourceforge</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> herunter und entpackt <sup><a href="#source-5">[5]</a></sup> es in ein Verzeichnis seiner Wahl. Danach öffnet man zuerst mit einem Editor <sup><a href="#source-4">[4]</a></sup> die Datei <strong>installer.sh</strong> und ändert die erste Zeile in</p><pre class="notranslate">#!/bin/bash</pre><p>um. Jetzt installiert man rkhunter vom Terminal <sup><a href="#source-6">[6]</a></sup> aus mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ./installer.sh --layout /usr/local --install </pre></div></div><p>Um nun die Probleme der Version aus den Paketquellen zu beheben, bringt man rkhunter 1.3 mit einem zusätzlichen Parameter auf den aktuellen Stand:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter --propupd --update </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Durch den Parameter <code class="notranslate">--propupd</code> werden die Hash-Werte für "known-good"-Dateien vom momentanen System erstellt. Bei einem Scan werden dann die gefundenen Werte mit diesen Hash-Werten verglichen. Dabei gilt zu beachten, dass dies nur funktioniert, wenn das System zu dem Zeitpunkt der Durchführung des Updates durch <code class="notranslate">--propupd</code> noch nicht kompromittiert war. Es empfiehlt sich also, diesen Schritt auf einer neuen Ubuntu-Installation anzuwenden, da somit sichergestellt wird, dass die Hash-Werte auch richtig sind. 
</p></div></div></div></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
Jetzt kann man das komplette System mit folgendem Befehl scannen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter -c </pre></div></div><table><tr><td colspan="2" style="text-align: center; background-color: #F9EAAF"> <strong>Einige Parameter</strong></td></tr><tr><td><code class="notranslate">-c</code> </td><td>kompletter System-Scan</td></tr><tr><td><code class="notranslate">--rwo</code></td><td> gibt nur Befunde aus ("report warnings only"); vermeidet überlange Ausgabe-Listen...</td></tr><tr><td><code class="notranslate">--display-logfile</code></td><td> zeigt eine Zusammenfassung des Scans am Ende</td></tr><tr><td><code class="notranslate">--skip-keypress</code></td><td> man muss zwischen den einzelnen Scan-Abschnitten nicht mehr Enter drücken</td></tr><tr><td><code class="notranslate">--update</code></td><td>führt ein Update der known-bad Hash-Datenbank durch</td></tr><tr><td><code class="notranslate">--propupd</code></td><td>führt ein Update der known-good Hash-Datenbank durch (nur bei der manuell installierten Version bzw. &gt; 1.3 möglich )</td></tr></table><p>
Eine vollständige Liste der möglichen Parameter findet man in den <a class="internal" href="./man.html">manpages</a> von rkhunter.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Alleine durch die Benutzung von rkhunter kann nicht garantiert werden, dass sich nicht doch ein Rootkit auf dem System befindet. Die Anwendung von nur einem einzigen Tool ist nicht sehr effektiv, da ein Autor sein Rootkit dagegen immun gemacht haben könnte. Es sollten immer noch weitere Tests durchgeführt werden, wie zum Beispiel mit <a class="internal" href="./chkrootkit.html">chkrootkit</a> bzw. andere Maßnahmen vorgenommen werden. Des Weiteren sollte rkhunter, um dessen Integrität und damit die Verlässlichkeit sicherzustellen, immer von einem 100%ig unkompromittierten System ausgeführt werden, wie z.B. einer Live-CD. 
</p></div></div></div><div class="section_1"><h2 id="Automatische-Scans-und-Signatur-Aktualisierungen-per-Cron-Job-einrichten">Automatische Scans und Signatur-Aktualisierungen per Cron-Job einrichten<a class="headerlink" href="#Automatische-Scans-und-Signatur-Aktualisierungen-per-Cron-Job-einrichten">¶</a></h2><p>
Gerade bei Servern ist es nicht immer möglich, von einer Live-CD zu booten und dann nach Rootkits zu fanden. Hierfür haben die Programmierer die Möglichkeit geschaffen, sowohl rkhunter täglich als auch die Signatur-Aktualisierung automatisch als Cron-Job auszuführen.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bevor man rkhunter als Cron-Job einplant, sollte man sich jedoch sicher sein, das Programm auf einem nicht kompromittierten System zu installieren, um die entsprechenden MD5-Fingerprints ("Checksummen") anzulegen (zum Beispiel direkt nach einer Neuinstallation).
</p></div></div><p>Nach der Installation von rkhunter sollte man zuerst</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter --propupd --update  </pre></div></div><p>ausführen, um das Programm auf den aktuellen Stand zu bringen.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rkhunter -c  </pre></div></div><p>startet dann einen umfassenden interaktiven Prüflauf. Hierbei kann es durchaus zu Fehlalarmen kommen. Diese überprüft man in der Logdatei <strong>/var/log/rkhunter.log</strong> und passt gegebenenfalls die Konfigurationsdatei <strong>/etc/rkhunter.conf</strong> an,
zum Beispiel, um inetd-Dienste wie „swat“ hinzuzufügen.</p><div class="section_2"><h3 id="Falsche-Warnungen-durch-Whitelist-Eintraege-beseitigen">Falsche Warnungen durch Whitelist-Einträge beseitigen<a class="headerlink" href="#Falsche-Warnungen-durch-Whitelist-Eintraege-beseitigen">¶</a></h3><p>
Nach dem ersten Scan sollte man <strong>/var/log/rkhunter.log</strong> genau ansehen und alle Warnungen genauer untersuchen.</p><p>Dann kann man die Konfigurations-Datei <strong>/etc/rkhunter.conf</strong> so ändern, dass keine Warnungen mehr kommen ("Whitelisting").</p><p>Das folgendes Skript (das aus der FAQ von rkhunter entstanden ist) vereinfacht diese Arbeit, indem es für jede in der Log-Datei vorhandenen Warnung eine Whitelist-Konfigurations-Zeile am Bildschirm ausgibt.</p><p>Für die falschen Warnungen kopiert man dann die passenden Konfigurations-Zeilen ans Ende der Konfigurations-Datei.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1"># http://rkhunter.cvs.sourceforge.net/viewvc/rkhunter/rkhunter/files/FAQ</span>
<span class="nv">LOG</span><span class="o">=</span>/var/log/rkhunter.log
cat <span class="s">&lt;&lt;EOF</span>
<span class="s">6. WHITELISTING EXAMPLES</span>
<span class="s">========================</span>

<span class="s">6.1) After Rootkit Hunter has run you may encounter items in the log</span>
<span class="s">     file you would like to whitelist. First verify that the entries</span>
<span class="s">     are safe to add. The results of running these commands can be</span>
<span class="s">     added to your 'rkhunter.conf' configuration file. Please</span>
<span class="s">     adjust the commands, and the location of your 'rkhunter.log' log</span>
<span class="s">     file, and verify the results before adding them. Do not automate</span>
<span class="s">     adding whitelist entries to your configuration file.</span>

<span class="s">EOF</span>

<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow script replacements ("properties" test):'</span>
     awk -F<span class="s2">"'"</span> <span class="s1">'/replaced by a script/ {print "SCRIPTWHITELIST="$2}'</span> <span class="nv">$LOG</span>
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow processes using deleted files ("deleted_files" test):'</span>
     awk <span class="s1">'/Process: / {print "ALLOWPROCDELFILE="$3}'</span> <span class="nv">$LOG</span> <span class="p">|</span> sort -u
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow Xinetd services:'</span>
     awk <span class="s1">'/Found enabled xinetd service/ {print $NF}'</span> <span class="nv">$LOG</span> <span class="p">|</span>
      xargs -iX grep -e <span class="s2">"server[[:blank:]]"</span> <span class="s1">'X'</span> <span class="p">|</span> awk <span class="s1">'{print "XINETD_ALLOWED_SVC="$NF}'</span>
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow packet capturing applications ("packet_cap_apps" test):'</span>
     awk -F<span class="s2">"'"</span> <span class="s1">'/is listening on the network/ {print "ALLOWPROCLISTEN="$2}'</span> <span class="nv">$LOG</span>
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow "suspicious" files ("filesystem" test):'</span>
     grep <span class="s1">'^\[..:..:..\][[:blank:]]\{6\}.*/dev/shm/.*:'</span> <span class="nv">$LOG</span> <span class="p">|</span>
      awk <span class="s1">'{print "ALLOWDEVFILE="$2}'</span> <span class="p">|</span> sed -e <span class="s2">"s|:</span>$<span class="s2">||g"</span>
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow hidden directories ("filesystem" test):'</span>
     awk <span class="s1">'/Warning: Hidden directory/ {print "ALLOWHIDDENDIR="$6}'</span> <span class="nv">$LOG</span>
<span class="nb">echo</span> <span class="s1">'</span>
<span class="s1">     Allow hidden files ("filesystem" test):'</span>
     awk <span class="s1">'/Warning: Hidden file/ {print "ALLOWHIDDENFILE="$6}'</span> <span class="nv">$LOG</span> <span class="p">|</span>
      sed -e <span class="s2">"s|:</span>$<span class="s2">||g"</span>
</pre></div>
</td></tr></table></div><p><strong>Hinweis: Diese Skript-Datei verändert nichts, sie zeigt nur die Zeilen an, welche dann manuell in die Konfigurations-Datei kopiert werden können!</strong></p></div><div class="section_2"><h3 id="cron-Job-und-E-Mail-Benachrichtigung-aktivieren">cron-Job und E-Mail-Benachrichtigung aktivieren<a class="headerlink" href="#cron-Job-und-E-Mail-Benachrichtigung-aktivieren">¶</a></h3><p>
Wer aus den Paketquellen installiert hat, muss die cron-Job-Datei <strong>/etc/cron.daily</strong> nicht mehr manuell modifieren (das hat die Installation bereits erledigt).</p><p>Bei einer manuellen Installation von rkhunter kann man rkhunter zur regelmäßigen automatischen Ausführung als Cron-Job in <a class="internal" href="./cron.html">/etc/crontab</a> eintragen:</p><div class="bash"><div class="contents"><pre class="notranslate">10 3    * * *   root    /usr/bin/rkhunter --cronjob </pre></div></div><p>rkhunter kann per E-Mail Status-Meldungen schicken. Man erhält z. B. täglich eine E-Mail über die Scan-Ergebnisse, die ungefähr so aussieht (bei Auffälligkeiten):</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>From: root@localhost
Subject: [rkhunter] &lt;ComputerName&gt; - Daily report

Warning: The command '/usr/bin/unhide.rb' has been replaced by a script: /usr/bin/unhide.rb: Ruby script, ASCII text
Warning: Suspicious file types found in /dev:
         /dev/.udev/rules.d/root.rules: ASCII text
Warning: Hidden directory found: /etc/.java: directory 
Warning: Hidden directory found: /dev/.udev: directory 
Warning: Hidden file found: /dev/.initramfs: symbolic link to `/run/initramfs'
</pre></div>
</td></tr></table></div><p>
Die folgende Beschreibung funktioniert nur auf dem lokalen Rechner mit lokalen E-Mails und benötigt das Installations-Paket <strong>mailutils</strong> (siehe <a class="crosslink" href="#Aus-den-Paketquellen">Installation aus den Paket-Quellen</a>).
Wie man rkhunter-E-Mails über das Firmen- oder Internet verschickt, wäre hier zu kompliziert zu beschreiben (Stichworte: sendmail/MTA einrichten).</p><p>Folgende rkhunter-Konfigurations-Datei muss außerdem einmalig angepasst werden (dazu eine Konsole öffnen):</p><div class="bash"><div class="contents"><pre class="notranslate">sudo gedit /etc/default/rkhunter </pre></div></div><p>Dort die vorhandenen Eigenschaften für cron-Jobs wie folgt setzen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nv">CRON_DAILY_RUN</span><span class="o">=</span><span class="s2">"true"</span>
<span class="nv">CRON_DB_UPDATE</span><span class="o">=</span><span class="s2">"true"</span>
<span class="nv">DB_UPDATE_EMAIL</span><span class="o">=</span><span class="s2">"true"</span>
<span class="nv">REPORT_EMAIL</span><span class="o">=</span><span class="s2">"&lt;username&gt;@localhost"</span> <span class="c1"># &lt;username&gt; durch den Login-Namen des Haupt-Benutzers ersetzen (ermitteln z. B. mit dem Befehl "whoami")</span>
<span class="nv">APT_AUTOGEN</span><span class="o">=</span><span class="s2">"true"</span>
</pre></div>
</td></tr></table></div><p>Testen der E-Mail-Benachrichtigung durch manuelles Ausführen des cron-Job-Skripts (nur bei Installation von rkhunter über das Installations-Paket vorhanden!):</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/cron.daily/rkhunter </pre></div></div><p>Anmerkung: Zum Lesen der E-Mail muss ein E-Mail-Leseprogramm eingerichtet werden (siehe Beschreibung im nächsten Abschnitt).</p><p>Alternativ kann man die E-Mails in der Konsole mit folgendem Befehl lesen:</p><div class="bash"><div class="contents"><pre class="notranslate">mail </pre></div></div><p>Optional: Die E-Mail-Benachrichtigung, dass Warnungen gefunden wurden, sollte deaktiviert werden, da sie keine Details über die gefundenen Warnungen enthält (im Gegensatz zur obigen E-Mail-Benachrichtigung):</p><div class="bash"><div class="contents"><pre class="notranslate">sudo gedit /etc/rkhunter.conf </pre></div></div><p>Dort die allgemeinen rkhunter-Einstellungen wie folgt setzen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>MAIL-ON-WARNING<span class="o">=</span><span class="s2">""</span>
</pre></div>
</td></tr></table></div></div><div class="section_2"><h3 id="Lokales-E-Mail-Postfach-zum-Lesen-der-rkhunter-Nachrichten-einrichten">Lokales E-Mail-Postfach zum Lesen der rkhunter-Nachrichten einrichten<a class="headerlink" href="#Lokales-E-Mail-Postfach-zum-Lesen-der-rkhunter-Nachrichten-einrichten">¶</a></h3><p>
rkhunter kann Befunde und Status-Meldungen wie Signatur-Aktualisierungen per E-Mail mitteilen.</p><p>Wenn man diese Option wie im vorigen Abschnitt beschrieben aktiviert hat, muss man noch den Zugriff auf das lokale Postfach im E-Mail-Leseprogramm einrichten.</p><p>Die folgende Beschreibung gilt für das E-Mail-Leseprogramm <a class="internal" href="./evolution.html">Evolution</a>:</p><p>Menü <strong>Bearbeiten &gt; Einstellungen &gt; E-Mail-Konten</strong></p><p>Dort ein neues Konto anlegen mit folgenden Einstellungen (wobei &lt;username&gt; durch den Benutzer-Namen zu ersetzen ist, an den die E-Mails gemäß der Konfiguration im vorherigen Abschnitt geschickt werden):</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>Benutzer-Name: "&lt;username&gt;@thisComputer"
Server Typ: Standard unix mbox spool file
Datei: /var/mail/&lt;username&gt;
</pre></div>
</td></tr></table></div><p>Hinweis: &lt;username&gt; ist durch den Login-Namen des Haupt-Benutzers ersetzen (ermitteln z. B. mit dem Befehl "whoami")</p><p>Falls die Datei <strong>var/mail/&lt;username&gt;</strong> noch nicht vorhanden und damit nicht auswählbar ist, schickt man einmalig eine E-Mail an den Benutzer:</p><div class="bash"><div class="contents"><pre class="notranslate">echo "Meine erste E-Mail..." | mail -s "Nummer 1" &lt;username&gt; </pre></div></div><p>Jetzt kann man die E-Mails regelmäßig ansehen und lesen.</p><div class="section_3"><h4 id="Optional-Lokale-E-Mails-an-root-weiterleiten">Optional: Lokale E-Mails an root weiterleiten<a class="headerlink" href="#Optional-Lokale-E-Mails-an-root-weiterleiten">¶</a></h4><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Es empfiehlt sich generell, eine E-Mail-Weiterleitung der lokalen <strong>root</strong>-E-Mails zu dem &lt;username&gt; einzurichten, um keine E-Mails zu verpassen, die von anderen
Diensten geschickt werden (z. B. Hinweis auf gehäufte Fehler bei Festplatten-Zugriffen).
</p></div></div><p>Eine E-Mail-Weiterleitung von <strong>root</strong>-E-Mails wird so eingerichtet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo gedit /root/.forward </pre></div></div><p>Dort die (lokale!) Ziel-E-Mail-Adresse eintragen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>&lt;username&gt;@localhost
</pre></div>
</td></tr></table></div><p>Zum Testen schickt man von der Konsole eine E-Mail an den <strong>root</strong>-Benutzer und prüft, ob sie im E-Mail-Postfach ankommt:</p><div class="bash"><div class="contents"><pre class="notranslate">echo "lorem ipsum" | mail -s "Test-Mail an root" root </pre></div></div></div></div></div><div class="section_1"><h2 id="Weitere-Sicherheits-Massnahmen">Weitere Sicherheits-Maßnahmen<a class="headerlink" href="#Weitere-Sicherheits-Massnahmen">¶</a></h2><p>
Es ist auch sinnvoll, regelmäßig mit einem weiteren Scanner wie <a class="internal" href="./chkrootkit.html">chkrootkit</a> nach Auffälligkeiten zu suchen.</p><p></p></div></div>
<p class="meta">
<a href="./rkhunter/a/revision/939978.html">Diese Revision</a> wurde am 6. Mai 2017 18:12 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./rkhunter.html">rkhunter</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>