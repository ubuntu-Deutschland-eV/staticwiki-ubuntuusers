<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>NetworkManager/NetworkManager_ohne_GUI › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../networkmanager/networkmanager_ohne_gui.html">NetworkManager ohne GUI</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/NetworkManager/NetworkManager_ohne_GUI">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../networkmanager/networkmanager_ohne_gui/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../networkmanager/networkmanager_ohne_gui/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../networkmanager/networkmanager_ohne_gui/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../networkmanager/networkmanager_ohne_gui/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../networkmanager/networkmanager_ohne_gui/a/backlinks.html">NetworkManager ohne GUI</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../terminal.html#Virtuelle-Konsole">Arbeiten in der (virtuellen) Konsole</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../editor.html#Konsole">Einen Editor im Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../chmod.html">Rechte einer Datei setzen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#NetworkManager-einrichten">NetworkManager einrichten
</a><ol class="arabic"><li><a class="crosslink" href="#Kabelverbindung-konfigurieren">Kabelverbindung konfigurieren
</a></li><li><a class="crosslink" href="#Konfigurationsdatei-bearbeiten">Konfigurationsdatei bearbeiten
</a></li><li><a class="crosslink" href="#Statische-IP-definieren">Statische IP definieren
</a></li><li><a class="crosslink" href="#WLAN-Verbindung-konfigurieren">WLAN-Verbindung konfigurieren
</a></li></ol></li><li><a class="crosslink" href="#Beispiele-NM-verwenden">Beispiele: NM verwenden
</a><ol class="arabic"><li><a class="crosslink" href="#Genereller-Status">Genereller Status
</a></li><li><a class="crosslink" href="#Ab-Aufbau-Verbindung">Ab/-Aufbau Verbindung
</a></li><li><a class="crosslink" href="#Konfiguration-anzeigen">Konfiguration anzeigen
</a></li></ol></li><li><a class="crosslink" href="#Dokumentation">Dokumentation
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>
<img alt="Wiki/Icons/terminal.png" class="image-left" src="../_/e81889fd6e485dd32e1cde611eabc18abced7993.png"/></p><p><a class="internal" href="../networkmanager.html">NetworkManager</a> ist für Rechner ohne graphische <a class="internal" href="../desktop.html">Desktops</a>, also z.B. für</p><ul><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Headless">Headless Server</a></p></li><li><p><a class="internal" href="../server_installation.html">Server</a> ohne Desktop und ohne <a class="internal" href="../desktop.html">Window-Manager</a> (also nur eine Konsole)</p></li></ul><p>
nicht konzipiert – aber trotzdem über das Kommandozeilen-Programm <strong>nmcli</strong> einsetzbar.
Diese spezielle Anwendung wird hier beschrieben.</p><p>NetworkManager hat Vorteile gegenüber anderen Verfahren, insbesondere bei einer WLAN-Verbindung, weil er die Verbindung zum Netzwerk nicht nur beim Hochfahren regelt (siehe <a class="internal" href="../dienste.html">Dienste</a>), sondern auch im laufenden Betrieb ständig die Verbindung überwacht und wenn erforderlich nach Unterbrechungen auch wieder herstellt.</p><p>Das macht NetworkManager auch für Server-Installationen interessant – als Ersatz für die Netzwerkkonfigurationen über die Datei <strong><a class="internal" href="../interfaces.html">/etc/network/interfaces</a></strong>. NetworkManager verwendet allerdings im Gegensatz zu <strong>ifupdown</strong> zur Legitimation von System-Operationen <a class="internal" href="../policykit.html">PolicyKit</a>, dieses sollte vom Administrator für seinen konkreten Einzelfall konfiguriert werden.</p><p>Auch bei Rechnern mit graphischem Desktop können die hier vorgestellten Arbeitsweisen genutzt werden, beispielsweise bei der Fehlersuche.</p><p>Die Möglichkeiten von <strong>nmcli</strong> und die dabei zu verwendende Kommandosprache sind versionsabhängig. Hier wird die mit Ubuntu 16.04 ausgelieferte Version 1.2.6 oder neuer vorausgesetzt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Mit dem Begriff <code class="notranslate">Konsole</code> ist hier die Eingabe am <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Prompt">Shell-Prompt</a> (<code class="notranslate">cmdline</code>, <code class="notranslate">shell</code>) gemeint. Dieser ist nicht mit dem Programm <a class="internal" href="../konsole.html">Konsole</a> aus KDE identisch!
</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Bei einem Desktop-System ist keine Installation erforderlich, da der vorinstallierte NetworkManager bereits eine Bedienung auch über die Kommandozeile ermöglicht.</p><p>Bei einem nur über eine Konsole bedienbarem Rechner bedarf die Installation einer besonderen Vorgehensweise, da eine normale Installation des Paketes <strong>network-manager</strong> den vollen Umfang der jeweiligen Desktop-Pakete nachinstallieren würde – was auf einem Server meistens nicht erwünscht ist. Daher ist das folgende Vorgehen empfohlen.</p><p>1. Eine Verbindung zum Internet sollte bereits vorhanden sein, um den folgenden Befehl ausführen zu können<sup><a href="#source-1">[1]</a></sup>:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get --no-install-recommends install network-manager </pre></div></div><p> 2. Nach der erfolgreichen Installation von NetworkManager muss die bisherige automatische Konfiguration des Netzwerkes über <strong>ifupdown</strong> deaktiviert und für die Zukunft dauerhaft unterbunden werden:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifdown -a --exclude lo
sudo mv /etc/network/interfaces /etc/network/interfaces.unused </pre></div></div><p> 3. Nach einem Neustart des Rechners übernimmt NetworkManager die Konfiguration des Netzwerkes. Wenn er einen DHCP-Server findet, wird auch gleich eine aktive Verbindung hergestellt; anderenfalls muss man gemäß den hier folgenden Anleitungen nun eine Konfigurationsdatei anlegen.</p></div><div class="section_1"><h2 id="NetworkManager-einrichten">NetworkManager einrichten<a class="headerlink" href="#NetworkManager-einrichten">¶</a></h2><p>
NetworkManager erstellt für jede von ihm verwaltete Netzwerkschnittstelle (sog. device) automatisch eine temporäre Konfiguration (sog. connection) und liest zusätzlich bereits vor dem Login eines Benutzers Konfigurationsdateien aus dem Verzeichnis <strong>/etc/NetworkManager/system-connections/</strong>. Anschließend versucht NetworkManager für jede von ihm verwaltete Netzwerkschnittstelle eine Verbindung zu aktivieren.</p><p>Nach dem Login eines Benutzers werden keine Konfigurationsdateien aus dem HOME-Verzeichnis gelesen. (Das war früher anders!)</p><p>Eine Übersicht der Netzwerkschnittstellen bzw. der möglichen Verbindungen erhält man auf einer Konsole mit den Befehlen:
</p><div class="bash"><div class="contents"><pre class="notranslate">nmcli device
nmcli connection </pre></div></div><p>Das Programm <strong>nmcli</strong> unterstützt hinsichtlich seiner Kommandosprache die automatische Vervollständigung per Tab-Taste; man muss also z.B. nur <strong>nmcli c</strong> eingeben und (ggf. mehrmals) die Tab-Taste betätigen und kann sich so die möglichen Befehle zusammenbauen lassen.</p><p>Eine neue Konfigurationsdatei für eine kabelgebundene Verbindung erstellt man auf einer Konsole mit dem Befehl:
</p><div class="bash"><div class="contents"><pre class="notranslate">nmcli connection add type ethernet ifname GERÄT </pre></div></div><p> Dabei ist GERÄT eine der von <strong>nmcli device</strong> gelisteten Schnittstellen.</p><p>Diese Methode der Datei weist automatisch <em>root</em> als Besitzer und Gruppe zu, sorgt für die richtigen Benutzerrechte (<em>0600</em>)<sup><a href="#source-3">[3]</a></sup>, synchronisiert den Dateinamen mit dem Wert der Konfigurationsvariablen <code class="notranslate">id=...</code> und verwaltet die Datei innerhalb von NetworkManager unter ihrer UUID. Damit vermeidet man gegenüber der direkten Erzeugung einer passenden Datei im Verzeichnis <strong>/etc/NetworkManager/system-connections/</strong> viele Fehlermöglichkeiten.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Beachte: Man führt das Kommando <strong>nmcli</strong> nicht als <em>root</em>, sondern als normaler Benutzer aus!</p><p>NetworkManager verwendet <a class="internal" href="../policykit.html">PolicyKit</a> zur Authentifizierung der Benutzer bei kritischen Systemoperationen. Die Vorgabe-Werte sind großzügig eingestellt; der Administrator eines Multi-User- bzw. Server-Systems sollte die Vorgaben mit seinen Sicherheits-Anforderungen abgleichen!
</p></div></div><p>Der Dateiname für jede Konfigurationsdatei muss mit dem frei wählbaren Wert der Konfigurationsvariablen <code class="notranslate">id=...</code> in der Datei übereinstimmen; diese sind synchronisiert änderbar mit dem Befehl:
</p><div class="bash"><div class="contents"><pre class="notranslate">#nmcli connection modify ALTER-NAME connection.id NEUER-NAME
nmcli connection modify ethernet-eth0 connection.id IntraNET </pre></div></div><p>Praxistipp: Zur einfachen Unterscheidung von automatisch angelegten und bewusst angelegten Verbindungen kann man bei der Wahl des Namens reichlich Grossbuchstaben verwenden.</p><div class="section_2"><h3 id="Kabelverbindung-konfigurieren">Kabelverbindung konfigurieren<a class="headerlink" href="#Kabelverbindung-konfigurieren">¶</a></h3><p>
Der Befehl
</p><div class="bash"><div class="contents"><pre class="notranslate">#nmcli connection add type ethernet ifname GERÄT
nmcli connection add type ethernet ifname eth0 </pre></div></div><p> erzeugt diese Datei <strong>/etc/NetworkManager/system-connections/ethernet-eth0</strong>:</p><pre class="notranslate">[connection]
id=ethernet-eth0
uuid=1a7f80db-a616-44b2-abb8-b4ec1fbb3413
type=ethernet
interface-name=eth0
permissions=
secondaries=

[ethernet]
mac-address-blacklist=

[ipv4]
dns-search=
method=auto

[ipv6]
addr-gen-mode=stable-privacy
dns-search=
method=auto</pre><p>Die leeren Zeilen sind für die Auswertung erforderlich! Die Zeilen in eckigen Klammern <code class="notranslate">[</code> bzw. <code class="notranslate">]</code> fassen die einzelnen Abschnitte zur Auswertung zusammen. Nachfolgend die wesentlichen Werte, soweit diese nicht selbsterklärend sind.</p><p>
</p><table style="width: 95%"><tr class="titel"><td colspan="5"> Wichtige Variablen in der Konfigurationsdatei </td></tr><tr class="kopf"><td style="text-align: center; width: 30px"> Abschnitt </td><td style="text-align: center; width: 15%"> Variable </td><td colspan="5" style="text-align: left; vertical-align: top"> Funktion </td></tr><tr><td style="text-align: center; vertical-align: top"> connection </td><td style="text-align: left; vertical-align: top"> id </td><td colspan="3" style="text-align: left; vertical-align: top"> bezeichnet den Namen für die Verbindung und muss mit der realen Bezeichnung der Datei übereinstimmen. </td></tr><tr><td style="text-align: center; vertical-align: top"> connection </td><td style="text-align: left; vertical-align: top"> uuid </td><td colspan="3" style="text-align: left; vertical-align: top"> ist eine vom NetworkManager verwaltete 128-bit Identifizierung dieser Datei. </td></tr><tr><td style="text-align: center; vertical-align: top"> connection </td><td style="text-align: left; vertical-align: top"> type </td><td colspan="3" style="text-align: left; vertical-align: top"> beschreibt die Art der Verbindung: <code class="notranslate">ethernet</code> bedeutet IEEE802-3 (Kabel), <code class="notranslate">wifi</code> IEEE802-11 (Funk). </td></tr><tr><td style="text-align: center; vertical-align: top"> connection </td><td style="text-align: left; vertical-align: top"> autoconnect </td><td colspan="3" style="text-align: left; vertical-align: top"> <code class="notranslate">=false</code> verhindert die automatische Aktivierung dieser Verbindung. Beim Wert <code class="notranslate">true</code> oder wie hier fehlendem Eintrag wird die Verbindung bei Bedarf automatisch aktiviert. </td></tr><tr><td style="text-align: center; vertical-align: top"> ethernet </td><td style="text-align: left; vertical-align: top"> mac-address </td><td colspan="3" style="text-align: left; vertical-align: top"> identifiziert den rechnereigenen Baustein, der für die Verbindung benutzt werden soll, über dessen Hardwareadresse. </td></tr><tr><td style="text-align: center; vertical-align: top"> ethernet, wifi </td><td style="text-align: left; vertical-align: top"> mac-address-blacklist </td><td colspan="3" style="text-align: left; vertical-align: top"> listet die Hardwareadressen der rechnereigenen Schnittstellen, welche für diese Verbindung gesperrt sind. Nach jeder Adresse folgt ein Semikolon. </td></tr><tr><td style="text-align: center; vertical-align: top"> ipv4 </td><td style="text-align: left; vertical-align: top"> method </td><td colspan="3" style="text-align: left; vertical-align: top"> Beim Wert <code class="notranslate">auto</code> erfragt NetworkManager per DHCP eine IP und weitere Konfigurationsdaten; beim Wert <code class="notranslate">manual</code> werden mit zusätzlichen Variablen in diesem Abschnitt eine statische IP, Routen, Gateway und DNS-Server definiert. </td></tr><tr><td rowspan="2" style="text-align: center"> ipv4 </td><td rowspan="2" style="text-align: left"> addresses1 </td><td style="text-align: center; width: 33%"> eigene IP </td><td style="text-align: center; width: 33%"> Netzmaske </td><td style="text-align: center; width: 33%"> Gateway </td></tr><tr><td style="text-align: center"> 10.0.0.42 </td><td style="text-align: center"> 10 (für 255.192.0.0) </td><td style="text-align: center"> 10.0.0.1 </td></tr><tr><td rowspan="2" style="text-align: center"> ipv4 </td><td rowspan="2" style="text-align: left"> addresses2 </td><td colspan="3" style="text-align: left; vertical-align: top"> (mit Nummer = 2 und folgende) beschreibt jeweils eine weitere IP-Adresse und deren Netzmaske, jedoch wird hier kein Gateway angegeben. </td></tr><tr><td style="text-align: center"> 192.0.2.42 </td><td style="text-align: center"> 32 (für 255.255.255.255) </td><td style="text-align: center"> </td></tr><tr><td style="text-align: center; vertical-align: top"> ipv4 </td><td style="text-align: left; vertical-align: top"> dns </td><td colspan="3" style="text-align: left; vertical-align: top"> listet die IPv4-Adressen der DNS-Server. Nach jeder IP-Adresse folgt ein Semikolon. </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi </td><td style="text-align: left; vertical-align: top"> ssid </td><td colspan="3" style="text-align: left; vertical-align: top"> ist der Klartext-Name des WLAN-Netzes (SSID). </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi </td><td style="text-align: left; vertical-align: top"> mode </td><td colspan="3" style="text-align: left; vertical-align: top"> bedeutet Modus des WLAN-Netzes: <code class="notranslate">infrastructure</code> bzw. <code class="notranslate">adhoc</code> </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi </td><td style="text-align: left; vertical-align: top"> seen-bssids </td><td colspan="3" style="text-align: left; vertical-align: top"> listet die zum WLAN-Netz gehörenden Access-Points mit ihren MAC-Adressen (BSSID) an. Die BSSID wird im Gegensatz zur SSID vom Access-Point immer ausgesendet. So lassen sich auch versteckte Netzwerke zuordnen und einbinden. Nach jeder BSSID folgt ein Semikolon. </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi </td><td style="text-align: left; vertical-align: top"> mac-address-randomization </td><td colspan="3" style="text-align: left; vertical-align: top"> enthält einen <strong>missverständlichen Schlüssel</strong> 0, 1 oder 2: <code class="notranslate">0</code> bedeutet „überlasse anderen die Entscheidung“; <code class="notranslate">1</code> bedeutet „feste MAC-Adresse“ (!); <code class="notranslate">2</code> bedeutet „veränderliche MAC-Adresse“. </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi </td><td style="text-align: left; vertical-align: top"> powersave </td><td colspan="3" style="text-align: left; vertical-align: top"> enthält einen <strong>missverständlichen Schlüssel</strong> 0, 1, 2 oder 3 für die Energie-Einspar-Strategie: <code class="notranslate">0</code> bedeutet „verwende eine global definierte Strategie“; <code class="notranslate">1</code> bedeutet „nichts verändern“; <code class="notranslate">2</code> bedeutet „ausschalten“ und <code class="notranslate">3</code> bedeutet „einschalten“. </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi-sec </td><td style="text-align: left; vertical-align: top"> key-mgmt </td><td colspan="3" style="text-align: left; vertical-align: top"> beschreibt Art der Verschlüsselung des WLAN-Netzes. </td></tr><tr><td style="text-align: center; vertical-align: top"> wifi-sec </td><td style="text-align: left; vertical-align: top"> psk </td><td colspan="3" style="text-align: left; vertical-align: top"> ist entweder ein WPA-Key mit genau 64 hexadezimalen Ziffern oder eine WPA-Passphrase mit 8-63 ASCII-Zeichen. </td></tr></table><p>Zur Bedeutung weiterer Variablen sowie zur Verwendung des Abschnitts <code class="notranslate">[ipv6]</code> und weiterer Abschnitte siehe die Dokumentation von NetworkManager.</p></div><div class="section_2"><h3 id="Konfigurationsdatei-bearbeiten">Konfigurationsdatei bearbeiten<a class="headerlink" href="#Konfigurationsdatei-bearbeiten">¶</a></h3><p>
Zur Bearbeitung kann man eine der folgenden Methoden anwenden:  
</p><ol class="arabic"><li><p>Datei als <em>root</em> mit einen Texteditor<sup><a href="#source-2">[2]</a></sup> bearbeiten:</p><ul><li><p>Man sollte dies <span class="underline">nicht</span> bei laufendem NetworkManager machen, da man sonst inkonsistente Zustände provoziert.</p></li><li><p>Dies ist die mächtigste Methode, man kann aber auch leicht fehlerhafte Konfigurationen erstellen.</p></li></ul></li><li><p>Verwendung des in <strong>mncli</strong> eingebauten interaktiven Verbindungs-Editor, dessen Bedienung exemplarisch hier im Abschnitt <a class="crosslink" href="#Statische">„Statische IP definieren“</a> erläutert wird.</p><ul><li><p>Hierbei profitiert man von dem in <strong>nmcli</strong> eingebauten Hilfesystem, den direkt verfügbaren Erläuterungen zu den Optionen und deren Werten und auch wegen der automatischen Befehls-Vervollständigung und der eingebauten Befehls-Historie.</p></li><li><p>Alle Möglichkeiten von NetworkManager sind zugänglich.</p></li><li><p>Die Eingaben werden geprüft und syntaktisch falsche Eingaben werden abgewiesen.</p></li></ul></li><li><p>Ab Ubuntu 16.04: Verwendung des halbgraphischen Editors <strong>nmtui</strong>, der mittels der NCURSES-Bibliothek die Daten aufbereitet:</p><ul><li><p>Übersichtlicher als der interaktive Verbindungs-Editor von <strong>nmcli</strong>,</p></li><li><p>aber weniger mächtig.</p></li></ul></li><li><p>Einsatz eines graphischen Konfigurierwerkzeuges:</p><ul><li><p>Erfordert installierten Desktop,</p></li><li><p>noch übersichtlicher und schöner als <strong>nmtui</strong>,</p></li><li><p>aber noch weniger mächtig.</p></li></ul></li></ol><p>
</p></div><div class="section_2"><h3 id="Statische-IP-definieren">Statische IP definieren<a class="headerlink" href="#Statische-IP-definieren">¶</a></h3><p>
Muss oder will man für IPv4 statische Adressen verwenden, so wird der Abschnitt <code class="notranslate">[ivp4]</code> angepasst, beispielsweise:
</p><pre class="notranslate">[ipv4]
address1=10.0.0.42/10,10.0.0.1
address2=192.0.2.42/32
dns=192.0.2.222;10.0.0.1;
dns-search=
method=manual</pre><p>Man kann dies mit <strong>nmcli</strong> erledigen, indem man den interaktiven Verbindungs-Editor startet:
</p><div class="bash"><div class="contents"><pre class="notranslate">#nmcli connection edit VERBINDUNGSNAME
nmcli connection edit ethernet-eth0 </pre></div></div><p>Der interaktive Verbindungs-Editor versteht eine ganze Reihe von Befehlen, die wichtigsten sind:
</p><ul><li><p><code class="notranslate">help</code> zum Aufruf von Hilfstexten.</p></li><li><p><code class="notranslate">print</code> zur Anzeige von Variablen und Werten.</p></li><li><p><code class="notranslate">goto</code> und <code class="notranslate">back</code> zum Navigieren zu einem Abschnitt und Verlassen des Abschnitts.</p></li><li><p><code class="notranslate">set</code> zum Setzen von Werten.</p></li><li><p><code class="notranslate">save</code> zur Speicherung der Datei.</p></li><li><p><code class="notranslate">quit</code> zum Verlassen des Editors.</p></li></ul><p>
Der Editor beherrscht die automatische Vervollständigung mit der Tab-Taste und führt eine Befehls-Historie.</p><p>Die o.g. Veränderung des Abschnitts [ipv4] erreicht man durch diese Befehlsfolge:
</p><pre class="notranslate">nmcli&gt; goto ipv4
nmcli ipv4&gt; set method manual 
nmcli ipv4&gt; set addresses 10.0.0.42/10
nmcli ipv4&gt; set addresses 192.0.2.42/32
nmcli ipv4&gt; set gateway  10.0.0.1
nmcli ipv4&gt; set dns 192.0.2.222
nmcli ipv4&gt; set dns 10.0.0.1
nmcli ipv4&gt; save
nmcli ipv4&gt; quit</pre><p>Beachte: Die Variablen im Editor weichen teilweise von den in der Datei hinterlegten Optionen ab, vgl. <code class="notranslate">addresses</code> und <code class="notranslate">gateway</code> im Editor mit <code class="notranslate">address1</code> in der Datei.</p><p>Zum Löschen eines Wertes, auch einer Adressliste, gibt man einen leeren Wert durch zweimaliges Betätigen der Eingabetaste ein.</p></div><div class="section_2"><h3 id="WLAN-Verbindung-konfigurieren">WLAN-Verbindung konfigurieren<a class="headerlink" href="#WLAN-Verbindung-konfigurieren">¶</a></h3><p>
Für eine WLAN-Verbindung geht man im Prinzip genau so vor wie für eine Kabelverbindung, verwendet aber <code class="notranslate">type wifi</code> und muss die SSID des WLAN-Netzes angeben:
</p><div class="bash"><div class="contents"><pre class="notranslate">#nmcli connection add ifname GERÄT type wifi ssid SSID
nmcli connection add ifname wlan0 type wifi ssid UbuntuUsers </pre></div></div><p>Dieser Befehl erzeugt diese Datei <strong>/etc/NetworkManager/system-connections/wifi-wlan0</strong>:
</p><pre class="notranslate">[connection]
id=wifi-wlan0
uuid=d63bfffb-b4f1-465f-af8e-b4cb0786a3eb
type=wifi
interface-name=wlan0
permissions=
secondaries=

[wifi]
mac-address-blacklist=
mac-address-randomization=0
seen-bssids=
ssid=UbuntuUsers

[ipv4]
dns-search=
method=auto

[ipv6]
addr-gen-mode=stable-privacy
dns-search=
method=auto</pre><p>Anstelle des Abschnitts <code class="notranslate">[ethernet]</code> bei der Kabelverbindung wird hier ein Abschnitt <code class="notranslate">[wifi]</code> erzeugt; alle Abschnitte können mit dem interaktiven Verbindungs-Editor wie vorstehend beschrieben mit Optionen ausgestaltet werden.</p><p>Ebenfalls bearbeitbar, jedoch nicht auslesbar, ist ein (in der frisch erzeugten Datei noch fehlender) Abschnitt <code class="notranslate">[wifi-sec]</code> zur Aufnahme der für eine verschlüsselte Kommunikation erforderlichen Angaben inklusive des Passwortes.</p><p>Zur Nutzung der so erzeugten Verbindungsdatei muss man noch im Abschnitt <code class="notranslate">[wifi]</code> die Variable <code class="notranslate">mode</code> und im Abschnitt <code class="notranslate">[wifi-sec]</code> die Variablen <code class="notranslate">key-mgmt</code> und <code class="notranslate">psk</code> setzen; dies kann man mit dem interaktiven Verbindungs-Editor erledigen:
</p><pre class="notranslate">#nmcli connection edit VERBINDUNGSNAME
nmcli connection edit wifi-wlan0</pre><pre class="notranslate">nmcli&gt; goto wifi
nmcli 802-11-wireless&gt; set mode infrastructure 
nmcli 802-11-wireless&gt; back 
nmcli&gt; goto wifi-sec 
nmcli 802-11-wireless-security&gt; set key-mgmt wpa-psk 
nmcli 802-11-wireless-security&gt; set psk Hier ist nichts geheim!
nmcli 802-11-wireless-security&gt; save 
nmcli 802-11-wireless-security&gt; quit </pre><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Der Vorgabewert <code class="notranslate">0</code> für die Variablen <code class="notranslate">mac-address-randomization</code> und <code class="notranslate">powersave</code> kann Fehlverhalten verursachen.</p><p>Im Zweifel und im Fehlerfall sollte man diese Funktionalitäten ausschalten.
</p></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>NetworkManager soll zwar die Begriffe <code class="notranslate">ethernet</code> und <code class="notranslate">802-3-ethernet</code> sowie <code class="notranslate">wifi</code> und <code class="notranslate">802-11-wireless</code> als Synonyme verwenden; jedoch funktioniert an manchen Stellen nur eine der jeweils alternativen Bezeichnungen.
</p></div></div></div></div><div class="section_1"><h2 id="Beispiele-NM-verwenden">Beispiele: NM verwenden<a class="headerlink" href="#Beispiele-NM-verwenden">¶</a></h2><p>
</p><div class="section_2"><h3 id="Genereller-Status">Genereller Status<a class="headerlink" href="#Genereller-Status">¶</a></h3><p>
</p><ul><li><p>Aktuelle Netzwerk-Konfiguration anzeigen:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli general </pre></div></div><ul><li><p>Netzwerk generell ein- bzw. ausschalten:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli networking on    # bzw. off statt on </pre></div></div><ul><li><p>Funk ein-/ausschalten: (<code class="notranslate">wwan</code> steht für Telefon-Netze, <code class="notranslate">wifi</code> für IEEE802-11.)</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli radio wwan off   # bzw. on statt off
nmcli radio wifi on    # bzw. off statt on </pre></div></div><p>Die drei letzten Befehle ändern in der Datei <strong>/var/lib/NetworkManager/NetworkManager.state</strong>
den (auch über re-boot) gemerkten generellen Status von NetworkManager.</p></div><div class="section_2"><h3 id="Ab-Aufbau-Verbindung">Ab/-Aufbau Verbindung<a class="headerlink" href="#Ab-Aufbau-Verbindung">¶</a></h3><p>
In den folgenden Befehlen sind natürlich VERBINDUNGSNAME bzw. GERÄT durch sinnvolle Angaben gemäß den Listen <strong>nmcli connection</strong> bzw. <strong>nmcli device</strong> zu ersetzen.</p><ul><li><p>Aktive Verbindung beenden:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli connection down VERBINDUNGSNAME </pre></div></div><p>Beachte: Falls NetworkManager nach dem Abbau der Verbindung eine nutzbare Konfiguration für die Schnittstelle GERÄT findet, bei der <code class="notranslate">autoconnect</code> nicht ausgeschaltet wurde, so wird er automatisch mit der gefundenen Konfiguration die Schnittstelle wieder aktivieren. Das dauert einige Sekunden. Die „neue“ aktive Konfiguration kann durchaus wieder die gerade beendete alte oder eine andere sein.</p><ul><li><p>Alternative Methode zum Beenden einer Verbindung:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli device disconnect GERÄT  </pre></div></div><p>Beachte: Nach dem Abbau der über das GERÄT aktiven Verbindung wird NetworkManager nicht automatisch wieder eine Verbindung über dieses Gerät aufbauen.</p><ul><li><p>Verbindung aktivieren:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli connection up VERBINDUNGSNAME </pre></div></div><ul><li><p>Alternative Methode zum Verbinden:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli device connect GERÄT </pre></div></div><p>Falls für die zu aktivierende Schnittstelle bereits eine andere Verbindung aktiv ist, so wird diese vor dem Aufbau der neuen Verbindung beendet.</p></div><div class="section_2"><h3 id="Konfiguration-anzeigen">Konfiguration anzeigen<a class="headerlink" href="#Konfiguration-anzeigen">¶</a></h3><p>
</p><ul><li><p>Konfiguration der Schnittstelle GERÄT anzeigen:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">nmcli device show GERÄT </pre></div></div><ul><li><p>Falls man die Ausgabe dieses Befehls in einem Skript verwenden möchte, verwendet man besser:</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">LANG=C nmcli -t device show GERÄT </pre></div></div><p>NetworkManager zeigt per <strong>nmcli</strong> Informationen zu allen im System vorhandenen – auch für die von ihm nicht verwalteten –  Netzwerkschnittstellen an.</p></div></div><div class="section_1"><h2 id="Dokumentation">Dokumentation<a class="headerlink" href="#Dokumentation">¶</a></h2><p>
</p><ul><li><p>Man-Pages:</p><ul><li><p>nmcli als Programm: <strong>man nmcli</strong></p></li><li><p>nmtui als Programm: <strong>man nmtui</strong></p></li><li><p>Optionen für die Konfigurationsdateien: <strong>man nm-settings</strong></p></li></ul></li><li><p>NetworkManager-Projekt:</p><ul><li><p><a class="external" href="https://developer.gnome.org/NetworkManager/" rel="nofollow">NetworkManager Reference Manual</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p>Hier die passende Version lt. folgender Tabelle wählen!</p></li><li><p>
</p><table><tr class="kopf"><td> Ubuntu-Version </td><td> NM-version </td></tr><tr><td> 14.04 </td><td> 0.9.8.8 </td></tr><tr><td> 16.04 </td><td> 1.2.6 </td></tr><tr><td> 17.04 </td><td> 1.4.4 </td></tr></table></li></ul></li></ul></li></ul><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="../networkmanager.html">NetworkManager</a> - Hauptartikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../networkmanager/networkmanager_ohne_gui/a/revision/943828.html">Diese Revision</a> wurde am 27. September 2017 17:29 von <a href="https://ubuntuusers.de/user/noisefloor/">noisefloor</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../networkmanager.html">NetworkManager</a></li>
<li><a href="../networkmanager/networkmanager_ohne_gui.html">NetworkManager ohne GUI</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>