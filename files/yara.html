<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>YARA › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./yara.html">YARA</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/YARA">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./yara/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./yara/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./yara/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./yara/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./yara/a/backlinks.html">YARA</a></h1>
<div id="page"><p>
</p><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#aus-den-Paketequellen">aus den Paketequellen
</a></li><li><a class="crosslink" href="#manuell-installieren">manuell installieren
</a></li></ol></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a><ol class="arabic"><li><a class="crosslink" href="#Optionen">Optionen
</a></li><li><a class="crosslink" href="#Dokumentation-aufrufen">Dokumentation aufrufen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><a class="external" href="http://virustotal.github.io/yara/" rel="nofollow">YARA</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein Programm, mit dem sich der Inhalt von Dateien nach definierten Mustern durchsuchen lässt. YARA kann sowohl text-basierte als auch Binärdateien durchsuchen.</p><p>Die Entwickler von YARA bezeichnen das Programm selbst als "The pattern matching swiss knife for malware researchers (and everyone else)", was auf Deutsch so viel heißt wie: "Das Schweizer Taschenmesser für den Musterabgleich für Malware-Forscher (und jeden anderen)". Dies kommt daher, dass YARA auch in den Programmen namhafter Anti-Malware Softwareanbieter zum Einsatz kommt. Das Programm selber steht unter einer OpenSource Lizenz und kann frei genutzt werden.</p><p>Neben dem Einsatz auf der Kommandozeile bietet YARA auch eine API für <a class="external" href="http://yara.readthedocs.io/en/v3.6.0/yarapython.html" rel="nofollow">Python</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> und <a class="external" href="http://yara.readthedocs.io/en/v3.6.0/capi.html" rel="nofollow">C</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="section_2"><h3 id="aus-den-Paketequellen">aus den Paketequellen<a class="headerlink" href="#aus-den-Paketequellen">¶</a></h3><p>
YARA ist in den Paketquellen enthalten und kann über das Paket <strong>yara</strong> installiert werden<sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>yara</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install yara </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install yara </pre></div></div><p>
</p></div></div><p>Wer auch die Dokumentation lokal installieren möchte, der installiert noch zusätzlich folgendes Paket:</p><ul><li><p><strong>yara-docs</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install yara-docs </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install yara-docs </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="manuell-installieren">manuell installieren<a class="headerlink" href="#manuell-installieren">¶</a></h3><p>
Wenn die neueste bzw. eine neueren Version von YARA benötigt wird, als in den Paketquellen vorliegt, kann YARA manuell installieren werden, indem das Programm direkt aus dem Quelltext kompiliert wird. Die notwendigen Schritte für Ubuntu sind <a class="external" href="http://yara.readthedocs.io/en/v3.6.0/gettingstarted.html#compiling-and-installing-yara" rel="nofollow">in der Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> beschrieben.</p></div></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
YARA wird über die Kommandozeile genutzt<sup><a href="#source-2">[2]</a></sup>, die allgemeine Syntax lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">yara [OPTIONEN] RULES_DATEI ZIELVERZEICHNIS </pre></div></div><p>Die <code class="notranslate">RULES_DATEI</code> enthält dabei die Regel bzw. Regeln, nach der alle Dateien im Verzeichnis <code class="notranslate">ZIELVERZEICHNIS</code> durchsucht werden.</p><p>Die Suche erfolgt standardmäßig nicht rekursiv, d.h. es wird nur das angegebene Zielverzeichnis durchsucht, nicht dessen Unterverzeichnisse.</p><p>Die Datei, die die Regeln bzw. Muster enthält, nach der die Dateien durchsucht werden sollen, kann mehrere Regeln enthalten und pro Regel müssen mindestens die Sektionen <code class="notranslate">strings</code> und <code class="notranslate">conditions</code> vorhanden sein. Eine Regeldatei kann z.B. so aussehen:</p><pre class="notranslate">rule UbuntuusersTest
{

    meta:
        my_meta_string = "Beispiel für ubuntuusers.de"

    strings:
        $my_jpg_string = { FF D9 }
        $my_png_string = { 89 50 4E 47 0D 0A 1A 0A }
        $my_txt_string = "Hallo Welt!"

    condition:
        $my_jpg_string or $my_png_string or $my_txt_string
}</pre><p>Die Zeile <code class="notranslate">rule UbuntuusersTest</code> leitet einen neue Regel mit dem Namen <code class="notranslate">UbuntuusersTest</code> ein, die zugehörigen Regeln sind dann in geschweifte Klammern eingeschlossen. Die Sektion <code class="notranslate">strings</code> enthält ein oder mehrere Strings, nach der die Dateien durchsucht werden sollten. Die Namen der Strings müssen mit dem Dollarzeichen $ beginnen, die Strings können, wie in der 1. und 2. Zeile, entweder hexadezimal sein oder, wie in der 3. Zeile, Text.</p><p>Im Abschnitt <code class="notranslate">condition</code> wird definiert, unter welchen Umständen beim Durchsuchen ein Treffer gemeldet werden soll. In Beispiel wäre dies der Fall, wenn einer der drei Strings gefunden wird.</p><p>Der Abschnitt <code class="notranslate">meta</code> dient der zusätzlichen Dokumentation. Er ist optional und hat keine Einfluss auf die Suchregeln.</p><p>Eine Regeldatei kann dabei auch mehr als eine Regel enthalten. Jede Regel muss, wie oben bereits gesagt mit <code class="notranslate">rule NameDerRegel</code> eingeleitet werden. Regeldateien können dabei unter einem beliebigen Namen gespeichert werden.</p><p>Das Ergebnis einer Suche kann dann z.B. so aussehen:</p><div class="bash"><div class="contents"><pre class="notranslate">yara uude.rule Bilder/ </pre></div></div><p>
</p><pre class="notranslate">UbuntuusersTest Bilder//spamegg.txt
UbuntuusersTest Bilder//foo.png
UbuntuusersTest Bilder//20170703_174902.jpg
UbuntuusersTest Bilder//20170703_174818.jpg</pre><p>Die Datei <strong>uude.rule</strong> wird auf das Verzeichnis <strong>Bilder</strong> angewendet. In der Trefferliste wird ausgegeben, welche Regel zutrifft, gefolgt vom Dateinamen, auf die die Regel zutrifft.</p><p>Ruft man <code class="notranslate">yara</code> zusätzlich mit der Option <code class="notranslate">-s</code> auf, wird zusätzlich noch die Position des Treffers in der Datei mit ausgegeben und gezeigt, welcher der Strings den Treffer ausgelöst hat:</p><pre class="notranslate">UbuntuusersTest Bilder//spamegg.txt
0x7:$my_txt_string: Hallo Welt!
UbuntuusersTest Bilder//foo.png
0x0:$my_png_string: 89 50 4E 47 0D 0A 1A 0A 
UbuntuusersTest Bilder//20170703_174902.jpg
0x13bc05:$my_jpg_string: FF D9 
UbuntuusersTest Bilder//20170703_174818.jpg
0x24ae:$my_jpg_string: FF D9 
0x13ed06:$my_jpg_string: FF D9</pre><p>YARA bietet noch viel mehr Möglichkeiten, Regeldateien mit wesentlich komplexeren Regeln zu schreiben. Eine umfassende Übersicht inklusive vieler Beispielen ist in <a class="external" href="http://yara.readthedocs.io/en/v3.6.0/writingrules.html" rel="nofollow">der Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> zu finden.</p><div class="section_2"><h3 id="Optionen">Optionen<a class="headerlink" href="#Optionen">¶</a></h3><p>
YARA kennt eine Reihe von Optionen:</p><p>
</p><table><tr class="titel"><td colspan="2">Optionen von YARA </td></tr><tr class="kopf"><td>Option </td><td> Erklärung </td></tr><tr><td> <code class="notranslate">-s</code>, <code class="notranslate">--print-strings</code> </td><td> Zeigt zusätzlich den String an, der den Treffer ausgelöst hat und die Position des Treffers in der Datei. </td></tr><tr><td> <code class="notranslate">-n</code> </td><td> Zeigt nur die Regeln an, die keinen Treffer ausgelöst haben. </td></tr><tr><td> <code class="notranslate">-p ANZAHL</code>, <code class="notranslate">--threads=ANZAHL</code> </td><td> YARA startet <code class="notranslate">ANZAHL</code> Threads zum (parallelen) Durchsuchen der Dateien. </td></tr><tr><td> <code class="notranslate">-a SEKUNDEN</code>, <code class="notranslate">--timeout=SEKUNDEN</code> </td><td> Die Suche wird nach <code class="notranslate">SEKUNDEN</code> abgebrochen. </td></tr><tr><td> <code class="notranslate">-r</code>, <code class="notranslate">--recursive</code> </td><td> Das Zielverzeichnis wird rekursiv durchsucht. </td></tr></table><p>YARA kennt noch eine Reihe weitere Optionen, welche in der <a class="internal" href="./man.html">Manpage</a> und auch der <a class="external" href="http://yara.readthedocs.io/en/v3.6.0/commandline.html" rel="nofollow">Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> erklärt sind.</p></div><div class="section_2"><h3 id="Dokumentation-aufrufen">Dokumentation aufrufen<a class="headerlink" href="#Dokumentation-aufrufen">¶</a></h3><p>
Hat man die Dokumentation über die Paketverwaltung installiert, kann man diese über die URL <code class="notranslate">file:///usr/share/doc/yara-doc/html/index.html</code> aufrufen. Die Online-Dokumentation ist unter <code class="notranslate">http://yara.readthedocs.io/en/v3.6.0/</code> zu finden, wobei das <code class="notranslate">v3.6.0</code> gegebenenfalls. durch die Version zu ersetzen ist, die man verwendet.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-github" href="https://github.com/virustotal/yara">Github-Seite</a></p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./yara/a/revision/942873.html">Diese Revision</a> wurde am 2. August 2017 19:24 von <a href="https://ubuntuusers.de/user/noisefloor/">noisefloor</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./yara.html">YARA</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>