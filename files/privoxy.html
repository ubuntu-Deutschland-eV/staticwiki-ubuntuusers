<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Privoxy › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./privoxy.html">Privoxy</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Privoxy">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./privoxy/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./privoxy/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./privoxy/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./privoxy/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./privoxy/a/backlinks.html">Privoxy</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./dienste.html">Dienste steuern</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./sudo.html">Root-Rechte</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a></li><li><a class="crosslink" href="#Privoxy-im-Browser-aktivieren">Privoxy im Browser aktivieren
</a></li><li><a class="crosslink" href="#Werbefilter-einrichten">Werbefilter einrichten
</a></li><li><a class="crosslink" href="#Kinderschutz-einrichten">Kinderschutz einrichten
</a></li><li><a class="crosslink" href="#Funktion-ueberpruefen">Funktion überprüfen
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./privoxy_logo.png" class="image-left" src="./_/5acc987cc095df7df4dfb816bca074e2dc2ab0a1.png"/>
<a class="external" href="http://www.privoxy.org/" rel="nofollow">Privoxy</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – der Name steht für <strong>Privacy Enhancing Proxy</strong> – ist zum Schutz der Privatsphäre beim Internet-Surfen gedacht. Mit Privoxy können mit wenig Aufwand aufgerufene Webseiten nach eigenen Regeln gefiltert werden. So können beispielsweise Werbebanner automatisch aus dem Seiteninhalt entfernt werden. Auch die Verfolgung des Nutzerverhaltens durch Cookies kann mit Privoxy verhindert werden. Privoxy ist ein sogenannter Content-Filtering-<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Proxy">Proxy</a>.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Privoxy kann direkt aus den offiziellen Paketquellen installiert <sup><a href="#source-1">[1]</a></sup> werden. Folgendes Paket wird benötigt:</p><ul><li><p><strong>privoxy</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install privoxy </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install privoxy </pre></div></div><p>
</p></div></div><p>Anschließend wird Privoxy automatisch gestartet und lauscht auf Port <em>8118</em>.</p></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
Privoxy wird über die ausführlich dokumentierte Datei <strong>/etc/privoxy/config</strong> konfiguriert. Zur Einrichtung von Privoxy muss diese mit einem Editor <sup><a href="#source-4">[4]</a></sup> und Root-Rechten <sup><a href="#source-5">[5]</a></sup> bearbeitet werden. Zu blockierende Elemente werden in der Datei <strong>/etc/privoxy/user.action</strong> eingetragen (siehe auch <a class="crosslink" href="#Werbefilter-einrichten">Werbefilter einrichten</a>). Änderungen werden automatisch übernommen werden. Wie man den Privoxy-Dienst steuert, erfährt man mit dem Befehl <sup><a href="#source-2">[2]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate"># bis 14.04
sudo /etc/init.d/privoxy
# ab 16.04
sudo service privoxy </pre></div></div><p>Weitere Einstellungen (siehe nächster Abschnitt) sind optional und nicht unbedingt erforderlich. Dann geht es weiter mit <a class="crosslink" href="#Privoxy-im-Browser-aktivieren">Privoxy im Browser aktivieren</a>.</p><p><a class="crosslink anchor" href="#Weiterleitung_einrichten" id="Weiterleitung_einrichten"></a></p><div class="section_2"><h3 id="Weiterleitung">Weiterleitung<a class="headerlink" href="#Weiterleitung">¶</a></h3><p>
Privoxy kann Anfragen an einen vorgelagerten Proxyserver (parent proxy) weiterleiten. Ein Beispiel:</p><pre class="notranslate">#  5.1. forward 
forward   /      PROXY:PORT
forward   :443   .</pre><p>
Hier werden alle Anfragen (<code class="notranslate">/</code> = alle URLs) an einen vorgelagerten Proxy weitergeleitet. Davon ausgenommen sind Anfragen über den Port <code class="notranslate">443</code> (HTTPS), die als direkte Anfragen behandelt werden sollen. Will man eine Weiterleitung ausschließlich für bestimmte Domains einrichten, sieht die Zeile so aus:</p><pre class="notranslate">forward   .i2p   localhost:4444</pre><p>Dies leitet alle Aufrufe für DNS-Namen, die auf <code class="notranslate">.i2p</code> enden, an den eigenen Rechner auf Port <code class="notranslate">4444</code> weiter. Da keine Proxy-Art angegeben ist, erwartet Privoxy dort einen weiteren Webproxy.</p><div class="section_3"><h4 id="SOCKS">SOCKS<a class="headerlink" href="#SOCKS">¶</a></h4><p>
Auf Wunsch kann auch ein <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/SOCKS">SOCKS</a>-Proxy genutzt werden:</p><pre class="notranslate"># 5.2. forward-socks4 and forward-socks4a (neuere Versionen auch forward-socks5)
# ...
forward-socks4a / IP:PORT .</pre><p>Wichtig: Bitte nicht den <strong>Punkt</strong> am Ende vergessen! Sonst ignoriert Privoxy den Eintrag. IP muss durch die IP-Adresse ersetzt werden, an welcher der andere Proxy lauscht (wenn er auf demselben PC läuft, ist die IPv4-Adresse <code class="notranslate">127.0.0.1</code>), und PORT durch die entsprechenden Port-Nummer.</p></div></div><div class="section_2"><h3 id="Protokollierung">Protokollierung<a class="headerlink" href="#Protokollierung">¶</a></h3><p>
Optional kann man innerhalb der Konfiguration das Erstellen von Protokollen (z.B. zur Fehlersuche) ein- oder ausschalten. Zum Deaktivieren setzt man das Zeichen <strong>#</strong> an den Zeilenanfang, zum Aktivieren entfernt man es wieder. Beispiel (deaktiviert):</p><pre class="notranslate"># 2.5. logfile
# ...
# logfile logfile</pre></div><div class="section_2"><h3 id="Als-Dienst-im-LAN">Als Dienst im LAN<a class="headerlink" href="#Als-Dienst-im-LAN">¶</a></h3><p>
Soll Privoxy nicht nur lokal zur Verfügung stehen, sondern auch von anderen Rechnern im LAN erreichbar sein, so muss die Adresse geändert werden, auf der Privoxy lauscht. Hier muss die LAN-IP eingetragen werden. In diesem Beispiel <em>192.168.0.1</em>:</p><pre class="notranslate"># 4.1. listen-address
# ...
listen-address  192.168.0.1:8118</pre><p>
Dabei kann auch gleich aktiviert werden, dass Rechner aus dem lokalen Netzwerk (LAN) Privoxy über die Pseudo-Adresse <code class="notranslate">http://p.p/</code> steuern können:</p><pre class="notranslate"># 4.4. enable-edit-actions
# 0 = deaktiviert, 1 = aktiviert
enable-edit-actions 0</pre><p><a class="crosslink anchor" href="#browser" id="browser"></a></p></div></div><div class="section_1"><h2 id="Privoxy-im-Browser-aktivieren">Privoxy im Browser aktivieren<a class="headerlink" href="#Privoxy-im-Browser-aktivieren">¶</a></h2><p>
<img alt="./privoxy_firefox.png" class="image-right" src="./_/758b3f576b80f2171ae79da2050be76caec94075.png"/>
Damit Privoxy beim Surfen genutzt wird, müssen in den Netzwerkeinstellungen des Browsers der HTTP-Proxy und der Port angegeben werden:</p><pre class="notranslate">localhost:8118</pre><p>
bzw.</p><pre class="notranslate">&lt;Server-IP&gt;:8118</pre><p>
falls man Privoxy im LAN eingerichtet hat. Je nach Desktop-Umgebung können auch eigene Konfigurationswerkzeuge zur Einrichtung eines Proxys verwendet werden (siehe <a class="internal" href="./proxyserver.html">Proxyserver</a>). Aber nicht jeder Browser berücksichtigt die Verwendung eines zentralen Proxys, und evtl. streiken manche Programme (z.B. die <a class="internal" href="./paketverwaltung.html">Paketverwaltung</a>). Von daher ist man mit der direkten Konfiguration nur im Browser auf der sicheren Seite.</p></div><div class="section_1"><h2 id="Werbefilter-einrichten">Werbefilter einrichten<a class="headerlink" href="#Werbefilter-einrichten">¶</a></h2><p>
Will man die Konfiguration ändern, etwa eine Werbe-URL hinzufügen, die Privoxy nicht selbst erkennt, geht das über die Pseudo-Adresse: <a class="external" href="http://p.p" rel="nofollow" title="http://p.p">http://p.p</a></p><p>Dort gibt es den Link <em>"View &amp; change the current configuration"</em>. Hier auf den Button <em>"Edit"</em> in der Zeile <strong>/etc/privoxy/user.action</strong> klicken. Den Abschnitt suchen, bei dem unter <em>"Actions"</em> lediglich <em>"<code class="notranslate">+block</code>"</em> steht. Dort die Domain des Werbe-Servers eintragen, angeführt von einem Punkt, aber ohne ein eventuelles <em>"<code class="notranslate">http://www</code>"</em>. Das Resultat sind z.B. Einträge wie <em>"<code class="notranslate">.altfarm.xxx.com</code>"</em> oder <em>"<code class="notranslate">.adserv.xxx.de</code>"</em>. Mit <em>"Add"</em> fügt man die Werbe-URL hinzu.</p><p>Analog trägt man Seiten, die irrtümlich ausgeblendet werden (zu erkennen an der "Blocked"-Meldung), unter <em>"<code class="notranslate">-block</code>"</em> ein. Hier wird auch der Link <em>"go there anyway"</em> angeboten, über den man blockierten Seiten trotzdem aufrufen kann.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Auch in der Zeile <strong>/etc/privoxy/default.action</strong> gibt es einen <em>"Edit"</em>-Button. Davon sollte man aber keinen Gebrauch machen. Hier befinden sich die grundlegenden Regeln, nach denen Privoxy filtert. Anders als <strong>/etc/privoxy/user.action</strong> wird diese Datei bei einer Systemaktualisierung überschrieben.
</p></div></div><div class="section_2"><h3 id="EasyList">EasyList<a class="headerlink" href="#EasyList">¶</a></h3><p>
Um die Filterliste <a class="external" href="https://easylist.to/" rel="nofollow">EasyList</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> (die unter anderem auch im Firefox Add-On <a class="internal" href="./adblock.html">Adblock</a> verwendet wird) für Privoxy nutzen zu können, kann man ein Shell-Skript nutzen. Damit das Skript korrekt arbeiten kann, müssen aus dem Ordner <strong>/etc/privoxy/</strong> alle selbst angelegten Dateien zu Aktionen (<strong>.action</strong>) und Filtern (<strong>.filter</strong>) entfernt werden (wurden keine Anpassungen vorgenommen, kann man diesen Hinweis ignorieren). Gestattet sind lediglich folgende Dateien:</p><ul><li><p><strong>config</strong></p></li><li><p><strong>default.*</strong></p></li><li><p><strong>global.action</strong></p></li><li><p><strong>match-all.action</strong></p></li><li><p><strong>trust</strong></p></li><li><p><strong>user.action</strong></p></li></ul><p>
Außerdem sollte die Datei <strong>/etc/privoxy/config</strong> vorab auf Einträge zu benutzerdefinierten Aktionen und Filtern kontrolliert werden.</p><p>Gespeichert wird das Skript unter dem Namen <strong>~/bin/privoxy-blocklist.sh</strong> oder <strong>/usr/local/bin/privoxy-blocklist.sh</strong>:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1">#                  Author: Andrwe Lord Weber</span>
<span class="c1">#                  Mail: lord-weber-andrwe&lt;at&gt;renona-studios&lt;dot&gt;org</span>
<span class="c1">#                  Version: 0.2</span>
<span class="c1">#                  URL: http://andrwe.dyndns.org/doku.php/blog/scripting/bash/privoxy-blocklist</span>
<span class="c1">#</span>
<span class="c1">##################</span>
<span class="c1">#</span>
<span class="c1">#                  Sumary: </span>
<span class="c1">#                   This script downloads, converts and installs</span>
<span class="c1">#                   AdblockPlus lists into Privoxy</span>
<span class="c1">#</span>
<span class="c1">######################################################################</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1">#                 TODO:</span>
<span class="c1">#                  - implement:</span>
<span class="c1">#                     domain-based filter</span>
<span class="c1">#</span>
<span class="c1">######################################################################</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1">#                  script variables and functions</span>
<span class="c1">#</span>
<span class="c1">######################################################################</span>

<span class="c1"># array of URL for AdblockPlus lists</span>
<span class="nv">URLS</span><span class="o">=(</span><span class="s2">"https://easylist-downloads.adblockplus.org/easylistgermany.txt"</span> <span class="s2">"http://adblockplus.mozdev.org/easylist/easylist.txt"</span><span class="o">)</span>
<span class="c1"># privoxy config dir (default: /etc/privoxy/)</span>
<span class="nv">CONFDIR</span><span class="o">=</span>/etc/privoxy
<span class="c1"># directory for temporary files</span>
<span class="nv">TMPDIR</span><span class="o">=</span>/tmp/privoxy-blocklist
<span class="nv">TMPNAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="si">${</span><span class="nv">0</span><span class="si">}</span><span class="k">)</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1">#                  No changes needed after this line.</span>
<span class="c1">#</span>
<span class="c1">######################################################################</span>

<span class="k">function</span> usage<span class="o">()</span>
<span class="o">{</span>
	<span class="nb">echo</span> <span class="s2">"</span><span class="si">${</span><span class="nv">TMPNAME</span><span class="si">}</span><span class="s2"> is a script to convert AdBlockPlus-lists into Privoxy-lists and install them."</span>
	<span class="nb">echo</span> <span class="s2">" "</span>
	<span class="nb">echo</span> <span class="s2">"Options:"</span>
	<span class="nb">echo</span> <span class="s2">"      -h:    Show this help."</span>
	<span class="nb">echo</span> <span class="s2">"      -q:    Don't give any output."</span>
	<span class="nb">echo</span> <span class="s2">"      -v 1:  Enable verbosity 1. Show a little bit more output."</span>
	<span class="nb">echo</span> <span class="s2">"      -v 2:  Enable verbosity 2. Show a lot more output."</span>
	<span class="nb">echo</span> <span class="s2">"      -v 3:  Enable verbosity 3. Show all possible output and don't delete temporary files.(For debugging only!!)"</span>
	<span class="nb">echo</span> <span class="s2">"      -r:    Remove all lists build by this script."</span>
<span class="o">}</span>

<span class="o">[</span> <span class="si">${</span><span class="nv">UID</span><span class="si">}</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -e <span class="s2">"Root privileges needed. Exit.\n\n"</span> <span class="o">&amp;&amp;</span> usage <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>

<span class="c1"># check whether an instance is already running</span>
<span class="o">[</span> -e <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">TMPNAME</span><span class="si">}</span>.lock <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"An Instance of </span><span class="si">${</span><span class="nv">TMPNAME</span><span class="si">}</span><span class="s2"> is already running. Exit"</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span>

<span class="nv">DBG</span><span class="o">=</span><span class="m">0</span>

<span class="k">function</span> debug<span class="o">()</span>
<span class="o">{</span>
	<span class="o">[</span> <span class="si">${</span><span class="nv">DBG</span><span class="si">}</span> -ge <span class="si">${</span><span class="nv">2</span><span class="si">}</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -e <span class="s2">"</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">"</span>
<span class="o">}</span>

<span class="k">function</span> main<span class="o">()</span>
<span class="o">{</span>
	<span class="nv">cpoptions</span><span class="o">=</span><span class="s2">""</span>
	<span class="o">[</span> <span class="si">${</span><span class="nv">DBG</span><span class="si">}</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">cpoptions</span><span class="o">=</span><span class="s2">"-v"</span>

	<span class="k">for</span> url in <span class="si">${</span><span class="nv">URLS</span><span class="p">[@]</span><span class="si">}</span>
	<span class="k">do</span>
		debug <span class="s2">"Processing </span><span class="si">${</span><span class="nv">url</span><span class="si">}</span><span class="s2"> ...\n"</span> <span class="m">0</span>
		<span class="nv">file</span><span class="o">=</span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/<span class="k">$(</span>basename <span class="si">${</span><span class="nv">url</span><span class="si">}</span><span class="k">)</span>
		<span class="nv">actionfile</span><span class="o">=</span><span class="si">${</span><span class="nv">file</span><span class="p">%</span><span class="se">\.</span><span class="p">*</span><span class="si">}</span>.script.action
		<span class="nv">filterfile</span><span class="o">=</span><span class="si">${</span><span class="nv">file</span><span class="p">%</span><span class="se">\.</span><span class="p">*</span><span class="si">}</span>.script.filter
		<span class="nv">list</span><span class="o">=</span><span class="k">$(</span>basename <span class="si">${</span><span class="nv">file</span><span class="p">%</span><span class="se">\.</span><span class="p">*</span><span class="si">}</span><span class="k">)</span>
	
		<span class="c1"># download list</span>
		debug <span class="s2">"Downloading </span><span class="si">${</span><span class="nv">url</span><span class="si">}</span><span class="s2"> ..."</span> <span class="m">0</span>
		wget -t <span class="m">3</span> --no-check-certificate -O <span class="si">${</span><span class="nv">file</span><span class="si">}</span> <span class="si">${</span><span class="nv">url</span><span class="si">}</span> &gt;<span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/wget-<span class="si">${</span><span class="nv">url</span><span class="p">//</span><span class="se">\/</span><span class="p">/#</span><span class="si">}</span>.log <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
		debug <span class="s2">"</span><span class="k">$(</span>cat <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/wget-<span class="si">${</span><span class="nv">url</span><span class="p">//</span><span class="se">\/</span><span class="p">/#</span><span class="si">}</span>.log<span class="k">)</span><span class="s2">"</span> <span class="m">2</span>
		debug <span class="s2">".. downloading done."</span> <span class="m">0</span>
		<span class="o">[</span> <span class="s2">"</span><span class="k">$(</span>grep -E <span class="s1">'^\[Adblock.*\]$'</span> <span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="k">)</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">""</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"The list recieved from </span><span class="si">${</span><span class="nv">url</span><span class="si">}</span><span class="s2"> isn't an AdblockPlus list. Skipped"</span> <span class="o">&amp;&amp;</span> <span class="k">continue</span>
	
		<span class="c1"># convert AdblockPlus list to Privoxy list</span>
		<span class="c1"># blacklist of urls</span>
		debug <span class="s2">"Creating actionfile for </span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2"> ..."</span> <span class="m">1</span>
		<span class="nb">echo</span> -e <span class="s2">"{ +block{</span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2">} }"</span> &gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		sed <span class="s1">'/^!.*/d;1,1 d;/^@@.*/d;/\$.*/d;/#/d;s/\./\\./g;s/\?/\\?/g;s/\*/.*/g;s/(/\\(/g;s/)/\\)/g;s/\[/\\[/g;s/\]/\\]/g;s/\^/[\/\&amp;:\?=_]/g;s/^||/\./g;s/^|/^/g;s/|$/\$/g;/|/d'</span> <span class="si">${</span><span class="nv">file</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		debug <span class="s2">"... creating filterfile for </span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2"> ..."</span> <span class="m">1</span>
		<span class="nb">echo</span> <span class="s2">"FILTER: </span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2"> Tag filter of </span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2">"</span> &gt; <span class="si">${</span><span class="nv">filterfile</span><span class="si">}</span>
		<span class="c1"># set filter for html elements</span>
		sed <span class="s1">'/^#/!d;s/^##//g;s/^#\(.*\)\[.*\]\[.*\]*/s|&lt;([a-zA-Z0-9]+)\\s+.*id=.?\1.*&gt;.*&lt;\/\\1&gt;||g/g;s/^#\(.*\)/s|&lt;([a-zA-Z0-9]+)\\s+.*id=.?\1.*&gt;.*&lt;\/\\1&gt;||g/g;s/^\.\(.*\)/s|&lt;([a-zA-Z0-9]+)\\s+.*class=.?\1.*&gt;.*&lt;\/\\1&gt;||g/g;s/^a\[\(.*\)\]/s|&lt;a.*\1.*&gt;.*&lt;\/a&gt;||g/g;s/^\([a-zA-Z0-9]*\)\.\(.*\)\[.*\]\[.*\]*/s|&lt;\1.*class=.?\2.*&gt;.*&lt;\/\1&gt;||g/g;s/^\([a-zA-Z0-9]*\)#\(.*\):.*[:[^:]]*[^:]*/s|&lt;\1.*id=.?\2.*&gt;.*&lt;\/\1&gt;||g/g;s/^\([a-zA-Z0-9]*\)#\(.*\)/s|&lt;\1.*id=.?\2.*&gt;.*&lt;\/\1&gt;||g/g;s/^\[\([a-zA-Z]*\).=\(.*\)\]/s|\1^=\2&gt;||g/g;s/\^/[\/\&amp;:\?=_]/g;s/\.\([a-zA-Z0-9]\)/\\.\1/g'</span> <span class="si">${</span><span class="nv">file</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">filterfile</span><span class="si">}</span>
		debug <span class="s2">"... filterfile created - adding filterfile to actionfile ..."</span> <span class="m">1</span>
		<span class="nb">echo</span> <span class="s2">"{ +filter{</span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2">} }"</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		<span class="nb">echo</span> <span class="s2">"*"</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		debug <span class="s2">"... filterfile added ..."</span> <span class="m">1</span>
		debug <span class="s2">"... creating and adding whitlist for urls ..."</span> <span class="m">1</span>
		<span class="c1"># whitelist of urls</span>
		<span class="nb">echo</span> <span class="s2">"{ -block }"</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		sed <span class="s1">'/^@@.*/!d;s/^@@//g;/\$.*/d;/#/d;s/\./\\./g;s/\?/\\?/g;s/\*/.*/g;s/(/\\(/g;s/)/\\)/g;s/\[/\\[/g;s/\]/\\]/g;s/\^/[\/\&amp;:\?=_]/g;s/^||/\./g;s/^|/^/g;s/|$/\$/g;/|/d'</span> <span class="si">${</span><span class="nv">file</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		debug <span class="s2">"... created and added whitelist - creating and adding image handler ..."</span> <span class="m">1</span>
		<span class="c1"># whitelist of image urls</span>
		<span class="nb">echo</span> <span class="s2">"{ -block +handle-as-image }"</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		sed <span class="s1">'/^@@.*/!d;s/^@@//g;/\$.*image.*/!d;s/\$.*image.*//g;/#/d;s/\./\\./g;s/\?/\\?/g;s/\*/.*/g;s/(/\\(/g;s/)/\\)/g;s/\[/\\[/g;s/\]/\\]/g;s/\^/[\/\&amp;:\?=_]/g;s/^||/\./g;s/^|/^/g;s/|$/\$/g;/|/d'</span> <span class="si">${</span><span class="nv">file</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span>
		debug <span class="s2">"... created and added image handler ..."</span> <span class="m">1</span>
		debug <span class="s2">"... created actionfile for </span><span class="si">${</span><span class="nv">list</span><span class="si">}</span><span class="s2">."</span> <span class="m">1</span>
	
		<span class="c1"># install Privoxy actionsfile</span>
		cp <span class="si">${</span><span class="nv">cpoptions</span><span class="si">}</span> <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>
		<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="k">$(</span>grep <span class="k">$(</span>basename <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span><span class="k">)</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/config<span class="k">)</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">""</span> <span class="o">]</span> 
		<span class="k">then</span>
			debug <span class="s2">"\nModifying </span><span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span><span class="s2">/config ..."</span> <span class="m">0</span>
			sed <span class="s2">"s/^actionsfile user\.action/actionsfile </span><span class="k">$(</span>basename <span class="si">${</span><span class="nv">actionfile</span><span class="si">}</span><span class="k">)</span><span class="s2">\nactionsfile user.action/"</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/config &gt; <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/config
			debug <span class="s2">"... modification done.\n"</span> <span class="m">0</span>
			debug <span class="s2">"Installing new config ..."</span> <span class="m">0</span>
			cp <span class="si">${</span><span class="nv">cpoptions</span><span class="si">}</span> <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/config <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>
			debug <span class="s2">"... installation done\n"</span> <span class="m">0</span>
		<span class="k">fi</span>	
		<span class="c1"># install Privoxy filterfile</span>
		cp <span class="si">${</span><span class="nv">cpoptions</span><span class="si">}</span> <span class="si">${</span><span class="nv">filterfile</span><span class="si">}</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>
		<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="k">$(</span>grep <span class="k">$(</span>basename <span class="si">${</span><span class="nv">filterfile</span><span class="si">}</span><span class="k">)</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/config<span class="k">)</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">""</span> <span class="o">]</span> 
		<span class="k">then</span>
			debug <span class="s2">"\nModifying </span><span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span><span class="s2">/config ..."</span> <span class="m">0</span>
			sed <span class="s2">"s/^\(#*\)filterfile user\.filter/filterfile </span><span class="k">$(</span>basename <span class="si">${</span><span class="nv">filterfile</span><span class="si">}</span><span class="k">)</span><span class="s2">\n\1filterfile user.filter/"</span> <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/config &gt; <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/config
			debug <span class="s2">"... modification done.\n"</span> <span class="m">0</span>
			debug <span class="s2">"Installing new config ..."</span> <span class="m">0</span>
			cp <span class="si">${</span><span class="nv">cpoptions</span><span class="si">}</span> <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/config <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>
			debug <span class="s2">"... installation done\n"</span> <span class="m">0</span>
		<span class="k">fi</span>	
	
		debug <span class="s2">"... </span><span class="si">${</span><span class="nv">url</span><span class="si">}</span><span class="s2"> installed successfully.\n"</span> <span class="m">0</span>
	<span class="k">done</span>
<span class="o">}</span>

<span class="c1"># create temporary directory and lock file</span>
mkdir -p <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>
touch <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">TMPNAME</span><span class="si">}</span>.lock

<span class="c1"># set command to be run on exit</span>
<span class="o">[</span> <span class="si">${</span><span class="nv">DBG</span><span class="si">}</span> -le <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">trap</span> <span class="s2">"rm -fr </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="s2">;exit"</span> INT TERM EXIT

<span class="c1"># loop for options</span>
<span class="k">while</span> <span class="nb">getopts</span> <span class="s2">":hrqv:"</span> opt
<span class="k">do</span>
	<span class="k">case</span> <span class="s2">"</span><span class="si">${</span><span class="nv">opt</span><span class="si">}</span><span class="s2">"</span> in 
		<span class="s2">"h"</span><span class="o">)</span>
			usage
			<span class="nb">exit</span> <span class="m">0</span>
			<span class="p">;;</span>
		<span class="s2">"v"</span><span class="o">)</span>
			<span class="nv">DBG</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2">"</span>
			<span class="p">;;</span>
		<span class="s2">"q"</span><span class="o">)</span>
			<span class="nv">DBG</span><span class="o">=</span>-1
			<span class="p">;;</span>
		<span class="s2">"r"</span><span class="o">)</span>
			<span class="nb">echo</span> <span class="s2">"Do you really want to remove all build lists?(y/N)"</span>
			<span class="nb">read</span> choice
			<span class="o">[</span> <span class="s2">"</span><span class="si">${</span><span class="nv">choice</span><span class="si">}</span><span class="s2">"</span> !<span class="o">=</span> <span class="s2">"y"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span>
			rm -rf <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/*.script.<span class="o">{</span>action,filter<span class="o">}</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
			sed <span class="s1">'/^actionsfile .*\.script\.action$/d;/^filterfile .*\.script\.filter$/d'</span> -i <span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span>/config <span class="o">&amp;&amp;</span> <span class="se">\</span>
			<span class="nb">echo</span> <span class="s2">"Lists removed."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span>
			<span class="nb">echo</span> -e <span class="s2">"An error occured while removing the lists.\nPlease have a look into </span><span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span><span class="s2"> whether there are .script.* files and search for *.script.* in </span><span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span><span class="s2">/config."</span>
			<span class="nb">exit</span> <span class="m">1</span>
			<span class="p">;;</span>
		<span class="s2">":"</span><span class="o">)</span>
			<span class="nb">echo</span> <span class="s2">"</span><span class="si">${</span><span class="nv">TMPNAME</span><span class="si">}</span><span class="s2">: -</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2"> requires an argument"</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
			<span class="nb">exit</span> <span class="m">1</span>
			<span class="p">;;</span>
	<span class="k">esac</span>
<span class="k">done</span>

debug <span class="s2">"URL-List: </span><span class="si">${</span><span class="nv">URLS</span><span class="si">}</span><span class="s2">\nPrivoxy-Configdir: </span><span class="si">${</span><span class="nv">CONFDIR</span><span class="si">}</span><span class="s2">\nTemporary directory: </span><span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span><span class="s2">"</span> <span class="m">2</span>
main

<span class="c1"># restore default exit command</span>
<span class="nb">trap</span> - INT TERM EXIT
<span class="o">[</span> <span class="si">${</span><span class="nv">DBG</span><span class="si">}</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> rm -r <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>
<span class="o">[</span> <span class="si">${</span><span class="nv">DBG</span><span class="si">}</span> -eq <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> rm -vr <span class="si">${</span><span class="nv">TMPDIR</span><span class="si">}</span>
<span class="nb">exit</span> <span class="m">0</span>
</pre></div>
</td></tr></table></div><p>
<a class="external" href="http://andrwe.org/doku.php/scripting/bash/privoxy-blocklist" rel="nofollow">Quelle</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><p>Das Skript muss mit Root-Rechten <sup><a href="#source-5">[5]</a></sup> gestartet werden <sup><a href="#source-3">[3]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo bash privoxy-blocklist.sh -v 1 </pre></div></div><p>Nun werden automatisch:</p><ol class="arabic"><li><p>die aktuellen Filterlisten <em>"EasyList"</em> und <em>"EasyList Germany"</em> heruntergeladen</p></li><li><p>für die Nutzung mit Privoxy umgewandelt</p></li><li><p>in den Ordner <strong>/etc/privoxy/</strong> kopiert und</p></li><li><p>in der Datei <strong>/etc/privoxy/config</strong> eingetragen</p></li></ol><p>
Die neue Konfiguration wird von Privoxy automatisch erkannt. Empfehlenswert ist – bedingt durch den Zwischenspeicher (Cache) – ein Neustart des Webbrowsers. Das Skript kann man später (beispielsweise ein- bis zweimal im Monat) immer wieder erneut ausführen, um die Filterlisten zu aktualisieren. Fortgeschrittene können sich dazu einen <a class="internal" href="./cron.html">Cron</a>-Job einrichten.</p><p>Die angepasste Konfiguration und alle erzeugten Listen lassen sich mit dem Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo bash privoxy-blocklist.sh -r </pre></div></div><p>
wieder vollständig und rückstandsfrei vom Rechner entfernen.</p></div></div><div class="section_1"><h2 id="Kinderschutz-einrichten">Kinderschutz einrichten<a class="headerlink" href="#Kinderschutz-einrichten">¶</a></h2><p>
<img alt="./privoxy_kinderschutz.jpg" class="image-right" src="./_/b8d838e2059e3bf432f927f3c950d4960f0ad4c0.png"/>
Die folgende Idee basiert auf einer Kindersicherung, die Dieter Schütze im Rahmen des ehemaligen Projekts "KinderTux" sehr elegant umgesetzt hat. Es werden zwei Dateien mit Regeln benötigt, zur Erstellung braucht man Root-Rechte:</p><ul><li><p><strong>/etc/privoxy/blacklist.action</strong> - einzige Regel: es ist alles verboten. Inhalt: </p><pre class="notranslate">{+block{Kinderschutz aktiv}}
/ # alles blockieren!</pre></li><li><p><strong>/etc/privoxy/whitelist.action</strong> - erlaubte Ausnahmen. Inhalt: </p><pre class="notranslate">{-block}
.privoxy.org
.wdrmaus.de
.die-maus.de
.hirnwindungen.de
.mathe-spass.de
.learnetix.de
.wikipedia.org
.wikimedia.org
.fragfinn.de
.geolino.de
.geo.de
.blinde-kuh.de
.br-online.de
.derkleinekoenig.de
.kika.de
.kindersache.de
.kindernetz.de
.seitenstark.de
.rbb-online.de
.kidsweb.de
.bmu-kids.de
.br-online.de
.helles-koepfchen.de
.kidsville.de
.legakids.net
.lilipuz.de
.milkmoon.de
.pixelkids.de
.pomki.de
.labbe.de
.hamsterkiste.de
.physikfuerkids.de
.sowieso.de
.hanisauland.de
.rossipotti.de
.wasistwas.de
.wolf-kinderclub.de
.kidnetting.de
.radio108komma8.de
.klasse-wasser.de
.oekolandbau.de
.news4kids.de
.primolo.de
.starke-pfoten.de
.internet-abc.de
.notenmax.de
.lucylehmann.de
.kidkit.de
.junge-klassik.de
.medizin-fuer-kids.de
.global-gang.de
.klickerkids.de
.kinderrathaus.de
.bayerische.staatsoper.de
.zum.de
.mechant-loup.schule.de
.prinzessin-knoepfchen.de
.1000-maerchen.de
.creativecommons.org
.toggo.de
.toggolino.de</pre></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Diese Liste mit Ausnahmen ist nur ein Beispiel und sollte unbedingt – am besten nach Rücksprache mit den Kindern – angepasst werden! Weitere Informationen sind im Artikel <a class="internal" href="./kinder.html#Browser">Kinder</a> zu finden.
</p></div></div><p>Nun müssen diese Regeln noch aktiviert werden. Dazu bearbeitet <sup><a href="#source-4">[4]</a></sup> man die Datei <strong>/etc/privoxy/config</strong> mit Root-Rechten <sup><a href="#source-5">[5]</a></sup>, sucht den Abschnitt <em>"actionsfile"</em>, deaktiviert die vorhandenen Einträge (durch ein <strong>#</strong> am Zeilenanfang) und fügt die beiden neuen Regeln hinzu. Beispiel:</p><pre class="notranslate">#actionsfile match-all.action # Actions that are applied to all sites and maybe overruled later on.
#actionsfile default.action   # Main actions file
#actionsfile user.action      # User customizations
actionsfile blacklist.action   # alle blockieren
actionsfile whitelist.action   # erlaubte Seiten</pre><p>Die neue Konfiguration wird automatisch erkannt. Empfehlenswert ist – bedingt durch den Zwischenspeicher (Cache) – ein Neustart des Webbrowsers. Weitere erlaubte Webseiten werden später einfach in <strong>/etc/privoxy/whitelist.action</strong> nachgetragen <sup><a href="#source-4">[4]</a></sup><sup><a href="#source-5">[5]</a></sup>.</p><p>Deutsche und für Kinder (die bereits lesen können) verständliche Fehlermeldungen erreicht man durch den Austausch der Dateien <a class="crosslink" href="./privoxy.html">/etc/privoxy/templates/blocked</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> und <a class="crosslink" href="./privoxy.html">/etc/privoxy/templates/cgi-style.css</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/>. Leider fehlt im Gegensatz zum Original eine grafische Oberfläche, mit der man bei KinderTux neue Adressen bequem hinzufügen konnte.</p><p>Alternativ gibt es mit <a class="internal" href="./kinder.html#KinderServer">KinderServer</a> eine hervorragende Alternative, die das Erstellen einer eigenen "Whitelist" (erlaubte Adressen) überflüssig machen kann.</p></div><div class="section_1"><h2 id="Funktion-ueberpruefen">Funktion überprüfen<a class="headerlink" href="#Funktion-ueberpruefen">¶</a></h2><p>
Die Aktivitäten von Privoxy lassen sich im Terminal beobachten. Dazu muss die <a class="crosslink" href="#Protokolle">Protokollierung</a> aktiv sein:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo tail -f /var/log/privoxy/logfile </pre></div></div><p>
Mehr zum Thema <a class="internal" href="./logdateien.html">Logdateien</a>.</p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Privoxy-nach-Neustart-nicht-verfuegbar">Privoxy nach Neustart nicht verfügbar<a class="headerlink" href="#Privoxy-nach-Neustart-nicht-verfuegbar">¶</a></h3><p>
Immer wieder berichten Anwender, dass Privoxy beim Systemstart scheinbar nicht automatisch gestartet wird. Zwar läuft das Programm, aber ein Clientprogramm (z.B. ein Webbrowser) meldet trotzdem einen Fehler. In der Regel hilft ein manueller Neustart (des Dienstes) mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/privoxy restart
#bzw.
sudo service privoxy restart </pre></div></div><p>
Eine andere pragmatische Lösung ist ein automatischer Neustart via <a class="internal" href="./rc.local.html#Probleme-und-Loesungen">/etc/rc.local</a>:</p><pre class="notranslate"># startet Privoxy 30 Sekunden nach Systemstart erneut
(/bin/sleep 30 &amp;&amp; /etc/init.d/privoxy restart)</pre><p>Alternativ kann  auch ein Cronjob eingerichtet werden.</p></div><div class="section_2"><h3 id="Midori-kann-sich-nicht-mit-lokalem-Privoxy-verbinden">Midori kann sich nicht mit lokalem Privoxy verbinden<a class="headerlink" href="#Midori-kann-sich-nicht-mit-lokalem-Privoxy-verbinden">¶</a></h3><p>
Wenn man <a class="internal" href="./midori.html">Midori</a> in Kombination mit einem lokalen Privoxy verwenden möchte, kann es passieren, dass Midori die Fehlermeldung "<code class="notranslate">Cannot connect to proxy (127.0.0.1)</code>" oder "<code class="notranslate">Connection terminated unexpectedly</code>" ausgibt. Hier sollte man zunächst versuchen, statt der IP-Adresse <code class="notranslate">localhost</code> als Rechnernamen zu benutzen. Hilft dies nicht, ändert man den Rechnernamen zurück auf <code class="notranslate">127.0.0.1</code>, und fügt der Konfigurationsdatei <strong>/etc/privoxy/config</strong> zwei Zeilen zu:</p><ul><li><p>im Abschnitt 4.1 (<code class="notranslate">## listen-address</code>) die Zeile: </p><pre class="notranslate">listen-address  127.0.0.1:8118</pre></li><li><p>im Abschnitt 4.7 (<code class="notranslate">## ACLs: permit-access and deny-access</code>) die Zeile: </p><pre class="notranslate">permit-access  127.0.0.1</pre></li></ul><p>Anschließend startet man Privoxy neu.</p></div><div class="section_2"><h3 id="Chromium">Chromium<a class="headerlink" href="#Chromium">¶</a></h3><p>
<a class="internal" href="./chromium.html">Chromium</a> bzw. Google Chrome berücksichtigt unter GNOME und KDE die systemweiten Proxy-Einstellungen automatisch. Benutzer anderer Desktop-Umgebungen wie Xfce und LXDE oder alternativer Fenstermanager müssen selbst Hand anlegen, um Privoxy verwenden zu können: <a class="internal" href="./chromium.html#Proxy-Nutzung">Chromium Proxy-Einstellungen</a>.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.fabiankeil.de/privoxy-anleitung/" rel="nofollow">Ausführliche Anleitung zu Privoxy</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </p><ul><li><p><a class="external" href="http://www.fabiankeil.de/sourcecode/uagen/" rel="nofollow">Ein Werkzeug zum Erstellen von User-agents für Privoxy-actionfiles</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> </p></li></ul></li><li><p><a class="external" href="http://andrwe.org/doku.php/scripting/bash/privoxy-blocklist" rel="nofollow">privoxy-blocklist.sh</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p><a class="crosslink topic" href="https://forum.ubuntuusers.de/topic/howto-adblock-plus-filerlisten-in-privoxy-einb/">Howto: Adblock Plus Filterlisten in Privoxy einbinden</a></p></li></ul></li><li><p><a class="external" href="http://pgl.yoyo.org/as/serverlist.php?hostformat=junkbuster" rel="nofollow">Ad server hostnames</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> - Liste von Peter Lowe</p></li><li><p><a class="internal" href="./proxyserver.html">Proxyserver</a> - System für Proxy-Nutzung konfigurieren</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./privoxy/a/revision/940907.html">Diese Revision</a> wurde am 9. Mai 2017 02:11 von <a href="https://ubuntuusers.de/user/ubot/">ubot</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./privoxy.html">Privoxy</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>