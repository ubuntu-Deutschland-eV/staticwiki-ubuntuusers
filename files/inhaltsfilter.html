<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Inhaltsfilter › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./inhaltsfilter.html">Inhaltsfilter</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Inhaltsfilter">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./inhaltsfilter/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./inhaltsfilter/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./inhaltsfilter/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./inhaltsfilter/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./inhaltsfilter/a/backlinks.html">Inhaltsfilter</a></h1>
<div id="page"><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./sudo.html">Dateien mit Root-rechten bearbeiten</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./rechte.html">Rechte</a> - Dateien ausführbar machen</p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#etc-squid-squid-conf">/etc/squid/squid.conf
</a></li><li><a class="crosslink" href="#etc-dansguardian-dansguardian-conf">/etc/dansguardian/dansguardian.conf
</a></li><li><a class="crosslink" href="#etc-dansguardian-dansguardianf1-conf">/etc/dansguardian/dansguardianf1.conf
</a></li><li><a class="crosslink" href="#Erweitere-Konfiguration">Erweitere Konfiguration
</a></li></ol></li><li><a class="crosslink" href="#Dienste-neustarten">Dienste neustarten
</a></li><li><a class="crosslink" href="#Filterung-aktivieren">Filterung aktivieren
</a><ol class="arabic"><li><a class="crosslink" href="#Firefox">Firefox
</a></li></ol></li><li><a class="crosslink" href="#Log-als-E-Mail-versenden">Log als E-Mail versenden
</a><ol class="arabic"><li><a class="crosslink" href="#Logrotate">Logrotate
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Diese Anleitung beschreibt, wie man unter Linux einen Proxy-Server einrichtet, um den Webzugriff zu filtern und zu überwachen. Dieser ContentFilter besteht aus dem Proxyserver <a class="internal" href="./squid.html">Squid</a> und der Filterliste <a class="external" href="http://www.dansguardian.org/" rel="nofollow">DansGuardian</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>. Damit stellt er eine ähnliche Funktionalität wie <a class="external" href="http://www.covenanteyes.com/" rel="nofollow">CovenantEyes</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> zur Verfügung.</p><p>Die hier beschriebene Variante ist nicht die einzige Lösung. Denn in der Praxis definiert der Begriff "Inhaltsfilter" nicht zwangsläufig den gewünschten konkreten Einsatzzweck. Die einen verstehen darunter Anonymität im Internet, andere möchten eher Werbung ausfiltern oder eine Art Kinderschutz verwirklichen. Daher gibt es nicht nur eine Lösung:</p><ul><li><p><a class="internal" href="./tor.html">Tor</a> - Anonymität im Webbrowser (siehe auch <a class="internal" href="./polipo.html">Polipo</a>)</p></li><li><p>Werbefilter mit <a class="internal" href="./privoxy.html#Werbefilter-einrichten">Privoxy</a> einrichten</p></li><li><p>Kinderschutz <a class="internal" href="./privoxy.html#Kinderschutz-einrichten">Privoxy</a> einrichten</p></li><li><p><a class="internal" href="./tinyproxy.html">Tinyproxy</a> - einfacher Proxy für Einzelplatzrechner oder kleine Netze</p></li></ul><p>
Um einen Inhaltsfilter in Desktop-Umgebungen oder konkreten Programmen verwenden zu können, gibt es einen eigenen <a class="internal" href="./proxyserver.html">Artikel</a>.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Zunächst werden einige Programme installiert <sup><a href="#source-1">[1]</a></sup>. Die meisten davon sind bei einer Standardinstallation bereits vorhanden:</p><ul><li><p><strong>cron</strong></p></li><li><p><strong>anacron</strong></p></li><li><p><strong>logrotate</strong></p></li><li><p><strong>squid</strong></p></li><li><p><strong>dansguardian</strong> (<em>universe</em> )</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install cron anacron logrotate squid dansguardian </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install cron anacron logrotate squid dansguardian </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
Für die Konfiguration müssen einige Dateien in einem Editor <sup><a href="#source-2">[2]</a></sup> mit Root-Rechten <sup><a href="#source-3">[3]</a></sup> bearbeitet werden.</p><div class="section_2"><h3 id="etc-squid-squid-conf">/etc/squid/squid.conf<a class="headerlink" href="#etc-squid-squid-conf">¶</a></h3><p>
</p><pre class="notranslate">emulate_httpd_log on
visible_hostname localhost</pre></div><div class="section_2"><h3 id="etc-dansguardian-dansguardian-conf">/etc/dansguardian/dansguardian.conf<a class="headerlink" href="#etc-dansguardian-dansguardian-conf">¶</a></h3><p>
</p><pre class="notranslate"># UNCONFIGURED
language = 'german'</pre></div><div class="section_2"><h3 id="etc-dansguardian-dansguardianf1-conf">/etc/dansguardian/dansguardianf1.conf<a class="headerlink" href="#etc-dansguardian-dansguardianf1-conf">¶</a></h3><p>
</p><pre class="notranslate">naughtynesslimit = 130
bypass = 0</pre></div><div class="section_2"><h3 id="Erweitere-Konfiguration">Erweitere Konfiguration<a class="headerlink" href="#Erweitere-Konfiguration">¶</a></h3><p>
In der Standardinstallation von DansGuardian werden unter anderem sehr viele Dateitypen geblockt, die aber teilweise sehr wichtig sein können. Beispielsweise werden <strong>TAR</strong>-Archive und  <strong>GZ</strong>- und <strong>BZ2</strong>-komprimierte Dateien geblockt. Unter Umständen ist es auch nicht mehr möglich, Paketlisten über die <a class="internal" href="./paketverwaltung.html">Paketverwaltung</a> zu aktualisieren.</p><p>Diese erweiterten Einschränkungen werden im Verzeichnis <strong>/etc/dansguardian/</strong> unter anderem über Dateien geregelt, die mit <code class="notranslate">banned</code> (für geblockte Inhalte) oder <code class="notranslate">exception</code> (für Ausnahmen) beginnen. So werden z.B. Dateitypbeschränkungen in der Datei <strong>/etc/dansguardian/lists/bannedextensionlist</strong> geregelt.</p></div></div><div class="section_1"><h2 id="Dienste-neustarten">Dienste neustarten<a class="headerlink" href="#Dienste-neustarten">¶</a></h2><p>
Nun startet man die Dienste in einem Terminal <sup><a href="#source-4">[4]</a></sup> neu:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/squid restart
sudo /etc/init.d/dansguardian restart </pre></div></div></div><div class="section_1"><h2 id="Filterung-aktivieren">Filterung aktivieren<a class="headerlink" href="#Filterung-aktivieren">¶</a></h2><p>
Damit der Proxy und somit die Inhaltsfilterung aktiv wird, muss man nun die Proxy-Nutzung aktivieren (siehe auch <a class="internal" href="./proxyserver.html">Proxyserver</a>).</p><div class="section_2"><h3 id="Firefox">Firefox<a class="headerlink" href="#Firefox">¶</a></h3><p>
In <a class="internal" href="./firefox.html">Firefox</a> wählt man im Menü <em>"Bearbeiten -&gt; Einstellungen"</em> und klickt dann im Reiter <em>"Allgemein"</em> bzw je nach Version auf <em>"Erweitert -&gt; Netzwerk"</em> und dann auf den Button <em>"Verbindungs-Einstellungen..."</em>. In dem sich öffnenden Fenster wählt man <em>"Manuelle Proxy-Konfiguration"</em> aus. Bei <em>"HTTP-Proxy"</em> trägt man <code class="notranslate">localhost</code> ein und als Port <code class="notranslate">8080</code>. Zum Schluss setzt man noch den Haken bei <em>"Für alle Protokolle diesen Proxyserver verwenden"</em>.</p><p>Nun ist die Inhaltsfilterung aktiv. Falls eine Seite geblockt wurde, wird man darüber im Browser-Fenster in Kenntnis gesetzt.</p><p>Falls es stört, dass unten auf dem Block-Hinweis "Ihre Firma" steht, so öffnet man die Datei <strong>/etc/dansguardian/languages/german/template.html</strong> in einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> und sucht dort nach diesem Ausdruck. Man kann diesen jetzt entfernen oder durch etwas anderes ersetzen.</p></div></div><div class="section_1"><h2 id="Log-als-E-Mail-versenden">Log als E-Mail versenden<a class="headerlink" href="#Log-als-E-Mail-versenden">¶</a></h2><p>
Voraussetzung ist ein funktionierender <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Mail_Transfer_Agent">MTA</a>, z.B. <a class="internal" href="./postfix.html">Postfix</a>. Jetzt erstellt man das folgende Skript in einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> und speichert es als <strong>/usr/local/bin/visited_urls</strong> ab:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1"># gib alle URLs aus, für die Squid angefragt wurde</span>
<span class="c1"># die option -v zu grep bedeutet alle Zeilen, die den folgenden Text (oder regulaeren Ausdruck)</span>
<span class="c1"># enthalten nicht augeben (A.d.Ue.)</span>
<span class="c1">#</span>
<span class="nb">echo</span> <span class="nv">$1</span>
<span class="nb">echo</span> <span class="s2">""</span>
cat /var/log/squid/access.log <span class="p">|</span> <span class="se">\</span>
grep -v .tar.bz2 <span class="p">|</span> grep -v .tar.gz <span class="p">|</span> grep -v .pdf <span class="p">|</span> <span class="se">\</span>
grep -v .jpg <span class="p">|</span> grep -v .gif <span class="p">|</span> grep -v .png <span class="p">|</span> <span class="se">\</span>
grep -v .ra <span class="p">|</span> grep -v .ram <span class="p">|</span> grep -v .rm <span class="p">|</span> grep -v .mp3 <span class="p">|</span> grep -v .mid <span class="p">|</span> <span class="se">\</span>
grep -v .css <span class="p">|</span> grep -v .js <span class="p">|</span> grep -v .ico <span class="p">|</span> <span class="se">\</span>
sed -e <span class="s1">'s#.http://#http://#'</span> -e <span class="s1">'s#.*CONNECT.#https://#'</span> -e <span class="s1">'s#[[:blank:]].*##'</span> <span class="p">|</span> <span class="se">\</span>
sed -e <span class="s1">'s#\?##'</span> -e <span class="s1">'s#:[0-9][0-9]*##'</span> -e <span class="s1">'s#{\|\;].*##'</span> <span class="p">|</span> <span class="se">\</span>
sed -e <span class="s1">'s#/#§#3'</span> -e <span class="s1">'s#§.*##'</span> <span class="p">|</span> <span class="se">\</span>
sort -u <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</td></tr></table></div><p>
Analog dazu erstellt man die Datei <strong>/usr/local/bin/mail_visited_urls</strong>:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#</span>
<span class="c1"># sende die besuchten URLs an den Accountability-Partner (jemand gegenüber den du</span>
<span class="c1"># Rechenschaft über dein Surfverhalten ablegst)</span>
<span class="c1">#</span>
/usr/local/bin/visited_urls <span class="s2">"MeinName hat von den folgenden Webseiten Inhalte abgerufen:"</span> <span class="p">|</span> <span class="se">\</span>
mail -s <span class="s2">"Webseiten – MeinName"</span> meinpartner@accountability.net
<span class="nb">echo</span> <span class="s2">"mail_visited_urls @ </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">"</span> &gt;&gt; /var/log/mail_visited_urls.log
</pre></div>
</td></tr></table></div><p>Beide Skripte müssen noch ausführbar gemacht werden <sup><a href="#source-5">[5]</a></sup>.</p><div class="section_2"><h3 id="Logrotate">Logrotate<a class="headerlink" href="#Logrotate">¶</a></h3><p>
Hier bearbeitet man die Datei <strong>/etc/logrotate.d/squid</strong> so, dass sie folgenden Inhalt enthält:</p><pre class="notranslate">/var/log/squid/*.log {
        '''weekly'''
        compress
        delaycompress
        rotate 8
        missingok
        nocreate
        sharedscripts
        prerotate
                /usr/local/bin/mail_visited_urls
        endscript
        postrotate
                test ! -e /var/run/squid.pid || /usr/sbin/squid -k rotate
        endscript
}</pre></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="./serverdienste.html#Proxyserver">Proxyserver</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Programmübersicht</p></li><li><p><a class="interwiki interwiki-pdf" href="http://www.eternium.de/files/linux-filtering-monitoring-howto-de.pdf">Internet Filter und Zugriffsüberwachung unter Linux</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> - Anleitung im PDF-Format, ursprüngliche Quelle für diesen Artikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./inhaltsfilter/a/revision/943185.html">Diese Revision</a> wurde am 21. August 2017 12:36 von <a href="https://ubuntuusers.de/user/noisefloor/">noisefloor</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./inhaltsfilter.html">Inhaltsfilter</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>