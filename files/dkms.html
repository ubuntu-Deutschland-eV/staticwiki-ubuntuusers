<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>DKMS › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./dkms.html">DKMS</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/DKMS">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./dkms/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./dkms/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./dkms/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./dkms/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./dkms/a/backlinks.html">DKMS</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./programme_kompilieren.html">Programme bzw. Kernelmodule aus dem Quelltext übersetzen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/develop.png" class="image-left" src="./_/a1a1cf93aadb058302a86738e0a49687b41844f8.png"/>
<a class="external" href="http://linux.dell.com/dkms/" rel="nofollow">DKMS</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> steht für <strong>D</strong>ynamic <strong>K</strong>ernel <strong>M</strong>odule <strong>S</strong>upport. Das von Dell entwickelte Hilfsprogramm überwacht, ob zusätzliche Kernelmodule manuell installiert wurden und aktualisiert die Module immer dann, wenn ein neuer oder aktualisierter Kernel installiert wird. Dies ist insofern praktisch, dass das Kompilieren des Kernelmoduls nicht immer von Hand durchgeführt werden muss, wenn der Kernel aktualisiert wurde.</p><p>Hat man also z.B. zusätzliche Treiber in Form von selbstkompilierten Kernelmodulen von Hand installiert, so stehen diese in der Regel direkt nach dem ersten Neustart (nach dem Kernelupdate) wieder zur Verfügung. DKMS prüft entweder bei der Installation eines neuen Kernels oder spätestens beim Rechnerstart, ob die passenden Module für den aktuellen Kernel vorhanden sind und erstellt diese bei Bedarf automatisch.</p><p>Praktisch wird DKMS meist bei proprietären (unfreien) Treibern für Grafikkarten und RAID-Controller sowie Softwarelösungen zur <a class="internal" href="./virtualisierung.html">Virtualisierung</a> eingesetzt, also Bereiche, bei denen ein Kernelupdate unter Umständen zu einem nicht mehr funktionierendem System bzw. Programm führen kann.</p><p><img alt="Wiki/Icons/synaptic.png" class="image-right" src="./_/5f59c9b9aac5b4e2ab9c85b868bf348c72dc10aa.png"/>
</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
DKMS kann über folgende Pakete installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>build-essential</strong> (zum Übersetzen des Quellcodes)</p></li><li><p><strong>dkms</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install build-essential dkms </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install build-essential dkms </pre></div></div><p>
</p></div></div><p><img alt="Wiki/Icons/settings.png" class="image-right" src="./_/44291e0203c1fed32d9b02c10c138504ec425e3d.png"/>
</p></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
DKMS wird über eine einzelne Datei konfiguriert. Die Standardkonfiguration findet man unter Ubuntu im Verzeichnis <strong>/etc/dkms/framework.conf</strong>. Die Datei ist relativ kurz und gut kommentiert, weitere Informationen findet man auch in der <a class="internal" href="./man.html">Manpage</a> zu DKMS. Ein Anpassung der Datei ist in der Regel nicht notwendig.</p></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
Ist DKMS installiert, nimmt es die Arbeit ohne weiteres Zutun direkt auf. Weiterhin wird DKMS bei jedem Systemstart über ein <a class="internal" href="./dienste.html">init-Skript</a> automatisch gestartet.</p><p>Installiert man von Hand ein Kernelmodul (z.B. mittels des <a class="internal" href="./module-assistant.html">module-assistant</a>), so fließt es direkt in die Liste der überwachten Module ein. Möchte man wissen, welche Module aktuell von DKMS überwacht werden, so kann man dies abfragen oder schaut alternativ in das Verzeichnis <strong>/var/lib/dkms</strong>. Für jedes Kernelmodul existiert hier ein Unterverzeichnis mit dem Namen des Moduls. Innerhalb der jeweiligen Unterverzeichnisse findet man den Quellen des Moduls sowie die kompilierten Module für die jeweiligen Kernel.</p><div class="bash"><div class="contents"><pre class="notranslate">dkms status
ls -l /var/lib/dkms </pre></div></div><div class="section_2"><h3 id="Manuell">Manuell<a class="headerlink" href="#Manuell">¶</a></h3><p>
Auch wenn DKMS unter Ubuntu quasi "vollautomatisch" läuft, bietet es eine Reihe von Möglichkeiten, manuell einzugreifen.</p><p>Die allgemeine Syntax von DKMS lautet <sup><a href="#source-3">[3]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">dkms AKTION OPTION </pre></div></div><p><code class="notranslate">AKTION</code> kann dabei z.B. das manuelle Hinzufügen (<code class="notranslate">add</code>) oder Entfernen (<code class="notranslate">remove</code>) eines Moduls zu DKMS sein oder auch das von Hand angestoßene Kompilieren (<code class="notranslate">build</code>) und Installieren (<code class="notranslate">install</code>) des Moduls. Dies funktioniert auch für einen anderen Kernel als den aktuell laufenden. Als <code class="notranslate">OPTION</code> kann z.B. angegeben werden, für welchen Kernel oder welche (Prozessor-) Architektur das Modul gebaut werden soll. Recht ausführlich kann man alle Aktionen und Optionen in der <a class="internal" href="./man.html">Manpage</a> von DKMS nachlesen.</p><p>Weiterhin wird noch eine Datei <strong>dkms.conf</strong> benötigt bzw. diese ist von Hand anzulegen. Diese enthält einige Informationen über das Kernelmodul, welche von DKMS eingelesen werden. Die möglichen Angaben für die <strong>dkms.conf</strong> sind ebenfalls in der Manpage dokumentiert.</p><p><img alt="Wiki/Icons/hint.png" class="image-right" src="./_/373498fdc2029677a28c73a7dbfd03875da129fa.png"/>
</p><div class="section_3"><h4 id="Beispiel">Beispiel<a class="headerlink" href="#Beispiel">¶</a></h4><p>
Gegeben sei ein Quelltextarchiv mit dem fiktiven Namen <strong>xyz-1.2.3.tar.gz</strong>, das nicht aus den offiziellen Paketquellen stammt, sondern beispielsweise vom Hersteller der Hardware-Komponente mitgeliefert wird. Dieses wird zuerst einmal im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> entpackt. Das Archiv enthält dabei in der Regel</p><ul><li><p>einige Textdateien (<strong>README, INSTALL, NEWS</strong> etc.) mit Informationen, die zuerst gelesen werden sollten</p></li><li><p>zur Kompilieren erforderliche Dateien wie <strong>Makefile, configure</strong> etc.</p></li><li><p>und einen Unterordner <strong>src</strong>, der den eigentlichen Quellcode enthält.</p></li></ul><p>
Nun wird der Archivinhalt mit Root-Rechten in einen Ordner unterhalb von <strong>/usr/src/</strong> kopiert. Die Benennung des Unterordners folgt dabei immer dem Schema <em>"&lt;modulename&gt;-&lt;version&gt;"</em>, also praktisch <strong>/usr/src/xyz-1.2.3/</strong>. Falls das Archiv Unterordner enthält, müssen auch diese kopiert werden.</p><p>Im nächsten Schritt wird eine Datei <strong>/usr/src/xyz-1.2.3/dkms.conf</strong> mit Root-Rechten und folgendem Inhalt angelegt:</p><pre class="notranslate">PACKAGE_NAME=xyz
PACKAGE_VERSION=1.2.3

DEST_MODULE_LOCATION=/extra
BUILT_MODULE_NAME=xyz
BUILT_MODULE_LOCATION=src/

MAKE="'make' -C src/ all"
CLEAN="'make' -C src/ clean"
AUTOINSTALL="yes"</pre><p>
Erwähnenswert ist hier die Option "<strong><code class="notranslate">-C src/</code></strong>". Da sich im Beispiel der eigentliche Quellcode in einem Unterordner befindet, wird hierüber angegeben, wo DKMS den Quellcode suchen soll. Falls ein Quelltextarchiv keine Unterordner enthält, kann man diese Option auch weglassen.</p><p>Das Kompilieren mittels DKMS wird mit folgenden Schritten getestet:</p><ol class="arabic"><li><p>Mit dem Befehl: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo dkms add -m xyz -v 1.2.3 </pre></div></div><p> wird das Kompilieren von <code class="notranslate">xyz</code> vorbereitet.</p></li><li><p>Der eigentliche Kompilierungsvorgang wird mit: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo dkms build -m xyz -v 1.2.3 </pre></div></div><p> gestartet.</p></li><li><p>Abschließend erfolgt die Installation des Kernelmoduls: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo dkms install -m xyz -v 1.2.3 </pre></div></div></li><li><p>Nur erforderlich, wenn man das Kernelmodul wieder aus DKMS entfernen möchte: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo dkms remove -m xyz -v 1.2.3 --all </pre></div></div></li></ol><p>
Gibt es bei einem dieser Schritte Probleme, informiert DKMS darüber mit entsprechenden (englischen) Meldungen. Leider kann es passieren, das sich der Quellcode nicht unter dem installierten Kernel übersetzen lässt. Dieses kann unterschiedliche Ursachen haben, die eine Anpassung des Quellcodes erforderlich machen. Zum Beispiel ändern sich manchmal interne Schnittstellen im Kernel oder der Pfad zu System-Bibliotheken. Diese Probleme würden jedoch auch beim manuellen Kompilieren ohne DKMS auftreten.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Empfehlenswert ist <span class="underline">vor dem Einsatz</span> von DKMS ein manuelles Kompilieren des Quellcodes <sup><a href="#source-2">[2]</a></sup>, um bereits hier auftretende Fehler zu erkennen und gegebenenfalls zu beheben.
</p></div></div></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Kernelquellen-nicht-installiert">Kernelquellen nicht installiert<a class="headerlink" href="#Kernelquellen-nicht-installiert">¶</a></h3><p>
Tritt bei Verwendung von DKMS folgende Meldung auf – zum Beispiel während der Installation eines Pakets oder während anderer Verwendung des Paketmanagers im Zusammenhang mit Treibern oder Kerneln – so sind für den verwendeten Kernel die Header nicht vorhanden:</p><pre class="notranslate">Module build for the currently running kernel was skipped since the
kernel source for this kernel does not seem to be installed.</pre><p>Die Header können über die Paketverwaltung installiert werden. Je nachdem, wie der Kernel installiert worden ist, sei auf die Artikel <a class="internal" href="./kernel.html">Kernel</a> oder <a class="internal" href="./mainline-kernel.html">Mainline-Kernel</a> verwiesen. Nach Installation der Header wird DKMS das zuvor fehlgeschlagene Kompilieren und Installieren der Module erneut anstoßen.</p></div><div class="section_2"><h3 id="Kernel-Modul-wurde-nach-dem-Kernel-Update-nicht-neu-gebaut">Kernel Modul wurde nach dem Kernel Update nicht neu gebaut<a class="headerlink" href="#Kernel-Modul-wurde-nach-dem-Kernel-Update-nicht-neu-gebaut">¶</a></h3><p>
Falls nach einem Kernel Update ein Kernel Modul (das aus den Paketquellen installiert wurde) nicht oder nicht richtig gebaut wurde kann es reichen dies einfach noch einmal manuell anzustoßen: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo dpkg-reconfigure kernel-modul-paket-name </pre></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com//community/DKMS">DKMS</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> im Ubuntu-Wiki</p></li><li><p><a class="external" href="http://www.linuxjournal.com/article/6896" rel="nofollow">Kernel Korner - Exploring Dynamic Kernel Module Support (DKMS)</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Grundlagenartikel, 09/2003</p></li><li><p><a class="external" href="http://www.thomas.maetz-bv.de/2010/12/25/howto-rocketraid-2310-raid-host-adapter-mit-dynamic-kernel-module-support-dkms-unter-ubuntu-installieren/" rel="nofollow">RocketRAID 2310 RAID Host Adapter mit DKMS unter Ubuntu installieren</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Blogbeitrag 12/2010, kann als Beispiel genutzt werden</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./dkms/a/revision/940285.html">Diese Revision</a> wurde am 7. Mai 2017 18:53 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./dkms.html">DKMS</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>