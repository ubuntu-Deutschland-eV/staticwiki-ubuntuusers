<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Herunterfahren › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./herunterfahren.html">Herunterfahren</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Herunterfahren">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./herunterfahren/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./herunterfahren/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./herunterfahren/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./herunterfahren/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./herunterfahren/a/backlinks.html">Herunterfahren</a></h1>
<div id="page"><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./paketquellen_freischalten.html">Bearbeiten von Paketquellen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./paketinstallation_deb.html">Ein einzelnes Paket installieren</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Zeitgesteuert-herunterfahren">Zeitgesteuert herunterfahren
</a></li><li><a class="crosslink" href="#Herunterfahren-per-Terminal">Herunterfahren per Terminal
</a></li><li><a class="crosslink" href="#Server-mittels-ACPI-herunterfahren">Server mittels ACPI herunterfahren
</a></li><li><a class="crosslink" href="#Ungewolltes-Abschalten-vermeiden">Ungewolltes Abschalten vermeiden
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./shutdown_logo.png" class="image-left" src="./_/539b59631e809c76983cbf4301a5d5669de72864.png"/> 
Ein PC ist schnell eingeschaltet. Das Abschalten dagegen kann komplexer sein: Soll es zeitgesteuert sein? Und wie erlaubt man einem Nutzer das Ausschalten, wenn kein <a class="internal" href="./displaymanager.html">Displaymanager</a> diese Funktion global bereitstellt? Im Terminal geht es mit welchem Befehl? Dieser Artikel klärt diese Fragen.</p><div class="section_1"><h2 id="Zeitgesteuert-herunterfahren">Zeitgesteuert herunterfahren<a class="headerlink" href="#Zeitgesteuert-herunterfahren">¶</a></h2><p>
In diesem Abschnitt werden Programme mit grafischer Oberfläche vorgestellt, die das zeitgesteuerte Abschalten des Rechners ermöglichen. Auch per Terminal ist dies mit dem Befehl <a class="crosslink" href="#shutdown">shutdown</a> möglich.
</p><div class="section_2"><h3 id="qshutdown">qshutdown<a class="headerlink" href="#qshutdown">¶</a></h3><p>
</p><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="./qshutdown.png" class="image-default" src="./_/96781ecdb0e0214c5aa3bbb2d348dc70e5727235.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 150px"> qshutdown</td></tr></table><p><a class="internal" href="./qshutdown.html">qshutdown</a> ist ein Programm, das den PC zeitgesteuert herunterfahren, neu starten, in den Energiespar- oder Ruhezustand versetzen kann. Man kann sowohl eine Uhrzeit als auch eine Anzahl von Minuten angeben, zu der die entsprechende Aktion ausgeführt werden soll. Wenn nur noch wenig Zeit bis zur gewünschten Aktion verbleibt, warnt das Programm optional durch ein dreimaliges Wiedererscheinen. Mit Hilfe dieses Programms kann man stets die verbleibende Zeit im Auge behalten. Es soll einem ermöglichen, ohne Terminal auszukommen, und vermeidet dabei die <a class="internal" href="./wall.html">wall</a>-Meldung, die beim <code class="notranslate">shutdown</code>-Befehl im Terminal manche Prozesse stören kann. Außerdem benötigt qshutdown in der Regel keine Root-Rechte.</p><p><img alt="./complexshutdown_logo.png" class="image-right" src="./_/ae049f98650e81e3841206cf18a24341526898bd.png"/>
</p></div><div class="section_2"><h3 id="ComplexShutdown-EasyShutdown">ComplexShutdown &amp; EasyShutdown<a class="headerlink" href="#ComplexShutdown-EasyShutdown">¶</a></h3><p>
<a class="interwiki interwiki-launchpad" href="https://launchpad.net/complexshutdown">ComplexShutdown</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> und <a class="interwiki interwiki-launchpad" href="https://launchpad.net/easyshutdown">EasyShutdown</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> sind Python-Skript, mit denen sich das Herunterfahren bequem mittels einer grafischen, aber englischen Oberfläche automatisieren lässt. Dabei werden verschiedene Optionen angeboten, um dies auch zeitgesteuert zu ermöglichen. Über die Projektseite steht ein Fremdpaket zur Verfügung, das heruntergeladen und manuell installiert werden kann.</p><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
<a class="internal" href="./fremdquellen.html">Fremdpakete</a> können das System gefährden. 
</p></div></div><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="./gshutdown.png" class="image-default" src="./_/abf428dbd21d54b72d6a5993682fd699d28ce8fc.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 150px"> GShutdown</td></tr></table><p>
</p></div><div class="section_2"><h3 id="GShutdown">GShutdown<a class="headerlink" href="#GShutdown">¶</a></h3><p>
<a class="external" href="http://gshutdown.tuxfamily.org/en/" rel="nofollow">GShutdown</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> funktioniert nur korrekt mit den <a class="internal" href="./displaymanager.html">Displaymanagern</a> <a class="internal" href="./kdm.html">KDM</a> und <a class="internal" href="./gdm.html">GDM</a>, also mit <a class="internal" href="./kubuntu.html">Kubuntu</a>, <a class="internal" href="./ubuntu_gnome.html">Ubuntu Gnome</a> und <a class="internal" href="./xubuntu.html">Xubuntu</a> und nicht dem Standardubuntu, das <a class="internal" href="./lightdm.html">LightDM</a> verwendet. GShutdown kann den Rechner zu einem bestimmten Termin herunterfahren, neustarten oder die aktuelle Sitzung beenden.</p><p>In <a class="internal" href="./12.04.html">Ubuntu 12.04</a> ist das Programm in den offiziellen Paketquellen enthalten:
</p><ul><li><p><strong>gshutdown</strong> (Ubuntu 12.04)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install gshutdown </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install gshutdown </pre></div></div><p>
</p></div></div><p>Alternativ kann das Programm von der  <a class="external" href="http://gshutdown.tuxfamily.org/en/download.php" rel="nofollow">Download-Seite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> von GShutdown heruntergeladen und manuell installiert werden <sup><a href="#source-3">[3]</a></sup>. Nach der Installation kann man das Programm über <em>"Zubehör -&gt; GShutdown"</em> starten.</p><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
<a class="internal" href="./fremdquellen.html">Fremdpakete</a> können das System gefährden. 
</p></div></div><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="ShutdownTimer.png" class="image-default" src="./_/5dab5dec686d98698798be2d6b34410d88f6b7f5.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 150px"> ShutdownTimer</td></tr></table><p>
</p></div><div class="section_2"><h3 id="ShutdownTimer">ShutdownTimer<a class="headerlink" href="#ShutdownTimer">¶</a></h3><p>
Wenn man die <a class="internal" href="./gnome_shell.html">GNOME Shell</a> benutzt, bietet die Erweiterung <a class="external" href="https://extensions.gnome.org/extension/792/shutdowntimer/" rel="nofollow">ShutdownTimer</a> eine sehr bequeme Möglichkeit, den Rechner zeitgesteuert auszuschalten. Unterhalb der Herunterfahren-Schaltfläche im Statusmenü fügt sich der Menüpunkt ein, mit dem man die Zeit einstellen und den Timer (de-)aktivieren kann.</p><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="./kshutdown.png" class="image-default" src="./_/05a9b44e082a36425d418d0928a8567e84a48181.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 150px"> KShutDown</td></tr></table><p>
</p></div><div class="section_2"><h3 id="KShutDown">KShutDown<a class="headerlink" href="#KShutDown">¶</a></h3><p>
<a class="external" href="http://kshutdown.sourceforge.net/" rel="nofollow">KShutDown</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein Programm für das automatische Herunterfahren des Systems aus KDE heraus. Das Programm kann jedoch deutlich mehr als nur den Rechner herunterfahren. So kann das Programm z.B. die Internetverbindung zu einem bestimmten Zeitpunkt beenden, die Wiedergabe verschiedener Audio-Player stoppen usw.</p><p>Das Programm kann bis inklusive Kubuntu <a class="internal" href="./14.04.html">14.04</a> direkt aus den Paketquellen von Ubuntu über das folgende Paket installiert werden:</p><ul><li><p><strong>kshutdown</strong> (<em>universe</em> )</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install kshutdown </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install kshutdown </pre></div></div><p>
</p></div></div><p>
Nach der Installation kann man das Programm unter <em>"K-Menü -&gt; Dienstprogramme -&gt; KShutDown (System Shut Down Utility)"</em> starten.</p></div></div><div class="section_1"><h2 id="Herunterfahren-per-Terminal">Herunterfahren per Terminal<a class="headerlink" href="#Herunterfahren-per-Terminal">¶</a></h2><p>
Auch aus dem Terminal <sup><a href="#source-4">[4]</a></sup> kann man einen Linux-Rechner (zeitgesteuert) herunterfahren lassen. Hierfür gibt es allgemeine Befehle für die root-Rechte notwendig sind und andere meist von der Oberfläche abhängige Befehle, die mit Benutzerrechten ausgeführt werden können.</p><div class="section_2"><h3 id="Allgemein-mit-Root-Rechten">Allgemein mit Root-Rechten<a class="headerlink" href="#Allgemein-mit-Root-Rechten">¶</a></h3><p>
</p><div class="section_3"><h4 id="shutdown">shutdown<a class="headerlink" href="#shutdown">¶</a></h4><p>
Shutdown muss man verschiedene Optionen mitgeben. Möchte man bei sehr alten Rechnern sichergehen, dass der Rechner danach abgeschaltet wird, sollte man die Option <code class="notranslate">-P</code> verwenden (<code class="notranslate">-h</code> überlässt die Wahl dem System).</p><div class="bash"><div class="contents"><pre class="notranslate">sudo shutdown -h now     # Fährt das System sofort herunter
sudo shutdown -P now     # Fährt das System sofort herunter und veranlasst die Abschaltung des Rechners
sudo shutdown -h 60     # Fährt das System in 60 Minuten herunter
sudo shutdown -h 20:30   # Fährt das System um 20:30 Uhr herunter
sudo shutdown -r 60     # Fährt das System in 60 Minuten herunter und startet es anschließend neu </pre></div></div><p>Wenn man nun den Timer gestartet hat, es sich aber doch anders überlegt und den Computer weiterhin benutzen möchte, so muss man das Herunterfahren des Rechners mittels</p><div class="bash"><div class="contents"><pre class="notranslate">sudo shutdown -c </pre></div></div><p>
abbrechen.</p></div><div class="section_3"><h4 id="halt-reboot">halt / reboot<a class="headerlink" href="#halt-reboot">¶</a></h4><p>
Alternativ kann man auch die Befehle</p><div class="bash"><div class="contents"><pre class="notranslate">sudo halt -p </pre></div></div><p>zum sofortigen Herunterfahren und</p><div class="bash"><div class="contents"><pre class="notranslate">sudo reboot </pre></div></div><p>für einen Neustart nutzen.</p><p><a class="crosslink anchor" href="#Benutzershutdown" id="Benutzershutdown"></a>
</p></div></div><div class="section_2"><h3 id="Mit-Benutzerrechten">Mit Benutzerrechten<a class="headerlink" href="#Mit-Benutzerrechten">¶</a></h3><p>
</p><div class="section_3"><h4 id="Die-sudoers-Methode">Die "sudoers" Methode<a class="headerlink" href="#Die-sudoers-Methode">¶</a></h4><p>
Möchte man den Befehl <code class="notranslate">shutdown</code> in einem Skript benutzen oder anderen Benutzern ermöglichen (die dazu keine Root-Rechte auf dem Rechner bekommen sollen), den Rechner per shutdown herunterzufahren, so ist dies problematisch. Der Befehl braucht Root-Rechte. Man kann jedoch einzelnen Benutzern ermöglichen, shutdown auszuführen, ohne ein Passwort einzugeben zu brauchen. Hierzu muss <a class="internal" href="./sudo.html">sudo</a> über den Befehl <sup><a href="#source-4">[4]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">sudo visudo </pre></div></div><p>konfiguriert und die Zeilen</p><pre class="notranslate"># User alias specification
User_Alias ABSCHALTER = otto, anna, berta

# Cmnd alias specification
Cmnd_Alias DOWN = /sbin/shutdown, /sbin/halt, /sbin/reboot

# User privilege specification
ABSCHALTER ALL = NOPASSWD: DOWN</pre><p>(am Ende der Datei) eingefügt werden. In diesem Beispiel würden die drei Benutzer <code class="notranslate">otto, anna, berta</code> den Rechner über z.B.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo shutdown -h now </pre></div></div><p>herunterfahren können, ohne dass sie nach einem Passwort gefragt werden.</p><p>Eine andere einfache Lösung besteht darin, jedem Benutzer das Recht zum Ausführen des shutdown-Befehls einzuräumen, in man das entsprechende SUID-Bit, wie in <a class="internal" href="./chmod.html#SUID-bit">chmod</a> beschrieben, setzt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod +s /sbin/shutdown </pre></div></div><p>Dieses Vorgehen ist meist nur bei Desktop-Systemen mit einem einzigen Benutzer sinnvoll.</p></div><div class="section_3"><h4 id="Die-D-Bus-Methode">Die D-Bus Methode<a class="headerlink" href="#Die-D-Bus-Methode">¶</a></h4><p>
Um über D-Bus herunterfahren zu können, gibt es verschiedene Schnittstellen, die angesprochen werden können (siehe z.B. nachfolgend unter GNOME etc.). Über ConsoleKit gibt es eine Methode, die prinzipiell bei allen Systemen funktioniert, die das Paket <strong>consolekit</strong> installiert haben.</p><div class="bash"><div class="contents"><pre class="notranslate">dbus-send --system --print-reply --dest=org.freedesktop.ConsoleKit /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Stop      #zum Herunterfahren
dbus-send --system --print-reply --dest=org.freedesktop.ConsoleKit /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Restart   #zum Neustarten </pre></div></div></div><div class="section_3"><h4 id="GNOME">GNOME<a class="headerlink" href="#GNOME">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">gnome-session-quit --power-off                  # Zeigt den Dialog zum Ausschalten, Neustarten usw. an.
gnome-session-quit --logout                     # Zeigt den Dialog zum Abmelden oder Benutzerwechsel an.
gnome-session-quit --logout --no-prompt         # Meldet jetzt den Benutzer direkt ab (sofern dies nicht von einem Programm verhindert wird). </pre></div></div><p>Siehe auch <code class="notranslate">gnome-session-quit --help-all</code>.</p></div><div class="section_3"><h4 id="Xfce">Xfce<a class="headerlink" href="#Xfce">¶</a></h4><p>
Wenn man Xfce ohne GDM startet, wird beim Klicken auf <em>"Herunterfahren"</em> oder <em>"Neustart"</em> das Passwort abgefragt. Dies lässt sich wie folgt umgehen:</p><p>Die Datei <strong>/etc/sudoers</strong> mit <sup><a href="#source-4">[4]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">sudo visudo </pre></div></div><p>bearbeiten. Folgender Text muss hinzugefügt werden, wobei <code class="notranslate">BENUTZERNAME</code> durch den eigenen Benutzernamen ersetzt wird und genauso der Hostname:</p><pre class="notranslate">BENUTZERNAME HOSTNAME=NOPASSWD:/usr/sbin/xfsm-shutdown-helper</pre></div><div class="section_3"><h4 id="KDE">KDE<a class="headerlink" href="#KDE">¶</a></h4><p>
Kubuntu kann man u.a. über den Session-Manager via D-Bus herunterfahren.</p><div class="bash"><div class="contents"><pre class="notranslate">dbus-send --print-reply --dest=org.kde.ksmserver /KSMServer org.kde.KSMServerInterface.logout int32:0 int32:2 int32:2  # D-Bus-Befehl zum sofortigen Abschalten
dbus-send --print-reply --dest=org.kde.ksmserver /KSMServer org.kde.KSMServerInterface.logout int32:1 int32:1 int32:1  # D-Bus-Befehl um jetzt einen Neustart zu versuchen </pre></div></div><p>
Die drei Parameter am Ende haben folgende Funktionen:
</p><ul><li><p>Parameter 1: Bestätigungsabfrage (0 = nein, 1 = ja)</p></li><li><p>Parameter 2: Modus (0 = einplanen, 1 = jetzt versuchen, 2 = erzwingen)</p></li><li><p>Parameter 3: Methode (0 = abmelden, 1 = neustarten, 2 = herunterfahren)</p></li></ul><p>Weitere Informationen findet man <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/><a class="external" href="http://api.kde.org/3.5-api/kdelibs-apidocs/kdecore/html/classKApplication.html" rel="nofollow">hier</a>.</p></div></div></div><div class="section_1"><h2 id="Server-mittels-ACPI-herunterfahren">Server mittels ACPI herunterfahren<a class="headerlink" href="#Server-mittels-ACPI-herunterfahren">¶</a></h2><p>
Für kleine Heimserver ist es möglicherweise interessant, diese auch über den Einschalter am PC-Gehäuse herunterzufahren. Das erspart eventuell ungeübten Benutzern, am Server den Monitor einzuschalten, sich anzumelden und dann den Befehl <code class="notranslate">sudo halt</code> zum Herunterfahren einzugeben. Durch Installation des Paketes <strong>acpid</strong> können auch Rechner ohne grafische Oberfläche heruntergefahren werden. Bei Rechnern mit grafischer Oberfläche ist das Paket normalerweise dabei, ansonsten muss es installiert werden und kann dann sofort verwendet werden.</p><ul><li><p><strong>acpid</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install acpid </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install acpid </pre></div></div><p>
</p></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Wichtig ist noch, den Schalter nicht länger als 5 Sekunden gedrückt zu halten. Ansonsten schaltet sich das Netzteil hart ab und kann so einen Datenverlust verursachen. Gegen unabsichtliches Drücken des Schalters schützt ein eigener Serverschrank oder eine ähnliche Maßnahme.
</p></div></div></div><div class="section_1"><h2 id="Ungewolltes-Abschalten-vermeiden">Ungewolltes Abschalten vermeiden<a class="headerlink" href="#Ungewolltes-Abschalten-vermeiden">¶</a></h2><p>
Arbeitet man in einem Netzwerk mit mehreren Rechnern, die man per <a class="internal" href="./ssh.html">SSH</a> steuert, so kann es leicht zu Verwechselungen kommen, so dass man aus Versehen den falschen Rechner herunterfährt. Dieses kann man mit dem Paket</p><ul><li><p><strong>molly-guard</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install molly-guard </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install molly-guard </pre></div></div><p>
</p></div></div><p>vermeiden. Hat man molly-guard auf einem Rechner installiert <sup><a href="#source-1">[1]</a></sup>, auf dem man sich per SSH angemeldet hat, und fährt den Rechner herunter, so wird man nach dem <a class="internal" href="./rechnername.html">Hostnamen</a> des Rechners gefragt. Erst wenn man diesen korrekt eingegeben hat, wird der Rechner tatsächlich heruntergefahren.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo shutdown -h now </pre></div></div><pre class="notranslate">W: molly-guard: SSH session detected!
Please type in hostname of the machine to shutdown:</pre><p>Ist man lokal angemeldet, so beeinflusst molly-guard das Herunterfahren nicht.</p><p>Ist man per SSH angemeldet, arbeitet jedoch mit <a class="internal" href="./screen.html">SCREEN</a> in einer virtuellen Konsolensitzung, so wird beim Herunterfahren nicht nach dem Rechnernamen gefragt. Möchte man trotzdem gefragt werden, kann man ab Ubuntu "Intrepid Ibex" 8.10 in der Datei <strong>/etc/molly-guard/rc</strong> folgenden Wert eintragen bzw. auskommentieren.</p><pre class="notranslate">ALWAYS_QUERY_HOSTNAME=true</pre><p>Nach dieser Änderung wird bei jedem Herunterfahren nach dem Hostnamen gefragt, auch in einer lokalen Sitzung.</p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Rechner-schaltet-sich-nicht-ab">Rechner schaltet sich nicht ab<a class="headerlink" href="#Rechner-schaltet-sich-nicht-ab">¶</a></h3><p>
Es kommt vor, dass sich der Rechner nach dem Herunterfahren nicht abschaltet. Man bekommt dann die Meldung, dass man den Rechner nun abschalten kann. Erst wenn man den Taster am Rechner betätigt, schaltet sich der Rechner ab. Um dieses zu lösen, kann man verschiedene Dinge probieren.</p><div class="section_3"><h4 id="ACPI-erzwingen">ACPI erzwingen<a class="headerlink" href="#ACPI-erzwingen">¶</a></h4><p>
Es kommt vor, dass Ubuntu nicht erkennt, dass der Rechner <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Advanced_Configuration_and_Power_Interface">ACPI</a>-Funktionen bietet. Dann kann man Ubuntu dazu zwingen, ACPI zu nutzen. Man bearbeitet, wie in <a class="internal" href="./grub_2/konfiguration.html">Grub 2 Konfiguration</a> beschrieben, die Datei <strong>/etc/default/grub</strong>, wobei die Zeile</p><pre class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"</pre><p>um die Option <code class="notranslate">acpi=force</code> ergänzt wird:</p><pre class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT="quiet splash acpi=force"</pre><p>Nun aktualisiert man die Konfiguration von Grub mittels des Befehls <sup><a href="#source-4">[4]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>Nach dem nächsten Neustart schaltet sich der Rechner nun korrekt ab.</p></div><div class="section_3"><h4 id="Behilfs-Bootoptionen-der-Installation-loeschen">Behilfs-Bootoptionen der Installation löschen<a class="headerlink" href="#Behilfs-Bootoptionen-der-Installation-loeschen">¶</a></h4><p>
Bei der <a class="internal" href="./installation.html">Installation</a> des Betriebssystems kann es zu <a class="internal" href="./bootoptionen.html#Praxisbeispiele">Problemen</a> kommen, so das man mit geeigneten <a class="internal" href="./bootoptionen.html#Optionen">Bootoptionen</a> den Systemstart beeinflussen muß. 
Diese Optionen werden in die Datei <strong>/etc/default/grub</strong> des Installierten Systems übertragen, damit nach Installation das System ohne weitere Eingriffe starten kann. In der Regel werden solche Behilfs-Bootoptionen nach einer <a class="internal" href="./aktualisierungen.html">Aktualisierung</a> bzw. nach einem <a class="internal" href="./apt-get.html#Kommandos">Update</a> überflüssig und sollten dann entfernt werden, da diese zum Beispiel das automatisierte Herunterfahren und Ausschalten des Computers verhindern können.</p><p>Dazu bearbeitet man, wie in <a class="internal" href="./grub_2/konfiguration.html">Grub 2 Konfiguration</a> beschrieben, die Datei <strong>/etc/default/grub</strong>.</p><p>Beispielauszug der Datei <strong>/etc/default/grub</strong> unmittelbar nach der Installation mit Behilfs-Bootoptionen:</p><pre class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX="priority=low acpi=off noapic nolapic nomodeset"</pre><p>Beispielauszug der Datei <strong>/etc/default/grub</strong> mit den im Idealfall nötigsten Bootoptionen:</p><pre class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX=""</pre><p>Es sei an dieser Stelle nochmals darauf hingewiesen, das im Standard Boot-Login beide Zeilen zum einen <code class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT</code> und zum anderen <code class="notranslate">GRUB_CMDLINE_LINUX</code> berücksichtigt und Verarbeitet werden. Siehe hierzu auch den Abschnitt <a class="internal" href="./bootoptionen.html#Dauerhafte-Konfiguration-eines-Systems">Dauerhafte Konfiguration eines Systems</a>.</p><p>Abschließend aktualisiert man die Konfiguration von Grub mittels des Befehls <sup><a href="#source-4">[4]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>Nach dem nächsten Neustart schaltet sich der Rechner nun korrekt ab.</p></div><div class="section_3"><h4 id="Power-Off-ueber-APM">Power-Off über APM<a class="headerlink" href="#Power-Off-ueber-APM">¶</a></h4><p>
Alternativ kann man Ubuntu anweisen, dass es speziell zum Abschalten des Rechners das veraltete <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Advanced_Power_Management">APM</a> nutzen soll. Dieses Verfahren wird heutzutage nicht mehr genutzt, kann aber bei sehr alter Hardware oder ACPI-Problemen eine Lösung sein. Dazu editiert man, wie bei <a class="crosslink" href="#ACPI-erzwingen">ACPI erzwingen</a> beschrieben, die Konfigurationsdatei von GRUB oder GRUB 2 und fügt <code class="notranslate">apm=power_off</code> ein. Die Schreibweisen <code class="notranslate">power-off</code> und <code class="notranslate">poweroff</code> sind Synonyme, funktionieren also ebenfalls.</p><p>Danach muss GRUB 2 noch aktualisiert werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>Anschließend muss dem APM-Kernelmodul noch mitgeteilt werden, dass es den Rechner abschalten soll. Dazu muss die Datei <strong>/etc/modules</strong> mit Root-Rechten bearbeitet <sup><a href="#source-5">[5]</a></sup> und die Zeile</p><pre class="notranslate">apm power_off=1</pre><p>eingefügt werden. Mit einem Neustart des Systems kann der Erfolg der Maßnahme überprüft werden.</p></div><div class="section_3"><h4 id="HDA-High-Definition-Audio-abschalten">"HDA"(High Definition Audio) abschalten<a class="headerlink" href="#HDA-High-Definition-Audio-abschalten">¶</a></h4><p>
Laut <a class="crosslink topic" href="https://forum.ubuntuusers.de/topic/shutdown-rechner-schaltet-sich-nicht-ab-acpi-/">Berichten</a> aus dem Forum scheint es Probleme mit manchen Intel-Chipsätzen zu geben. Die Kernelmodule <code class="notranslate">snd_hda_intel</code> sowie <code class="notranslate">snd_hda_codec</code> können das ACPI wohl so "durcheinander" bringen, dass der Rechner sich nicht ausschalten kann. Um das Problem zu lösen, muss man ein Skript anlegen, das die Module vor dem Herunterfahren entfernt werden.</p><div class="section_4"><h5 id="Pruefen">Prüfen<a class="headerlink" href="#Pruefen">¶</a></h5><p>
Als erstes muss man prüfen, ob das Modul überhaupt verwendet wird:</p><div class="bash"><div class="contents"><pre class="notranslate">lsmod | grep snd_hda_intel </pre></div></div><p>Wird das Modul verwendet, kann man fortfahren.</p></div><div class="section_4"><h5 id="Skript-erstellen">Skript erstellen<a class="headerlink" href="#Skript-erstellen">¶</a></h5><p>
Mit einem Editor mit Root-Rechten <sup><a href="#source-5">[5]</a></sup> erzeugt man das Skript <strong>/etc/init.d/intelaudio</strong> und träge Folgendes ein.</p><pre class="notranslate">#!/bin/sh
rmmod -f snd_hda_intel
exit 0</pre><p>Damit das Skript ausgeführt werden kann, muss man es anschließend mittels</p><pre class="notranslate">sudo chmod +x /etc/init.d/intelaudio</pre><p>ausführbar machen.</p></div><div class="section_4"><h5 id="Beim-Herunterfahren-ausfuehren">Beim Herunterfahren ausführen<a class="headerlink" href="#Beim-Herunterfahren-ausfuehren">¶</a></h5><p>
</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Damit das Skript funktioniert, muss es nach dem Entladen des <a class="internal" href="./soundsystem.html">Soundsystems</a> (ALSA) gestartet werden. Beim Herunterfahren werden die Skripte in <strong>/etc/rc0.d/</strong> alphabetisch abgearbeitet. Standardmäßig wird ALSA über das Skript <strong>K50alsa-utils</strong> entladen. Darum sollte der Link <code class="notranslate">S51intelaudio</code> heißen. (K steht für Kill und S für Start)
</p></div></div><p>Jetzt muss das System erfahren, dass das Skript beim Herunterfahren ausgeführt werden soll. Hierfür gibt es das Programm <a class="internal" href="./dienste.html">update-rc.d</a>, das die Skripte aus <strong>/etc/init.d/</strong> in die jeweiligen Runlevel-Verzeichnisse (<strong>/etc/rc0.d/</strong> bis <strong>/etc/rcS.d/</strong>) verlinkt und ihnen einen Platz in der Ausführungsreihenfolge zuweist. Mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-rc.d intelaudio start 51 0 6 .    # Der Punkt am Ende ist wichtig! </pre></div></div><p>wird das Skript <strong>intelaudio</strong> auf Platz 51 in den "run levels" 0 und 6 ("Shutdown" und "Reboot") gestartet.</p></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="./skripte/auto_off.html">Skripte/Auto OFF</a> - automatisches Abschalten eines Computers bei Nichtbenutzung (Shell-Skript)</p></li><li><p><a class="interwiki interwiki-launchpad" href="https://launchpad.net/gpoweroff">Gpoweroff Shutdown utility</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - auf GShutdown basierendes Programm</p></li><li><p><a class="internal" href="./kinder.html#Nutzungszeit-einschraenken">Kinder</a> - Nutzungszeit des Computers einschränken</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./herunterfahren/a/revision/928418.html">Diese Revision</a> wurde am 3. Januar 2017 09:20 von <a href="https://ubuntuusers.de/user/superhonk/">superhonk</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./herunterfahren.html">Herunterfahren</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>