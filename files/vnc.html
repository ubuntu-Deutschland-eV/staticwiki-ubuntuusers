<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>VNC › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./vnc.html">VNC</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/VNC">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./vnc/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./vnc/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./vnc/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./vnc/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./vnc/a/backlinks.html">VNC</a></h1>
<div id="page"><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./autostart.html">Automatischer Start von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Server">Server
</a></li><li><a class="crosslink" href="#Viewer">Viewer
</a></li><li><a class="crosslink" href="#Gesicherte-Verbindung-ueber-SSH">Gesicherte Verbindung über SSH
</a></li><li><a class="crosslink" href="#Reverse-VNC-Verbindung">Reverse VNC-Verbindung
</a></li><li><a class="crosslink" href="#Reverse-VNC-Verbindung-ueber-SSH-Verbindung">Reverse VNC-Verbindung über SSH-Verbindung...</a></li><li><a class="crosslink" href="#Server-Informationen-ermitteln">Server-Informationen ermitteln
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Spezielle-Anwendungsfaelle">Spezielle Anwendungsfälle
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Mit <strong>VNC</strong> kann ein entfernter Rechner bedient werden. VNC ist die Abkürzung für <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Virtual_Network_Computing">Virtual Network Computing</a> und basiert auf dem <a class="interwiki interwiki-github" href="https://github.com/rfbproto/rfbproto">RFB-Protokoll</a>. Praktisch wird der Bildschirminhalt eines anderen Rechners auf dem lokalen Rechner angezeigt. Maus- und Tastatureingaben werden vom lokalen Rechner (hier läuft der Client, auch <em>Viewer</em> genannt) zurück an den entfernten Rechner (dort auf dem <em>Host</em> läuft der <em>VNC-Server</em>) gesendet.</p><p>Es existieren zwei unterschiedliche Konzepte für VNC-Server. Der übliche Server (z.B. x11vnc) bietet den tatsächlichen Bildschirm des Host-Rechners zur Anwenderunterstützung an. Weil am entfernten Rechner Tastatur und Maus benutzbar bleiben, ist eine Absprache empfehlenswert. Eine zweite Gruppe von Server-Programmen (z.B. tightvnc) ermöglicht die Benutzeranmeldung an virtuelle <a class="internal" href="./xserver.html">Sitzungen</a>, ähnlich dem Terminalserver-Konzept.</p><p>Server- und Viewer-Programme für VNC gibt es für alle gängigen Betriebssysteme. Daher werden viele IT-Dienstleistungen mit VNC durchgeführt. Ähnliche Einsatzzwecke haben der proprietäre <a class="internal" href="./teamviewer.html">TeamViewer</a>, <a class="internal" href="./rdesktop.html">RDP</a> und der NX-Nachfolger <a class="internal" href="./x2go.html">X2Go</a>.</p><p>Es gibt drei verschiedene Wege, um die Verbindung zwischen den Rechnern aufzubauen:</p><ol class="arabic"><li><p>Beim traditionellen Weg lauscht der VNC-Server auf TCP-Port <code class="notranslate">5900</code>. Er bietet dort sein Display <code class="notranslate">0</code> an. Weitere Displays können über zusätzliche Ports angeboten werden. Diese sind meistens <code class="notranslate">590n</code>, wobei <code class="notranslate">n</code> die Displaynummer ist. Falls der Host hinter einer Firewall (z.B. einem Hardware-Router) erreichbar sein soll, müsste der auf den entsprechende TCP-Port <a class="internal" href="./portweiterleitung.html">weitergeleitet</a> werden. Bei von außen (= über das Internet) erreichbaren Rechnern wäre dies ohne verschlüsselte Verbindung grob fahrlässig. Für die einfache Anwenderunterstützung ist dieser Weg daher nicht zu empfehlen.</p></li><li><p>Beim umgekehrten Weg lauscht der Client auf eingehende Anfragen von hilfsbedürftigen Anwendern. Diese Benutzer starten dazu einen VNC-Server, der sich dann mit dem wartenden Client auf TCP-Port <code class="notranslate">5500</code> verbindet. Für solche <em>Reverse-Connections</em> muss die IP-Nummer oder der Hostname des Client-Rechners bekannt sein. Die Programme <a class="internal" href="./gitso.html">Gitso</a> und <a class="external" href="http://www.uvnc.com/products/uvnc-sc.html" rel="nofollow">UVNC SC</a> (nur für Windows) unterstützen diesen Verbindungsweg.</p></li><li><p>Beim indirekten Weg verbinden sich sowohl Server als auch Client zu einem dritten, offen erreichbaren Rechner. Dieser stellt dann die Verbindung her.</p></li></ol><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>VNC-Verbindungen sind grundsätzlich unverschlüsselt! Sämtliche Passwörter werden im Klartext übertragen. Am Ende des Artikels wird beschrieben, wie man VNC-Verbindungen mit SSH oder VPN absichern kann.
</p></div></div><div class="section_1"><h2 id="Server">Server<a class="headerlink" href="#Server">¶</a></h2><p>
Das Server-Programm läuft auf dem Host-Rechner, auf dessen Desktop zugegriffen werden soll. Hierbei handelt es sich also um den Hilfesuchenden. Einige Distributionen bieten vorinstallierte VNC-Server an. Deren Einrichtung ist im nächsten Abschnitt beschrieben.</p><p><a class="crosslink anchor" href="#vino" id="vino"></a></p><div class="section_2"><h3 id="Server-einrichten">Server einrichten<a class="headerlink" href="#Server-einrichten">¶</a></h3><p>
<img alt="./vnc_vino-preferences.png" class="image-right" src="./_/cb2e4f71579ea6403e2ce32c06b30d6fbea2d305.png"/>
<img alt="screenshot" class="image-right" src="./_/b77ffdf5edc0fb1e4fa3d37b8ef479550a3fc92a.png" title="vino-preferences in Xubuntu 14.04"/>
</p></div><div class="section_2"><h3 id="Unity-GNOME">Unity/GNOME<a class="headerlink" href="#Unity-GNOME">¶</a></h3><p>
GNOME bringt das Programm <a class="external" href="https://wiki.gnome.org/action/show/Projects/Vino" rel="nofollow">Vino</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> als VNC-Server mit. Dieses bietet den Bildschirm der Sitzung an, aus der er gestartet wurde. Die Konfiguration erfolgt durch das Programm <strong>vino-preferences</strong>, das über den Begriff <em>"Freigabe der Arbeitsfläche"</em> zu finden ist. Unter dem Punkt <em>"Sicherheit"</em> sollte mindestens eine der beiden Sicherheits-Optionen aktiviert sein – entweder nur auf Bestätigung und oder mit Passworteingabe.</p><p>Wenn im Autostart <sup><a href="#source-1">[1]</a></sup> <em>"Entfernter Desktop"</em> nicht aktiviert ist, wird der Vino-Server nicht gestartet und eine Fernwartung ist nicht möglich. Den Server kann man dann auch manuell über das Terminal starten:</p><div class="bash"><div class="contents"><pre class="notranslate">/usr/lib/vino/vino-server </pre></div></div><p>
Bei aktivierten 3D-Effekten können Darstellungsprobleme auftreten. So bekommt der VNC-Client nur eine Bildschirmansicht übertragen, die sich bei Maus- und Tastatureingaben nicht mehr verändert. Bei Desktop-Umgebungen, die einen 3D-Desktop zwingend voraussetzen (<a class="internal" href="./unity.html">Unity</a>, <a class="internal" href="./gnome.html">GNOME</a>), empfiehlt sich eine Sitzung mit einer 2D-Oberfläche (soweit vorhanden). Speziell bei GNOME heißt diese Variante <a class="internal" href="./gnome_flashback.html">GNOME Flashback</a>. Dies verbessert die Geschwindigkeit und Stabilität von VNC deutlich. Auch mangelhafte Grafikkarten-Treiber können Darstellungsproblem verursachen.</p><p>Bei Xfce bzw. Xubuntu kann man den Vino-Server über <em>"Einstellungen -&gt; System  -&gt; Sitzung und Startverhalten -&gt; Automatisch gestartete Anwendungen -&gt; Hinzufügen"</em> zu den Startprogrammen hinzufügen (siehe auch <a class="internal" href="./xfce-einstellungen.html">Xfce-Einstellungen</a>).</p><p><a class="crosslink anchor" href="#krfb" id="krfb"></a></p></div><div class="section_2"><h3 id="KDE">KDE<a class="headerlink" href="#KDE">¶</a></h3><p>
<img alt="./krfb.png" class="image-right" src="./_/a4d9d6e95f3de8e6b12f379a40fbfa0cab44e305.png"/></p><p>Die KDE Applications bieten <a class="external" href="https://www.kde.org/applications/system/krfb/" rel="nofollow">krfb</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> als VNC-Server. Das Paket kann nachinstalliert <sup><a href="#source-2">[2]</a></sup> werden:</p><ul><li><p><strong>krfb</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install krfb </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install krfb </pre></div></div><p>
</p></div></div><p>Nach der Installation ist er unter</p><ul><li><p><em>"K-Menü -&gt; Internet -&gt; Krfb - Arbeitsfläche freigeben"</em> </p></li></ul><p>
zu finden. Um den Server zu starten, muss eine Einladung ausgesprochen werden. Im nächsten Schritt erhält man die IP des Host-Rechners und ein Passwort. Beides wird von einem Client benötigt, der sich verbinden möchte (siehe auch <a class="crosslink" href="#KDE-2">krdc</a>).</p></div><div class="section_2"><h3 id="Manuelle-Einrichtung">Manuelle Einrichtung<a class="headerlink" href="#Manuelle-Einrichtung">¶</a></h3><p>
</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Auf Systemen mit Fenstermanagern, die keinen eigenen VNC-Server mitbringen, kann ein solcher zusätzlich installiert werden. Auch wenn die mitgelieferten VNC-Server für bestimmte Anforderungen nicht ausreichen, kann dieser Weg gewählt werden. Der folgende Abschnitt richtet sich vor allem an fortgeschrittene Benutzer. 
</p></div></div><p>Im folgenden sind Implementierungen von VNC-Servern aufgeführt. Von diesen gibt x11vnc einen tatsächlichen Bildschirm wieder und die anderen erzeugen jeweils virtuelle X-Sitzungen. Häufig verwenden die Programme die selben Konfigurationsdateien.</p><p><a class="crosslink anchor" href="#x11vnc" id="x11vnc"></a></p><div class="section_3"><h4 id="x11vnc">x11vnc<a class="headerlink" href="#x11vnc">¶</a></h4><p>
x11vnc gibt den aktuellen Bildschirm des Hosts-Rechners wieder. Dies ermöglicht den VNC-Zugriff auf die grafische Benutzeranmeldung nach dem Booten. Die Installation erfolgt mit</p><ul><li><p><strong>x11vnc</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install x11vnc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install x11vnc </pre></div></div><p>
</p></div></div><p>Nach der Installation ist ein Passwort für den VNC-Server zu setzen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo x11vnc -storepasswd KENNWORT /etc/x11vnc.pass </pre></div></div><p>Das weitere Vorgehen zum Autostart findet sich <a class="crosslink" href="#VNC-Server-bei-jedem-Bootvorgang-starten">weiter unten</a> im Artikel.</p></div><div class="section_3"><h4 id="TightVNC">TightVNC<a class="headerlink" href="#TightVNC">¶</a></h4><p>
<a class="external" href="http://www.tightvnc.com/" rel="nofollow">TightVNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> führte als Neuerung eine Dateiübertragung ins VNC-Protokoll ein. Ältere Versionen bereiteten teilweise Probleme (bspw. Abstürze, wenn vom Vollbildmodus zurückgeschaltet wird). Daher sind mehrere Abspaltungen (Forks) entstanden, die diese Probleme nicht haben.</p><ul><li><p><strong>tightvncserver</strong> (<em>universe</em>)</p></li><li><p><strong>xtightvncviewer</strong> (<em>universe</em> )</p></li><li><p><strong>tightvnc-java</strong> (<em>universe</em>,  optional für Java-Clients)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install tightvncserver xtightvncviewer tightvnc-java </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install tightvncserver xtightvncviewer tightvnc-java </pre></div></div><p>
</p></div></div><p><img alt="./tigervnc_logo.png" class="image-right" src="./_/3cd8578ab2de143bb46df2f56f6545ce33ef43d1.png"/>
</p></div><div class="section_3"><h4 id="TigerVNC">TigerVNC<a class="headerlink" href="#TigerVNC">¶</a></h4><p>
<a class="external" href="http://tigervnc.org/" rel="nofollow">TigerVNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist eine Abspaltung von TightVNC, die noch aktiv gepflegt wird. Die Installation erfolgt mittels Archivdateien, die die vorkompilierte Binarversion enthalten:</p><ul><li><p>32-Bit: <a class="external" href="https://bintray.com/tigervnc/" rel="nofollow">tigervnc-Linux-i686-VERSION.tar.gz</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/></p></li><li><p>64-Bit: <a class="external" href="https://bintray.com/tigervnc/" rel="nofollow">tigervnc-Linux-x86_64-VERSION.tar.gz</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/></p></li></ul><p>
Nach dem Herunterladen wird das Archiv mit Root-Rechten entpackt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo tar -xzf tigervnc-Linux-ARCHITEKTUR-VERSION.tar.gz -C / </pre></div></div><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
<a class="internal" href="./fremdsoftware.html">Fremdsoftware</a> kann das System gefährden.
</p></div></div><p>
</p></div><div class="section_3"><h4 id="RealVNC">RealVNC<a class="headerlink" href="#RealVNC">¶</a></h4><p>
<a class="external" href="http://www.realvnc.com/" rel="nofollow">RealVNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> wird von den ursprünglichen Entwicklern des VNC-Protokolls angeboten. Auf diesen Server kann auch mit einem Webbrowser als Klienten zugegriffen werden. Die in den Paketquellen enthaltene letzte freie Version 4.x ist von Anfang 2006. Folgende Pakete müssen installiert werden:</p><ul><li><p><strong>vnc4server</strong> (<em>universe</em>)</p></li><li><p><strong>vnc-java</strong> (<em>multiverse</em>, optional für Java-Clients)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install vnc4server vnc-java </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install vnc4server vnc-java </pre></div></div><p>
</p></div></div></div><div class="section_3"><h4 id="Anpassungen-fuer-Ubuntu-Server">Anpassungen für Ubuntu-Server<a class="headerlink" href="#Anpassungen-fuer-Ubuntu-Server">¶</a></h4><p>
Falls ein VNC-Server auf einem Ubuntu-Server installiert werden soll, muss zusätzlich folgendes Paket installiert werden.</p><ul><li><p><strong>xfonts-base</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install xfonts-base </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install xfonts-base </pre></div></div><p>
</p></div></div></div><div class="section_3"><h4 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h4><p>
Damit eine Verbindung hergestellt werden kann, muss noch im Terminal <sup><a href="#source-3">[3]</a></sup> ein Passwort eingestellt werden. Es ist darauf zu achten, einen lokalen Benutzer zu verwenden.</p><div class="bash"><div class="contents"><pre class="notranslate">vncpasswd </pre></div></div></div><div class="section_3"><h4 id="Starten-und-Stoppen">Starten und Stoppen<a class="headerlink" href="#Starten-und-Stoppen">¶</a></h4><p>
Um den VNC-Server zu starten, wird einfach folgender Befehl im Terminal eingegeben (man sollte sich die angezeigte Displaynummer merken!):</p><div class="bash"><div class="contents"><pre class="notranslate"># Für VNC und TigerVNC
vncserver
# Für tightvncserver
tightvncserver </pre></div></div><p>Der VNC-Server sollte nicht mit <a class="internal" href="./kill.html">kill</a> beendet werden. Unter Angabe der Displaynummer bietet der VNC-Server eine eigene Routine zum Beenden:</p><div class="bash"><div class="contents"><pre class="notranslate"># Für VNC und TigerVNC
vncserver -kill :&lt;Displaynummer&gt;
# Für tightvncserver
tightvncserver -kill :&lt;Displaynummer&gt; </pre></div></div></div><div class="section_3"><h4 id="VNC-per-xinetd-starten">VNC per xinetd starten<a class="headerlink" href="#VNC-per-xinetd-starten">¶</a></h4><p>
Eine komfortable und ressourcensparende Variante, eine VNC-Session zu starten, ermöglicht die Verwendung von <a class="internal" href="./xinetd.html">xinetd</a>. Hierbei wird das Starten des VNC-Servers von xinetd übernommen. Diese Methode benötigt kein "init-script" für den VNC-Server. Sollte bereits eines vorhanden sein, entfernt man den Server dazu einfach mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-rc.d -f vncserver remove  </pre></div></div><p>aus den <a class="internal" href="./dienste.html">Runlevels</a>.</p></div></div></div><div class="section_1"><h2 id="Viewer">Viewer<a class="headerlink" href="#Viewer">¶</a></h2><p>
Das Viewer-Programm läuft auf dem Client-Rechner, der auf den entfernten Server zugreift. Dies geschieht meist mittels eines speziellen VNC-Viewers. Einige Server lassen es auch zu, mit einem Webbrowser auf den entfernten Desktop zuzugreifen.</p><div class="section_2"><h3 id="Unity-GNOME-2">Unity / GNOME<a class="headerlink" href="#Unity-GNOME-2">¶</a></h3><p>
</p><div class="section_3"><h4 id="Remmina">Remmina<a class="headerlink" href="#Remmina">¶</a></h4><p>
Ab <a class="internal" href="./oneiric.html">Ubuntu 11.10</a> wird <a class="internal" href="./remmina.html">Remmina</a> empfohlen. Es ist standardmäßig installiert und lässt sich in Unity mit dem Begriff <em>"Zugriff auf entfernte Arbeitsflächen"</em> starten.</p><p><a class="crosslink anchor" href="#vinagre" id="vinagre"></a>
</p></div><div class="section_3"><h4 id="Vinagre">Vinagre<a class="headerlink" href="#Vinagre">¶</a></h4><p>
<img alt="./vinagre.png" class="image-right" src="./_/8a5003fc8868d3bf99a611580af5da031cb20ed2.png"/></p><p><a class="internal" href="./vinagre.html">Vinagre</a> ist ein VNC-Client, der erstmals in <a class="internal" href="./hardy.html">Ubuntu 8.04</a> integriert wurde. Man findet das Programm bei Ubuntu-Varianten mit einem Anwendungsmenü unter <em>"Internet -&gt; Betrachter für entfernte Desktops"</em>. Vinagre kann gleichzeitig mehrere Verbindungen mit verschiedenen VNC-Servern aufbauen. Diese werden in der Bedienoberfläche als Reiter (Tabs) dargestellt und können als Lesezeichen gespeichert werden. Passwörter für VNC-Server werden im GNOME-Schlüsselbund gespeichert. Vinagre kann über <a class="internal" href="./avahi.html">Avahi</a> im lokalen Netzwerk nach verfügbaren VNC-Servern suchen.</p><p><a class="crosslink anchor" href="#krdc" id="krdc"></a></p></div></div><div class="section_2"><h3 id="KDE-2">KDE<a class="headerlink" href="#KDE-2">¶</a></h3><p>
Um sich zu einem System zu verbinden, auf dem ein VNC-Server läuft, ist in der Standardinstallation von Kubuntu das Programm <a class="external" href="http://www.kde.org/applications/internet/krdc/" rel="nofollow">KRDC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> enthalten.</p><p><img alt="./krdc.png" class="image-right" src="./_/c7e9e15a0181fc2ff8d6a6d4727d6b6e12d88d48.png"/>
Um es manuell zu installieren, wird das folgende Paket benötigt:</p><ul><li><p><strong>krdc</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install krdc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install krdc </pre></div></div><p>
</p></div></div><p>Nach der Installation ist es unter <em>"K-Menü -&gt; Internet -&gt; Krdc - Verbindung zu Fremdrechner"</em> zu finden. Neben VNC unterstützt es auch RDP-Verbindungen, wie sie beispielsweise unter Windows für die Desktop-Freigabe benutzt werden.</p><p>Um eine Verbindung herzustellen, muss in das Eingabefeld des Programms die IP-Adresse des Systems eingetragen werden, zu dem man sich verbinden möchte. Im davor liegenden Auswahlmenü muss gewählt werden, ob es sich um eine VNC- oder eine RDP-Verbindung handelt. Nach Klicken auf <em>"Verbinden"</em> wird versucht, das andere System zu erreichen. Wurde ein Passwort vergeben, so muss es in das erscheinende Dialogfeld eingetragen und bestätigt werden.</p></div><div class="section_2"><h3 id="Xfce">Xfce<a class="headerlink" href="#Xfce">¶</a></h3><p>
Benutzer von <a class="internal" href="./xfce.html">Xfce</a> können <a class="internal" href="./remmina.html">Remmina</a> als Client verwenden.</p></div><div class="section_2"><h3 id="LXDE">LXDE<a class="headerlink" href="#LXDE">¶</a></h3><p>
Auch hier ist <a class="internal" href="./remmina.html">Remmina</a> der Client der Wahl.</p></div><div class="section_2"><h3 id="Weitere">Weitere<a class="headerlink" href="#Weitere">¶</a></h3><p>
</p><div class="section_3"><h4 id="noVNC-BrowserClient">noVNC (BrowserClient)<a class="headerlink" href="#noVNC-BrowserClient">¶</a></h4><p>
<img alt="./novnc1.png" class="image-right" src="./_/25f5fb41b4833e84acd307f6d737de717edaf56f.png"/>
<img alt="./novnc2.png" class="image-right" src="./_/8f590ab62a569ad784b8398e8ca4d94f69115b1e.png"/>
<a class="external" href="https://github.com/novnc/noVNC" rel="nofollow">noVNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein HTML5 VNC Client, der mit jedem modernen Browser funktioniert (inkl. mobile Browser von iOS und Android). Zusätzlichen Browser Plugins/Addons sind nicht notwendig. Serverseitig muss lediglich ein VNC Server laufen, auf dem sich noVNC verbinden kann.
</p><ul><li><p><strong>novnc</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install novnc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install novnc </pre></div></div><p>
</p></div></div><p>noVNC starten auf dem Server starten (VNC-Server muss aktiv sein):
</p><div class="bash"><div class="contents"><pre class="notranslate">/usr/share/novnc/utils/launch.sh --vnc &lt;SERVER-IP&gt;:&lt;VNC_PORT&gt;
# z.B.
/usr/share/novnc/utils/launch.sh --vnc 192.168.1.1&gt;:5900 </pre></div></div><p>Beispielausgabe:
</p><pre class="notranslate">Warning: could not find self.pem
Starting webserver and WebSockets proxy on port 6080
WebSocket server settings:
  - Listen on :6080
  - Flash security policy server
  - Web server. Web root: /home/&lt;username&gt;/noVNC
  - No SSL/TLS support (no cert file)
  - proxying from :6080 to localhost:5900


Navigate to this URL:

    http://192.168.1.1:6080/vnc.html?host=server&amp;port=6080

Press Ctrl-C to exit</pre></div><div class="section_3"><h4 id="SSVNC">SSVNC<a class="headerlink" href="#SSVNC">¶</a></h4><p>
<a class="external" href="http://www.karlrunge.com/x11vnc/ssvnc.html" rel="nofollow">SSVNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist eine Abspaltung von TightVNC und in den offiziellen Paketquellen enthalten. Die Verbindung wird grundsätzlich über TLS bzw. SSL verschlüsselt. Nach der Installation steht das Programm bei Ubuntu-Varianten mit einem Anwendungsmenü über den Eintrag <em>"SSL/SSH VNC Viewer"</em> zur Verfügung. Weitere Details sind der Homepage zu entnehmen.</p><ul><li><p><strong>ssvnc</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install ssvnc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install ssvnc </pre></div></div><p>
</p></div></div></div></div><div class="section_2"><h3 id="Kommandozeile">Kommandozeile<a class="headerlink" href="#Kommandozeile">¶</a></h3><p>
Auf der Kommandozeile steht der Befehl <code class="notranslate">vncviewer</code> aus dem Paket <strong>xvncviewer</strong> zur Verfügung. Dieses ist bei einer Standardinstallation von Ubuntu bereits vorinstalliert, kann jedoch alternativ wie folgt installiert werden:</p><ul><li><p><strong>xvnc4viewer</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install xvnc4viewer </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install xvnc4viewer </pre></div></div><p>
</p></div></div><p>Die Verbindung zu einem VNC-Server kann mit dem Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate"># Für VNC und TigerVNC
vncviewer host:display
# Für TightVNC
xtightvncviewer host:display [OPTIONEN] </pre></div></div><p>hergestellt werden. <code class="notranslate">host</code> ist dabei der Hostname oder die IP-Adresse des Servers, <code class="notranslate">display</code> die Nummer des angesprochenen Displays - in der Regel <code class="notranslate">0</code>. Ist ein Passwort erforderlich, wird es nach der Verbindungsherstellung abgefragt. Falls der vncviewer nicht aus der Kommandozeile heraus gestartet wird (sondern beispielsweise aus einem Skript), wird das Passwort in einem kleinen Eingabefenster eingegeben. Damit nicht mehrere Benutzer gleichzeitig auf den VNC-Server zugreifen können, kann im TightVNC-Viewer die Option <code class="notranslate">-noshare</code> gesetzt werden.</p><p><a class="crosslink anchor" href="#vncoverssh" id="vncoverssh"></a>
</p></div></div><div class="section_1"><h2 id="Gesicherte-Verbindung-ueber-SSH">Gesicherte Verbindung über SSH<a class="headerlink" href="#Gesicherte-Verbindung-ueber-SSH">¶</a></h2><p>
Um eine sichere VNC-Verbindung zu aufzubauen, kann man einen verschlüsselten <a class="internal" href="./ssh.html">SSH</a>-Tunnel benutzen. Voraussetzung hierfür ist, dass eine SSH-Verbindung zwischen Host und Client hergestellt werden kann.</p><div class="section_2"><h3 id="Automatisch-durch-den-VNC-Viewer">Automatisch durch den VNC-Viewer<a class="headerlink" href="#Automatisch-durch-den-VNC-Viewer">¶</a></h3><p>
Das Programm <em>vncviewer</em> kann selbst einen SSH-Tunnel herstellen:</p><div class="bash"><div class="contents"><pre class="notranslate">vncviewer -via user@host localhost:0 </pre></div></div></div><div class="section_2"><h3 id="Manuell-ueber-SSH">Manuell über SSH<a class="headerlink" href="#Manuell-ueber-SSH">¶</a></h3><p>
Alternativ kann man auch zunächst den Tunnel auf dem Client-Rechner aufbauen. Danach wird die VNC-Verbindung aufgerufen:</p><div class="bash"><div class="contents"><pre class="notranslate">ssh -4 -N -L 5900:localhost:5900 user@host
vncviewer localhost:0 </pre></div></div><p>Bei beiden Methoden steht <code class="notranslate">host</code> für den Hostnamen oder die IP-Adresse des Rechners mit dem VNC-Server und <code class="notranslate">user</code> für den Benutzernamen, mit dem dort die SSH-Anmeldung erfolgen soll. Die VNC-Verbindung erfolgt nicht zum Host, sondern zum Eingang des SSH-Tunnels auf dem lokalen Client <code class="notranslate">localhost</code>.</p></div><div class="section_2"><h3 id="Authentifizierung-ueber-Public-Keys">Authentifizierung über Public Keys<a class="headerlink" href="#Authentifizierung-ueber-Public-Keys">¶</a></h3><p>
Damit die vorgenannten Methoden funktionieren, ist ein Benutzerkonto auf dem Host-Rechner notwendig. Eine Alternative besteht in der Benutzung von "Public keys". Dazu sind <a class="internal" href="./ssh.html#Authentifizierung-ueber-Public-Keys">SSH-Schlüsselpaare</a> notwendig. Der oder die public-keys der zugelassenen VNC-Benutzer sind auf dem Host in der Datei <strong>/home/user/.ssh/authorized_keys</strong> abzuspeichern. Damit der Nutzer des public-key nur auf den VNC-Server zugreifen kann, müssen dessen Rechte in der Datei <strong>/home/user/.ssh/authorized_keys</strong> noch beschränkt werden (s.a. <a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/VNC#Let_other_people_view_your_desktop">VNC</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>):</p><pre class="notranslate">command="/bin/sleep 4294967295",no-agent-forwarding,no-pty,no-user-rc,no-X11-forwarding,permitopen="localhost:5900" PUBLIC_KEY</pre><p>Danach hat der Besitzer des passenden private-keys <a class="crosslink" href="#Automatisch-durch-den-VNC-Viewer">automatisch</a> oder <a class="crosslink" href="#Manuell-ueber-SSH">manuell</a> Zugriff auf den VNC-Server. Die Anmeldung muss dabei auch als Benutzer <code class="notranslate">user</code> erfolgen, da sonst nicht auf die Datei <strong>/home/user/.ssh/authorized_keys</strong> zugegriffen werden kann, in welcher der public-key gespeichert ist.</p></div><div class="section_2"><h3 id="VNC-Server-auf-lokale-Verbindungen-beschraenken">VNC-Server auf lokale Verbindungen beschränken<a class="headerlink" href="#VNC-Server-auf-lokale-Verbindungen-beschraenken">¶</a></h3><p>
Wenn die Verbindung zum VNC-Server über den SSH-Tunnel klappt, kann man noch einen Schritt weitergehen und den VNC-Server auf lokale Verbindungen beschränken. Damit wird die Benutzung des SSH-Tunnels erzwungen und Angreifer können sich nicht mehr direkt mit dem VNC-Server verbinden. TightVNC startet man dazu mit der zusätzlichen Option <code class="notranslate">-localhost</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">tightvncserver -localhost </pre></div></div><p>Für Vino kann man die Einstellung wie folgt setzen (Information übernommen von <a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/VNC/Servers#vino">vino</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>):</p><div class="bash"><div class="contents"><pre class="notranslate">gsettings set org.gnome.Vino network-interface lo </pre></div></div></div></div><div class="section_1"><h2 id="Reverse-VNC-Verbindung">Reverse VNC-Verbindung<a class="headerlink" href="#Reverse-VNC-Verbindung">¶</a></h2><p>
Hier initiiert der Server den Verbindungsaufbau zum Viewer. Diese Art ist hilfreich, wenn der Hilfesuchende keine Netzwerkkenntnisse besitzt und zudem hinter einem Router sitzt. Die Einrichtung ist sehr einfach, da der Hilfesuchende nur ein Paket zu installieren hat.</p><p>Hier werden drei mögliche Wege zu einer reversen VNC-Verbindung beschrieben – es gibt noch einige mehr.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Bei manchen Arten von Reverse-Verbindungen hat nicht nur der Helfer Zugriff auf das System des Hilfesuchenden, sondern auch der Hilfesuchende Zugriff auf das System des Helfers. Eine einfache Schutzmaßnahme ist zum Beispiel, als Helfer eine <a class="internal" href="./gastsitzung.html">Gastsitzung</a> zu nutzen.
</p></div></div><div class="section_2"><h3 id="Gitso">Gitso<a class="headerlink" href="#Gitso">¶</a></h3><p>
Der einfachste Weg läuft über <a class="internal" href="./gitso.html">Gitso</a>. Hier muss man am wenigsten einstellen und man hat einen fast automatisierten Weg bis auf die Einstellungen des Routers des Helfenden.</p><p>Wenn man Gitso ausprobieren möchte, kann man die nächsten beiden Abschnitte vernachlässigen.</p></div><div class="section_2"><h3 id="DynDNS">DynDNS<a class="headerlink" href="#DynDNS">¶</a></h3><p>
Da im Regelfall keine statische IP-Adresse vorhanden ist, muss man zuerst einen DynDNS-Account einrichten. Zudem sollte der Helfende wissen, wie man sich, wenn man hinter einem Router sitzt, eine korrekte <a class="internal" href="./portweiterleitung.html">Portweiterleitung</a> oder Portfreischaltung einrichtet. Meistens muss man – je nach Routermodell – Einstellungen für DynDNS im Router vornehmen. Zu diesem Zwecke sollte man das Handbuch des Routers konsultieren. Wenn man diesen Weg beschreiten will, bitte weiterlesen unter <a class="crosslink" href="#Weitere-Schritte">Weitere Schritte</a>.</p></div><div class="section_2"><h3 id="Dynamische-IP-Adresse">Dynamische IP-Adresse<a class="headerlink" href="#Dynamische-IP-Adresse">¶</a></h3><p>
Hier muss man keine DynDNS-Adresse einrichten, dafür hat man den Nachteil, dass man vor jeder Verbindung die IP des Helfenden bzw. die des vorhandenen Routers herausfinden muss - z.B. bei <a class="external" href="http://www.wieistmeineip.de/" rel="nofollow">wieistmeineip.de</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/>. Der Helfende muss dann jedesmal dem Hilfesuchenden mitteilen, wie die IP lautet. Dieser Umstand wird durch DynDNS umgangen. Der Helfer muss sich auch hier mit <a class="internal" href="./portweiterleitung.html">Portweiterleitung</a> oder Portfreischaltung auseinandergesetzt haben, wenn er hinter einem Router sitzt. Eine DynDNS-Einrichtung am Router entfällt hier natürlich.</p><div class="section_3"><h4 id="Weitere-Schritte">Weitere Schritte<a class="headerlink" href="#Weitere-Schritte">¶</a></h4><p>
Folgende Pakete müssen installiert sein:</p><ul><li><p>Beim Helfenden das Paket: </p><ul><li><p><strong>xvnc4viewer</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install xvnc4viewer </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install xvnc4viewer </pre></div></div><p>
</p></div></div></li><li><p>Beim Hilfesuchenden das Paket: </p><ul><li><p><strong>x11vnc</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install x11vnc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install x11vnc </pre></div></div><p>
</p></div></div></li></ul><p>
Nach der Installation und für jede weitere Verbindung muss der Helfende immer vor dem Hilfesuchenden in einem Terminal folgenden Befehl eingeben, da sonst die Verbindung nicht aufgebaut werden kann:</p><div class="bash"><div class="contents"><pre class="notranslate">xvnc4viewer -listen 5500 </pre></div></div><p>Der Helfer hört kontinuierlich auf Port <code class="notranslate">5500</code>, der im Router freigeschaltet sein muss, ob jemand bei ihm anklopft. Der Hilfesuchende sollte dann mit dem Befehl anklopfen:</p><ul><li><p>bei Verwendung von DynDNS: </p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -connect name.dyndns.org </pre></div></div></li><li><p>bei statischer IP-Adresse: </p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -connect 123.456.789.123 </pre></div></div><p> Die IP-Adresse <code class="notranslate">123.456.789.123</code> ist nur ein Beispiel und muss durch diejenige ersetzt werden, die der Helfer bei sich herausgefunden hat. Diese kann er z.B. über <a class="external" href="http://www.wieistmeineip.de/" rel="nofollow">wieistmeineip.de</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> ermitteln. Dort wird gegebenenfalls die IP des Routers angezeigt; dies ist dann die richtige.</p></li></ul><p>
Nun sollte sich ein Fenster öffnen, auf dem der Helfer den Desktop des Hilfesuchenden sehen und steuern kann.</p></div></div><div class="section_2"><h3 id="Weitere-Tipps-und-Optionen">Weitere Tipps und Optionen<a class="headerlink" href="#Weitere-Tipps-und-Optionen">¶</a></h3><p>
</p><div class="section_3"><h4 id="Anlegen-eines-Starters">Anlegen eines Starters<a class="headerlink" href="#Anlegen-eines-Starters">¶</a></h4><p>
Wenn die erste Verbindung steht, ist es meist praktisch, dem Hilfesuchenden einen Starter auf den Desktop zu legen, der den Befehl im Terminal für ihn ausführt. Oftmals werden Befehle im Terminal seitens des Hilfesuchenden vergessen, mit Tippfehlern eingegeben oder es besteht eine Hemmschwelle in der Benutzung des Terminals. Außerdem ist dieser Weg am wenigsten störanfällig.</p></div><div class="section_3"><h4 id="Verkleinerte-Darstellung-ohne-Rollbalken">Verkleinerte Darstellung ohne Rollbalken<a class="headerlink" href="#Verkleinerte-Darstellung-ohne-Rollbalken">¶</a></h4><p>
Es ist zu empfehlen, sich den Desktop etwas verkleinert darstellen zu lassen, da der Desktop des Hilfesuchenden manchmal nicht ganz auf den Bildschirm des Helfers passt. Das kann zwar zu minimalen Verzerrungen in der Darstellung führen, ist beim Arbeiten jedoch meist praktischer. Dazu sollte der Hilfesuchende zum Anklopfen folgenden Befehl mit der zusätzlichen Option <code class="notranslate">-scale X/Y</code> eingeben:</p><ul><li><p>bei Verwendung von DynDNS: </p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -connect name.dyndns.org -scale 9/10 </pre></div></div></li><li><p>bei statischer IP-Adresse: </p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -connect 123.456.789.123 -scale 9/10 </pre></div></div></li></ul><p>
Dadurch wird der Bildschirm des Hilfesuchenden vor der Übertragung auf 9/10 verkleinert. Statt 9/10 kann man jeden anderen Wert eingeben, z.B. 2/3, wenn der Desktop auf 2/3 verkleinert dargestellt werden soll.</p></div><div class="section_3"><h4 id="Volle-Farbdarstellung">Volle Farbdarstellung<a class="headerlink" href="#Volle-Farbdarstellung">¶</a></h4><p>
Die aufgebaute Verbindung hat meist nur eine sehr geringe Farbdarstellung, damit VNC möglichst wenige Daten übermitteln muss. Dies ergibt Sinn, wenn die Verbindung relativ langsam ist. Will man sich alle Farben beim Hilfesuchenden anzeigen lassen, muss man die Option <code class="notranslate">-FullColor</code> beim Helfenden setzen. Entsprechend sieht der Befehl dann so aus:</p><div class="bash"><div class="contents"><pre class="notranslate">xvnc4viewer -FullColor -listen 5500 </pre></div></div><p>
Nun wird der Bildschirmaufbau langsamer, jedoch mit allen Farben erfolgen. Noch mehr Optionen, Beispiele und Erklärungen findet man in den <a class="internal" href="./man.html">Manpages</a> von x11vnc und xvnc4viewer.</p></div></div></div><div class="section_1"><h2 id="Reverse-VNC-Verbindung-ueber-SSH-Verbindung">Reverse VNC-Verbindung über SSH-Verbindung<a class="headerlink" href="#Reverse-VNC-Verbindung-ueber-SSH-Verbindung">¶</a></h2><p>
Auch diese Methode verfolgt das Ziel, den Konfigurationsaufwand für den Hilfesuchenden so gering wie möglich zu halten. Deshalb baut der Hilfesuchende hier mit dem schon vorinstallierten SSH-Client eine normale SSH-Verbindung zum Helfer auf. Durch diese wird dann eine umgekehrte VNC-Verbindung getunnelt. Folgende Schritte sind dabei bei Hilfesuchenden und Helfer vorzunehmen:</p><div class="section_2"><h3 id="Vorbereitungen-auf-der-Seite-des-Helfers">Vorbereitungen auf der Seite des Helfers<a class="headerlink" href="#Vorbereitungen-auf-der-Seite-des-Helfers">¶</a></h3><p>
</p><ol class="arabic"><li><p>Sofern der Helfer hinter einem Router sitzt, ist dort eine <a class="internal" href="./portweiterleitung.html">Portweiterleitung</a> für die SSH-Verbindung einzurichten. Läuft eine Firewall auf dem System des Helfers, so muss diese so konfiguriert werden, dass sie die SSH-Anfrage des Hilfesuchenden durchlässt.</p></li><li><p>Installation des <a class="internal" href="./ssh.html#Der-SSH-Server">SSH-Servers</a></p></li><li><p>Installation des <strong>vncviewers</strong>: </p><ul><li><p><strong>xvnc4viewer</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install xvnc4viewer </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install xvnc4viewer </pre></div></div><p>
</p></div></div></li><li><p><a class="internal" href="./benutzer_und_gruppen.html">Anlegen eines Benutzers</a>, mit dem sich der Hilfesuchende dann per SSH auf dem Rechner des Helfers anmelden kann</p></li><li><p>Ermittlung der <a class="crosslink" href="#Dynamische-IP-Adresse">eigenen IP</a> oder alternativ Einrichtung von <a class="crosslink" href="#DynDNS">DynDNS</a></p></li></ol><p>
</p></div><div class="section_2"><h3 id="Vorbereitungen-auf-der-Seite-des-Hilfesuchenden">Vorbereitungen auf der Seite des Hilfesuchenden<a class="headerlink" href="#Vorbereitungen-auf-der-Seite-des-Hilfesuchenden">¶</a></h3><p>
</p><ul><li><p>Installation des VNC-Servers: </p><ul><li><p><strong>x11vnc</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install x11vnc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install x11vnc </pre></div></div><p>
</p></div></div></li></ul><p>
</p></div><div class="section_2"><h3 id="Aufbau-der-Verbindung">Aufbau der Verbindung<a class="headerlink" href="#Aufbau-der-Verbindung">¶</a></h3><p>
</p><ul><li><p>Helfer:</p><ol class="arabic"><li><p>Start des SSH-Servers: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/ssh restart </pre></div></div></li><li><p>Start des VNC-Viewers im Listen-Modus:</p><div class="bash"><div class="contents"><pre class="notranslate">vncviewer -listen </pre></div></div></li></ol></li></ul><p>
</p><ul><li><p>Hilfesuchender:</p><ol class="arabic"><li><p>Start der SSH-Verbindung mittels SSH-Client und Verbindung zum lauschenden VNC-Viewer: </p><div class="bash"><div class="contents"><pre class="notranslate">ssh -NfL 5500:localhost:5500 hilflos@IP-ADRESSE-HELFER sleep 2 &amp;&amp; x11vnc -connect_or_exit localhost:5500 -scale 9/10 </pre></div></div></li></ol></li></ul><p>
Der erste Teil des Befehls startet vom System des Hilfesuchenden eine SSH-Verbindung zum System des Helfers. Diese SSH-Verbindung läuft im Hintergrund und benötigt keine Shell(<code class="notranslate">-Nf</code>). Mit <code class="notranslate">-L</code> wird der angegebene Port an den Server weitergeleitet. Durch <em>sleep 2</em> wird die Verbindung aufrecht erhalten, bis die VNC-Verbindung "übernimmt". Der Teil rechts vom <em>&amp;&amp;</em> verbindet den VNC-Server des Hilfesuchenden über die SSH-Verbindung mit dem lauschenden VNC-Viewer des Helfers. Das Elegante an dieser Lösung ist, dass mit dem Schließen des VNC-Viewers auf der Helferseite zugleich der VNC-Server und die SSH-Verbindung auf Seiten des Hilfesuchenden sauber geschlossen werden. Die Option <code class="notranslate">-scale 9/10</code> sorgt dafür, dass der entfernte Desktop beim Helfer etwas verkleinert dargestellt wird und kann je nach Auflösung angepasst bzw. weggelassen werden.</p></div></div><div class="section_1"><h2 id="Server-Informationen-ermitteln">Server-Informationen ermitteln<a class="headerlink" href="#Server-Informationen-ermitteln">¶</a></h2><p>
Wenn der Hilfesuchende über das Internet von einem Helfer unterstützt werden soll, benötigt der Helfer (Client) Informationen über den Server des Hilfesuchenden. Diese muss ihm der Hilfe-Suchende mitteilen. Notwendig sind - sofern nicht DynDNS verwendet wird - IP-Adresse und Display-Nummer. Letztere kann von <code class="notranslate">0</code> abweichen, wenn auf dem Server-Rechner z.B. mehrere Benutzer angemeldet sind.</p><p>Um es dem Hilfe-Suchenden möglichst einfach zu machen, kann für diesen (im Voraus) einen Programmstarter im Menü oder Panel angelegt werden, der die Informationen ermittelt und ausgibt. Dieser Starter ruft folgendes ausführbares Skript auf:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">DISPLAY_NUMBER</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$DISPLAY</span> <span class="p">|</span> cut -c <span class="m">2</span><span class="sb">`</span>
<span class="nv">IP_ADDRESS</span><span class="o">=</span><span class="sb">`</span>wget http://checkip.dyndns.com/ -O - <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep <span class="s2">"Current IP Address"</span> <span class="p">|</span> cut -d <span class="s2">":"</span> -f <span class="m">2</span>- <span class="p">|</span> sed <span class="s1">'s#&lt;/body&gt;&lt;/html&gt;##g'</span> <span class="p">|</span> sed <span class="s1">'s/ //'</span><span class="sb">`</span>

zenity --info --text <span class="s2">"IP-Adresse: </span><span class="nv">$IP_ADDRESS</span><span class="s2">\nDisplay-Nummer: </span><span class="nv">$DISPLAY_NUMBER</span><span class="s2">"</span> --title <span class="s2">"VNC-Info"</span>
</pre></div>
</td></tr></table></div><p>
Dazu muss <a class="internal" href="./zenity.html">Zenity</a> beim Hilfesuchenden installiert sein.</p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Tastaturproblem">Tastaturproblem<a class="headerlink" href="#Tastaturproblem">¶</a></h3><p>
Unter <a class="internal" href="./xfce.html">Xfce</a> (Xubuntu) wird in der Standard-Einstellung das Tastatur-Layout nicht korrekt übertragen. Das Problem wird behoben, indem man im Hauptmenü <em>"Einstellungen -&gt; Einstellungen -&gt; Tastatur -&gt; Tastaturbelegung"</em> (ab <a class="internal" href="./quantal.html">Xubuntu 12.10</a> nur noch <em>"Einstellungen -&gt; Tastatur -&gt; Tastaturbelegung"</em>) aufruft, dort die Option <em>"Systemweite Einstellungen benutzen"</em> deaktiviert und bei <em>"Tastaturbelegung"</em> die gewünschte Sprache einstellt. Nach einem Neustart des VNC-Servers sollte das Tastaturproblem behoben sein.</p></div><div class="section_2"><h3 id="Keine-Panels-in-Unity">Keine Panels in Unity<a class="headerlink" href="#Keine-Panels-in-Unity">¶</a></h3><p>
Wenn bei den anderen VNC-Servern die Leisten in <a class="internal" href="./unity.html">Unity</a> fehlen, kann man <strong>x11vnc</strong> als VNC-Server verwenden. Dieser leitet die komplette X11-Ausgabe von Display "<strong>:0</strong>" direkt auf VNC um.</p><pre class="notranslate">x11vnc -storepasswd
x11vnc -usepw -display :0</pre><p>
Je nach Anwendungsfall nützlicher oder störender Nebeneffekt ist, dass man die Ein- und Ausgaben sowohl auf dem fernsteuernden als auch auf dem ferngesteuerten Rechner beobachten kann.</p></div><div class="section_2"><h3 id="Datenvolumen-Bandbreite-zu-hoch">Datenvolumen/Bandbreite zu hoch<a class="headerlink" href="#Datenvolumen-Bandbreite-zu-hoch">¶</a></h3><p>
Bei z.B. dem VNC-Viewer <strong>xtightvncviewer</strong> kann man unter anderem die Option <code class="notranslate">-compresslevel 9</code> für die höchste Kompressionsstufe setzen. Weitere Optimierungen sind möglich.</p></div><div class="section_2"><h3 id="Authentifizierungsproblem-vino-server">Authentifizierungsproblem vino-server<a class="headerlink" href="#Authentifizierungsproblem-vino-server">¶</a></h3><p>
Der <strong>vino-server</strong> meldet:
</p><blockquote><p>"The authentication mechanism requested cannot be provided by the computer."</p></blockquote><p>bzw.</p><blockquote><p>"Server did not offer supported security type"</p></blockquote><p>bzw.</p><blockquote><p>"No matching security types"</p></blockquote><p>
Lösung: Die Verschlüsselung von <strong>vino-server</strong> kann mit dem <a class="internal" href="./dconf-editor.html">dconf-editor</a> unter <em>"org.gnome.desktop.remote-access"</em> mit dem Schlüssel <em>"require-encryption"</em> deaktiviert werden.</p></div></div><div class="section_1"><h2 id="Spezielle-Anwendungsfaelle">Spezielle Anwendungsfälle<a class="headerlink" href="#Spezielle-Anwendungsfaelle">¶</a></h2><p>
</p><div class="section_2"><h3 id="VNC-Sitzung-gemeinsam-nutzen">VNC-Sitzung gemeinsam nutzen<a class="headerlink" href="#VNC-Sitzung-gemeinsam-nutzen">¶</a></h3><p>
Wenn man gemeinsam in derselben Sitzung arbeiten möchte, z.B. um etwas vorzuführen, kann man dazu <strong>x11vnc</strong> als VNC-Server verwenden. Siehe <a class="crosslink" href="#Keine-Panels-in-Unity">Keine Panels in Unity</a>.</p></div><div class="section_2"><h3 id="VNC-Server-bei-jedem-Bootvorgang-starten">VNC-Server bei jedem Bootvorgang starten<a class="headerlink" href="#VNC-Server-bei-jedem-Bootvorgang-starten">¶</a></h3><p>
</p><div class="section_3"><h4 id="System-mit-systemd-ab-Ubuntu-15-04">System mit systemd – ab Ubuntu 15.04<a class="headerlink" href="#System-mit-systemd-ab-Ubuntu-15-04">¶</a></h4><p>
Unter <a class="internal" href="./systemd.html">systemd</a> muss ein Dienst angelegt und gestartet werden. Hierzu ist zunächst eine Beschreibung für die x11vnc-Einheit anzulegen. Wie üblich gilt auch hier, dass rechnerspezifische Beschreibungen unter <strong>/etc/systemd/system/</strong> Vorrang haben vor etwaigen distributionsgelieferten in<strong>/lib/systemd/system/</strong>.</p><p>Die Datei <strong>/etc/systemd/system/x11vnc.service</strong> sollte enthalten:</p><pre class="notranslate">[Unit]
Description=x11vnc-Server

[Service]
ExecStart=/usr/bin/x11vnc -auth guess -forever -localhost -loop -noxdamage -o /var/log/x11vnc.log -rfbauth /etc/x11vnc.pass -rfbport 5900 -shared

[Install]
WantedBy=multi-user.target</pre><p>
<strong>Hinweis:</strong> Durch den Parameter "-localhost" werden nur lokale Verbindungen angenommen (z.b. für eine Tunnelung bei einer ssh-Portweiterleitung). Möchtest du, dass dein PC von außen erreichbar ist, lasse diesen Parameter weg!</p><p>Danach ist diese Einheit bei systemd anzumelden mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl enable x11vnc.service </pre></div></div><p>
Der x11vnc-Server kann dann direkt aktualisiert, gestartet und kontrolliert werden mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl daemon-reload
sudo systemctl restart x11vnc
sudo systemctl status x11vnc </pre></div></div><p>Mit den drei vorstehenden Befehlen können Änderungen an der <code class="notranslate">x11vnc.service</code> unmittelbar in Betrieb genommen werden. Ansonsten geschieht dies beim nächsten Systemstart.</p></div><div class="section_3"><h4 id="System-mit-Upstart-bis-Ubuntu-14-04">System mit Upstart – bis Ubuntu 14.04<a class="headerlink" href="#System-mit-Upstart-bis-Ubuntu-14-04">¶</a></h4><p>
Der Server soll nach dem Laden des <a class="internal" href="./displaymanager.html">Displaymanagers</a> (hier LightDM) gestartet werden. Dazu wird für das <a class="internal" href="./upstart.html">Upstart</a>-Ereignis "<code class="notranslate">login-session-start</code>" ein Job angelegt. Für X11VNC ist beispielsweise die Datei <strong>/etc/init/x11vnc.conf</strong> anzulegen:</p><pre class="notranslate">start on login-session-start
script
/usr/bin/x11vnc -auth /var/run/lightdm/root/:0  -display :0  -rfbauth /etc/x11vnc.pass  -rfbport 5900  -noxrecord -noxfixes -noxdamage -forever -bg  -o /var/log/x11vnc.log
end script</pre><p>
Der Parameter "<code class="notranslate">-forever</code>" verhindert, dass sich der Server beim Schließen einer Sitzung beendet.</p></div><div class="section_3"><h4 id="ltere-Ubuntu-Systeme">Ältere Ubuntu-Systeme<a class="headerlink" href="#ltere-Ubuntu-Systeme">¶</a></h4><p>
Um den VNC-Server bei jedem Booten automatisch zu starten, empfiehlt sich die Erstellung eines SysVinit-Skripts, das in <strong>/etc/init.d/</strong> gespeichert wird. Dazu mit Root-Rechten einen Editor <sup><a href="#source-4">[4]</a></sup> öffnen und das folgende Skript, eine abgewandelte Version von <a class="external" href="http://www.linuxnetmag.org/2011-03-17-eine-netzwerkinstallation-unter-suse-8-0-scripte" rel="nofollow">linuxnetmag.org</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> , unter <strong>/etc/init.d/vncserver</strong> abspeichern.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#! /bin/sh</span>
<span class="c1"># Original: http://www.linuxnetmag.org/2011-03-17-eine-netzwerkinstallation-unter-suse-8-0</span>
<span class="c1"># Author: Guenther Zander &lt;g.zander@hamburg.de&gt;</span>
<span class="c1"># /etc/init.d/vncserver         This script</span>
<span class="c1"># /usr/bin/vncserver            Program</span>
<span class="c1">#</span>

<span class="c1"># Check for missing binaries</span>
<span class="nv">FOO_BIN</span><span class="o">=</span>/usr/bin/vncserver
<span class="nb">test</span> -x <span class="nv">$FOO_BIN</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">5</span>

<span class="c1"># User, unter dem der VNC-Server ausgefuehrt wird</span>
<span class="nv">VNC_USER</span><span class="o">=</span><span class="s2">"&lt;User&gt;"</span>
<span class="nb">export</span> VNC_USER

<span class="c1"># Set HOME of User</span>
<span class="nv">HOME</span><span class="o">=</span><span class="s2">"&lt;Home-Verzeichnis des verwendeten Users&gt;"</span>
<span class="nb">export</span> HOME

<span class="c1"># Set ID for Connections</span>
<span class="nv">FOO_ID</span><span class="o">=</span><span class="m">1</span>

<span class="k">case</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> in
    start<span class="o">)</span>
        <span class="nb">echo</span> -n <span class="s2">"Starting Vnc-Server with Terminal-ID </span><span class="nv">$FOO_ID</span><span class="s2"> "</span>

        <span class="c1"># Delete old PIDs</span>
        rm -f <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.pid

        <span class="k">if</span> <span class="o">[</span> -e <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.log <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
           cat <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.log &gt;&gt; /var/log/vncserver.log <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
           rm -f <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.log
        <span class="k">fi</span>

        sudo -u <span class="nv">$VNC_USER</span> -H <span class="nv">$FOO_BIN</span> :<span class="nv">$FOO_ID</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
        <span class="p">;;</span>
<span class="c1">#</span>
     stop<span class="o">)</span>
        <span class="nb">echo</span> -n <span class="s2">"Shutting down Vnc-Server "</span>
        <span class="nv">$FOO_BIN</span> -kill :<span class="nv">$FOO_ID</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>

        cat <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.log &gt;&gt; /var/log/vncserver.log <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
        rm -f <span class="nv">$HOME</span>/.vnc/<span class="nv">$HOSTNAME</span>:<span class="nv">$FOO_ID</span>.log

        <span class="p">;;</span>
<span class="c1">#</span>
     restart<span class="o">)</span>
        <span class="nv">$0</span> stop
        <span class="nv">$0</span> start
        <span class="p">;;</span>
<span class="c1">#</span>
    *<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> {start|stop|restart}"</span>
        <span class="nb">exit</span> <span class="m">1</span>
        <span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</td></tr></table></div><p>
Die Variable <code class="notranslate">VNC_USER</code> bestimmt den auszuführenden Benutzer. <code class="notranslate">HOME</code> bestimmt, unter welchem Verzeichnis die Konfiguration und Protokolle des VNC-Servers gespeichert werden und <code class="notranslate">FOO_ID</code> bestimmt die Terminal-ID des VNC-Servers. Diese Variablen müssen den eigenen Wünschen entsprechend angepasst werden. Das Skript benötigt, bevor es genutzt werden kann, noch die richtigen <a class="internal" href="./rechte.html">Rechte</a>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chown root:root /etc/init.d/vncserver
sudo chmod 755 /etc/init.d/vncserver </pre></div></div><p>
Damit der VNC-Server auch wirklich bei jedem Systemstart geladen und bei jedem Abschalten ordentlich heruntergefahren wird, muss das Skript mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-rc.d vncserver defaults </pre></div></div><p>
den Runlevels zugewiesen werden.</p></div><div class="section_3"><h4 id="GDM-konfigurieren">GDM konfigurieren<a class="headerlink" href="#GDM-konfigurieren">¶</a></h4><p>
Um sich am System anzumelden, kann <a class="internal" href="./gdm.html">GDM</a> (fast) genauso verwendet werden wie bei einer lokalen Authentifizierung. Damit dieser jedoch auch in einer Session mit <code class="notranslate">Xvnc</code> als X-Server startet, müssen noch ein paar Änderungen durchgeführt werden.</p><p>Dazu öffnet man mit einem beliebigen Texteditor mit Root-Rechten die Datei <strong>/etc/gdm/gdm.conf</strong> (bzw. <strong>/etc/gdm/gdm.conf-custom</strong>) und kommentiert folgende Zeile ein:</p><pre class="notranslate">RemoteGreeter=/usr/lib/gdm/gdmlogin</pre><p>Schließlich aktiviert man noch XDMCP. Hierfür sucht man sich den Eintrag <code class="notranslate">[xdmcp]</code>.</p></div></div><div class="section_2"><h3 id="Einzelnes-Fenster-freigeben">Einzelnes Fenster freigeben<a class="headerlink" href="#Einzelnes-Fenster-freigeben">¶</a></h3><p>
Manchmal kann es sinnvoll sein, nicht den gesamten Desktop, sondern nur ein Fenster freizugeben. Dazu ist folgendes Vorgehen notwendig (siehe diesen <a class="external" href="http://nicktj.tumblr.com/post/17166592046/share-a-single-x-window-with-someone-over-vnc" rel="nofollow">Blogeintrag</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>). Dazu muss man zunächst die Fenster-ID des freizugebenden Fensters feststellen. Man startet das Programm</p><div class="bash"><div class="contents"><pre class="notranslate">xwininfo </pre></div></div><p>
Nun ändert sich der Mausanzeiger. Dann klickt man auf das entsprechende Fenster und u.a. wird die Fenster-ID ausgegeben. Anschließend kann nur das spezielle Fenster und nicht der gesamte Desktop freigegeben werden:</p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -id WINDOW_ID </pre></div></div><p>
wobei <code class="notranslate">WINDOW_ID</code> durch den ermittelten Hex-Wert von xwininfo zu ersetzen ist. Wählt man als Fenster-ID <code class="notranslate">pick</code>, dann wird im Hintergrund automatisch xwininfo gestartet und man kann das zu exportierende Fenster durch einfache Auswahl anklicken:</p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -id pick </pre></div></div><p>
Zusätzliche Optionen (bspw. <code class="notranslate">-xkb</code>, <code class="notranslate">-usepw</code>, <code class="notranslate">-capslock</code>, <code class="notranslate">-nodpms</code>) für x11vnc können wie bei der Desktop-Variante mit angegeben werden. Der Zugriff auf das Einzelfenster erfolgt wie zum Desktop mit Hilfe eines Clients. Falls eine Applikation exportiert werden soll, welche aus mehreren Einzelfenstern besteht (bspw. <a class="internal" href="./gimp.html">GIMP</a>), empfiehlt sich die Option <code class="notranslate">-appshare</code>. Eine ausführlichere Anleitung findet sich in den Manpages von <strong>x11vnc</strong>.</p><div class="bash"><div class="contents"><pre class="notranslate">x11vnc -appshare -help </pre></div></div></div><div class="section_2"><h3 id="Freigeben-einer-einzelnen-Anwendung">Freigeben einer einzelnen Anwendung<a class="headerlink" href="#Freigeben-einer-einzelnen-Anwendung">¶</a></h3><p>
Um ein einzelnes Programm auf einem (meist an einen Beamer angeschlossen) Rechner z.B. Schülern freizugeben, damit diese mit dem eigenen Rechner etwas demonstrieren können, nutzt man folgendes Skript. Voraussetzung sind <a class="interwiki interwiki-packages" href="http://packages.ubuntu.com/xnest">xnest</a> und der Fenstermanager <a class="internal" href="./ratpoison.html">Ratpoison</a>:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">passwortdatei</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="k">)</span>

<span class="c1"># Passwort erstellen</span>
date +%N <span class="p">|</span> grep -o ^.... &gt; <span class="nv">$passwortdatei</span><span class="p">;</span>

<span class="nv">hinweise</span><span class="o">=</span><span class="s2">"Passwort: </span><span class="k">$(</span>cat <span class="nv">$passwortdatei</span><span class="k">)</span><span class="s2"> </span><span class="k">$(</span>/sbin/ifconfig <span class="p">|</span> grep -o inet<span class="se">\ </span>Adresse:<span class="o">[</span><span class="m">0</span>-9<span class="se">\.</span><span class="o">]</span>*<span class="k">)</span><span class="s2">"</span>
<span class="nv">programm</span><span class="o">=</span><span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span>

<span class="c1"># Unterfenster erzeugen</span>
Xnest -geometry 1024x720 :4 <span class="p">&amp;</span>

<span class="c1"># VNC aufschalten</span>
x11vnc -shared -forever -zeroconf -noshm -passwdfile <span class="nv">$passwortdatei</span> -display :4 <span class="p">&amp;</span>

lxterm -fs <span class="m">40</span> -display :4 -e <span class="s2">"ratpoison &amp; </span><span class="nv">$programm</span><span class="s2">; rm </span><span class="nv">$passwortdatei</span><span class="s2">"</span> <span class="p">&amp;</span>

sleep <span class="m">5</span><span class="p">;</span> ratpoison --display :4 -c <span class="s2">"echo </span><span class="nv">$hinweise</span><span class="s2">"</span>
sleep <span class="m">5</span><span class="p">;</span> ratpoison --display :4 -c <span class="s2">"echo </span><span class="nv">$hinweise</span><span class="s2">"</span>
sleep <span class="m">5</span><span class="p">;</span> ratpoison --display :4 -c <span class="s2">"echo </span><span class="nv">$hinweise</span><span class="s2">"</span>
sleep <span class="m">5</span><span class="p">;</span> ratpoison --display :4 -c <span class="s2">"echo </span><span class="nv">$hinweise</span><span class="s2">"</span>
</pre></div>
</td></tr></table></div><p>
Das Skript kann ausführbar im Suchpfad liegen, z.B. mit dem Dateinamen <strong>start-vnc</strong>. Ein Programm lässt sich dann mit</p><div class="bash"><div class="contents"><pre class="notranslate">start-vnc PROGRAMM PARAMETER </pre></div></div><p>
starten.</p><div class="section_3"><div class="section_4"><h5 id="Desktopumgebung">Desktopumgebung<a class="headerlink" href="#Desktopumgebung">¶</a></h5><p>
Möchte man, dass die komplette Desktopumgebung - also z.B. GNOME oder KDE - des Benutzers, der VNC startet, geladen wird, so kann man dies in der Konfigurationsdatei <strong>/etc/vnc.conf</strong> des VNC-Dienstes für alle Benutzer des Systems definieren. Ist die Datei <strong>/etc/vnc.conf</strong> nicht vorhanden, muss sie mit Root-Rechten aus <strong>/usr/share/doc/tightvncserver/examples/vnc.conf.gz</strong> bzw. <strong>/usr/share/doc/vnc4server/examples/vnc.conf.gz</strong> nach <strong>/etc/vnc.conf</strong> extrahiert werden.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cp /usr/share/doc/vnc4server/examples/vnc.conf.gz /etc/
sudo gunzip -d /etc/vnc.conf.gz </pre></div></div><p>
bzw. für den Tightvncserver:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cp /usr/share/doc/tightvncserver/examples/vnc.conf.gz /etc/
sudo gunzip -d /etc/vnc.conf.gz </pre></div></div><p>
Anschließend muss die Zeile</p><pre class="notranslate"># $vncStartup points to a script that will be started at the very beginning.
<strong class="highlighted">$vncStartup = "/etc/X11/Xsession";</strong></pre><p>einkommentiert werden. Von da an startet automatisch die Desktopumgebung, wenn ein Benutzer einen VNC-Server startet. Alternativ kann dies auch jeder Benutzer für sich selbst festlegen. Dazu muss man in der Datei <strong>~/.vnc/xstartup</strong> im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> Folgendes eintragen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nb">unset</span> SESSION_MANAGER
<span class="nb">exec</span> /etc/X11/Xsession
</pre></div>
</td></tr></table></div><p>
Anschließend muss die Datei ausführbar gesetzt werden:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>chmod +x ~/.vnc/xstartup
</pre></div>
</td></tr></table></div><p><a class="crosslink anchor" href="#fenstermanager" id="fenstermanager"></a></p></div><div class="section_4"><h5 id="Fenstermanager">Fenstermanager<a class="headerlink" href="#Fenstermanager">¶</a></h5><p>
Oftmals soll nicht eine komplette Desktopumgebung geladen werden; dies würde recht viel Last erzeugen, nur damit eine Desktopumgebung bereit steht, deren Möglichkeiten kaum genutzt werden. Um dem VNC-Server einen bestimmten Fenstermanager zuzuweisen, muss die Datei <strong>~/.vnc/xstartup</strong> editiert werden <sup><a href="#source-4">[4]</a></sup>. Im Original sieht die Datei so aus:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="o">[</span> -r <span class="nv">$HOME</span>/.Xresources <span class="o">]</span> <span class="o">&amp;&amp;</span> xrdb <span class="nv">$HOME</span>/.Xresources
xsetroot -solid grey
vncconfig -iconic <span class="p">&amp;</span>
x-terminal-emulator -geometry 80x24+10+10 -ls -title <span class="s2">"</span><span class="nv">$VNCDESKTOP</span><span class="s2"> Desktop"</span> <span class="p">&amp;</span>
x-window-manager <span class="p">&amp;</span>
</pre></div>
</td></tr></table></div><p>Um einen bestimmten Fenstermanager zu starten, ersetzt man einfach <code class="notranslate">x-window-manager</code>. Natürlich muss der gewünschte Fenstermanager installiert sein. Man kann dort zum Beispiel <code class="notranslate">openbox</code> oder <code class="notranslate">fluxbox</code> eintragen. Mit "&amp;" kann man weitere Programme hinzufügen, die automatisch mit gestartet werden sollen. Das Ganze sieht danach zum Beispiel so aus:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>x-terminal-emulator -geometry 80x24+10+10 -ls -title <span class="s2">"</span><span class="nv">$VNCDESKTOP</span><span class="s2"> Desktop"</span> <span class="p">&amp;</span>
fluxbox <span class="p">&amp;</span>
firefox <span class="p">&amp;</span>
</pre></div>
</td></tr></table></div><p>Hier werden der Fenstermanager <a class="internal" href="./fluxbox.html">Fluxbox</a> und der Webbrowser <a class="internal" href="./firefox.html">Firefox</a> gestartet. Im nächsten Beispiel wird eine <a class="internal" href="./lxde.html">LXDE</a>-Sitzung mit speziellen Optionen für <code class="notranslate">vncconfig</code> gestartet:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>vncconfig -sendPrimary<span class="o">=</span><span class="m">0</span> -nowin <span class="p">&amp;</span>
x-terminal-emulator -geometry 80x24+10+10 -ls -title <span class="s2">"</span><span class="nv">$VNCDESKTOP</span><span class="s2"> Desktop"</span> <span class="p">&amp;</span>
startlubuntu
</pre></div>
</td></tr></table></div><p>Der bisher undokumentierte Schalter <code class="notranslate">-sendPrimary=0</code> schaltet die Option "Send primary selection to viewers" von <code class="notranslate">vncconfig</code> aus (die "primary selection" ist der von der Maus markierte Text), der Parameter <code class="notranslate">-nowin</code> versteckt das Fenster. Mit dem Befehl <code class="notranslate">startlubuntu</code> wird schlussendlich <a class="internal" href="./lubuntu.html">Lubuntu</a> gestartet.</p></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-man" href="http://manpages.ubuntu.com/cgi-bin/search.py?lr=lang_en&amp;q=x11vnc">x11vnc</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Beschreibung und Startbefehle für den VNC-Server x11vnc</p></li><li><p><a class="external" href="http://linuxundich.de/de/ubuntu/das-eigene-pc-helpdesk/" rel="nofollow">Das eigene PC-Helpdesk</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Blogbeitrag 09/2009</p></li><li><p><a class="interwiki interwiki-heise" href="https://www.heise.de/-221463">Fernhilfe - X-Window-Desktop fernsteuern per Shell-Skript und VNC</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - heise Netze, 05/2008</p></li><li><p><a class="internal" href="./howto/vnc_-_verschlüsselte_pc-fernsteuerung.html">Howto VNC - Verschlüsselte PC-Fernsteuerung</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="internal" href="./epoptes.html">Epoptes</a> - Rechner im lokalen Netzwerk fernsteuern</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./vnc/a/revision/944507.html">Diese Revision</a> wurde am 28. Oktober 2017 16:36 von <a href="https://ubuntuusers.de/user/JackyOH/">JackyOH</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./vnc.html">VNC</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>