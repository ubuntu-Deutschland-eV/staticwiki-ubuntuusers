<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>OpenNMS › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./opennms.html">OpenNMS</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/OpenNMS">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./opennms/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./opennms/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./opennms/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./opennms/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./opennms/a/backlinks.html">OpenNMS</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./editor.html">Editor</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./dienste.html">Programme als Dienst ausführen</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./snmp.html">SNMP Grundlagen und Konfiguration</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Aufbau">Aufbau
</a></li><li><a class="crosslink" href="#Voraussetzungen">Voraussetzungen
</a><ol class="arabic"><li><a class="crosslink" href="#Java">Java
</a></li><li><a class="crosslink" href="#PostgreSQL">PostgreSQL
</a></li></ol></li><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Fremdquelle">Fremdquelle
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Absichern-von-Postgres">Absichern von Postgres
</a></li></ol></li></ol></li><li><a class="crosslink" href="#Erste-Schritte">Erste Schritte
</a><ol class="arabic"><li><a class="crosslink" href="#Benutzeroberflaeche">Benutzeroberfläche
</a></li><li><a class="crosslink" href="#Discovery">Discovery
</a></li><li><a class="crosslink" href="#Notifications">Notifications
</a></li></ol></li><li><a class="crosslink" href="#Backup-Restore">Backup / Restore
</a><ol class="arabic"><li><a class="crosslink" href="#Datenbank">Datenbank
</a></li><li><a class="crosslink" href="#RRD-Archive">RRD Archive
</a></li><li><a class="crosslink" href="#Konfiguration-2">Konfiguration
</a></li><li><a class="crosslink" href="#Webinterface">Webinterface
</a></li></ol></li><li><a class="crosslink" href="#Problembehandlung">Problembehandlung
</a><ol class="arabic"><li><a class="crosslink" href="#Logs">Logs
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="opennms-logo.jpg" class="image-left" src="./_/5993cb5372ab94791d03cb9fb449567336892abf.png"/>
<a class="external" href="http://www.opennms.org/" rel="nofollow">OpenNMS</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein freies Netzwerkmanagement-System zur Überwachung von IT-Netzwerken. Der gesamte Code steht unter der GNU General Public License (GPL). Verwaltet wird das Projekt von Tarus Balog, der OpenNMS Group und „The Order of the Green Polo“. OpenNMS ist in Java geschrieben und lässt sich über eine Weboberfläche benutzen. Es gilt als sehr skalierbar. Installationen zur Überwachung von 70.000 Systemen mit einer Instanz sind in der Praxis im Einsatz.</p><p>Kernfunktionen:</p><ul><li><p>Discovery: Im Netzwerk zu überwachende Knoten (Geräte) und darauf laufende Dienste können automatisch durch einen Discovery-Prozess erkannt werden.</p></li><li><p>Service Polling: Die auf den Knoten erkannten Dienste werden über ein Polling-Verfahren überwacht.</p></li><li><p>Datacollection: In regelmäßigen Abständen können Leistungsdaten der einzelnen Knoten per SNMP, JMX, HTTP, WMI, JDBC und NSClient erhoben werden.</p></li><li><p>Thresholding: Die gesammelten Leistungsdaten können mittels Schwellwerten überwacht werden.</p></li><li><p>Event Management: Umfasst die Verwaltung von internen sowie externen Ereignissen, die unter anderem per SNMP-Trap oder Syslog empfangen werden können.</p></li><li><p>Benachrichtigungen: Benachrichtigungen über sämtliche Ereignisse (wie zum Beispiel ein ausgefallener Dienst oder Knoten) sind unter anderem per E-Mail oder XMPP möglich.</p></li></ul><p>
</p><div class="section_1"><h2 id="Aufbau">Aufbau<a class="headerlink" href="#Aufbau">¶</a></h2><p>
OpenNMS besteht aus mehreren Diensten, die jeweils über einen gemeinsamen Eventbus miteinander kommunizieren. Der Discovery-Daemon durchsucht in regelmäßigen konfigurierbaren Abständen IP-Adressbereiche nach neuen Knoten. Wird ein neuer Knoten erkannt, wird ein NewSuspect-Ereignis erzeugt. Nach dem Auftreten eines solchen Ereignisses beginnt der Dienst Capsd die auf dem Gerät verfügbaren Dienste zu erkennen und in OpenNMS aufzunehmen. Der Pollerd übernimmt anschließend das Abfragen der einzelnen erkannten Dienste während der Collectd in regelmäßigen Abständen Leistungsdaten wie zum Beispiel die CPU-Auslastung unter anderem per SNMP erhebt. Mit den Diensten Trapd und Syslogd können SNMP-Traps sowie Syslog-Nachrichten empfangen werden und dem jeweiligen überwachten Knoten zugeordnet werden. Sämtliche Daten mit Ausnahme von Leistungsdaten werden in einer PostgreSQL-Datenbank gespeichert. Leistungsdaten werden in RRD-Dateien abgelegt. Mit einem Applikationsserver werden die gesammelten Informationen dem Benutzer über eine Weboberfläche zur Verfügung gestellt.</p></div><div class="section_1"><h2 id="Voraussetzungen">Voraussetzungen<a class="headerlink" href="#Voraussetzungen">¶</a></h2><p>
</p><div class="section_2"><h3 id="Java">Java<a class="headerlink" href="#Java">¶</a></h3><p>
OpenNMS basiert auf <a class="internal" href="./java.html">Java</a>. Empfohlen wird die Installation einer Entwicklungsumgebung (<a class="internal" href="./java.html#JDK-SDK">JDK</a>, Version 7). OpenNMS funktioniert sowohl mit <a class="internal" href="./java/installation.html#OpenJDK">OpenJDK</a> als auch mit <a class="internal" href="./java/oracle_java.html">Java/Oracle Java</a>.</p></div><div class="section_2"><h3 id="PostgreSQL">PostgreSQL<a class="headerlink" href="#PostgreSQL">¶</a></h3><p>
Dann muss <a class="internal" href="./postgresql.html">PostgreSQL</a> installiert <sup><a href="#source-1">[1]</a></sup> werden:
</p><ul><li><p><strong>postgresql</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install postgresql </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install postgresql </pre></div></div><p>
</p></div></div><p>Danach müssen die Zugriffsberechtigungen der Datenbank geändert werden. Die Datei <strong>/etc/postgresql/VERSION/main/pg_hba.conf</strong> muss mit einem Editor <sup><a href="#source-2">[2]</a></sup> und Root-Rechten <sup><a href="#source-3">[3]</a></sup> bearbeitet werden. Am Ende der Datei gibt es die Einträge:</p><pre class="notranslate">local   all         all                               ident sameuser
host    all         all         127.0.0.1/32          ident sameuser
host    all         all         ::1/128               ident sameuser</pre><p>Diese bitte abändern:
</p><pre class="notranslate">local   all         all                               trust
host    all         all         127.0.0.1/32          trust
host    all         all         ::1/128               trust</pre><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die oben genannten Änderungen in der Konfiguration erlauben jedem Zugriff auf die Datenbank, der sich auf localhost (also dem OpenNMS Server) anmelden darf! Diese Konfiguration ist für die Installation von OpenNMS am unkompliziertesten. In den meisten Fällen sollte dies allerdings kein Sicherheitsrisiko darstellen, da der Server sowieso nicht offen für jeden zugänglich sein sollte. Weiter unten in der Konfig wird erklärt, wie der Postgres Zugriff abgesichert werden kann.</p></div></div><p>Danach die Server-Komponente von PostgreSQL neu starten:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service postgresql restart </pre></div></div></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
OpenNMS ist nicht über die offiziellen Ubuntu Paketquellen verfügbar. Daher muss man die Paketquelle manuell hinzufügen.</p><div class="section_2"><h3 id="Fremdquelle">Fremdquelle<a class="headerlink" href="#Fremdquelle">¶</a></h3><p>
</p><p>Um aus der <a class="internal" href="./fremdquellen.html">Fremdquelle</a> zu installieren, muss man unabhängig von der Ubuntu-Version die folgende <a class="internal" href="./paketquellen_freischalten.html">Paketquelle freischalten</a>:
</p><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
Zusätzliche <a class="internal" href="./fremdquellen.html">Fremdquellen</a> können das System gefährden. 
</p></div></div><p>
</p><pre class="notranslate">deb http://debian.opennms.org stable main</pre><p>Um die <a class="internal" href="./fremdquellen.html">Fremdquelle</a> zu authentifizieren, kann man 
entweder den <a class="external" href="http://debian.opennms.org/OPENNMS-GPG-KEY" rel="nofollow">Signierungsschlüssel herunterladen</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> und in der <a class="internal" href="./paketquellen_freischalten.html">Paketverwaltung hinzufügen</a> oder folgenden Befehl ausführen:
</p><div class="bash"><div class="contents"><pre class="notranslate">wget -q http://debian.opennms.org/OPENNMS-GPG-KEY -O- | sudo apt-key add - </pre></div></div><p>Nach dem Aktualisieren der Paketquellen kann das Paket <strong>opennms</strong> installiert werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get update
sudo apt-get install opennms -y </pre></div></div></div><div class="section_2"><h3 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h3><p>
Danach muss OpenNMS gesagt werden, wo es Java findet bzw. welches es nutzen soll:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /usr/share/opennms/bin/runjava -S /PFAD/ZU/JAVA/bin/java </pre></div></div><p>Nun noch schnell die OpenNMS Datenbank erstellen. Dazu gibt es ein Installationsprogramm von OpenNMS. Dieses muss auch nach Updates erneut ausgeführt werden.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /usr/share/opennms/bin/install -dis </pre></div></div><div class="section_3"><h4 id="Absichern-von-Postgres">Absichern von Postgres<a class="headerlink" href="#Absichern-von-Postgres">¶</a></h4><p>
Wie schon erwähnt, kann nun der Zugriff auf die Postgres Datenbank abgesichert werden. Den Datenbankbenutzern <strong>postgres</strong> und <strong>opennms</strong> muss ein Passwort zur Authentifizierung gegeben werden (siehe auch <a class="internal" href="./davical.html#DAViCal-Konfiguration">daviCAL</a>). Dazu zuerst den Benutzer wechseln <sup><a href="#source-4">[4]</a></sup><sup><a href="#source-5">[5]</a></sup> und die Datenbankverwaltung starten:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>su - postgres
psql
</pre></div>
</td></tr></table></div><p>Am PostgreSQL-Prompt <code class="notranslate">postgres=#</code> folgende Befehle eingeben:
</p><pre class="notranslate">ALTER USER opennms with password 'geheim';
ALTER USER postgres with password 'geheim';
\q</pre><p>Dann wieder zum normalen Benutzer werden:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nb">exit</span>
</pre></div>
</td></tr></table></div><p>Nun muss OpenNMS das Passwort bekannt gegeben werden. In der Datei <strong>/etc/opennms/opennms-datasources.xml </strong> kann dieses hinterlegt werden:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>  <span class="nt">&lt;jdbc-data-source</span> <span class="na">name=</span><span class="s">"opennms"</span>
                    <span class="na">database-name=</span><span class="s">"opennms"</span>
                    <span class="na">class-name=</span><span class="s">"org.postgresql.Driver"</span>
                    <span class="na">url=</span><span class="s">"jdbc:postgresql://localhost:5432/opennms"</span>
                    <span class="na">user-name=</span><span class="s">"opennms"</span>
                    <span class="na">password=</span><span class="s">"geheim"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;jdbc-data-source</span> <span class="na">name=</span><span class="s">"opennms-admin"</span>
                    <span class="na">database-name=</span><span class="s">"template1"</span>
                    <span class="na">class-name=</span><span class="s">"org.postgresql.Driver"</span>
                    <span class="na">url=</span><span class="s">"jdbc:postgresql://localhost:5432/template1"</span>
                    <span class="na">user-name=</span><span class="s">"postgres"</span>
                    <span class="na">password=</span><span class="s">"geheim"</span> <span class="nt">/&gt;</span>
</pre></div>
</td></tr></table></div><p>Die Datei <strong>/etc/postgresql/VERSION/main/pg_hba.conf</strong> kann jetzt von <strong>trust</strong> auf <strong>md5</strong> geändert werden. Der Zugriff auf PostgreSQL ist dann über lokale Unix sockets sowie local loopback über IPv4 und IPv6 nur mit MD5 verschlüsselter Authentifizierung möglich.</p><pre class="notranslate">local   all         all                               md5
host    all         all         127.0.0.1/32          md5
host    all         all         ::1/128               md5</pre><p>Damit die Änderung wirksam wird, muss PostgreSQL neu gestartet werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service postgresql restart </pre></div></div><p>Danach ist OpenNMS einsatzbereit. Es muss nur noch gestartet werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service opennms start </pre></div></div></div></div></div><div class="section_1"><h2 id="Erste-Schritte">Erste Schritte<a class="headerlink" href="#Erste-Schritte">¶</a></h2><p>
</p><div class="section_2"><h3 id="Benutzeroberflaeche">Benutzeroberfläche<a class="headerlink" href="#Benutzeroberflaeche">¶</a></h3><p>
Der Zugriff erfolgt über den Browser: <code class="notranslate">http://OPENNMS-IP-ADRESSE:8980/opennms/</code></p><p>Benutzername: admin
Passwort: admin</p></div><div class="section_2"><h3 id="Discovery">Discovery<a class="headerlink" href="#Discovery">¶</a></h3><p>
Um großflächig Nodes in die OpenNMS Datenbank zu bekommen, sollte man den Discovery Daemon konfigurieren. Dies lässt sich leicht über die grafische Oberfläche einstellen.</p><div style="clear: both"><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="discovery01.png" class="image-default" src="./_/5dbedd5ae718c7fdf381cf4ed8206d9b549a939e.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Administrations-Weboberfläche</td></tr></table><div><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="discovery02.png" class="image-default" src="./_/56bcfca2544d422fae67b715356ef44f8f90b31b.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Discovery-Konfiguration</td></tr></table><div><div class="contents"></div></div><div style="clear: both"><div class="contents"></div></div><p>Einfach eine gewünschte IP, IP-Bereich oder URL eingeben und auf <em>"Save and Restart Discovery"</em> klicken. In der <em>"Node List"</em> werden dann alle Geräte erscheinen, die per ICMP im Netzwerk erreichbar sind. Diese werden auch fortan auch auf ICMP und div. andere Dienste, die dort erkannt werden (wie. z.B. HTTP, SSH usw.), überwacht.</p></div><div class="section_2"><h3 id="Notifications">Notifications<a class="headerlink" href="#Notifications">¶</a></h3><p>
OpenNMS bietet viele Möglichkeiten, um Nachrichten zu versenden. Meist werden Emails oder Instant Messages verwendet. Aber auch SMS, Anrufe oder Mikrobloggingdienste könnten genutzt werden.
Der Versand von Nachrichten ist grundlegend bei einer Neuinstallation ausgeschaltet. Das heißt aber nicht, dass OpenNMS nichts meldet! Denn die Nachrichten sind im Menü <strong>Notifications</strong> ersichtlich. Sie werden nur nicht per Mail etc. versendet.</p><p>In der Datei <strong>/etc/opennms/javamail.configuration.properties</strong> muss der gewünschte Emailserver hinterlegt sein. Eine funktionierende Konfiguration könnte z.B. so aussehen (wenn der SMTP Server keine Authentifizierung benötigt):</p><pre class="notranslate">org.opennms.core.utils.fromAddress=EMAILADRESSE-DES-NMS-SERVER
org.opennms.core.utils.mailHost=IP-DES-MAIL-SERVER
org.opennms.core.utils.mailer=smtpsend
org.opennms.core.utils.transport=smtp
org.opennms.core.utils.smtpport=25
org.opennms.core.utils.useJMTA=false
org.opennms.core.utils.messageContentType=text/html
org.opennms.core.utils.encoding=8-bit
org.opennms.core.utils.charset=utf8
org.opennms.core.utils.contentTransferEncoding=8-bit</pre><p>Diese Konfiguration benötigt einen Neustart von OpenNMS.</p><div class="bash"><div class="contents"><pre class="notranslate">service restart opennms </pre></div></div><p>Der Versand von Nachrichten kann im Bereich <strong>Admin</strong> eingeschaltet werden:</p><div style="clear: both"><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="notifications_ein.png" class="image-default" src="./_/fe66995dad8950dd5bc2b6a4d6efedd6e2378de9.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Notifications einschalten</td></tr></table><div><div class="contents"></div></div><div style="clear: both"><div class="contents"></div></div><p>Im Adminbereich unter <strong>Home / Admin / Configure Notifications / Event Notifications</strong> können einzelne Nachrichten ein- oder ausgeschaltet werden. In der Grundinstallation sind folgende Benachrichtigungen enthalten:</p><ul><li><p>High/Low Threshold - Wird ausgelöst, wenn ein überwachter Wert über/unterschritten wird</p></li><li><p>InterfaceDeleted - Wird ausgelöst, wenn ein Interface eines überwachten Gerätes gelöscht wird</p></li><li><p>InterfaceDown - Wird ausgelöst, wenn ein Interface eines überwachten Gerätes nicht mehr erreichbar ist.</p></li><li><p>NodeAdded - Wird ausgelöst, wenn ein zu überwachendes Gerät in OpenNMS hinzugefügt wird</p></li><li><p>NodeDown - Wenn ein komplettes überwachtes Gerät nicht mehr erreichbar ist</p></li><li><p>NodeLostService - Wenn ein Dienst eines überwachten Gerätes nicht mehr erreichbar ist. Z.B. HTTP oder SSH</p></li></ul><p>
</p><div style="clear: both"><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="event_notifications_ein.png" class="image-default" src="./_/d3937c1795b22b4ce262631942355616f7711280.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Event notifications</td></tr></table><div><div class="contents"></div></div><div style="clear: both"><div class="contents"></div></div><p>Um nun auch diese Nachrichten per Email zu erhalten, muss man sich einen Benutzeraccount anlegen und diesen in die Gruppe <strong>admin</strong> hinzufügen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Da die Standardbenachrichtigungen auf die Gruppe <strong>admin</strong> eingestellt sind, ist es für den ersten Schritt (um Ergebnisse zu erzielen, sprich, Emails zu bekommen) einfacher sich in die Gruppe <strong>admin</strong> hinzuzufügen, als die ganzen Notifications neu zu konfigurieren. In einem größeren Szenario muss dies natürlich überarbeitet werden.
</p></div></div><p>Der User benötigt nur einen Benutzernamen, Passwort und eine Emailadresse. Er kann im Adminbereich 
<strong>Home / Admin / Users and Groups / User List</strong> erstellt und in <strong>Home / Admin / Users and Groups / Group List</strong> der Gruppe <strong>admin</strong> hinzugefügt werden.
</p><div style="clear: both"><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="user_erstellen.png" class="image-default" src="./_/75a95226ae462af6d05e72c4ee0f0b17725caabe.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Menü für Usererstellung</td></tr></table><div><div class="contents"></div></div><p>
</p><table style="float: left; margin: 10px 5px; border: none"><tr><td style="text-align: center; background-color: #E2C889; border: none"> <img alt="user_gruppenmitgliedschaft.png" class="image-default" src="./_/91e02593f977d7f8019a083be71556c59a98fc55.png"/> </td></tr><tr><td style="text-align: center; background-color: #F9EAAF; border: none"> Gruppenmitglieder definieren</td></tr></table><div><div class="contents"></div></div><div style="clear: both"><div class="contents"></div></div></div></div><div class="section_1"><h2 id="Backup-Restore">Backup / Restore<a class="headerlink" href="#Backup-Restore">¶</a></h2><p>
Die Sicherung von OpenNMS besteht aus 4 Komponenten. Mit diesen vier Teilen kann man eine Neuinstallation von OpenNMS wieder auf seinen letzten Stand zurück bringen.</p><div class="section_2"><h3 id="Datenbank">Datenbank<a class="headerlink" href="#Datenbank">¶</a></h3><p>
In der PostgreSQL Datenbank stehen z.B. alle Events, Notifications, Alarme etc.
Mit dem Programm <strong>pg_dump</strong>, welches Teil des postgres-Paketes ist, kann eine Sicherung erstellt werden.</p><div class="bash"><div class="contents"><pre class="notranslate">pg_dump -U opennms -Fc -f /backups/opennms-pgsql.gz opennms </pre></div></div><p>Der Restore dazu sieht so aus:
</p><div class="bash"><div class="contents"><pre class="notranslate">createdb -U opennms opennms
pg_restore -U opennms -Fc -d opennms /backups/opennms-pgsql.gz </pre></div></div></div><div class="section_2"><h3 id="RRD-Archive">RRD Archive<a class="headerlink" href="#RRD-Archive">¶</a></h3><p>
Sie enthalten die gespeicherten Leistungsdaten aller überwachten Geräte. Die RRD Archive sind in dem Ordner <strong>/usr/share/opennms/share/rrd</strong> zu finden. Zur Sicherung genügt eine Kopie des Ordners.
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Je nach Umgebung kann dieser Ordner sehr groß werden! Daher empfiehlt es sich den Inhalt zu komprimieren.
</p></div></div><div class="bash"><div class="contents"><pre class="notranslate">tar -cvzf /backups/opennms-rrd.tar.gz /usr/share/opennms/share/rrd </pre></div></div></div><div class="section_2"><h3 id="Konfiguration-2">Konfiguration<a class="headerlink" href="#Konfiguration-2">¶</a></h3><p>
Die Konfigurationen liegen unter <strong>/etc/opennms/</strong>. Auch dieser Ordner muss nur kopiert bzw. archiviert werden.
</p><div class="bash"><div class="contents"><pre class="notranslate">tar -cvzf /backups/opennms-etc.tar.gz /etc/opennms </pre></div></div></div><div class="section_2"><h3 id="Webinterface">Webinterface<a class="headerlink" href="#Webinterface">¶</a></h3><p>
Die Konfigurationen für das Webfrontend findet man im Ordner <strong>/usr/share/opennms/jetty-webapps</strong>. Falls man das Webfrontend modifiziert hat, sollte man auch diesen Ordner sichern.
</p><div class="bash"><div class="contents"><pre class="notranslate">tar -cvzf /backups/opennms-jetty.tar.gz /usr/share/opennms/jetty-webapps </pre></div></div><p>
</p></div></div><div class="section_1"><h2 id="Problembehandlung">Problembehandlung<a class="headerlink" href="#Problembehandlung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Logs">Logs<a class="headerlink" href="#Logs">¶</a></h3><p>
Die Protokolldateien (Logs) werden unter <strong>/var/log/opennms/daemon/</strong> gespeichert. In der Datei <strong>/etc/opennms/log4j2.xml</strong> kann das Loglevel angepasst werden. Die meisten Daemons sind standardmäßig auf WARN eingestellt. Es kann, gerade bei der Fehlersuche in der Konfiguration, hilfreich sein, mehr Meldungen zu erhalten. Das Loglevel sollte dann auf INFO oder DEBUG gestellt werden.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span># Pollers
log4j.category.OpenNMS.Poller=WARN, POLLERS
</pre></div>
</td></tr></table></div><p>Diese Änderung wird sofort gültig und die Logs werden mit Debug Informationen gefüllt.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.opennms.org/" rel="nofollow">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> </p><ul><li><p><a class="external" href="http://www.opennms.org/wiki/Main_Page" rel="nofollow">Wiki</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://www.opennms.org/wiki/Mailing_lists" rel="nofollow">Mailinglisten</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/><img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li></ul></li><li><p><a class="external" href="http://www.opennms.eu/" rel="nofollow">OpenNMS Foundation Europe</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - e.V.</p></li><li><p><a class="external" href="http://www.hemmler.net/category/opennms/" rel="nofollow">zahlreiche Blogbeiträge zu OpenNMS</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="internal" href="./netzwerk-monitoring.html">Netzwerk-Monitoring</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Programmübersicht</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./opennms/a/revision/939695.html">Diese Revision</a> wurde am 5. Mai 2017 21:22 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./opennms.html">OpenNMS</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>