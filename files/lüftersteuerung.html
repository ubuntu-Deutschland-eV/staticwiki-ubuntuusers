<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Lüftersteuerung › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./lüftersteuerung.html">Lüftersteuerung</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Lüftersteuerung">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./lüftersteuerung/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./lüftersteuerung/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./lüftersteuerung/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./lüftersteuerung/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./lüftersteuerung/a/backlinks.html">Lüftersteuerung</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Es sollte mit äußerster Aufmerksamkeit und Vorsicht vorgegangen werden, da bei falscher Handhabung die Hardware irreparabel beschädigt werden kann! 
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./lm_sensors.html">LM-Sensors einrichten</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Voraussetzungen">Voraussetzungen
</a></li><li><a class="crosslink" href="#Konfiguration-der-Lueftersteuerung">Konfiguration der Lüftersteuerung
</a><ol class="arabic"><li><a class="crosslink" href="#Welche-Luefter-sind-regelbar">Welche Lüfter sind regelbar?
</a></li><li><a class="crosslink" href="#Luefter-konfigurieren">Lüfter konfigurieren
</a></li><li><a class="crosslink" href="#Autostart-einrichten">Autostart einrichten
</a></li><li><a class="crosslink" href="#Drehzahl-beim-Beenden-der-Steuerung">Drehzahl beim Beenden der Steuerung
</a></li><li><a class="crosslink" href="#Luefter-werden-nach-Ruhezustand-Energiesparmodus-nicht-mehr-angesteuert">Lüfter werden nach Ruhezustand/Energiesp...</a></li></ol></li></ol></div><p>Die Anleitung kann für Nutzer sinnvoll sein, bei denen der CPU-Lüfter ständig auf höchster Drehzahl läuft und deshalb viel Lärm verursacht. IBM/Lenovo Thinkpad-Notebooks können <span class="underline">nicht</span> mit LM-Sensors gesteuert werden. Bei diesen Notebooks hilft der Artikel <a class="internal" href="./thinkpad_acpi.html#Luefter">Thinkpad ACPI</a> weiter. Das betrifft auch zumindest einige Dell-Notebooks. Diese kann man mit den <code class="notranslate">i8kutils</code> steuern, wobei auch eine automatische Steuerung direkt integriert ist.</p><div class="section_1"><h2 id="Voraussetzungen">Voraussetzungen<a class="headerlink" href="#Voraussetzungen">¶</a></h2><p>
Mit Hilfe von <a class="internal" href="./lm_sensors.html">LM-Sensors</a> und eines Konfigurationsskriptes lassen sich die Lüfter im System, die per <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Pulsweitenmodulation">PWM</a> angesteuert werden können, dynamisch anhand der Temperatur (z.B. der CPU) steuern. Voraussetzung für diese Anleitung ist die korrekte Installation und Konfiguration des Programms LM-Sensors <sup><a href="#source-1">[1]</a></sup> und die Installation von fancontrol:</p><ul><li><p><strong>fancontrol</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install fancontrol </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install fancontrol </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Konfiguration-der-Lueftersteuerung">Konfiguration der Lüftersteuerung<a class="headerlink" href="#Konfiguration-der-Lueftersteuerung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Welche-Luefter-sind-regelbar">Welche Lüfter sind regelbar?<a class="headerlink" href="#Welche-Luefter-sind-regelbar">¶</a></h3><p>
Man startet das Konfigurationsskript in einem Terminal mit <a class="internal" href="./sudo.html">Rootrechten</a> <sup><a href="#source-2">[2]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo pwmconfig </pre></div></div><p>
Das Skript versucht nun festzustellen, welche Lüfter sich kontrollieren lassen. Dazu versucht es, einen Lüfter für 5 Sekunden anzuhalten - sollte das geschehen sein, bestätigt man die darauf folgende Abfrage mit 
<span class="key">Y</span> . Es kann vorkommen, dass eine Fehlermeldung angezeigt wird und der Lüfter noch einmal abgeschaltet werden soll. Dies sollte durchgeführt und die folgende Abfrage wieder mit 
<span class="key">Y</span>  beantwortet werden. Nun sollte es funktionieren.</p></div><div class="section_2"><h3 id="Luefter-konfigurieren">Lüfter konfigurieren<a class="headerlink" href="#Luefter-konfigurieren">¶</a></h3><p>
Hat man einen zu regelnden Lüfter gefunden, kann man ihn nach der entsprechenden mit 
<span class="key">Y</span>  zu bestätigenden Abfrage wie folgt konfigurieren:</p><pre class="notranslate">What should be the path to your fancontrol config file (/etc/fancontrol)</pre><p>
Wenn die Konfigurationsdatei noch nicht vorhanden ist, dann wird sie von dem Skript erstellt. Man bestätigt die Abfrage dafür mit 
<span class="key">⏎</span> </p><p>Man erhält nun ein Menü ähnlich dem folgenden:</p><pre class="notranslate"> fan output to configure, or other action:
1) 9191-0290/pwm2      3) Just quit           5) Show configuration
2) Change INTERVAL     4) Save and quit</pre><p>
Nun drückt man 
<span class="key">1</span>  + 
<span class="key">⏎</span> , um den entsprechenden Lüfter zu konfigurieren. Man wird nun nach dem Temperatursensor gefragt, nach dem sich die Drehzahl richten soll:</p><pre class="notranslate">Select a temperature sensor as source for 9191-0290/pwm2:
1) 9191-0290/temp1_input
2) 9191-0290/temp2_input
3) None (Do not affect this PWM output)</pre><p>
Nun wählt man die entsprechende Nummer und bestätigt sie mit 
<span class="key">⏎</span> </p><p>Man wird nun nach der Temperatur gefragt, bei der sich der Lüfter ausschalten kann:</p><pre class="notranslate">Enter the low temperature (C)
at which the fan should be switched off (0):</pre><p>
Jetzt wählt man nach Prozessor und Kühler-/Lüfterkombination einen relativ niedrigen Wert (auf die Herstellerangaben der CPU achten!) und bestätigt sie mit 
<span class="key">⏎</span> </p><p>Nun wird festgelegt, bei welcher Temperatur der Lüfter auf seine maximale Drehzahl gebracht werden soll:</p><pre class="notranslate">Enter the high temperature (C)
at which the fan should be switched to full speed (60):</pre><p>
Auch hier achtet man auf die Angaben des Herstellers zur maximalen Prozessortemperatur. Man gibt am besten einen Wert an, der etwas darunter liegt.</p><p>Jetzt wird man nach der Geschwindigkeit gefragt, mit der der Lüfter beginnen soll, sich zu drehen, sobald die Minimaltemperatur, die man im ersten Schritt festgelegt hat, überschritten wird:</p><pre class="notranslate">Enter the minimum PWM value (0-255)
at which the fan STARTS spinning (press t to test) (150):</pre><p>
Man kann einen Wert von <code class="notranslate">0 (Lüfter aus)</code> bis <code class="notranslate">255 (maximale Drehzahl)</code> eingeben.</p><p>Außerdem hat man die Möglichkeit, mit der Taste 
<span class="key">T</span>  die Lüfterdrehzahl in 10er-Schritten von 0-255 zu erhöhen, bis man den entsprechenden Wert gefunden hat und mit 
<span class="key">Y</span>  bestätigt. Man sollte sich mit dem "Durchtesten" beeilen, da der Lüfter während des Testens vermutlich nicht mit der erforderlichen Drehzahl arbeitet und das im schlimmsten Fall zu einer Überhitzung führen kann.</p><p>Jetzt wird man nach der Geschwindigkeit gefragt, mit welcher der Lüfter gerade noch am Laufen ist. Dies beschreibt den Zustand, der erreicht wird, wenn von einer höheren Temperatur erfolgreich heruntergekühlt wurde:</p><pre class="notranslate">Enter the minimum PWM value (0-255)
at which the fan STOPS spinning (press t to test) (100):</pre><p>
Auch hier kann man wieder 
<span class="key">T</span>  eingeben, um die optimale Einstellung herauszufinden - nur diesmal von "maximaler Geschwindigkeit" bis "dreht sich gar nicht". Wenn der Lüfter nun aufhört sich zu drehen oder kurz davor ist, drückt man wieder 
<span class="key">Y</span> .</p><p>Man sieht nun wieder folgendes Menü:</p><pre class="notranslate">Select fan output to configure, or other action:
1) 9191-0290/pwm2      3) Just quit           5) Show configuration
2) Change INTERVAL     4) Save and quit</pre><p>
Jetzt speichert und beendet man die Konfiguration mit 
<span class="key">4</span>  + 
<span class="key">⏎</span> . Um die Drehzahl und Temperatur zu verfolgen, benutzt man LM-Sensors <sup><a href="#source-3">[3]</a></sup>.</p></div><div class="section_2"><h3 id="Autostart-einrichten">Autostart einrichten<a class="headerlink" href="#Autostart-einrichten">¶</a></h3><p>
Für Systeme mit <a class="internal" href="./systemd.html">Systemd</a> (Ubuntu 16.04 und neuer) wird der Autostart automatisch eingerichtet.</p><p>Deaktivieren lässt sich der Autostart mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl disable fancontrol </pre></div></div><p>bzw. mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl enable fancontrol </pre></div></div><p>wieder reaktivieren.</p><div class="section_3"><h4 id="Ubuntu-14-04">Ubuntu 14.04<a class="headerlink" href="#Ubuntu-14-04">¶</a></h4><p>
Ist kein Systemd vorhanden (mittlerweile nur noch bei Ubuntu 14.04 relevant), verwendet man die Datei <a class="internal" href="./rc.local.html">/etc/rc.local</a>. Dabei spielt es keine Rolle, ob es sich um einen klassischen Dienst, ein alleinstehendes Programm oder ein Skript handelt.</p><p>Die entsprechende Zeile für <strong>/etc/rc.local</strong> lautet also:
</p><pre class="notranslate">fancontrol     </pre><p>
Hinweis: Der Befehl ist zwischen "# By default this script does nothing." und " exit 0" einzutragen.</p></div></div><div class="section_2"><h3 id="Drehzahl-beim-Beenden-der-Steuerung">Drehzahl beim Beenden der Steuerung<a class="headerlink" href="#Drehzahl-beim-Beenden-der-Steuerung">¶</a></h3><p>
Beim Beenden der Lüftersteuerung, z.B. wenn der Computer herunter gefahren wird, kann es auf einigen Systemen vorkommen, dass der Lüfter dann mit voller Drehzahl betrieben wird. Um dies zu unterbinden, kann man am Skript selber eine kleine Anpassung vornehmen. Dazu öffnet man mit einem Editor die Datei <strong>/usr/sbin/fancontrol</strong> und kommentiert in der Methode <em>restorefans()</em> die Zeile mit dem Eintrag <em>pwmdisable $pwmo</em> aus und fügt anschließend eine neue Zeile ein:</p><pre class="notranslate">echo `expr ${AFCMAXPWM[$fcvcount]} - 25` &gt; $pwmo</pre><p>
Sie bewirkt, dass der Lüfter beim Beenden der Lüftersteuerung mit dem in der <strong>/etc/fancontrol</strong> angegebenen Maximalwert minus 25 angesteuert wird.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Hierbei ist unbedingt zu beachten, dass auch mit dieser Einstellung die Komponenten immer noch genügend gekühlt werden müssen! Wird der Wert zu gering gesetzt, so kann es zur Beschädigung der Hardware führen! Dieses ist daher vorher für die eigene Hardware individuell zu ermitteln und zu testen. 
</p></div></div></div><div class="section_2"><h3 id="Luefter-werden-nach-Ruhezustand-Energiesparmodus-nicht-mehr-angesteuert">Lüfter werden nach Ruhezustand/Energiesparmodus nicht mehr angesteuert<a class="headerlink" href="#Luefter-werden-nach-Ruhezustand-Energiesparmodus-nicht-mehr-angesteuert">¶</a></h3><p>
Nach einem Aufwecken aus dem Energiesparmodus oder Ruhezustand kann es auf einigen System vorkommen, dass die Lüfter nicht mehr auf eine manuelle Steuerung konfiguriert sind. Hier kann es sinnvoll sein, das Script dahingehend anzupassen, dass die Lüfter neu initialisiert werden, wenn fancontrol längere Zeit pausiert wurde. Dafür mit einem Editor <strong>/usr/sbin/fancontrol</strong> bearbeiten:</p><pre class="notranslate">echo 'Starting automatic fan control...'

# main loop calling the main function at specified intervals
while true
do	
	UpdateFanSpeeds
	# Sleep while still handling signals
	sleep $INTERVAL &amp;
	wait
done</pre><p>Dafür die oberen Zeilen gegen die unteren austauschen.</p><pre class="notranslate">echo 'Starting automatic fan control...'

TICK_LAST=$(date +%s)

# main loop calling the main function at specified intervals
while true
do
	TICK_NOW=$(date +%s)
	
	if [ $(($TICK_NOW - $TICK_LAST)) -ge $(($INTERVAL * 5)) ];then
		
		echo 'fancontrol was paused for about '$(($TICK_NOW - $TICK_LAST))' seconds! (Hibernation, suspend or freeze?)'
		echo 'Re-enabling PWM on fans to be on the safe side...'
		
		let fcvcount=0
		while (( $fcvcount &lt; ${#AFCPWM[@]} )) # go through all pwm outputs
		do
			pwmo=${AFCPWM[$fcvcount]}
			pwmenable $pwmo
			if [ $? -ne 0 ]
			then
				echo "Error enabling PWM on $DIR/$pwmo" &gt;&amp;2
				restorefans 1
			fi
			let fcvcount=$fcvcount+1
		done
	fi

	TICK_LAST=$TICK_NOW
	
	UpdateFanSpeeds
	# Sleep while still handling signals
	sleep $INTERVAL &amp;
	wait
done</pre><p>Zur Erklärung: In jedem Intervall wird die aktuelle Zeit mit der des letzten Zyklus verglichen. Ist der letzte Zyklus länger als Intervall * 5 Sekunden her, so ist davon auszugehen, dass das System pausiert wurde und die Lüfter werden neu initialisiert.</p><p></p></div></div></div>
<p class="meta">
<a href="./lüftersteuerung/a/revision/946114.html">Diese Revision</a> wurde am 8. Januar 2018 12:28 von <a href="https://ubuntuusers.de/user/RabbidPinguin/">RabbidPinguin</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./lüftersteuerung.html">Lüftersteuerung</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>