<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>NFS › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./nfs.html">NFS</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/NFS">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./nfs/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./nfs/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./nfs/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./nfs/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./nfs/a/backlinks.html">NFS</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./fstab.html">fstab</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Einsatzszenario">Einsatzszenario
</a></li><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Freigaben">Freigaben
</a><ol class="arabic"><li><a class="crosslink" href="#Zugriffskontrolle">Zugriffskontrolle
</a></li></ol></li><li><a class="crosslink" href="#Auf-Freigaben-zugreifen">Auf Freigaben zugreifen
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a><ol class="arabic"><li><a class="crosslink" href="#Verzoegerung-beim-Shutdown">Verzögerung beim Shutdown
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#Intern">Intern
</a></li><li><a class="crosslink" href="#Extern">Extern
</a></li></ol></li></ol></div><p><img alt="Wiki/Icons/service.png" class="image-left" src="./_/afb6c1869d3e3412cb022363511bce77dccf937a.png"/>
<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Network_File_System">NFS</a> (Network File System) ist ein stabiles und gut funktionierendes Netzwerk-Protokoll von Sun, um Dateien über das lokale Netzwerk auszutauschen. Prinzipiell würde es auch über das Internet funktionieren, was aber aus Sicherheitsgründen nicht zu empfehlen ist. NFS ist im Prinzip das *NIX-Pendant zu <a class="internal" href="./samba.html">SMB</a> aus der Windows-Welt.</p><p>Dieser Artikel beschäftigt sich hauptsächlich mit den NFS-Versionen 2 und 3. Einen separaten Artikel zur Version4 gibt es hier: <a class="internal" href="./nfsv4.html">NFSv4</a></p><div class="section_1"><h2 id="Einsatzszenario">Einsatzszenario<a class="headerlink" href="#Einsatzszenario">¶</a></h2><p>
NFS setzt für einen reibungslosen und sicheren Betrieb voraus, dass</p><ol class="arabic"><li><p>alle Benutzer im Netzwerk eindeutige <a class="internal" href="./benutzer_und_gruppen.html#Nummerierung-der-UID-GID">UIDs</a> haben und</p></li><li><p>alle Rechner im Netzwerk zentral administriert werden</p></li></ol><p>
Die Rechner müssen also so konfiguriert werden, dass jeder Benutzer netzweit seine eigene feste, numerische UID erhält, die auf allen Rechnern dann gleich ist. Bei größeren Netzwerken stellt man das mit einem <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol">LDAP</a>- oder <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Network_Information_Service">NIS</a>-Server sicher. Die Zugriffskontrolle auf die einzelnen Dateien geschieht dann auf dem Server über das reguläre Dateiberechtigungssystem.</p><p>Wenn die Benutzer Root-Rechte auf ihren eigenen Rechnern haben bzw. ihre eigenen Notebooks ins Netz einbinden dürfen, können sie das aber umgehen und sich auf ihren Rechnern beliebige UIDs besorgen, die vom NFS-Server auch nicht weiter getestet werden. In diesem Fall muss dann entweder ein zusätzliches Sicherheitsprotokoll wie <a class="internal" href="./kerberos/nfs_mit_kerberos_sichern.html">Kerberos</a> (erst ab <a class="internal" href="./nfsv4.html">NFSv4</a> möglich) zum Einsatz kommen (nicht-trivial), oder <a class="internal" href="./samba.html">Samba</a> benutzt werden (langsamer).</p></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Sollte NFS noch nicht vorhanden sein, lässt es sich sehr schnell installieren. Folgende Pakete und deren Abhängigkeiten müssen über die Paketverwaltung <sup><a href="#source-1">[1]</a></sup> installiert werden:</p><p>Wenn der Rechner als Server dienen soll, der Dateien bereitstellt:</p><ul><li><p><strong>nfs-kernel-server</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nfs-kernel-server </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nfs-kernel-server </pre></div></div><p>
</p></div></div><p>
Wenn der Rechner nur als Client agieren soll, der auf andere Freigaben zugreift:</p><ul><li><p><strong>nfs-common</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nfs-common </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nfs-common </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Freigaben">Freigaben<a class="headerlink" href="#Freigaben">¶</a></h2><p>
Die Freigaben von Verzeichnissen und Dateien auf dem Server lassen sich durch direkte Bearbeitung der Datei <strong>/etc/exports</strong> verwalten. Dazu muss diese Datei angelegt und/oder bearbeitet werden <sup><a href="#source-3">[3]</a></sup>. Die Freigabe eines Verzeichnisses lässt sich mit einer Zeile nach folgendem Muster anlegen:</p><pre class="notranslate">PFAD  COMPUTERNAME (OPTION(EN))</pre><p>Hier sind einige Beispiele:</p><pre class="notranslate"># freigabe1 wird für zwei Rechner freigegeben
# notebook darf nur lesen (ro)
# desktop darf lesen und schreiben (rw)
/PFAD/ZUR/FREIGABE1      notebook(ro,async) desktop(rw,async)</pre><p>Alternativ kann die IP-Adresse angegeben werden:</p><pre class="notranslate"># Freigabe gilt nur für 192.168.1.13, jedoch nur mit Leserechten:
/PFAD/ZUR/FREIGABE2      192.168.1.13(ro,async)
# Freigabe gilt für alle IPs von 192.168.1.1 bis 192.168.1.255, mit Lese-/Schreibrechten:
/PFAD/ZUR/FREIGABE3       192.168.1.0/255.255.255.0(rw,async)
# Freigabe gilt nur für den Rechner mit dem Namen notebook
/PFAD/ZUR/FREIGABE4      notebook(ro,async)</pre><p>Die Parameter in den Klammern lauten:</p><p>
</p><table><tr class="titel"><td colspan="3">Optionen in der /etc/exports </td></tr><tr class="kopf"><td> Option </td><td> Beschreibung </td><td> default </td></tr><tr><td> <code class="notranslate">rw</code> </td><td> Lesen und Schreiben </td><td> - </td></tr><tr><td> <code class="notranslate">ro</code> </td><td> nur Lesen </td><td> X </td></tr><tr><td> <code class="notranslate">sync</code> </td><td> Synchroner Datentransfer </td><td> X* </td></tr><tr><td> <code class="notranslate">async</code> </td><td> Asynchroner Datentransfer. In der Regel führt diese Option zu einer Leistungsverbesserung auf Kosten möglicher Datenverluste durch Server-Abstürze bzw. Neustarts. Bis nfs-utils 1.0.0 war die Option 'async' standardmäßig aktiviert. </td><td> -* </td></tr><tr><td> <code class="notranslate">wdelay</code> </td><td> Diese Option hat nur im Zusammenhang mit 'sync' einen Effekt, siehe 'no_wdelay'. </td><td> X </td></tr><tr><td> <code class="notranslate">no_wdelay</code> </td><td> Diese Option hat nur im Zusammenhang mit 'sync' einen Effekt. Ein NFS-Server würde normalerweise einen Schreibzugriff auf die Platte etwas verschieben, wenn er davon ausgeht, dass ein anderer, verwandter Schreibzugriff gerade oder bald ankommt. Das ermöglicht es, mehrere Schreibzugriffe in einem Abwasch zu erledigen, was den Durchsatz erhöhen kann. Wenn ein NFS-Server hauptsächlich kleine und nicht zusammengehörige Schreibaufträge erhält, kann dieses Verfahren aber stören und die Leistung verringern. Für diesen Fall ist die Option gedacht, um es auszuschalten. Standardmäßig ist 'wdelay' aktiviert. </td><td> - </td></tr><tr><td> <code class="notranslate">secure</code> </td><td> Ports oberhalb 1024 nicht verwenden. </td><td> X </td></tr><tr><td> <code class="notranslate">insecure</code> </td><td> Ports oberhalb 1024 auch verwenden. </td><td> - </td></tr><tr><td> <code class="notranslate">hide</code> </td><td> "Platzhalter" </td><td> X </td></tr><tr><td> <code class="notranslate">nohide</code> </td><td> Wenn unterhalb eines exportierten Verzeichnisses (z.B. <strong>/home/user</strong> auf <strong>/dev/hda1</strong>) ein weiteres Dateisystem eingebunden wurde (z.B. <strong>/dev/hdb1</strong> in <strong>/home/user/Musik</strong>), so wird dieses Verzeichnis durch einen eigenen exports-Eintrag exportiert. Im Normalfall (Option <code class="notranslate">hide</code>) sieht der Client dieses Unterverzeichnis nicht, wenn er nur das Oberverzeichnis einbindet, weswegen er beide einbinden muss. Durch die Option <code class="notranslate">nohide</code> (im Export des übergeordneten Verzeichnisses) werden die eingebundenen Unterverzeichnisse dem Client nicht mehr als eigene Partitionen präsentiert, sondern als normale, zum Oberverzeichnis gehörende Verzeichnisse. Daher muss man zwar am Server noch alles explizit exportieren, am Client aber nur noch das übergeordnete Verzeichnis einbinden. Die Option <code class="notranslate">nohide</code> funktioniert nur, wenn die Client-Angabe ein festgelegter Rechner ist. Bei Wildcards oder ganzen IP-Bereichen klappt das nicht, dort könnte die Option <code class="notranslate">crossmnt</code> zum gewünschten Erfolg führen. </td><td> - </td></tr><tr><td> <code class="notranslate">crossmnt</code> </td><td> Diese Option ist so ähnlich wie <code class="notranslate">nohide</code>. Die Option <code class="notranslate">crossmnt</code> ermöglicht es, dass Clients auf exportierte Dateisysteme innerhalb der Freigabe zugreifen können. Wenn ein Kind-Dateisystem "B" auf einem übergeordneten "A" aktiviert ("mount") wird, hat die Einstellung crossmnt auf "A" den gleichen Effekt wie die Einstellung <code class="notranslate">nohide</code> auf B. Wie bei <code class="notranslate">nohide</code> muss auch hier jedes Kind-Dateisystem "B" explizit exportiert werden.  </td><td> - </td></tr><tr><td> <code class="notranslate">subtree_check</code> </td><td> Wenn nur einzelne Verzeichnisse eines Dateisystems freigegeben wurden, wird hiermit überprüft, ob eine vom Client angeforderte Datei in diesen Verzeichnissen des Dateisystems ist. Wurde das gesamte Dateisystem freigegeben, werden die Übertragungsgeschwindigkeiten beim Deaktivieren mittels <code class="notranslate">no_subtree_check</code> erhöht. Darüber hinaus stellt diese Option sicher, dass beim Einbinden eines NFS-Verzeichnisses mittels 'root_squash' alle Dateien, die dem user 'root' gehören, nicht abrufbar sind (selbst wenn die Datei-Rechte dies vorsehen).<br/> Diese Option kann jedoch Probleme verursachen, insbesondere wenn Dateien umbenannt werden, die auf dem Client gerade geöffnet sind. </td><td> -* </td></tr><tr><td> <code class="notranslate">no_subtree_check</code> </td><td> Diese Option schaltet die Überprüfung von Unterverzeichnisbäumen ab. Das hat zwar eine leichte Verringerung der Sicherheit zur Folge, kann aber die Verlässlichkeit unter Umständen erhöhen. Wenn ein Unterverzeichnis eines Dateisystems freigegeben (exportiert) wird, aber das ganze Dateisystem nicht, muss der NFS Server jedesmal, wenn er eine Anfrage bekommt, nicht nur überprüfen, ob die gewünschte Datei in dem Dateisystem liegt (einfach), sondern auch, ob sie tatsächlich in dem Unterverzeichnis liegt (schwieriger). Diese Überprüfung wird "subtree_check" genannt. Um diese Überprüfung durchzuführen, muss der Server einige Informationen über die Position der Datei im Dateisystem im Datei-Objekt ("file handle") integrieren, die an den Client weitergegeben wird. Das kann zu Problemen beim Zugriff auf Dateien führen, die umbenannt werden, während sie noch von einem Client geöffnet sind (obwohl es in vielen einfachen Fällen weiter funktioniert). Subtree_checking wird auch benutzt, um sicherzustellen, dass Dateien in Verzeichnissen auf die nur root Zugriff hat, nur zugreifbar sind, wenn das Dateisystem mit der <code class="notranslate">no_root_squash</code>-Option (siehe unten) exportiert wurde, auch wenn die Datei selbst weniger restriktive Zugriffsmodi hat. Als genereller Hinweis mag gelten, dass ein Home-Verzeichnis-Dateibaum, der normalerweise von seiner Wurzel aus exportiert wird und auf dem häufig Dateien umbenannt werden, ohne "subtree_checking" exportiert werden sollte. Ein Dateisystem, das größtenteils nur lesbar ("read only") ist und auf dem zumindest selten Dateien umbenannt werden (z.B. <strong>/usr</strong> oder <strong>/var</strong>) und aus dem Unterverzeichnisse exportiert werden, sollte mit "subtree_checking" versehen werden. </td><td> X* </td></tr><tr><td> <code class="notranslate">insecure_locks</code> <code class="notranslate">no_auth_nlm</code> </td><td> Diese Option (die beiden sind Synonyme) weist den NFS-Server an, bei Dateisperranfragen ("locking", z.B. Nachfragen, die das NLM-Protokoll benutzen) keine Authentifizierung zu verlangen. Normalerweise würde der NFS-Server einen Sperrmechanismus verlangen, um einen Berechtigungsnachweis für Nutzer zu verwalten, die Lesezugriff auf die Datei haben. Mit dieser Option werden keine Zugriffsüberprüfungen gemacht.<br/> Alte NFS-Client-Implementationen haben keine Berechtigungsnachweise zusammen mit Sperrnachfragen verschickt, und es gibt viele NFS-Clients, die auf diesen alten Architekturen basieren. Diese Option sollte also benutzt werden, wenn auffällt, dass nur Dateien gesperrt werden können, die von allen Nutzern lesbar sind. Die voreingestellte Option, Authentifizierung für NLM-Nachfragen zu verlangen, kann explizit mit einem der Synonymen <code class="notranslate">auth_nlm</code> oder <code class="notranslate">secure_locks</code> angegeben werden. </td><td> - </td></tr><tr class="kopf"><td colspan="3">Optionen zum UID/GID-Mapping in der <strong>/etc/exports</strong> </td></tr><tr><td> <code class="notranslate">root_squash</code> </td><td> Weist alle Anfragen der UID/GID 0 auf die UID/GID anonymous zu. Zu beachten ist, dass damit andere sensible bzw. mächtige UserIDs wie etwa "<code class="notranslate">bin</code>" oder "<code class="notranslate">staff</code>" nicht geändert werden. </td><td> X </td></tr><tr><td> <code class="notranslate">no_root_squash</code> </td><td> Bindet man per NFS-Verzeichnisse ein, die auf dem Server dem Nutzer <code class="notranslate">root</code> gehören, werden diese standardmäßig dem Nutzer <code class="notranslate">nobody</code> zugeordnet, und man kann diese nicht modifizieren. Um dieses Sicherheitsmerkmal zu umgehen, dient der Parameter 'no_root_squash' (weitere Informationen erhält man mittels <code class="notranslate">man 5 exports</code>). Das bedeutet, 'no_root_squash' verhindert eine Zuordnung ("mapping") der vom Nutzer <code class="notranslate">root</code> geschriebenen Dateien und Verzeichnisse auf einen anderen Nutzer. UID und GID 0 werden erhalten. </td><td> - </td></tr><tr><td> <code class="notranslate">all_squash</code> </td><td> Ordnet alle UserIDs dem Nutzer <code class="notranslate">anonymous</code> zu. Nützlich für NFS-exportierte öffentliche FTP-Verzeichnisse oder News-Spool-Verzeichnisse. </td><td> - </td></tr><tr><td> <code class="notranslate">anonuid</code> <code class="notranslate">anongid</code> </td><td> Diese Option setzt die anonyme User- und Gruppen-ID explizit auf die angegebenen Werte. Diese Option ist primär für PC/NFS Clients gedacht, wo davon ausgegangen wird, dass alle Nachfragen von einem bestimmten Rechner immer von einer Person kommen. Beispiel: <code class="notranslate">/home/joe   pc001(rw,all_squash,anonuid=150,anongid=100)</code> </td></tr></table><p>*: default Einstellung seit nfs-utils 1.0.1</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
</p><ul><li><p>Zwischen Freigabe und der Parameterklammer darf kein Leerzeichen stehen: z.B. </p><ul><li><p><code class="notranslate">192.168.1.13(ro,async)</code> und <span class="underline">nicht</span> </p></li><li><p><code class="notranslate">192.168.1.13 (ro,async)</code></p></li></ul></li></ul><p>
</p><ul><li><p><code class="notranslate">insecure</code> sollte nur verwendet werden, wenn es unbedingt notwendig ist, da dann auch die unsicheren Ports verwendet werden. Leider verwendet Mac OS X von Apple diese Ports für NFS-Verbindungen. Ein aktueller Apple-Computer kann sich nur dann mit dem NFS-Server verbinden, wenn die Option <code class="notranslate">insecure</code> gesetzt ist. </p></li></ul><p>
</p><ul><li><p>bei <code class="notranslate">nohide</code> sollte man beachten, dass es dadurch passieren kann, dass verschiedene Dateien, welche auf unterschiedlichen Partitionen bzw. Dateisystemen die gleiche Inode-Nummer haben, im aktivierten ("mounted") übergeordneten Verzeichnis die gleiche Inode-Nummer auf demselben (NFS-)Dateisystem haben; manche Treiber verkraften das nicht. Ggf. führt es beim Client zu einer Kernel Panic, wenn gleichzeitig lesend und schreibend auf den Server zugegriffen wird.  </p></li></ul><p>Beispiel:</p><p>NFS-Freigabe für Verzeichnis <strong>/media</strong> für eine VirtualBox  (auf Servern sollte man das Verzeichnis <strong>/media</strong>  nicht mounten, da sich dort ja auch Wechseldatenträger automatisch einhängen und von anderen auch darauf zugegriffen werden könnte): </p><pre class="notranslate">/media 192.168.56.0/24(rw,async,insecure,no_subtree_check,crossmnt)</pre><p> Die Option <code class="notranslate">crossmnt</code> sorgt dafür, dass der Client auch auf die eingehängten Dateisysteme unterhalb des Verzeichnisses <strong>/media</strong> zugreifen kann, z.B.: <strong>/media/Win7</strong>, <strong>/media/SD-Karte</strong>, <strong>/media/CD</strong> usw.
</p></div></div><p>Damit sich der Rechner <code class="notranslate">notebook</code> auch zu der Freigabe <strong>/PFAD/ZUR/FREIGABE3</strong> verbinden kann, muss er mit der IP-Adresse in der Datei <strong>/etc/hosts</strong> <sup><a href="#source-3">[3]</a></sup> stehen. Die Datei muss wie folgt aufgebaut sein:</p><pre class="notranslate">IP  COMPUTERNAME COMPUTERNAME.DOMAIN.tld</pre><p>z.B.:</p><pre class="notranslate">  192.168.1.12 notebook notebook.meinedomain.local
  192.168.1.13 desktop desktop.meinedomain.local</pre><p>Nun muss dem NFS-Server im Terminal <sup><a href="#source-2">[2]</a></sup> nur angewiesen werden, <strong>/etc/exports</strong> neu einzulesen.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo exportfs -ra </pre></div></div><p>Alternativ kann der gesamte NFS-Server neu gestartet werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/nfs-kernel-server restart </pre></div></div><p>Die eventuell auftauchende Warnung <em>"exportfs: No options for..."</em> kann ignoriert werden.</p><p>Die exportierten Freigaben können nun per <code class="notranslate">showmount</code> von einem Client abgefragt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">showmount -e NFS_SERVER </pre></div></div><p>
<code class="notranslate">NFS_SERVER</code> steht hierbei natürlich für den Namen oder Adresse des NFS-Servers</p><p><a class="crosslink anchor" href="#ACL" id="ACL"></a>
</p><div class="section_2"><h3 id="Zugriffskontrolle">Zugriffskontrolle<a class="headerlink" href="#Zugriffskontrolle">¶</a></h3><p>
Der NFS-Server beachtet die Zugriffsbeschränkungen, die durch die Dateien <strong>/etc/hosts.allow</strong> und <strong>/etc/hosts.deny</strong> beschrieben werden (siehe auch <a class="internal" href="./inetd.html">inetd#tcpwrapper</a> und <code class="notranslate">man hosts_access</code>).</p><p>Falls man diese Art der Zugriffskontrolle (zusätzlich zu der aus <strong>/etc/exports</strong>) verwenden will, sind folgende Einträge vorzunehmen (für den Fall, dass diese Dateien noch nicht existieren, kann man sie einfach selber anlegen):</p><p>In der <strong>/etc/hosts.deny</strong>:
</p><pre class="notranslate">portmap: ALL</pre><p>Und in der <strong>/etc/hosts.allow</strong>:</p><pre class="notranslate"># falls nur die IP 192.168.1.13 Zugriff erhalten soll:
portmap: 192.168.1.13

# falls das gesamte LAN Zugriff erhalten soll:
portmap: 192.168.1.
# oder
portmap: 192.168.1.0/24</pre><p>Auf dieselbe Art sollte man dann auch den Zugriff auf den <code class="notranslate">mountd</code> und den <code class="notranslate">statd</code> beschränken. Zu beachten ist, dass für diese Dienste nur IP-Adressen in den hosts_access-Dateien funktionieren, keine Domain-Namen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Einschränkung des <code class="notranslate">statd</code> bietet sich auch auf Client-Rechnern an, insbesondere auf Notebooks, die auch mal in unsicheren Netzen unterwegs sind. Hier muss der Zugriff nur dem/den Server(n) erlaubt werden. 
</p></div></div></div></div><div class="section_1"><h2 id="Auf-Freigaben-zugreifen">Auf Freigaben zugreifen<a class="headerlink" href="#Auf-Freigaben-zugreifen">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Weil NFS vom <a class="internal" href="./gvfs-mount.html">GVFS</a> nicht unterstützt wird, können die Dateimanager <a class="internal" href="./nautilus.html">Nautilus</a>, <a class="internal" href="./thunar.html">Thunar</a> und andere nicht direkt auf NFS-Freigaben zugreifen und Netzwerke auch nicht nach NFS-Freigaben durchsuchen. Zum Durchsuchen des Netzwerks eignet sich der Befehl <code class="notranslate">showmount</code>; als Alternative bietet sich auch <a class="internal" href="./autofs.html#NFS-Freigaben-browsen">Autofs</a> an.
</p></div></div><p>
Damit der Client auf die Freigaben zugreifen kann, muss er sie einfach einbinden können. Hierzu ein Terminal öffnen <sup><a href="#source-2">[2]</a></sup> und</p><div class="bash"><div class="contents"><pre class="notranslate">cd /media
sudo mkdir MEINEFREIGABE
sudo mount ipadresse:/PFAD/ZUR/FREIGABE /media/MEINEFREIGABE </pre></div></div><p>eingeben. Im Falle einer Notebookfreigabe sieht das etwa so aus:</p><div class="bash"><div class="contents"><pre class="notranslate">cd /media
sudo mkdir server
sudo mount 192.168.1.13:/home /media/server </pre></div></div><p>Man könnte nun ein Shell-Script schreiben, das bei Aufruf eine Verbindung zum Server herstellt. (Achtung: Wenn das Verzeichnis schon erstellt wurde, braucht dieses natürlich nicht mehr erstellt zu werden.) Die zweite Möglichkeit ist, das Ganze mit Root-Rechten in die <strong>/etc/fstab</strong>-Datei<sup><a href="#source-4">[4]</a></sup> zu schreiben <sup><a href="#source-3">[3]</a></sup>.</p><p>Beispiel für den Eintrag in die <strong>/etc/fstab</strong>: 
</p><pre class="notranslate">192.168.6.13:/home /media/server nfs rw 0 0</pre><p>
</p><table><tr class="titel"><td colspan="3">Weitere Optionen in der <strong>/etc/fstab</strong> </td></tr><tr class="kopf"><td> Option </td><td> Beschreibung </td></tr><tr><td> <code class="notranslate">rw</code> </td><td> Lese- und Schreibrechte </td></tr><tr><td> <code class="notranslate">ro</code> </td><td> Nur Leserechte </td></tr><tr><td> <code class="notranslate">hard</code> </td><td> Bei Unterbrechungen ohne Timeout warten, bis der Server wieder normal erreichbar ist  </td></tr><tr><td> <code class="notranslate">soft</code> </td><td> Bei Unterbrechungen sofort einen Timeout machen (verhindert ein Einfrieren des Dateimanagers) </td></tr><tr><td> <code class="notranslate">timeo=&lt;SEKUNDEN&gt;</code> </td><td> In Verbindung mit <code class="notranslate">soft</code> kann festgelegt werden, wann der Timeout erfolgen soll. </td></tr><tr><td> <code class="notranslate">bg</code> </td><td> Bei einem Timeout wird im Hintergrund weiter versucht, das Dateisystem zu aktivieren ("mount"). Ist z.B. bei einem Laptop, das sich im Heimnetz automatisch mit einem NFS-Server verbinden soll, nützlich. </td></tr><tr><td> <code class="notranslate">intr</code> </td><td> Erlaubt einem wartenden Programm, bei Bedarf dennoch zu unterbrechen oder abzubrechen </td></tr><tr><td> <code class="notranslate">nolock</code> </td><td> Deaktiviert das Sperren von Dateien. Wird gelegentlich für die Verbindung zu alten NFS-Servern benötigt </td></tr><tr><td> <code class="notranslate">rsize=8192,wsize=8192</code> </td><td> Mit diesen beiden Optionen kann man die Blockgröße der übertragenen Daten festlegen. In den meisten Fällen ist es nicht empfehlenswert, diese Optionen zu setzen. Server und Client handeln diese Werte selbst aus und erreichen so ein Maximum an Durchsatz. <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Falsche Werte können die Geschwindigkeit von NFS um bis zu <strong>50%</strong> reduzieren.
</p></div></div> </td></tr><tr><td> <code class="notranslate">_netdev</code> </td><td> Die <code class="notranslate">_netdev</code>-Option weist das System an, solange mit dem Versuch zu warten, einen "Share" zu mounten, bis das Netzwerk erreichbar ist.  </td></tr></table><p>Weitere Optionen stehen in der <a class="internal" href="./man.html">Manpage</a> zu nfs und <a class="internal" href="./fstab.html">fstab</a>.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Portmap öffnet seinen Port standardmäßig an allen Netzwerkschnittstellen, was auf einem Client-Rechner nicht unbedingt erwünscht ist (vor allem bei Laptops, die auch in anderen Netzen unterwegs sind). Man kann das ändern, indem man einfach folgenden Befehl ausführt und die Frage, ob "Portmap" nur an "localhost" gebunden werden soll, mit einem <em>JA</em> beantwortet. Damit ist der Port von anderen Rechnern nicht mehr erreichbar.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo dpkg-reconfigure portmap  </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
Sollten beim Zugriff auf NFS-Freigaben Probleme auftreten (z.B. Fehlermeldungen der Art <em>"Permission denied"</em>, kein Schreibzugriff, scheinbar leere Ordner oder Ähnliches), so hängt dies sehr häufig mit mangelnden bzw. fehlerhaft vergebenen <a class="internal" href="./rechte.html">Rechten</a> im eingebundenen (entfernten) Dateisystem zusammen.</p><p>Weitere Hinweise hierzu finden sich vor allem unter <a class="internal" href="./mount.html#Rechte">mount -&gt; Rechte</a> sowie <a class="internal" href="./mount.html#Externe-Laufwerke-einhaengen">Externe Laufwerke einhängen</a>.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei der Freigabe von Dateien auf VFAT-Partitionen (FAT32) über NFS muss mit Problemen gerechnet werden. Als Ausweg empfiehlt sich <a class="internal" href="./samba.html">Samba</a>.
</p></div></div><div class="section_2"><h3 id="Verzoegerung-beim-Shutdown">Verzögerung beim Shutdown<a class="headerlink" href="#Verzoegerung-beim-Shutdown">¶</a></h3><p>
Bedingt durch <a class="internal" href="./systemd.html">systemd</a> können beim Shutdown erhebliche Verzögerungen auftreten, falls noch NFS- oder cifs-Freigaben gemountet sind. Im Artikel <a class="internal" href="./samba_client_cifs.html#Shutdown-und-Reboot">Samba Client cifs</a> ist ein Workaround beschrieben, der leicht für NFS-Freigaben angepasst werden kann.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="Intern">Intern<a class="headerlink" href="#Intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./nfsv4.html">NFSv4</a> - Der Wikiartikel zu NFSv4</p></li><li><p><a class="internal" href="./serverdienste.html">Serverdienste</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Übersichtsartikel</p></li><li><p><a class="internal" href="./heimnetzwerk.html">Heimnetzwerk</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Einführender Artikel; betrifft vor allem einfache Anwendungen</p></li><li><p><a class="internal" href="./autofs.html">Autofs</a> – Erlaubt auch die Auswahl ("browse") und das Einbinden von NFS-Freigaben</p></li></ul></div><div class="section_2"><h3 id="Extern">Extern<a class="headerlink" href="#Extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="http://de.linwiki.org/wiki/Linuxfibel_-_Netzwerk_Server_-_NFS_Server" rel="nofollow">NFS-Server</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> – Linuxfibel</p></li><li><p><a class="external" href="http://www.selflinux.de/selflinux/html/nfs.html" rel="nofollow">NFS</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> – Ausführliche Erklärung (für fortgeschrittene Benutzer) von Selflinux.de</p></li><li><p><a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/SettingUpNFSHowTo">SettingUpNFSHowTo</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – Eine ausführliche Anleitung (Ubuntu 14.04)</p></li><li><p><a class="interwiki interwiki-archwiki" href="https://wiki.archlinux.org/index.php/index.php/NFS#Server">NFS</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – Eintrag im Archlinux-Wiki</p></li><li><p><a class="interwiki interwiki-sourceforge2" href="http://nfs.sourceforge.net.sourceforge.net">Linux NFS faq</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – Linux NFS Overview, FAQ and HOWTO Documents. "This document assumes the reader is already familiar with generic NFS terminology"</p></li><li><p><a class="interwiki interwiki-sourceforge2" href="http://nfs.sourceforge.net/nfs-howto/ar01s07.html.sourceforge.net">NFS-HowTo - Troubleshooting</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> – Gute Hilfestellung, wenn etwas nicht funktionieren sollte! </p></li></ul><p>
</p></div></div></div>
<p class="meta">
<a href="./nfs/a/revision/945277.html">Diese Revision</a> wurde am 6. Dezember 2017 22:08 von <a href="https://ubuntuusers.de/user/BillMaier/">BillMaier</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./nfs.html">NFS</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>