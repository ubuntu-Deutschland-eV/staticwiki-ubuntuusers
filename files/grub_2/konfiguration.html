<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>GRUB_2/Konfiguration › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../grub_2/konfiguration.html">Konfiguration</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/GRUB_2/Konfiguration">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../grub_2/konfiguration/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../grub_2/konfiguration/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../grub_2/konfiguration/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../grub_2/konfiguration/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../grub_2/konfiguration/a/backlinks.html">Konfiguration</a></h1>
<div id="page"><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Änderungen an den Konfigurationsdateien von GRUB 2 können das System beschädigen, bei unsachgemäßen Einstellungen startet es ggf. nicht mehr richtig. Eine Sicherung der Dateien <strong>/etc/default/grub</strong> und des Verzeichnisses <strong>/etc/grub.d</strong> ist ratsam.
</p></div></div><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="../trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../cd-images.html#Inhalt-von-Images-lesen">Den Inhalt eines CD-Images (ISO) lesen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Die-Datei-etc-default-grub">Die Datei /etc/default/grub
</a><ol class="arabic"><li><a class="crosslink" href="#Standardvariable">Standardvariable
</a></li><li><a class="crosslink" href="#Bedeutung-der-Variablen">Bedeutung der Variablen
</a></li><li><a class="crosslink" href="#Serielle-Ausgabe">Serielle Ausgabe
</a></li><li><a class="crosslink" href="#Variable-fuer-Kernelzeilen">Variable für Kernelzeilen
</a></li><li><a class="crosslink" href="#Eigene-Variablen">Eigene Variablen
</a></li></ol></li><li><a class="crosslink" href="#Skripte-in-etc-grub-d">Skripte in /etc/grub.d
</a><ol class="arabic"><li><a class="crosslink" href="#Die-Abarbeitungs-Reihenfolge-der-Skripte">Die Abarbeitungs-Reihenfolge der Skripte...</a></li><li><a class="crosslink" href="#Standardeintraege-in-die-grub-cfg">Standardeinträge in die grub.cfg
</a></li><li><a class="crosslink" href="#Festplatten-und-Partitions-Bezeichnungen">Festplatten- und Partitions-Bezeichnunge...</a></li><li><a class="crosslink" href="#Menue-Eintraege-entfernen">Menü-Einträge entfernen
</a></li></ol></li><li><a class="crosslink" href="#Grub-Konfiguration-updaten">Grub-Konfiguration updaten
</a><ol class="arabic"><li><a class="crosslink" href="#grub-cfg-updaten">grub.cfg updaten
</a></li><li><a class="crosslink" href="#grubenv-anpassen">grubenv anpassen
</a></li></ol></li><li><a class="crosslink" href="#Grub-Menue-absichern">Grub-Menü absichern
</a><ol class="arabic"><li><a class="crosslink" href="#Vorbereitung-Schluessel">Vorbereitung Schlüssel
</a></li><li><a class="crosslink" href="#Bereitstellung-zur-Verarbeitung">Bereitstellung zur Verarbeitung
</a></li><li><a class="crosslink" href="#Menue-Eintraege-anpassen">Menü-Einträge anpassen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#Intern">Intern
</a></li><li><a class="crosslink" href="#Extern">Extern
</a></li></ol></li></ol></div><p>In den Grundeinstellungen von GRUB 2 werden bei der Ausführung von <code class="notranslate">update-grub</code> bzw. <code class="notranslate">grub-mkconfig</code> alle auf einem Computer installierten Betriebssysteme gefunden und automatisch in das Auswahlmenü aufgenommen. Eine manuelle Konfiguration von GRUB 2 ist daher normalerweise nicht notwendig.</p><p>Manuelle Anpassungen werden an der Datei <strong>/etc/default/grub</strong> (grundlegende Einstellungen) und über die Skripte im Verzeichnis <strong>/etc/grub.d</strong> (individuelle Menüeinträge, optische Anpassungen etc.) vorgenommen.</p><p>Mit dem <a class="interwiki interwiki-launchpad" href="https://launchpad.net/grub-customizer">Grub Customizer</a> existiert ein grafisches Konfigurationswerkzeug.</p><div class="section_1"><h2 id="Die-Datei-etc-default-grub">Die Datei /etc/default/grub<a class="headerlink" href="#Die-Datei-etc-default-grub">¶</a></h2><p>
</p><div class="section_2"><h3 id="Standardvariable">Standardvariable<a class="headerlink" href="#Standardvariable">¶</a></h3><p>
Die Datei <strong>/etc/default/grub</strong> ist eine Textdatei, die direkt nach der Installation in aller Regel wie folgt aussieht:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1"># If you change this file, run 'update-grub' afterwards to update</span>
<span class="c1"># /boot/grub/grub.cfg.</span>
<span class="c1"># For full documentation of the options in this file, see:</span>
<span class="c1">#   info -f grub -n 'Simple configuration'</span>

<span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="m">0</span>
<span class="nv">GRUB_HIDDEN_TIMEOUT</span><span class="o">=</span><span class="m">0</span>
<span class="nv">GRUB_HIDDEN_TIMEOUT_QUIET</span><span class="o">=</span><span class="nb">true</span>
<span class="nv">GRUB_TIMEOUT</span><span class="o">=</span><span class="m">10</span>
<span class="nv">GRUB_DISTRIBUTOR</span><span class="o">=</span><span class="sb">`</span>lsb_release -i -s <span class="m">2</span>&gt; /dev/null <span class="o">||</span> <span class="nb">echo</span> Debian<span class="sb">`</span>
<span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">"quiet splash"</span>
<span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">""</span>

<span class="c1"># Uncomment to disable graphical terminal (grub-pc only)</span>
<span class="c1">#GRUB_TERMINAL=console</span>

<span class="c1"># The resolution used on graphical terminal</span>
<span class="c1"># note that you can use only modes which your graphic card supports via VBE</span>
<span class="c1"># you can see them in real GRUB with the command `vbeinfo'</span>
<span class="c1">#GRUB_GFXMODE=640x480</span>

<span class="c1"># Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to Linux</span>
<span class="c1">#GRUB_DISABLE_LINUX_UUID="true"</span>

<span class="c1"># Uncomment to disable generation of recovery mode menu entrys</span>
<span class="c1">## Bis GRUB 1.98</span>
<span class="c1">#GRUB_DISABLE_LINUX_RECOVERY="true"</span>
<span class="c1">## Ab GRUB 1.99</span>
<span class="c1">#GRUB_DISABLE_RECOVERY="true"</span>

<span class="c1"># Uncomment to get a beep at grub start</span>
<span class="c1">#GRUB_INIT_TUNE="480 440 1"</span>
</pre></div>
</td></tr></table></div><p>Die rosa Textzeilen stellen aktive Einstellungen dar. Mittels der <code class="notranslate">#</code> werden Einstellungen auskommentiert und damit deaktiviert.</p><p>Weiterhin ist zu beachten, dass manche für die Durchreichung durch GRUB bestimmte Zeichen wie z.B. '$' gleich doppelt maskiert werden müssen. So kann man als Beispiel dafür einen defekten RAM-Bereich umschiffen<a class="footnote" href="#fn-1" id="bfn-1"><span class="paren">[</span>1<span class="paren">]</span></a> mit:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">"memmap=128M\\\$0xA0000000"</span>
</pre></div>
</td></tr></table></div><p>Diese Datei ist in einem Editor <sup><a href="#source-3">[3]</a></sup> mit <a class="internal" href="../sudo.html">Rootrechten</a> zu bearbeiten. Im Standard-Ubuntu (Editor <a class="internal" href="../gedit.html">gedit</a>) führt man dafür folgendes Kommando aus, wobei in neueren Ubuntu-Versionen zunächst <a class="internal" href="../sudo.html#Installation">gksudo nachinstalliert</a> werden muss:</p><div class="bash"><div class="contents"><pre class="notranslate">gksudo gedit /etc/default/grub </pre></div></div><p>In Kubuntu heißt es:
</p><div class="bash"><div class="contents"><pre class="notranslate">kdesudo kate /etc/default/grub </pre></div></div><p>Es wird empfohlen, folgende Änderung im obigen Bereich der Zeilen <strong>6</strong> bis <strong>9</strong> ausführen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="m">0</span>
<span class="c1"># GRUB_HIDDEN_TIMEOUT=0</span>
<span class="c1"># GRUB_HIDDEN_TIMEOUT_QUIET=true</span>
<span class="nv">GRUB_TIMEOUT</span><span class="o">=</span><span class="m">5</span>
<span class="nv">GRUB_TIMEOUT_STYLE</span><span class="o">=</span>menu
</pre></div>
</td></tr></table></div></div><div class="section_2"><h3 id="Bedeutung-der-Variablen">Bedeutung der Variablen<a class="headerlink" href="#Bedeutung-der-Variablen">¶</a></h3><p>
Mit der Eingabe in ein Terminal <sup><a href="#source-1">[1]</a></sup> von
</p><div class="bash"><div class="contents"><pre class="notranslate">info -f grub -n 'Simple configuration' </pre></div></div><p>
erhält man eine Übersicht <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>, die nachfolgend übersetzt wiedergegeben wird:</p><p>
</p><table style="width: 95%"><tr class="titel"><td colspan="3"> Variable in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td><td style="text-align: center"> Bedeutung </td></tr><tr><td rowspan="3" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DEFAULT=</code> </td><td style="text-align: left; vertical-align: top"> Zahl </td><td style="text-align: left; vertical-align: top"> Gibt an, welcher Eintrag im Menü standardmäßig hervorgehoben wird. Dieser Eintrag wird geladen, falls keine andere Auswahl getroffen wird. Die Zählung beginnt mit 0. Der dritte Eintrag im Menü würde also durch eine <strong>2</strong> hervorgehoben. Diese Vorgabe ist statisch. </td></tr><tr><td style="text-align: left; vertical-align: top"> "<code class="notranslate">xxx</code>"  </td><td style="text-align: left; vertical-align: top">Wählt den Eintrag mit der exakten Bezeichnung, z.B. <code class="notranslate">Previous Linux versions&gt;Ubuntu, with Linux 3.8.0-30-generic</code> bzw. entsprechend lokalisiert, als Standard aus. Diese Vorgabe ist statisch. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">saved</code> </td><td style="text-align: left; vertical-align: top"> Trägt man anstelle eines Zahlenwertes (siehe Kasten oben) den Wert <code class="notranslate">saved</code> ein, so wird Grub veranlasst, den in <strong>/boot/grub/grubenv</strong> gespeicherten Menüeintrag auszulesen und als Vorgabe zu verwenden, unabhängig davon, ob die Reihenfolge inzwischen durch ein Kernel-Update oder durch eigene Skripte verändert wurde. Siehe auch nächsten Kasten <code class="notranslate">GRUB_SAVEDEFAULT</code>. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_SAVEDEFAULT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td><td style="text-align: left; vertical-align: top"> Wird diese Variable mit <code class="notranslate">true</code> nachgetragen, so wird für alle mit <strong>10_linux</strong> ausgewählten Kerneleinträge aus dem Verzeichnis <strong>/boot</strong> die Möglichkeit geschaffen, den mittels der Tasten 
<span class="key">↓</span>  bzw. 
<span class="key">↑</span>  ausgewählten und mit 
<span class="key">⏎</span>  bestätigten Menüeintrag als Vorgabe für den nächsten Start abzuspeichern. Es muss <code class="notranslate">GRUB_DEFAULT=saved</code> gesetzt sein, damit dieses ausgewertet wird (siehe Kasten oben und die Hinweise unter <a class="crosslink" href="#grubenv-anpassen">grubenv</a>). <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Das Abspeichern funktioniert aus Sicherheitsgründen nicht auf einem RAID-Verbund, einem <a class="internal" href="../lvm.html">LVM</a>-Dateisystem, einem <a class="internal" href="../btrfs.html">Btrfs</a>-Dateisystem oder einem <a class="internal" href="../zfs.html">ZFS</a>-Dateisystem (siehe <a class="external" href="https://www.gnu.org/software/grub/manual/grub.html#Environment-block" rel="nofollow">GNU GRUB MANUAL</a>).
</p></div></div> </td></tr><tr><td rowspan="2" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> </td><td rowspan="2" style="text-align: left; vertical-align: top"> Zahl </td><td style="text-align: left; vertical-align: top"> Diese Funktion sollte mit einer vorangestellten Raute (<code class="notranslate">#</code>) anstelle einem Wert <code class="notranslate">= 0</code> (Null) unwirksam gemacht werden. <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Wurde <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> aktiviert, so kann <span class="underline">nur</span> mit gedrückter Umschalt-Taste 
<span class="key">⇧</span>  während des Einschaltvorganges das Boot-Menü sichtbar gemacht werden, wenn <span class="underline">auch</span> gleichzeitig  <code class="notranslate">GRUB_DISABLE_OS_PROBER=true</code> gesetzt wurde! Siehe die Hinweise unter <a class="crosslink" href="#Skript-30-os-prober">Skript 30_os-prober</a>.
</p></div></div> Ein Zahlenwert &gt; 0 gibt die Zeit in Sekunden an, bis der Bootvorgang <span class="underline">ohne</span> Anzeige des Auswahlmenü ausgeführt wird. Mit der Umschalt-Taste kann das Auswahlmenü innerhalb der eingestellten Zeitspanne sichtbar gemacht werden. </td></tr><tr><td style="text-align: left; vertical-align: top"> <div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Für ein korrektes Arbeiten dieser Funktion muss der Wert <code class="notranslate">GRUB_TIMEOUT=0</code> (Null) gesetzt sein!
</p></div></div> <div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Entfällt zukünftig zugunsten GRUB_TIMEOUT_STYLE
</p></div></div> </td></tr><tr><td rowspan="2" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_HIDDEN_TIMEOUT_QUIET=</code> </td><td rowspan="2" style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td><td style="text-align: left; vertical-align: top"> Wenn dieser Wert auf ´false´ gesetzt, so wird nur der unter <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> eingestellte Wert auf dem Monitor als <code class="notranslate">Countdown</code> angezeigt. Mit der 
<span class="key">⇧</span> -Taste kann das Auswahlmenü innerhalb der Zeitspanne sichtbar gemacht werden. </td></tr><tr><td style="text-align: left; vertical-align: top"> <div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Entfällt zukünftig zugunsten GRUB_TIMEOUT_STYLE
</p></div></div> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_RECORDFAIL_TIMEOUT=</code> </td><td style="text-align: left; vertical-align: top"> Zahl </td><td style="text-align: left; vertical-align: top"> Ein Zahlenwert gibt die Zeit in Sekunden an, wie lange das Auswahlmenü angezeigt wird, wenn es beim Start ein Problem gibt. Im Normalfall fehlt dieser Eintrag, was dazu führt, dass im Falle eines Fehlers das Auswahlmenü unbegrenzt erscheint und auf die Auswahl durch den Benutzer gewartet wird. Bei Servern ist das in der Regel ein Problem, da beispielsweise bei einem Stromausfall oder einem Systemfehler kein automatischer Boot-Up mehr durchgeführt wird, sondern der Boot-Up im Grub-2 Auswahlmenü hängen bleibt. Diese Variable wird im Skript 00_header ausgewertet. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_TIMEOUT=</code> </td><td style="text-align: left; vertical-align: top"> Zahl </td><td style="text-align: left; vertical-align: top"> Ein Zahlenwert gibt die Zeit in Sekunden an, wie lange das Auswahlmenü angezeigt wird, bevor der Standard-Eintrag geladen wird. Bei <code class="notranslate">0</code> wird direkt der unter <code class="notranslate">GRUB_DEFAULT</code> eingestellte Eintrag geladen, ohne dass das Auswahlmenü angezeigt wird, bei <code class="notranslate">-1</code> wird der Zähler abgeschaltet und man muss den zu ladenden Eintrag immer von Hand wählen.  Wurde <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> aktiviert, ist diese Funktion solange wirkungslos, bis <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> mit der Umschalt-Taste deaktiviert wird. </td></tr><tr><td rowspan="3" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_TIMEOUT_STYLE=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">menu</code> </td><td style="text-align: left; vertical-align: top"> Ohne Eintrag oder mit dem Eintrag <code class="notranslate">menu</code> wird das GRUB_2-Menü auch dann angezeigt, wenn kein zweites Betriebssystem (Windows / Linux) gefunden wurde. Das System wird mit der Auswahl (
<span class="key">↓</span> /
<span class="key">↑</span>  + 
<span class="key">⏎</span>  oder nach Ablauf der mit <code class="notranslate">GRUB_TIMEOUT</code> eingestelltem Zeit gestartet. <div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Werden weitere Betriebssysteme auf dem Rechner erkannt, werden die Option <code class="notranslate">hidden</code> bzw. <code class="notranslate">countdown</code> ignoriert und das Grubmenü immer angezeigt. Außerdem wird dann ein Wert von <code class="notranslate">GRUB_TIMEOUT=0</code> (Vorgabe Null) immer auf 10 gesetzt. Alle anderen Werte werden (also -1 oder &gt;= +1 ) der Vorgabe entsprechend verarbeitet.
</p></div></div> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">hidden</code> </td><td style="text-align: left; vertical-align: top"> Mit dem Eintrag <code class="notranslate">hidden</code> wird kein GRUB_2-Menü angezeigt und die mit <code class="notranslate">GRUB_TIMEOUT</code> eingestellte Zeit gewartet, bis das System nach der voreingestellten Zeit startet. Durch kurzzeitiges Drücken der 
<span class="key">Esc</span>  innerhalb dieses Zeitfensters kann das Grub-Menü angezeigt und eine Auswahl vorgenommen werden.  </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">countdown</code> </td><td style="text-align: left; vertical-align: top"> Mit dem Eintrag <code class="notranslate">countdown</code> wird kein GRUB_2-Menü angezeigt und die mit <code class="notranslate">GRUB_TIMEOUT</code> eingestellte Zeit sichtbar  heruntergezählt. Danach startet das System mit dem mit <code class="notranslate">GRUB_DEFAULT</code> voreingestellten Eintrag. Durch kurzzeitiges Drücken der 
<span class="key">Esc</span>  innerhalb dieses Zeitfensters kann das Herunterzählen abgebrochen und eine Auswahl vorgenommen werden.  </td></tr><tr><td rowspan="2" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DISTRIBUTOR </code> </td><td rowspan="2" style="text-align: left; vertical-align: top"> *** </td><td style="text-align: left; vertical-align: top"> Generiert Hinweise zur aktuellen Distribution. Bei einer Installationen im BIOS-Modus sollte man hier keine Korrekturen vornehmen. </td></tr><tr><td style="text-align: left; vertical-align: top"> Bei einer Installationen im <a class="internal" href="../efi_nachbearbeitung.html#Anderes-Bootverzeichnis-erstellen">EFI-Modus</a> wird hier die aktuelle Distribution ausgelesen. Man kann hier einen selektiven Eintrag für das <a class="internal" href="../efi_grundlagen.html#Das-EFI-Menue">EFI-Menü</a> erstellen. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT=</code> </td><td style="text-align: left; vertical-align: top"> Text </td><td style="text-align: left; vertical-align: top"> siehe die Hinweise bei <a class="crosslink" href="#Variable-fuer-Kernelzeilen">Variable für Kernelzeilen</a> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_CMDLINE_LINUX</code> </td><td style="text-align: left; vertical-align: top"> Text </td><td style="text-align: left; vertical-align: top"> siehe die Hinweise bei <a class="crosslink" href="#Variable-fuer-Kernelzeilen">Variable für Kernelzeilen</a> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">#GRUB_TERMINAL=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">console</code> </td><td style="text-align: left; vertical-align: top"> Entfernt man die Raute <code class="notranslate">#</code>, so wird der grafische Modus wie unter <a class="internal" href="../grub_2/aussehen.html">GRUB 2/Aussehen</a> beschrieben komplett abgeschaltet (reiner Konsolenmodus). Ein Sonderfall stellt hierbei die Eingabe bzw. Ausgabe über ein serielles Gerät (VT100-Terminal, Modem) dar. Siehe dazu die Hinweise unter Eingabe/Ausgabe auf ein <a class="crosslink" href="#Serielle-Ausgabe">serielles Gerät</a>. <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Wurde ein RAID1-Verbund als Boot-Gerät konfiguriert, so sollte <code class="notranslate">GRUB_TERMINAL=console</code> eingestellt werden. Andernfalls kann nach einem Ausfall der ersten Festplatte nicht mehr gebootet werden. (siehe <a class="interwiki interwiki-bug" href="https://launchpad.net/bugs/594202">594202</a>)
</p></div></div> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">#GRUB_GFXMODE=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">640x400</code> </td><td style="text-align: left; vertical-align: top"> Nach dem Entfernen der Raute <code class="notranslate">#</code> kann man mit dieser Einstellung die Auflösung im Grub-Menü einstellen. Standard-Vorgabe ist 640x480 Pixel (große Schrift). Weitere Hinweise zur Ermittlung der möglichen Auflösung findet man unter <a class="internal" href="../grub_2/aussehen.html#Aufloesung">Auflösung ermitteln</a>. </td></tr><tr><td rowspan="4" style="vertical-align: top"> <code class="notranslate">GRUB_GFXPAYLOAD_LINUX=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">keep</code> </td><td style="text-align: left; vertical-align: top"> Diese Einstellung bewirkt für die im Verzeichnis <strong>/boot</strong> vorhandenen Kerneleinträge, dass beim Start die mit <code class="notranslate">GRUB_GFXMODE=</code> eingestellte Schriftgröße für die folgende Monitor-Ausgabe beibehalten wird.  </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">1280x1024</code> </td><td style="text-align: left; vertical-align: top"> Ein Eintrag mit Werten anstelle <code class="notranslate">keep</code> bei <code class="notranslate">GRUB_GFXMODE</code> stellt die Schriftgröße auf diese Werte ein. Die für den eigenen Monitor richtigen Werte erhält man mit <a class="internal" href="../grub_2/aussehen.html#Aufloesung">Auflösung ermitteln</a>. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">text</code> </td><td style="text-align: left; vertical-align: top"> Falls es mit den beiden obigen Vorgaben Probleme beim Start gibt (schwarzer bzw. verzerrter Bildschirm), dann sollte man diese Vorgabe nehmen. Damit wird auf die Werte aus einer Liste mit problematischen Grafikkarten ("blacklist") zugegriffen. </td></tr><tr><td colspan="2"> <div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Diese Einstellungen werden in der Regel von <a class="internal" href="../plymouth.html">Plymouth</a> überschrieben! Entsprechende Einstellungen werden dort erläutert.
</p></div></div> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">#GRUB_DISABLE_LINUX_UUID=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td><td style="text-align: left; vertical-align: top"> Normalerweise übergibt GRUB 2 die Root-Partition mittels <a class="internal" href="../uuid.html">UUID</a> an den zu startenden Linux-Kernel. Durch Entfernen der Raute <code class="notranslate">#</code> kann man GRUB 2 dazu veranlassen, dies per Device-Nummerierung (<strong>/dev/sdXX</strong>) zu machen. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">#GRUB_DISABLE_RECOVERY=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td><td style="text-align: left; vertical-align: top"> Nach Entfernen der Raute <code class="notranslate">#</code> und setzen auf <code class="notranslate">true</code> werden alle Recovery-Kernel-Einträge im Auswahlmenü deaktiviert. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DISABLE_OS_PROBER=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td><td style="text-align: left; vertical-align: top"> Wird diese Variable mit <code class="notranslate">true</code> nachgetragen, wird eine erneute Überprüfung auf andere Betriebssysteme auf dem PC bei einem <code class="notranslate">update-grub</code> unterdrückt. Es werden damit in das Grub-Menü nur die im Verzeichnis <strong>/boot</strong> enthaltenen Kernel-Images sowie eigene Skripte entsprechend der Nummerierung erfasst. </td></tr><tr><td rowspan="2" style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_OS_PROBER_SKIP_LIST=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">"UUID@Partition"</code> </td><td style="text-align: left; vertical-align: top"> Wird diese Variable mit z.B. <code class="notranslate">"BAEE3575EE352B51@/dev/sda2"</code> (bestehend aus <a class="internal" href="../uuid.html">UUID</a> "@" "Partition") nachgetragen, wird diese Partition nicht in das Grubmenü übernommen. Weitere Partitionen können mit einem Leerzeichen getrennt in gleicher Weise benannt werden.  </td></tr><tr><td colspan="2" style="text-align: left; vertical-align: top"> <div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Dieses wird dann angewendet, wenn z.B. neben dem regulären Windows ein <code class="notranslate">Recovery</code> vorhanden ist, was zu Missverständnissen oder die Auswahl sogar zu Schäden führen kann.
</p></div></div> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DISABLE_SUBMENU=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">y</code> </td><td style="text-align: left; vertical-align: top"> Wird diese Variable mit <code class="notranslate">y</code> (für <code class="notranslate">yes</code>) nachgetragen, wird auf die Erstellung eines separaten Blockes für den zweiten und weitere Kernel-Images verzichtet und es werden alle Kernel und die Varianten (<code class="notranslate">Normal</code>, <code class="notranslate">Recovery</code> sowie <code class="notranslate">Init-Mode</code>) direkt im Menü angezeigt. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_INIT_TUNE=</code> </td><td style="text-align: left; vertical-align: top"> "<code class="notranslate">480 440 1</code>"  </td><td style="text-align: left; vertical-align: top"> Hiermit wird ein Ton ausgegeben, sobald das Grub-Menü zur Eingabe bereit steht - <span class="underline">auch</span> wenn dieses durch <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> nicht angezeigt wird. Die dritte Zahl (im Beispiel die <code class="notranslate">1</code>) beeinflusst die Dauer. Alle durch Leerzeichen getrennten Wertegruppen müssen insgesamt von <code class="notranslate">""</code> eingefasst sein. </td></tr><tr><td> <code class="notranslate">GRUB_THEME=</code> </td><td> "<code class="notranslate">/PFAD/ZUR/KONFIGURATIONSDATEI</code>" </td><td> Stellt den Pfad zu einem GRUB Thema ein. Siehe dazu <a class="internal" href="../grub_2/aussehen_-_erweiterte_konfiguration.html">GRUB 2/Aussehen - erweiterte Konfiguration</a>. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_ENABLE_CRYPTODISK=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">y</code> </td><td style="text-align: left; vertical-align: top">  Wird diese Variable auf 'y' gesetzt, suchen 'grub-mkconfig' und 'grub-install' nach verschlüsselten Laufwerken und erzeugen zusätzliche Befehle um auf die verschlüsselten Laufwerke während des Systemstarts zugreifen zu können. Somit ist es möglich, auch das Boot-Verzeichnis zu verschlüsseln. <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>In diesem Fall ist kein unbeaufsichtigter Start mehr möglich, weil Grub auf die Eingabe der Passphrase zum Öffnen des verschlüsselten Laufwerks wartet, bevor das Menü angezeigt wird. Beim Start des verschlüsselten Systems wird man ein weiteres Mal zum Eingeben der Passphrase aufgefordert.
</p></div></div> </td></tr></table></div><div class="section_2"><h3 id="Serielle-Ausgabe">Serielle Ausgabe<a class="headerlink" href="#Serielle-Ausgabe">¶</a></h3><p>
Für die Ausgabe des GRUB-Menüs auf ein serielles Ein- bzw. Ausgabegerät (VT100-Terminal, Modem) müssen die nachfolgenden Variablen wie folgt gesetzt werden (fehlende Variablen sind entsprechend nachzutragen, auf die Optionen als solche wird hier <span class="underline">nicht</span> eingegangen!):</p><p>
</p><table style="width: 95%"><tr class="titel"><td colspan="3"> Terminal Variable in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td><td style="text-align: center"> Bedeutung </td></tr><tr><td rowspan="2" style="text-align: left; vertical-align: top"><code class="notranslate">GRUB_TERMINAL=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">serial</code> </td><td style="text-align: left; vertical-align: top"> Ersetzt man <code class="notranslate">console</code> mit <code class="notranslate">serial</code>, so wird die Ausgabe auf den seriellen Port umgeleitet - dieser muss von der Hardware her vorhanden, aber nicht notwendigerweise auch belegt sein. </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">"console serial"</code> </td><td style="text-align: left; vertical-align: top"> Setzt man <code class="notranslate">console</code> zusammen mit <code class="notranslate">serial</code>, eingefasst in <strong>"</strong>, so erfolgt die Ausgabe auf beide Anzeigegeräte. Auch die Bedienbarkeit ist von beiden Geräten alternativ möglich. </td></tr><tr><td style="text-align: left; vertical-align: top"><code class="notranslate">GRUB_SERIAL_COMMAND=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">serial --OPTIONEN</code> </td><td style="text-align: left; vertical-align: top"> Optionale Einträge zur seriellen Schnittstelle werden hier nach dem <code class="notranslate">=serial</code> jeweils hinter einem Doppel-Minus eingetragen (z.B.: <code class="notranslate">--unit=</code>, <code class="notranslate">--port=</code>, <code class="notranslate">--speed=</code>, <code class="notranslate">--word=</code>, <code class="notranslate">--parity=</code>, <code class="notranslate">--stop=</code>, <code class="notranslate">--device=</code>). Zum Beispiel  </td></tr><tr><td style="text-align: left; vertical-align: top"><code class="notranslate">GRUB_CMDLINE_LINUX=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">TEXT</code> </td><td style="text-align: left; vertical-align: top"> Hier werden ggf. obige Optionen beim Eintrag der <a class="crosslink" href="#Variable-fuer-Kernelzeilen">Kernelzeile</a> um die relevanten Daten ergänzt (z.B.: <code class="notranslate">serial=ttyS0</code> <code class="notranslate">console=ttyS0,9600n8</code>). </td></tr></table></div><div class="section_2"><h3 id="Variable-fuer-Kernelzeilen">Variable für Kernelzeilen<a class="headerlink" href="#Variable-fuer-Kernelzeilen">¶</a></h3><p>
Die nachfolgenden Variablen sind für die Übergabe von <a class="internal" href="../bootoptionen.html#Optionen">Kernel-Bootoptionen</a> reserviert und werden wie nachfolgend ausgewiesen bei den Images aus dem Verzeichnis <strong>/boot</strong> angewendet:</p><p>
</p><table><tr class="titel"><td colspan="3"> Kernel Variable in der /etc/default/grub </td></tr><tr class="kopf"><td rowspan="2" style="text-align: center"> Bezeichnung der Variable </td><td colspan="2" style="text-align: center"> Verwendung Bootoption </td></tr><tr class="kopf"><td style="text-align: center"> Login-Modus </td><td style="text-align: center"> Recovery-Modus </td></tr><tr><td style="text-align: left"> <code class="notranslate">GRUB_CMDLINE_LINUX=</code> </td><td style="background-color: #ccff99"> <strong>Ja</strong> </td><td style="background-color: #ccff99"> <strong>Ja</strong> </td></tr><tr><td style="text-align: left"> <code class="notranslate">GRUB_CMDLINE_LINUX_EXTRA=</code> </td><td style="background-color: #ccff99"> <strong>Ja</strong> </td><td style="background-color: #EEEEEE"> Nein </td></tr><tr><td style="text-align: left"> <code class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT=</code> </td><td style="background-color: #ccff99"> <strong>Ja</strong> </td><td style="background-color: #EEEEEE"> Nein </td></tr></table><p>Diese Variablen können auch bei der Erstellung der <a class="internal" href="../grub_2/skripte.html#Allgemeiner-Aufbau-Menueeintrag">eigenen Skripte</a> eingesetzt werden.</p></div><div class="section_2"><h3 id="Eigene-Variablen">Eigene Variablen<a class="headerlink" href="#Eigene-Variablen">¶</a></h3><p>
Will man weitere Variablen z.B. auch für die <a class="internal" href="../grub_2/skripte.html#Allgemeiner-Aufbau-Menueeintrag">eigenen Skripte</a> übergeben, so ergänzt man <span class="underline">je</span> die</p><p>
</p><table><tr class="titel"><td colspan="3"> eigene Variable in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Setzen </td><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">export</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_MEINE_VARIABLE=</code> </td><td style="text-align: left; vertical-align: top"> "meine Information" </td></tr></table></div></div><div class="section_1"><h2 id="Skripte-in-etc-grub-d">Skripte in /etc/grub.d<a class="headerlink" href="#Skripte-in-etc-grub-d">¶</a></h2><p>
Die Menü-Einträge zur Auswahl des zu startenden Betriebssystems und auch das genaue grafische Erscheinungsbild werden bei GRUB 2 über die Skripte im Verzeichnis <strong>/etc/grub.d</strong> konfiguriert. Standardmäßig sind dort u.a. die folgenden Skripte enthalten:</p><pre class="notranslate">00_header
05_debian_theme
10_linux
20_linux_xen
20_memtest86+
30_os-prober
40_custom
41_custom</pre><p><img alt="Wiki/Icons/wubi.png" class="image-left" src="../_/a7b0b5adf716b3c0fc0b3103784047bd5e7cca31.png"/><br/>Für die Installation mit <a class="internal" href="../wubi.html">Wubi</a> steht dieses spezielle Skript zusätzlich zur Verfügung:
</p><pre class="notranslate">10_lupin</pre><p>welches anstelle von <strong>10_linux</strong> zum Booten der Datei <strong>root.disk</strong> benutzt wird.</p><p><img alt="75px-Uefi_logo.png" class="image-left" src="../_/98dc5edf79f74994079c421ee1ea326eb01a8c94.png"/><br/>Für die Installation mit einem <a class="internal" href="../efi_bootmanagement.html">EFI Bootmanagement</a> steht dieses spezielle Skript zusätzlich zur Verfügung:
</p><pre class="notranslate">30_uefi-firmware</pre><p>welches den direkten Zugriff aus dem Grubmenü auf die Firmware (BIOS) ermöglicht.</p><p>Daneben können aber auch eigene Skripte erstellt werden. Dies ist auch grundsätzlich der Bearbeitung bzw. Veränderung eines vorhandenen Standard-Eintrages vorzuziehen. Dazu siehe die ausführlichen Beschreibungen unter <a class="internal" href="../grub_2/skripte.html">GRUB 2/Skripte</a>.</p><div class="section_2"><h3 id="Die-Abarbeitungs-Reihenfolge-der-Skripte">Die Abarbeitungs-Reihenfolge der Skripte<a class="headerlink" href="#Die-Abarbeitungs-Reihenfolge-der-Skripte">¶</a></h3><p>
Wie man sieht, werden die Skriptnamen von einer Nummer (XX_) angeführt. Die Skripte werden aufsteigend dieser Nummer entsprechend abgearbeitet. Haben zwei Skripte die gleiche Nummer, so bestimmt deren weitere alphanumerische Reihenfolge die Abarbeitung.</p><p>Ein Skript mit der Bezeichnung <strong>10_eigenes</strong> (Skript) wird vor <strong>10_linux</strong> zur Abarbeitung aufgerufen. Auf diese Weise lässt sich die Reihenfolge der Menü-Einträge beeinflussen.</p><p>Ein Klassiker dabei ist es, im Verzeichnis <strong>/etc/grub.d/</strong> die Datei <strong>30_os-prober</strong> in <strong>09_os-prober</strong> umzubenennen, um so die Windowseinträge vor den Linuxeinträgen anzuordnen.</p></div><div class="section_2"><h3 id="Standardeintraege-in-die-grub-cfg">Standardeinträge in die grub.cfg<a class="headerlink" href="#Standardeintraege-in-die-grub-cfg">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die nachfolgenden Beschreibungen der <strong>/boot/grub/grub.cfg</strong> dienen ausschließlich dazu, die Ergebnisse nach einem Eingriff in die Datei <strong>/etc/default/grub</strong> oder durch den Einsatz von <a class="internal" href="../grub_2/skripte.html">eigenen Skripten</a> zu überprüfen. Eine Bearbeitung dieser Datei ist zwar grundsätzlich möglich, sollte aber (<span class="underline">nur</span> zum Testen) der letzte Schritt sein.
</p></div></div><p>Es wird der Inhalt der Datei <strong>/boot/grub/grub.cfg</strong> beschrieben, wie dieser sich nach einer nicht nachbehandelten Installation darstellt. Dabei kann der Pfad zu dieser Datei in Abhängigkeit von der Partitionierung (getrennte Bootpartition) abweichen. Unterschiede bei den Informationen sind immer dann zu erwarten, wenn man die Ergebnisse der Skripte von <strong>10_linux</strong> bzw. <strong>30_os-prober</strong> sich ansieht. Insbesondere sind die beispielhaften Eintragungen <code class="notranslate">(hd0,3)</code> bzw. der <a class="internal" href="../uuid.html">UUID</a> nur als solche anzusehen und werden im jeweiligen System abweichen.</p><p>Jeder Eintrag wird von einer <code class="notranslate">###BEGIN-</code> bzw. <code class="notranslate">###END</code>-Sequenz eingefasst, aus der man auch das Skript ablesen kann, welches für den Inhalt dieses Teil-Abschnittes abgearbeitet wurde.</p><p>Ohne nachfolgend näher auf die detaillierten Inhalte einzugehen, werden hier die erforderlichen, allgemeinen Befehle und Funktionen bereitgestellt, die das GRUB-2-Basisprogramm benötigt. Dabei sind einige Befehle fest im GRUB-2-Basisprogramm verankert, die als ladbare Images (<strong>*.img</strong>) im Verzeichnis <strong>/boot/grub/</strong> vorliegen, andere hingegen sind in Form von <code class="notranslate">&lt;Befehl&gt;.mod</code> dort abgelegt.</p><div class="section_3"><h4 id="Skript-00-header">Skript 00_header<a class="headerlink" href="#Skript-00-header">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/00_header</strong> liefert in Abhängigkeit von den</p><p>
</p><table><tr class="titel"><td colspan="3"> Einstellungen in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DEFAULT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">0</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_TIMEOUT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">7</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_GFXMODE=</code> </td><td> <code class="notranslate">800x600x16</code> </td></tr></table><p>
folgendes Ergebnis:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/00_header ###</span>
<span class="k">if</span> <span class="o">[</span> -s <span class="nv">$prefix</span>/grubenv <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  load_env
<span class="k">fi</span>
<span class="nb">set</span> <span class="nv">default</span><span class="o">=</span><span class="s2">"0"</span>
<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">prev_saved_entry</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">set</span> <span class="nv">saved_entry</span><span class="o">=</span><span class="si">${</span><span class="nv">prev_saved_entry</span><span class="si">}</span>
  save_env saved_entry
  <span class="nb">set</span> <span class="nv">prev_saved_entry</span><span class="o">=</span>
  save_env prev_saved_entry
  <span class="nb">set</span> <span class="nv">boot_once</span><span class="o">=</span><span class="nb">true</span>
<span class="k">fi</span>

<span class="k">function</span> savedefault <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> -z <span class="si">${</span><span class="nv">boot_once</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">saved_entry</span><span class="o">=</span><span class="si">${</span><span class="nv">chosen</span><span class="si">}</span>
    save_env saved_entry
  <span class="k">fi</span>
<span class="o">}</span>

<span class="k">function</span> recordfail <span class="o">{</span>
  <span class="nb">set</span> <span class="nv">recordfail</span><span class="o">=</span><span class="m">1</span>
  <span class="k">if</span> <span class="o">[</span> -n <span class="si">${</span><span class="nv">have_grubenv</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="k">if</span> <span class="o">[</span> -z <span class="si">${</span><span class="nv">boot_once</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> save_env recordfail<span class="p">;</span> <span class="k">fi</span><span class="p">;</span> <span class="k">fi</span>
<span class="o">}</span>
insmod ext2
<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
search --no-floppy --fs-uuid --set ae875d31-cc84-4349-95d7-01a82ad76d61
<span class="k">if</span> loadfont /usr/share/grub/unicode.pf2 <span class="p">;</span> <span class="k">then</span>
  <span class="nb">set</span> <span class="nv">gfxmode</span><span class="o">=</span>800x600x16
  insmod gfxterm
  insmod vbe
  <span class="k">if</span> terminal_output gfxterm <span class="p">;</span> <span class="k">then</span> <span class="nb">true</span> <span class="p">;</span> <span class="k">else</span>
    <span class="c1"># For backward compatibility with versions of terminal.mod that don't</span>
    <span class="c1"># understand terminal_output</span>
    terminal gfxterm
  <span class="k">fi</span>
<span class="k">fi</span>
insmod ext2
<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
search --no-floppy --fs-uuid --set ae875d31-cc84-4349-95d7-01a82ad76d61
<span class="nb">set</span> <span class="nv">locale_dir</span><span class="o">=(</span><span class="nv">$root</span><span class="o">)</span>/boot/grub/locale
<span class="nb">set</span> <span class="nv">lang</span><span class="o">=</span>de
insmod gettext
<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">recordfail</span><span class="si">}</span> <span class="o">=</span> <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">set</span> <span class="nv">timeout</span><span class="o">=</span>-1
<span class="k">else</span>
  <span class="nb">set</span> <span class="nv">timeout</span><span class="o">=</span><span class="m">7</span>
<span class="k">fi</span>
<span class="c1">### END /etc/grub.d/00_header ###</span>
</pre></div>
</td></tr></table></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei einem <a class="internal" href="../btrfs.html">Btrfs</a>-Dateisystem und <span class="underline">integriertem</span> <strong>/boot</strong>-Verzeichnis ändern sich die obige Zeile 28 bzw. Zeile 41 in einer Standardinstallation wie folgt
</p></div></div><pre class="notranslate">if loadfont /usr/share/grub/unicode.pf2 ; then --&gt; 
if loadfont /@/usr/share/grub/unicode.pf2 ; then
...
set locale_dir=($root)/boot/grub/locale --&gt; 
set locale_dir=($root)/@/boot/grub/locale</pre></div><div class="section_3"><h4 id="Skript-05-debian-theme">Skript 05_debian_theme<a class="headerlink" href="#Skript-05-debian-theme">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/05_debian_theme</strong> liefert ohne Nachbearbeitung folgendes Ergebnis, bei dem die Zeilen der Auswahl vom Bootloader mit weißer Schrift auf schwarzen Hintergrund zur Anzeige gebracht werden, der hervorgehobene Eintrag dagegen mit schwarzer Schrift auf hellgrauem Hintergrund:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/05_debian_theme ###</span>
<span class="nb">set</span> <span class="nv">menu_color_normal</span><span class="o">=</span>white/black
<span class="nb">set</span> <span class="nv">menu_color_highlight</span><span class="o">=</span>black/light-gray
<span class="c1">### END /etc/grub.d/05_debian_theme ###</span>
</pre></div>
</td></tr></table></div><p>Man kann das Grub-Menü anpassen, entsprechende Informationen und Einstellungen sind unter <a class="internal" href="../grub_2/aussehen.html">GRUB 2/Aussehen</a> beschrieben. Danach sieht dieser Abschnitt dann z.B. wie folgt aus:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/05_debian_theme ###</span>
insmod ext2
<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
search --no-floppy --fs-uuid --set ae875d31-cc84-4349-95d7-01a82ad76d61
insmod png
<span class="k">if</span> background_image /boot/grub/grub_menu.png <span class="p">;</span> <span class="k">then</span>
  <span class="nb">set</span> <span class="nv">color_normal</span><span class="o">=</span>black/black
  <span class="nb">set</span> <span class="nv">color_highlight</span><span class="o">=</span>white/light-gray
<span class="k">else</span>
  <span class="nb">set</span> <span class="nv">menu_color_normal</span><span class="o">=</span>white/black
  <span class="nb">set</span> <span class="nv">menu_color_highlight</span><span class="o">=</span>black/white
<span class="k">fi</span>
<span class="c1">### END /etc/grub.d/05_debian_theme ###</span>
</pre></div>
</td></tr></table></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei einem <a class="internal" href="../btrfs.html">Btrfs</a>-Dateisystem und <span class="underline">integriertem</span> <strong>/boot</strong>-Verzeichnis ändert sich die obige Zeile in einer Standardinstallation wie folgt
</p></div></div><pre class="notranslate">if background_image /boot/grub/grub_menu.png ; then --&gt;
if background_image /@/boot/grub/grub_menu.png ; then</pre></div><div class="section_3"><h4 id="Skript-10-linux">Skript 10_linux<a class="headerlink" href="#Skript-10-linux">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/10_linux</strong> liefert in Abhängigkeit von den im Verzeichnis <strong>/boot</strong> vorhandenen Kernel-Images und den</p><p>
</p><table><tr class="titel"><td colspan="3"> Einstellungen in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_SAVEDEFAULT=</code> </td><td> <code class="notranslate">true</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_CMDLINE_LINUX_DEFAULT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">"quiet splash"</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DISABLE_LINUX_RECOVERY=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">false</code> </td></tr></table><p>
folgendes Ergebnis:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>menuentry <span class="s2">"Ubuntu, with Linux 2.6.31-17-generic"</span> <span class="o">{</span>
        recordfail
	savedefault
	insmod ext2
	<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
	search --no-floppy --fs-uuid --set<span class="o">=</span>root ae875d31-cc84-4349-95d7-01a82ad76d61
	linux	/boot/vmlinuz-2.6.31-17-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro   quiet splash
	initrd	/boot/initrd.img-2.6.31-17-generic
<span class="o">}</span>
menuentry <span class="s2">"Ubuntu, with Linux 2.6.31-17-generic (recovery mode)"</span> <span class="o">{</span>
        recordfail
	savedefault
	insmod ext2
	<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
	search --no-floppy --fs-uuid --set<span class="o">=</span>root ae875d31-cc84-4349-95d7-01a82ad76d61
	<span class="nb">echo</span>	Loading Linux <span class="m">2</span>.6.31-17-generic ...
	linux	/boot/vmlinuz-2.6.31-17-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro single 
	<span class="nb">echo</span>	Loading initial ramdisk ...
	initrd	/boot/initrd.img-2.6.31-17-generic
</pre></div>
</td></tr></table></div><p>Setzt man die Variable <code class="notranslate">GRUB_DISABLE_LINUX_RECOVERY=</code> auf <code class="notranslate">true</code>, wird der zweite Eintrag für den <a class="internal" href="../recovery_modus.html">Recovery Modus</a> unterbunden.</p></div><div class="section_3"><h4 id="Erscheinungsbild-Grubmenue">Erscheinungsbild Grubmenü<a class="headerlink" href="#Erscheinungsbild-Grubmenue">¶</a></h4><p>
Es wird nur der neueste Kernel (also der mit der höchsten Versionskennung) im Grub-Menü direkt angezeigt. Alle weiteren Linuxkernel (also die mit niedrigerer Versionskennung im gleichen System) werden in einem Untermenü zusammengefasst. Dieses wird im Grub-Menü wie folgt angezeigt:</p><p>
</p><table style="border-style: none"><tr class=";"><td colspan="3" style="text-align: center; width: 97%; border-style: none"> </td></tr><tr class=";"><td style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td><td style="text-align: left; border-style: none; color: white; background-color: #000000">  *Ubuntu </td><td class=";" style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td></tr><tr class=";"><td style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td><td style="text-align: left; border-style: none; color: white; background-color: #000000">  Erweiterte Optionen für Ubuntu </td><td class=";" style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td></tr><tr class=";"><td style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td><td style="text-align: left; border-style: none; color: white; background-color: #000000">  Windows Boot Manager (auf /dev/sda1) </td><td class=";" style="border-style: none; color: #FFFFFF; background-color: #000000; width: 10px"> </td></tr><tr><td colspan="3" style="text-align: left; border-style: none; color: #FFFFFF; background-color: #000000"> </td></tr></table><p>Die aktuelle Auswahl wird mit einem Sternchen gekennzeichnet. Wenn man mit den Pfeiltasten auf die im Beispiel zweite Position im Grub-Menü wechselt und diesen Menüpunkt mit der 
<span class="key">⏎</span> -Taste aufruft, werden (nun nur) die innerhalb dieses Untermenüs angelegten Kernel zur Auswahl angeboten. In der Datei <strong>/boot/grub/grub.cfg</strong> finden sich dazu nach dem ersten Kernelsatz folgende Zeile:</p><pre class="notranslate">submenu " Erweiterte Optionen für Ubuntu" {
.... andere Menüeinträge ...
}</pre><p>Wichtig sind hier nun die Zeile 1 mit der geschweiften Klammer sowie die Zeile 3, die diese Funktion mit der relevanten geschweiften Klammer abschliesst. Die anderen Menüeinträge liegen, in der oben beschriebenen Aufbereitung, jeweils vollständig dazwischen. Ins Hauptmenü zurück gelangt man durch Betätigen von 
<span class="key">Esc</span> .</p></div><div class="section_3"><h4 id="Ergaenzung-im-Skript">Ergänzung im Skript<a class="headerlink" href="#Ergaenzung-im-Skript">¶</a></h4><p>
</p><ul><li><p>Der Wiederherstellungsmodus (<a class="internal" href="../recovery_modus.html">Recovery Modus</a>) ist per Default auf eine eingeschränkte, read-only  Version voreingestellt, in der man zwar relevante Festplattentest o.ä. ausführen kann, jedoch werden alle Schreibzugriffe auf die Datenträger unterbunden. Um in das normale <a class="internal" href="../recovery_modus.html#friendly-recovery">Friendly Recovery</a> zu gelangen, muss hier erst die Option <code class="notranslate">remount</code> ausgewählt werden. Siehe auch die Beschreibung unter <a class="internal" href="../recovery_modus.html#Ab-Oneiric-Ocelot">Recovery_Modus</a>.</p></li></ul><p>
</p><ul><li><p>Änderung am Verhalten des Wiederherstellungsmodus ist dadurch möglich, dass man die jeweilige Zeile(n) wie folgt ändert:</p></li></ul><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>	linux	/boot/vmlinuz-2.6.31-17-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro  recovery nomodeset 
	linux	/boot/vmlinuz-2.6.31-17-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro  single
</pre></div>
</td></tr></table></div><ul><li><p>Wird ein <a class="internal" href="../btrfs-dateisystem.html">Btrfs-Dateisystem</a> eingesetzt, ändern sich dadurch die Kernelzeilen für die <strong>/boot/grub/grub.cfg</strong>, abhängig ob es ein <span class="underline">integriertes</span> <strong>/boot</strong>-Verzeichnis gibt oder eine getrennte <strong>/boot</strong>-Partition.</p></li></ul><p>
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>	linux	/boot/vmlinuz-2.6.31-17-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro   quiet splash --&gt;
	linux	/@/boot/vmlinuz-3.0.0-12-generic <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>ae875d31-cc84-4349-95d7-01a82ad76d61 ro  <span class="nv">rootflags</span><span class="o">=</span><span class="nv">subvol</span><span class="o">=</span>@ quiet splash

	initrd	/boot/initrd.img-2.6.31-17-generic
	initrd	/@/boot/initrd.img-3.0.0-12-generic
</pre></div>
</td></tr></table></div></div><div class="section_3"><h4 id="Skript-20-linux-xen">Skript 20_linux_xen<a class="headerlink" href="#Skript-20-linux-xen">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/20_linux_xen</strong> ist vergleichbar mit dem Skript <strong>/etc/10_linux</strong>, <span class="underline">nur</span> das es die Besonderheiten eines <em>"XEN virtual servers"</em> berücksichtigt und entsprechende Parameter abfragt und in die <strong>/boot/grub/grub.cfg</strong> einsetzt.</p></div><div class="section_3"><h4 id="Skript-20-memtest86">Skript 20_memtest86+<a class="headerlink" href="#Skript-20-memtest86">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/20_memtest86+</strong> liefert folgende Einträge, die zum <a class="internal" href="../memtest.html">Testen des RAM-Speichers</a> dienen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/20_memtest86+ ###</span>
menuentry <span class="s2">"Memory test (memtest86+)"</span> <span class="o">{</span>
        insmod ext2
        <span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
        search --no-floppy --fs-uuid --set<span class="o">=</span>root ae875d31-cc84-4349-95d7-01a82ad76d61
	linux16	/boot/memtest86+.bin
<span class="o">}</span>
menuentry <span class="s2">"Memory test (memtest86+, serial console 115200)"</span> <span class="o">{</span>
        insmod ext2
        <span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,3)'</span>
        search --no-floppy --fs-uuid --set<span class="o">=</span>root ae875d31-cc84-4349-95d7-01a82ad76d61
	linux16	/boot/memtest86+.bin <span class="nv">console</span><span class="o">=</span>ttyS0,115200n8
<span class="o">}</span>
<span class="c1">### END /etc/grub.d/20_memtest86+ ###</span>
</pre></div>
</td></tr></table></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei einem <a class="internal" href="../btrfs.html">Btrfs</a>-Dateisystem und <span class="underline">integriertem</span> <strong>/boot</strong>-Verzeichnis ändern sich die obige Zeilen in einer Standardinstallation wie folgt.
</p></div></div><pre class="notranslate">	linux16	/boot/memtest86+.bin --&gt;
	linux16	/@/boot/memtest86+.bin
        ...
	linux16	/boot/memtest86+.bin console=ttyS0,115200n8 --&gt;
	linux16	/@/boot/memtest86+.bin console=ttyS0,115200n8</pre></div><div class="section_3"><h4 id="Skript-30-os-prober">Skript 30_os-prober<a class="headerlink" href="#Skript-30-os-prober">¶</a></h4><p>
</p><div class="section_4"><h5 id="Normale-Verwendung">Normale Verwendung<a class="headerlink" href="#Normale-Verwendung">¶</a></h5><p>
Das Skript <strong>/etc/grub.d/30_os-prober</strong> überprüft alle angeschlossenen (und erkannten) Datenträger darauf hin, ob fertige Menü-Einträge, andere Kernel-Images oder Betriebssysteme vorhanden sind und liefert ohne Nachbearbeitung folgende beispielhafte Information:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/30_os-prober ###</span>
menuentry <span class="s2">"Windows NT/2000/XP (on /dev/sda1)"</span> <span class="o">{</span>
	savedefault
	insmod ntfs
	<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,1)'</span>
	search --no-floppy --fs-uuid --set<span class="o">=</span>root 265585bd5150c55f
	drivemap -s <span class="o">(</span>hd0<span class="o">)</span> <span class="si">${</span><span class="nv">root</span><span class="si">}</span>
	chainloader +1
<span class="o">}</span>
menuentry <span class="s2">"Ubuntu, with Linux 2.6.32-12-generic-pae (on /dev/sda6)"</span> <span class="o">{</span>
	savedefault
	insmod ext2
	<span class="nb">set</span> <span class="nv">root</span><span class="o">=</span><span class="s1">'(hd0,6)'</span>
	search --no-floppy --fs-uuid --set<span class="o">=</span>root 843c4345-0c0a-4df6-8abe-8114b06393b2
	linux /boot/vmlinuz-2.6.32-12-generic-pae <span class="nv">root</span><span class="o">=</span><span class="nv">UUID</span><span class="o">=</span>843c4345-0c0a-4df6-8abe-8114b06393b2 ro quiet splash
	initrd /boot/initrd.img-2.6.32-12-generic-pae
<span class="c1">### END /etc/grub.d/30_os-prober ###</span>
</pre></div>
</td></tr></table></div><p>Dieser Vorgang kann je nach der Anzahl sowie Größe der Datenträger und der jeweils gefundenen Partitionen durchaus länger andauern. Um dieses ggf. abzukürzen, kann man diese Sequenz durch Hinzufügen der Variable <code class="notranslate">GRUB_DISABLE_OS_PROBER=true</code> in der Datei <strong>/etc/default/grub</strong> unterbinden.</p><p>Die Ausgabe von <strong>30_os-prober</strong> kann auch dazu genutzt werden, die für die eigenen Skripte erforderliche Syntax sowie z.B. um die relevanten Daten für <code class="notranslate">(hd0,6)</code> bzw. <code class="notranslate">UUID</code> abzufragen. Die ausgegebenen Sequenzen kann man als Kopie (Vorlage) aus der generierten <strong>grub.cfg</strong> zum Erstellen von Skripten als Referenz / Beispiel nutzen.</p></div><div class="section_4"><h5 id="Countdown-einrichten">Countdown einrichten<a class="headerlink" href="#Countdown-einrichten">¶</a></h5><p>
Mittels des Skriptes <strong>30_os-prober</strong> und den folgenden</p><p>
</p><table><tr class="titel"><td colspan="3"> Einstellungen in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_DISABLE_OS_PROBER=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">true</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_HIDDEN_TIMEOUT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">5</code> </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_HIDDEN_TIMEOUT_QUIET=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">false</code> </td></tr></table><p>wird eine Countdown-Sequenz für die <strong>/boot/grub/grub.cfg</strong> erstellt:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/30_os-prober ###</span>
<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">timeout</span><span class="si">}</span> !<span class="o">=</span> -1 <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> sleep --interruptible <span class="m">5</span> <span class="p">;</span> <span class="k">then</span>
      <span class="nb">set</span> <span class="nv">timeout</span><span class="o">=</span><span class="m">0</span>
    <span class="k">fi</span>
<span class="k">fi</span>
<span class="c1">### END /etc/grub.d/30_os-prober ###</span>
</pre></div>
</td></tr></table></div><p>Damit wird ein verdeckter Countdown mit der vorgegebenen Zeit eingerichtet. Diesen Countdown kann man mit der 
<span class="key">⏎</span> - bzw. 
<span class="key">Esc</span> -Taste abbrechen und damit das Grub-Menü zur Anzeige bringen. Wenn man neben den Kerneleinträgen aus dem Verzeichnis <strong>/boot</strong> weitere Betriebssysteme einbinden will, so darf die oben beschriebene Funktion mittels <code class="notranslate">GRUB_DISABLE_OS_PROBER=true</code> nur verwendet werden, wenn man gleichzeitig für diese anderen Betriebssysteme <a class="internal" href="../grub_2/skripte.html">eigene Skripte</a> erstellt und einbindet.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Ohne obige Sequenz in der einen oder anderen Variante kann man das Bootmenü nach der Aktivierung von <code class="notranslate">GRUB_HIDDEN_TIMEOUT</code> nicht mehr sichtbar machen.
</p></div></div><p>Entsprechend der</p><p>
</p><table><tr class="titel"><td colspan="3"> Einstellungen in der /etc/default/grub </td></tr><tr class="kopf"><td style="text-align: center"> Variable </td><td style="text-align: center"> Wert </td></tr><tr><td style="text-align: left; vertical-align: top"> <code class="notranslate">GRUB_TIMEOUT=</code> </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">10</code> </td></tr></table><p>wird danach für diesen ausgewählten Zeitraum das Grub-Menü angezeigt.</p></div></div><div class="section_3"><h4 id="Skript-40-custom">Skript 40_custom<a class="headerlink" href="#Skript-40-custom">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/40_custom</strong> liefert ohne Nachbearbeitung folgende Information:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="c1">### BEGIN /etc/grub.d/40_custom ###</span>
<span class="c1"># This file provides an easy way to add custom menu entries.  Simply type the</span>
<span class="c1"># menu entries you want to add after this comment.  Be careful not to change</span>
<span class="c1"># the 'exec tail' line above.</span>
<span class="c1">### END /etc/grub.d/40_custom ###</span>
</pre></div>
</td></tr></table></div><p>Wobei die Übersetzung sinngemäß lautet:</p><pre class="notranslate"># Diese Datei bietet einen einfachen Weg, eigene Menü-Einträge hinzuzufügen.
# Füge die gewünschten Menü-Einträge einfach unterhalb dieses Kommentars ein.
# Achte darauf, die Zeile oben mit 'exec tail' nicht zu verändern.</pre></div><div class="section_3"><h4 id="Skript-41-custom">Skript 41_custom<a class="headerlink" href="#Skript-41-custom">¶</a></h4><p>
Das Skript <strong>/etc/grub.d/41_custom</strong> liefert ohne Nachbearbeitung folgende Information:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="k">if</span> <span class="o">[</span> -f  <span class="se">\$</span>prefix/custom.cfg <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">source</span> <span class="se">\$</span>prefix/custom.cfg<span class="p">;</span>
<span class="k">fi</span>
</pre></div>
</td></tr></table></div><p>und kann zum Laden einer <span class="underline">eigenen</span> Konfigurationsdatei beliebigen Inhaltes benutzt werden, die unter 
</p><ul><li><p><strong>/boot/grub/</strong></p></li></ul><p>abgelegt wurde. Die Bezeichnung <code class="notranslate">prefix</code> ist die relevante standardmäßige Umsetzung des jeweiligen Pfades zu dieser Datei und wird automatisch beim Booten gesetzt. Für ein System mit integriertem Verzeichnis auf:
</p><ul><li><p><code class="notranslate">(hd0,1)/boot/grub/</code></p></li></ul><p>bzw. bei getrennter Bootpartition auf:
</p><ul><li><p><code class="notranslate">(hd0,5)/grub</code></p></li></ul><p>Die jeweils zutreffende Partition wird dabei vom System selbstständig eingetragen.</p><p>Weitere Hinweise zur Erstellung eigener Skripte und den Möglichkeiten und Erfordernissen sind in den Beschreibungen unter <a class="internal" href="../grub_2/skripte.html">GRUB 2/Skripte</a> nachzulesen.</p></div></div><div class="section_2"><h3 id="Festplatten-und-Partitions-Bezeichnungen">Festplatten- und Partitions-Bezeichnungen<a class="headerlink" href="#Festplatten-und-Partitions-Bezeichnungen">¶</a></h3><p>
Die Festplatten werden im System (hardwaremäßig) in der Regel nach der Zuordnung zu den SATA- bzw. IDE-Ports eingeordnet und damit die Reihenfolge festgelegt. Die Auswahl bzw. Zuordnung im <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/BIOS">BIOS</a>, von welcher dieser Festplatten als "erste" Festplatte gebootet wird, hat hierauf keinen Einfluss. Ein nicht belegter Port wird in der Auflistung ausgelassen.</p><div class="section_3"><h4 id="Zaehlweise-Festplatten">Zählweise Festplatten<a class="headerlink" href="#Zaehlweise-Festplatten">¶</a></h4><p>
Die Bezeichnung in GRUB 2 wird fortlaufend vergeben, d.h. bei fehlender Platte in einem der Hardware-Ports erhält die niedrigste die Zuordnung <code class="notranslate">(hd0)</code>. Dieses Verhalten kann zu Problemen führen, wenn z.B. eine Platte vorübergehend aus dem System entfernt wird (z.B.: Datenkabel wird abgezogen) bzw. eine weitere Festplatte eingefügt wird. Die folgende Tabelle stellt Beispiele für die Zuordnung dar:</p><p>
</p><table><tr class="titel"><td colspan="4" style="text-align: center; width: 75%"> Portbelegung auf dem Motherboard und Zuordnung </td></tr><tr class="kopf"><td style="text-align: center; width: 25%"> SATA 1 Primär </td><td class="; ;" style="text-align: center; width: 25%"> SATA 1 Sekundär </td><td class="; ;" style="text-align: center; width: 25%"> SATA 2 Primär </td><td class="; ;" style="text-align: center; width: 25%"> SATA 2 Sekundär </td></tr><tr><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sda = (hd0)</strong> </td><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sdb = (hd1)</strong> </td><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td></tr><tr><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sda = (hd0)</strong> </td><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sdb = (hd1)</strong> </td><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sdc = (hd2)</strong> </td></tr><tr><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td><td style="text-align: center; background-color: #ccff99"> <strong>/dev/sda = (hd0)</strong> </td><td style="text-align: center; background-color: #EEEEEE"> <strong>---</strong> </td></tr></table></div><div class="section_3"><h4 id="Bezeichnung-Festplatten">Bezeichnung Festplatten<a class="headerlink" href="#Bezeichnung-Festplatten">¶</a></h4><p>
GRUB 2 bezeichnet die Festplattenpartitionen mit <code class="notranslate">(hdX,Y)</code>, dabei ist
</p><ul><li><p>X die lfd. Nummern der Festplatte</p></li><li><p>Y die lfd. Zählnummer der Partition</p></li></ul><p>Die Zählung der Festplatten beginnt immer mit 0, die der Partitionen immer mit 1:</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Zu beachten ist, dass die Nummerierung von <a class="external" href="http://www.slashcam.de/artikel/Ratgeber/Das-optimale-Schnittsystem-Teil-1--Festplatten-und-Partitionen.html#T1" rel="nofollow">logischen Laufwerken in einer erweiterten Partition</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> immer bei <strong>5</strong> beginnt - unabhängig von der Anzahl der vorhandenen primären Partitionen und als welche die erweiterte Partition angeordnet wurde.</p><p>Die in der <strong>grub.cfg</strong> ausgewiesene Schreibweise (Zählung) der Partitionen kann je nach Grub-Version abweichen.
</p></div></div><p>
</p><table><tr class="titel"><td colspan="3"> Festplatten-Bezeichnung und Zuordnung </td></tr><tr class="kopf"><td style="text-align: center; width: 50%"> Partition </td><td class=";" style="text-align: center; width: 25%"> Linux </td><td class=";" style="text-align: center; width: 25%"> Grub </td></tr><tr class=";"><td style="text-align: center; background-color: #DDDDDD"> 1. Partition auf der X. Platte </td><td class=";" style="text-align: center; background-color: #DDDDDD"> /dev/sdX<strong>1</strong> </td><td class=";" style="text-align: center; background-color: #DDDDDD"> (hdX,<strong>1</strong>) </td></tr><tr class=";"><td style="text-align: center; background-color: #EEEEEE"> 2. Partition auf der X. Platte </td><td class=";" style="text-align: center; background-color: #EEEEEE"> /dev/sdX<strong>2</strong> </td><td class=";" style="text-align: center; background-color: #EEEEEE"> (hdX,<strong>2</strong>) </td></tr><tr><td style="text-align: center"> ... </td><td style="text-align: center"> ... </td><td style="text-align: center"> ... </td></tr><tr class=";"><td style="text-align: center; background-color: #DDDDDD"> Y. Partition auf der 1. Platte </td><td class=";" style="text-align: center; background-color: #DDDDDD"> /dev/sd<strong>a</strong>Y </td><td class=";" style="text-align: center; background-color: #DDDDDD"> (hd<strong>0</strong>,Y) </td></tr><tr class=";"><td style="text-align: center; background-color: #EEEEEE"> Y. Partition auf der 2. Platte </td><td class=";" style="text-align: center; background-color: #EEEEEE"> /dev/sd<strong>b</strong>Y </td><td class=";" style="text-align: center; background-color: #EEEEEE"> (hd<strong>1</strong>,Y) </td></tr><tr><td style="text-align: center"> ... </td><td style="text-align: center"> ... </td><td style="text-align: center"> ... </td></tr></table></div><div class="section_3"><h4 id="Externe-Festplatten">Externe Festplatten<a class="headerlink" href="#Externe-Festplatten">¶</a></h4><p>
Wird eine externe Festplatte angeschlossen, so erkennt das System im Terminal bei einem:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo fdisk -l </pre></div></div><p>neben z.B: zwei internen Festplatten (<strong>/dev/sda</strong> und <strong>/dev/sdb</strong>) diese externe Festplatte als <strong>/dev/sdc</strong>. Will man hierauf <a class="internal" href="../grub_2/terminalbefehle.html#grub-install">GRUB 2 installieren</a>, so <span class="underline">muss</span> als Ziel-Laufwerk im Terminal:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo grub-install /dev/sdc </pre></div></div><p>angegeben werden. Nach dem Booten wird <span class="underline">nun</span> diese externe Festplatte in der <a class="internal" href="../grub_2/shell.html">GRUB 2 Konsole</a> bei einem:</p><div class="bash"><div class="contents"><pre class="notranslate">ls </pre></div></div><p>zu <code class="notranslate">(hd0) (hd0,1)</code> usw. je nach Anzahl der Partitionen und auch bei:</p><div class="bash"><div class="contents"><pre class="notranslate">set </pre></div></div><p>wird die Boot-Partition entsprechend mit <code class="notranslate">(hd0,x)</code> angezeigt. <span class="underline">Auch</span> wenn im entsprechenden <code class="notranslate">menuentry</code> als Ziel-Laufwerk z.B.: <code class="notranslate">(hd2,x)</code> steht.</p></div></div><div class="section_2"><h3 id="Menue-Eintraege-entfernen">Menü-Einträge entfernen<a class="headerlink" href="#Menue-Eintraege-entfernen">¶</a></h3><p>
</p><div class="section_3"><h4 id="Automatisch">Automatisch<a class="headerlink" href="#Automatisch">¶</a></h4><p>
</p><ul><li><p>Beim <a class="internal" href="../kernel.html#Kernel-deinstallieren">Entfernen alter Kernel</a> über die <a class="internal" href="../paketverwaltung.html">Paketverwaltung</a> wird in der Regel ein Update von GRUB 2 durchgeführt, so dass die Einträge auch aus der <strong>/boot/grub/grub.cfg</strong> gelöscht werden.</p></li><li><p>Andere Betriebssysteme werden - sofern sie vom Computer gelöscht wurden - aus dem Menü entfernt, indem man nach dem Löschen der Systeme die GRUB-2-Konfiguration updatet.</p></li></ul><p>
</p></div><div class="section_3"><h4 id="Manuell">Manuell<a class="headerlink" href="#Manuell">¶</a></h4><p>
Möchte man Einträge manuell aus dem GRUB-2-Menü löschen, so hat man mehrere Möglichkeiten:</p><ol class="arabic"><li><p>Man entzieht dem Skript, das die unerwünschten Einträge erstellt, die Ausführbarkeit:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod -x /etc/grub.d/20_memtest86+ </pre></div></div><p>Das Beispiel entzieht der Datei <strong>/etc/grub.d/20_memtest86+</strong> die Ausführbarkeit.</p></li><li><p>Auskommentieren von Einträgen mittels <code class="notranslate">#</code> im betreffenden Skript, das den oder die unerwünschten Eintragszeilen enthält.</p></li><li><p>Man löscht die Einträge aus dem betreffenden Skript.</p></li><li><p>Kernel-Recovery-Einträge kann man insgesamt durch den Eintrag <code class="notranslate">GRUB_DISABLE_LINUX_RECOVERY=true</code> in der <strong><a class="crosslink" href="#Die-Datei-etc-default-grub">/etc/default/grub</a></strong> unterdrücken.</p></li></ol><p>
Zwei weitere manuelle Lösungsmöglichkeiten befinden sich ausführlich erläutert <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2559509/">im Forum</a>. Die erste Variante davon ist einfach und solide, erfordert aber stets manuelles Eingreifen bei Installation weiterer Systeme, die im Bootmenü erscheinen sollen. Die zweite Variante ist ein technischer Kniff ("Workaround"), die besonders elegant und einfach eine Menü-Blacklist erzeugt. Die Erkennung weiterer Systeme funktioniert also weiterhin automatisch, jedoch ohne die unerwünschten Blacklist-Einträge. Allerdings sorgt ein eventuelles Update der GRUB-2-Datei <strong>/usr/bin/os-prober</strong> dafür, dass wieder alle Einträge einschließlich der Blacklist automatisch erkannt werden. Dann muss man alle Schritte wiederholen, außer der Erstellung der Blacklist.</p></div></div></div><div class="section_1"><h2 id="Grub-Konfiguration-updaten">Grub-Konfiguration updaten<a class="headerlink" href="#Grub-Konfiguration-updaten">¶</a></h2><p>
<a class="crosslink anchor" href="#update" id="update"></a>
</p><div class="section_2"><h3 id="grub-cfg-updaten">grub.cfg updaten<a class="headerlink" href="#grub-cfg-updaten">¶</a></h3><p>
Nach jeder Änderung an der Datei <strong>/etc/default/grub</strong> oder an Skripten im Verzeichnis <strong>/etc/grub.d</strong>, muss die Grubkonfiguration - die in der Datei <strong>/boot/grub/grub.cfg</strong> gespeichert ist - aktualisiert werden. Andernfalls werden Änderungen beim nächsten Systemstart nicht sichtbar.</p><p>Um eine Information darüber zu erhalten, wie die Datei <strong>/boot/grub/grub.cfg</strong> mit den momentanen Einstellungen aussieht, gibt man im Terminal <sup><a href="#source-1">[1]</a></sup> ein:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo grub-mkconfig </pre></div></div><p>(siehe auch <a class="internal" href="../grub_2/terminalbefehle.html#grub-mkconfig">GRUB 2/Terminalbefehle</a>) und kann dann das Ergebnis überprüfen. Dieses wird noch <span class="underline">nicht</span> in die Grub-Konfiguration übernommen. Ist man mit dem Ergebnis zufrieden, so kann man mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>die Datei <strong>/boot/grub/grub.cfg</strong> neu schreiben lassen. Nähere Informationen siehe unter <a class="internal" href="../grub_2/terminalbefehle.html#update-grub">GRUB 2/Terminalbefehle</a></p></div><div class="section_2"><h3 id="grubenv-anpassen">grubenv anpassen<a class="headerlink" href="#grubenv-anpassen">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Datei <strong>/boot/grub/grubenv</strong> ist nur wirksam, wenn bei den Optionen von <a class="crosslink" href="#Die-Datei-etc-default-grub"><strong>/etc/default/grub</strong></a> die Variable <code class="notranslate">GRUB_DEFAULT=saved</code> gesetzt ist.
</p></div></div><p>Hatte man Probleme beim Starten mit einem Menüeintrag oder kommt man wegen <em>falscher</em> Einstellungen in der Datei <strong>/etc/default/grub</strong> bei den Werten <code class="notranslate">GRUB_DEFAULT</code> bzw. <code class="notranslate">GRUB_TIMEOUT</code> oder anderer Fehler nicht ins Grub-Menü, so kann man die Datei <strong>/boot/grub/grubenv</strong> auch vom Desktop her in einem Terminal <sup><a href="#source-1">[1]</a></sup> <a class="internal" href="../grub_2/terminalbefehle.html#grub-set-default">neu konfigurieren</a>.</p><p>Will man dagegen einem bestimmten Eintrag beim nächsten Start des Rechners verwenden, so kann man die Datei <strong>/boot/grub/grubenv</strong> vom Desktop her in einem Terminal <sup><a href="#source-1">[1]</a></sup> entsprechend <a class="internal" href="../grub_2/terminalbefehle.html#grub-reboot">einrichten</a>, so dass dieser Eintrag einmalig aufgerufen wird. Der nächste Start erfolgt dann wieder mit dem vorher gespeicherten Eintrag.</p></div></div><div class="section_1"><h2 id="Grub-Menue-absichern">Grub-Menü absichern<a class="headerlink" href="#Grub-Menue-absichern">¶</a></h2><p>
Um zumindest einen einfachen Schutz vor einer Manipulation des GRUB-Menüs zur Laufzeit zu erhalten, kann man die Bearbeitung insgesamt (Superuser-Rechte) bzw. die Auswahl einzelner Menü-Einträge durch ein Passwort absichern.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Dieses kann von einen geübten Linux-Anwender ohne Probleme umgangen werden - jedoch braucht man dafür eine gewisse Zeit, in der man <em>ungestört</em> arbeiten kann und weitere Hilfsmittel. Wenn der Rechner in fremde Hände fällt, ist das nachfolgend Beschriebene ohnehin keine Barriere. 
</p></div></div><div class="section_2"><h3 id="Vorbereitung-Schluessel">Vorbereitung Schlüssel<a class="headerlink" href="#Vorbereitung-Schluessel">¶</a></h3><p>
Dazu muss die Sequenz - wie unter <a class="internal" href="../grub_2/terminalbefehle.html#grub-mkpasswd-pbkdf2">Terminalbefehle</a> beschrieben - im Terminal <sup><a href="#source-1">[1]</a></sup> mit dem Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">grub-mkpasswd-pbkdf2 [Optionen] </pre></div></div><p>erstellt und an geeigneter Stelle für die Datei <strong>/boot/grub/grub.cfg</strong> aufbereitet werden. Nachfolgend wird nur der grundsätzliche Aufbau aufgezeigt, der für das generelle Sperren des Grub-Menüs insgesamt bzw. von Menü-Einträgen im Einzelnen erforderlich ist:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nb">export</span> superusers
<span class="nb">set</span> <span class="nv">superusers</span><span class="o">=</span><span class="s2">"BENUTZERNAME-1"</span>
password_pbkdf2 &lt;BENUTZERNAME-1&gt; grub.pbkdf2.sha512.10000.&lt;salted.passwd&gt;
password_pbkdf2 &lt;BENUTZERNAME-2&gt; grub.pbkdf2.sha512.10000.&lt;salted.passwd&gt;
password  &lt;BENUTZERNAME-3&gt; MeinPasswort
</pre></div>
</td></tr></table></div><p>Die Zeilen eins (1) bis drei (3) sind obligatorisch, weitere Zeilen (ab vier (4) alternativ) und bedeuten:</p><p>
</p><table style="width: 95%"><tr class="titel"><td colspan="3"> Absicherung des Grub-Menü </td></tr><tr class="kopf"><td style="text-align: center; width: 10%"> Zeile </td><td class=";" style="text-align: center; width: 25%"> Befehl </td><td style="text-align: center"> Wertvorgabe/Bedeutung </td></tr><tr><td style="text-align: left; vertical-align: top"> Zeile 1 </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">export superusers</code> </td><td style="text-align: left; vertical-align: top"> Diese Variable für alle Bereich deklarieren - dieses ist zwingend erforderlich, damit z.B. die Funktion Untermenü richtig ausgewertet wird. </td></tr><tr><td style="text-align: left; vertical-align: top"> Zeile 2 </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">set superusers=</code> </td><td style="text-align: left; vertical-align: top"> Auflistung der Benutzernamen der Superuser, jeder getrennt durch ein Leerzeichen, insgesamt eingefasst durch Hochkommas. <span class="underline">Nur</span> diese Benutzer-Namen erhalten Superuser-Rechte. </td></tr><tr><td style="text-align: left; vertical-align: top"> Zeile 3 </td><td style="text-align: left; vertical-align: top"><code class="notranslate">password_pbkdf2</code> </td><td style="text-align: left; vertical-align: top"> Benutzername jeweils getrennt mit einem Leerzeichen, gefolgt von der generierten Schlüssel-Information </td></tr><tr><td style="text-align: left; vertical-align: top"> Zeile 4 </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">password_pbkdf2</code> </td><td style="text-align: left; vertical-align: top"> Für jeden (weiteren) Benutzernamen eine Zeile mit den jeweils generierten Schlüssel-Informationen </td></tr><tr><td style="text-align: left; vertical-align: top"> Zeile 5 </td><td style="text-align: left; vertical-align: top"> <code class="notranslate">password</code> </td><td style="text-align: left; vertical-align: top"> Für jeden (weiteren) Benutzernamen eine Zeile mit den jeweils im Klartext abgelegten Passwort. <div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Nicht empfehlenswert, da sehr unsicher!
</p></div></div> </td></tr></table></div><div class="section_2"><h3 id="Bereitstellung-zur-Verarbeitung">Bereitstellung zur Verarbeitung<a class="headerlink" href="#Bereitstellung-zur-Verarbeitung">¶</a></h3><p>
Es bietet sich hierfür die Datei <a class="crosslink" href="#Skript-40-custom">/etc/grub.d/40_custom</a> an, in die man obige Einträge direkt einbringt.</p><p>Es ist aber auch eine Trennung dieser Daten von der Datei <strong>/boot/grub/grub.cfg</strong> möglich. Dazu erstellt man für obige Einträge die Datei <strong>pbkdf2.lst</strong> und legt diese im Verzeichnis <strong>/boot/</strong> ab. Aufgerufen wird das dann beim Booten mittels:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="k">if</span> <span class="o">[</span> -f /boot/pbkdf2.lst <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
   <span class="nb">source</span> /boot/pbkdf2.lst
<span class="k">fi</span>
</pre></div>
</td></tr></table></div><p>welches als Eintrag in der <strong>/etc/grub.d/40_custom</strong> oder in einem eigenen Skript eingebracht wird.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Bezeichnung der Datei bzw. auch das Verzeichnis können frei gewählt werden, müssen aber vom Bootloader erreichbar sein. Dann muss auch anstelle von <code class="notranslate">/boot</code> ==&gt; <code class="notranslate">\$root/Pfad_zur_Datei</code> im Skript verwendet werden!
</p></div></div></div><div class="section_2"><h3 id="Menue-Eintraege-anpassen">Menü-Einträge anpassen<a class="headerlink" href="#Menue-Eintraege-anpassen">¶</a></h3><p>
GRUB 2 sperrt beim Setzen eines Passworts grundsätzlich alle Einträge und fragt das Superuserpasswort bei jedem Boot ab. Für alle Booteinträge kann dieses Verhalten in <strong>/etc/grub.d/10_linux</strong> geändert werden, indem die menuentrys <code class="notranslate">--unresticted</code> oder <code class="notranslate">--user BENUTZERNAME</code> hinzugefügt werden. Dabei ermöglicht <code class="notranslate">--unresticted</code> den Boot ohne Passwortabfrage im GRUB, während <code class="notranslate">--user BENUTZERNAME</code> dem entsprechenden Benutzer das Booten des Eintrags ermöglicht. Zu beachten ist, dass diese Änderungen überschrieben werden, wenn eine Aktualisierung des Pakets für GRUB 2 aufgespielt wird. Die entsprechende Zeile sieht danach wie folgt aus:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nb">echo</span> <span class="s2">"menuentry '</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$title</span><span class="s2">"</span> <span class="p">|</span> grub_quote<span class="k">)</span><span class="s2">' --unrestricted </span><span class="si">${</span><span class="nv">CLASS</span><span class="si">}</span><span class="s2"> \$menuentry_id_option 'gnulinux-</span><span class="nv">$version</span><span class="s2">-</span><span class="nv">$type</span><span class="s2">-</span><span class="nv">$boot_device_id</span><span class="s2">' {"</span> <span class="p">|</span> sed <span class="s2">"s/^/</span><span class="nv">$submenu_indentation</span><span class="s2">/"</span>
</pre></div>
</td></tr></table></div><p>
oder</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nb">echo</span> <span class="s2">"menuentry '</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$title</span><span class="s2">"</span> <span class="p">|</span> grub_quote<span class="k">)</span><span class="s2">' --users 'BENUTZERNAME' </span><span class="si">${</span><span class="nv">CLASS</span><span class="si">}</span><span class="s2"> \$menuentry_id_option 'gnulinux-</span><span class="nv">$version</span><span class="s2">-</span><span class="nv">$type</span><span class="s2">-</span><span class="nv">$boot_device_id</span><span class="s2">' {"</span> <span class="p">|</span> sed <span class="s2">"s/^/</span><span class="nv">$submenu_indentation</span><span class="s2">/"</span>
</pre></div>
</td></tr></table></div><p>Sollen nur bestimmte Einträge freigeschaltet werden, kann der entsprechende Eintrag in der <strong>/boot/grub/grub.cfg</strong> geändert werden. Diese Änderung muss jedoch nach jedem Lauf von <code class="notranslate">update-grub</code>, beispielsweise bei einer Aktualisierung des Linux-Kernel-Pakets wiederholt werden.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>menuentry <span class="s1">'Ubuntu, mit Linux 3.5.0-17-generic'</span> --unrestricted <span class="o">{</span>
</pre></div>
</td></tr></table></div><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>menuentry <span class="s1">'Ubuntu, mit Linux 3.5.0-17-generic'</span> --users <span class="s1">'BENUTZERNAME'</span> <span class="o">{</span>
</pre></div>
</td></tr></table></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="Intern">Intern<a class="headerlink" href="#Intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="../grub_2.html">GRUB 2 Übersicht</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/></p><ul><li><p><a class="internal" href="../grub_2/problembehebung.html">GRUB 2 Probleme und Lösungen</a></p></li><li><p><a class="internal" href="../grub_2/installation.html">GRUB 2 Installation</a></p></li><li><p><a class="internal" href="../grub_2/skripte.html">GRUB 2 Skripte</a></p></li><li><p><a class="internal" href="../grub_2/reparatur.html">GRUB 2 Reparatur</a></p></li><li><p><a class="internal" href="../grub_umgebung_analysieren.html">GRUB 2 Umgebung analysieren</a></p></li><li><p><a class="internal" href="../grub_2/shell.html">GRUB 2 Shell</a></p></li><li><p><a class="internal" href="../grub_2/aussehen.html">GRUB 2 optisch anpassen</a></p></li><li><p><a class="internal" href="../grub_2/terminalbefehle.html">GRUB 2 Terminalbefehle</a></p></li><li><p><a class="internal" href="../grub_2/grundlagen.html">GRUB 2 Grundlagen</a></p></li></ul></li><li><p><a class="internal" href="../efibootmgr.html">efibootmgr</a> - Konfiguration des (U)EFI Bootmenüs</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Extern">Extern<a class="headerlink" href="#Extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="http://www.gnu.org/software/grub/manual/" rel="nofollow">Grub 2 Handbuch</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <img alt="{dl}" src="../_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/></p></li><li><p><a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/Grub2">community/Grub2</a></p><ul><li><p><a class="interwiki interwiki-ubuntu_doc" href="https://help.ubuntu.com/community/Grub2#Password_Protection">Password Protection</a> Passwortschutz für GRUB 2</p></li></ul></li><li><p><a class="interwiki interwiki-uf_thread" href="https://ubuntuforums.org/showthread.php?t=1287602">Grub 2 (Title) Tweaks</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - diverse manuelle GRUB-Anpassungen</p></li><li><p><a class="internal" href="../grub_customizer.html">GRUB Customizer</a> - grafisches Werkzeug zum Bearbeiten der Bootmanager-Konfiguration</p></li></ul><p>
</p><ul class="footnotes"><li><a class="crosslink" href="#bfn-1" id="fn-1">1</a>: <a class="external" href="https://www.linuxvoice.com/issues/009/kernel.pdf" rel="nofollow">Kernel parameters</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Dip your toe into the mysterious heart of your 
Linux machine</li></ul></div></div></div>
<p class="meta">
<a href="../grub_2/konfiguration/a/revision/942676.html">Diese Revision</a> wurde am 20. Juli 2017 22:07 von <a href="https://ubuntuusers.de/user/ubot/">ubot</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../grub_2.html">GRUB 2</a></li>
<li><a href="../grub_2/konfiguration.html">Konfiguration</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>