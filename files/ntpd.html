<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>ntpd › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./ntpd.html">ntpd</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/ntpd">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./ntpd/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./ntpd/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./ntpd/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./ntpd/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./ntpd/a/backlinks.html">ntpd</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li></ol></div></div><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Empfehlenswerte-Zeitserver">Empfehlenswerte Zeitserver
</a></li><li><a class="crosslink" href="#externe-lokale-Zeitquellen-nutzen">externe lokale Zeitquellen nutzen
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Dieser Artikel beschreibt die Synchronisation der Software-Uhrzeit anhand des <strong>Network Time Protocol (NTP) daemon</strong> ntpd. Dieser arbeitet mit dem standardisierten Protokoll <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Network_Time_Protocol">NTP</a></p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Abkürzung NTP/ntp ist mehrdeutig. Dieser Artikel versucht, <strong>ntp</strong> als <a class="internal" href="./dienste.html">Dienst</a> gegenüber <strong>NTP</strong> als dem verwendeten Protokoll abzugrenzen.
</p></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Ubuntu synchronisiert die Software-Uhr seit Version <a class="internal" href="./16.04.html">16.04</a> bereits standardmäßig anhand <a class="internal" href="./systemd/timesyncd.html">timesyncd</a>.
</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
ntp kann direkt aus den Quellen installiert werden<sup><a href="#source-1">[1]</a></sup>
</p><ul><li><p><strong>ntp </strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install ntp  </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install ntp  </pre></div></div><p>
</p></div></div><div class="section_2"><h3 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h3><p>
Nach der Installation läuft der Dienst bereits und synchronisiert die Systemzeit anhand öffentlicher <a class="crosslink" href="#Zeitserver">Zeitserver</a>. Dies zeigt auch die Ausgabe von<sup><a href="#source-2">[2]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">service ntp status </pre></div></div></div><div class="section_2"><h3 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h3><p>
Die Konfigurationsdatei des Dienstes ist <strong>/etc/ntp.conf</strong>. Beispiel (Minimal-Variante):</p><pre class="notranslate"># /etc/ntp.conf, minimal configuration for ntpd; see ntp.conf(5) for help
server de.pool.ntp.org iburst</pre><p><a class="crosslink anchor" href="#Zeitserver" id="Zeitserver"></a>
</p></div></div><div class="section_1"><h2 id="Empfehlenswerte-Zeitserver">Empfehlenswerte Zeitserver<a class="headerlink" href="#Empfehlenswerte-Zeitserver">¶</a></h2><p>
Es empfiehlt sich, mehrere Zeitserver anzugeben, wenn möglich geographisch naheliegende. Es macht wenig Sinn, in Europa einen Zeitserver aus Amerika zu verwenden. ntp beobachtet und bewertet die angegebenen Zeitserver und sucht sich dabei selber den aktuell genauesten und besterreichbaren heraus. Der genaueste Server (Stratum 1) ist der, der sich hierarchisch am nächsten an der Originalzeitquelle (Stratum 0) befindet. Originalzeitquellen (Stratum 0) sollten in der Regel nicht selbst direkt abgefragt werden. Um eine Überlastung einzelner Zeitserver durch zu viele und zu häufige Anfragen zu vermeiden, wird empfohlen, keinen Zeitserver explizit anzugeben (z.B. ptbtime1.ptb.de), sondern einen der unten genannten Pools zu nutzen, für Deutschland z.B. aus dem pool.ntp.org Projekt.</p><p>Vorschläge für sinnvolle Zeitserver:</p><table style="width: 95%"><tr><td colspan="2" style="text-align: center; background-color: #E2C890"><strong>Zeitserver</strong></td></tr><tr style="background-color: #F9EAAF"><td><strong>Server</strong></td><td><strong>Beschreibung</strong></td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">0.de.pool.ntp.org</code> ... <code class="notranslate">3.de.pool.ntp.org</code> </td><td> <a class="external" href="http://www.pool.ntp.org/de/" rel="nofollow">Projektseite</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </td></tr><tr><td> <code class="notranslate">ptbtime1.ptb.de</code> </td><td> Physikalisch-Technische Bundesanstalt (Braunschweig) </td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">ptbtime2.ptb.de</code> </td><td> wie oben, alternativer Server </td></tr><tr><td> <code class="notranslate">ptbtime3.ptb.de</code> </td><td> wie oben, alternativer Server </td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">time-a.nist.gov</code> </td><td> National Institute of Standards and Technology (USA) </td></tr><tr><td> <code class="notranslate">time-b.nist.gov</code> </td><td> wie oben, alternativer Server </td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">pool.ntp.org</code> </td><td> wählt bei jedem Neustart per Zufall einen von etwa 1700 empfohlenen Zeitservern aus </td></tr><tr><td> <code class="notranslate">de.pool.ntp.org</code> </td><td> wie oben, wählt aber nur deutsche Zeitserver aus </td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">europe.pool.ntp.org</code> </td><td> wie oben, wählt aber nur europäische Zeitserver aus </td></tr><tr><td> <code class="notranslate">ntp.ubuntu.com</code> </td><td> Zeitserver von Ubuntu </td></tr><tr style="background-color: #EEEEEE"><td> <code class="notranslate">0.debian.pool.ntp.org</code> ... <code class="notranslate">3.debian.pool.ntp.org</code> </td><td> Zeitserver Pool von Debian </td></tr><tr><td> <code class="notranslate">0.ubuntu.pool.ntp.org</code> ... <code class="notranslate">3.ubuntu.pool.ntp.org</code> </td><td> Zeitserver Pool von Ubuntu </td></tr></table><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Mittels <a class="internal" href="./samba.html">Samba</a> ist es möglich, dass Windows-Clients ihre Zeit mit dem Server synchronisieren können (siehe <a class="internal" href="./samba_server/smb.conf.html#Zeit-Synchronisation">Samba Server/smb.conf</a>).
</p></div></div></div><div class="section_1"><h2 id="externe-lokale-Zeitquellen-nutzen">externe lokale Zeitquellen nutzen<a class="headerlink" href="#externe-lokale-Zeitquellen-nutzen">¶</a></h2><p>
Die Nutzung von ntp in Kombination mit einer externen lokalen Zeitquelle ist im Artikel <a class="internal" href="./ntpd/ntp_mit_externen_lokalen_zeitquellen.html">ntp mit externen lokalen Zeitquellen</a> erklärt.</p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Abweichung-zu-Zeitservern-anzeigen">Abweichung zu Zeitservern anzeigen<a class="headerlink" href="#Abweichung-zu-Zeitservern-anzeigen">¶</a></h3><p>
Will man herausfinden, um wie weit die Systemzeit von den angegebenen Zeitservern abweicht ("offset"), kann einer der beiden folgenden Befehle im Terminal<sup><a href="#source-2">[2]</a></sup> ausgeführt werden:</p><div class="bash"><div class="contents"><pre class="notranslate"># Offset zu jedem einzelnen Zeitserver (in ms)
ntpq -p
# für ntp relevanter Offset (in s)
# nach einem Neustart des ntp-Servers kann einige Zeit vergehen, bis hier ein Wert steht
ntpdc -c loopinfo </pre></div></div><p>
Hierbei ist allerdings zu beachten, dass die Systemzeit außer bei sehr großen Abweichungen "fließend" bzw. "schleichend" angepasst wird. Das heißt, dass die Systemzeit minimal langsamer oder schneller läuft, als sie eigentlich laufen müsste. Dadurch geht die Synchronisation nur langsam vonstatten, aber es treten keine Fehler durch Zeitsprünge auf. Beim Herunterfahren des Systems wird hingegen die Uhrzeit der Hardware-Uhr mit der vollen Abweichung überschrieben.</p></div><div class="section_2"><h3 id="ntp-korrigiert-die-Rechner-Uhrzeit-nicht">ntp korrigiert die Rechner-Uhrzeit nicht<a class="headerlink" href="#ntp-korrigiert-die-Rechner-Uhrzeit-nicht">¶</a></h3><p>
Läuft der ntp-Dienst nicht korrekt (z.B. unsinnige Ausgabe bei <code class="notranslate">ntpq -p</code> bzw. <code class="notranslate">ntpdc -c loopinfo</code>), so hilft ggf. der Befehl<sup><a href="#source-2">[2]</a></sup><sup><a href="#source-3">[3]</a></sup> zum Neustarten des Dienstes:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service ntp restart </pre></div></div><p>Eine weitere Problemquelle sind zu große Abweichungen zwischen lokaler und Internet-Zeit. Dann wird zuerst der ntp-Dienst beendet:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service ntp stop </pre></div></div><p>Nun setzt man die Zeit manuell:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ntpd -q -g -x -n </pre></div></div><p>Zum Schluss wird der ntp-Dienst wieder gestartet:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service ntp start </pre></div></div><p>Ver besonders vorsichtig sein möchte startet den Rechner nach dieser Prozedur neu, da der auftretende "Zeitsprung" unvorhersehbare Konsequenzen haben kann.</p><p><a class="crosslink anchor" href="#dualboot" id="dualboot"></a>
</p></div><div class="section_2"><h3 id="Falsche-Uhrzeit-bei-Windows-Mac-Linux-Parallelinstallation">Falsche Uhrzeit bei Windows-/Mac-/Linux-Parallelinstallation<a class="headerlink" href="#Falsche-Uhrzeit-bei-Windows-Mac-Linux-Parallelinstallation">¶</a></h3><p>
Das System muss neben der Zeitzone auch wissen, wie die Hardware-Uhr konfiguriert ist. Unter UNIX und Mac OS X läuft sie standardmäßig nach <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/UTC">koordinierter Weltzeit (UTC)</a>, während unter DOS/Windows die Hardware-Uhr nach lokaler Zeit gestellt wird. Dadurch geht in Windows die Zeit um eine (Winter-) bzw. zwei (Sommerzeit) Stunden nach, wenn man sie unter Linux korrekt stellt. Es empfiehlt sich daher, beide Systeme auf die selbe Methode einzustellen.</p><div class="section_3"><h4 id="Windows-auf-UTC-umstellen">Windows auf UTC umstellen<a class="headerlink" href="#Windows-auf-UTC-umstellen">¶</a></h4><p>
Windows kann man über die Systemregistrierung auf UTC umstellen bzw. mit UTC betreiben. Dazu legt man mit dem Windows-Editor eine Datei namens <strong>utc.reg</strong> an und fügt folgenden Inhalt ein:</p><pre class="notranslate">Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation]
"RealTimeIsUniversal"=dword:00000001

</pre><p>Wichtig sind zwei Leerzeilen am Ende der Datei! Danach speichert man die Datei ab und führt sie als Administrator mit einem Doppelklick aus. Teilweise ist ein Neustart erforderlich, damit die Uhrzeit korrekt angezeigt wird.</p><p>Alternativ kann auch folgender Windows-Befehl ausgeführt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">reg.exe add HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation /v RealTimeIsUniversal /t REG_DWORD /d 1 /f </pre></div></div></div></div><div class="section_2"><h3 id="Eigene-Zeitserver">Eigene Zeitserver<a class="headerlink" href="#Eigene-Zeitserver">¶</a></h3><p>
Wer einen eigenen öffentlich über das Internet erreichbaren Zeitserver betreibt, tut gut daran, diesen gegen Angriffe abzusichern. Mehr Hintergrundinformationen und weitere Maßnahmen sind der Anleitung <a class="external" href="http://heise.de/-2087846" rel="nofollow">Kommt Zeit, kommt – DDoS-Angriff</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> zu entnehmen (Stand: 01/2014).</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.eecis.udel.edu/~mills/ntp/html/release.html" rel="nofollow">NTP Version 4 Release Notes (David L. Mills, PhD, Professor)</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://www.eecis.udel.edu/~mills/ntp.html" rel="nofollow">Network Time Synchronization Research Project (David L. Mills, PhD, Professor)</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://www.eecis.udel.edu/~mills/ntp/html/refclock.html#list" rel="nofollow">Referenz-Uhren Hardwareliste (David L. Mills, PhD, Professor)</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://www.ntp-zeit.de/" rel="nofollow">Allgemeine Erklärung des NTP Protokolls</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Network_Time_Protocol">Network Time Protocol (NTP)</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./ntpd/a/revision/944997.html">Diese Revision</a> wurde am 22. November 2017 17:17 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./ntpd.html">ntpd</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>