<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Netzwerkbrücke › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./netzwerkbrücke.html">Netzwerkbrücke</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Netzwerkbrücke">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./netzwerkbrücke/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./netzwerkbrücke/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./netzwerkbrücke/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./netzwerkbrücke/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./netzwerkbrücke/a/backlinks.html">Netzwerkbrücke</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./interfaces.html">Die Datei /etc/network/interfaces</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Paket-installieren">Paket installieren
</a></li><li><a class="crosslink" href="#Einrichtung">Einrichtung
</a></li><li><a class="crosslink" href="#Konflikt-mit-NetworkManager">Konflikt mit NetworkManager
</a></li><li><a class="crosslink" href="#Bruecken-in-drahtlose-Netze">Brücken in drahtlose Netze
</a></li><li><a class="crosslink" href="#Einsatzszenarien">Einsatzszenarien
</a></li><li><a class="crosslink" href="#Link">Link
</a></li></ol></div><p>Eine <em>Netzwerkbrücke</em> (engl. <em>bridge</em>) ist ein Computer bzw. Gerät, dass zwei physikalische Netzwerke zu einem gemeinsamen zusammenschließt. Im Gegensatz zu einem <a class="internal" href="./router.html">Router</a> hat eine Bridge eine gemeinsame IP-Adresse für alle zusammengeschlossenen Schnittstellen, und die IPs der angeschlossenen Rechner liegen alle im selben logischen Netzwerk. Auch <em>Broadcast</em>-, <em>Arp</em>- und sonstige Pakete, die ein Router normalerweise blockiert, können frei über eine Bridge laufen.</p><p>Eine praktische Anwendung für eine Bridge ist der Zusammenschluss verschiedener Netze, die unterschiedliche Transportmedien nutzen, z.B. LAN und WLAN.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Leider funktioniert das nicht mit allen WLAN-Karten. Um Bridging betreiben zu können, muss der Treiber in der Lage sein, Pakete mit unterschiedlichen MAC-Adressen über ein und dieselbe Schnittstelle zu versenden. Das macht die Firmware einiger Karten aber nicht mit. (Siehe <a class="external" href="http://www.linuxfoundation.org/collaborate/workgroups/networking/bridge#It_doesn.27t_work_with_my_Wireless_card.21" rel="nofollow">hier</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> .)</p><p>Prism- und Atheros-Karten sollen angeblich funktionieren. Intel Centrino (ipw2200) funktioniert leider definitiv nicht. Wessen Chipsatz diesen Stunt nicht kann, der kann sich nur entweder eine neue WLAN-Karte besorgen oder statt einer Bridge einen <a class="internal" href="./router.html">Router</a> bauen.</p></div></div><p>
<img alt="./bridge-entwurf.png" class="image-center" src="./_/a3801faf1e269ea77d2efdb317a08d4648a66a4c.png"/></p><p>Man kann auf einer Bridge auch Paketfilter einsetzen, und damit den freien Datenverkehr wieder einschränken. Um logistisch unabhängige Netze miteinander zu verbinden, ist aber doch ein <a class="internal" href="./router.html">Router</a> die bessere Wahl.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>
Selbstverständlich ist es auch möglich, mehrere Brücken aus unterschiedlichen Schnittstellen zusammenzustellen und zwischen diesen dann zu routen.</p></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Eine Bridge ist kein <em>Gateway</em>, sondern leitet den gesamten Verkehr automatisch nach allen Seiten weiter (Vergleichbar mit einem Hub). Auf den Rechnern im Netzwerk sollte deswegen nirgendwo die Bridge als Gateway eingetragen werden, sondern der zugehörige Router, auch wenn er netzwerktopologisch hinter der Bridge liegt.</p></div></div><div class="section_1"><h2 id="Paket-installieren">Paket installieren<a class="headerlink" href="#Paket-installieren">¶</a></h2><p>
Folgendes Paket muss installiert <sup><a href="#source-1">[1]</a></sup> werden:
</p><ul><li><p><strong>bridge-utils</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install bridge-utils </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install bridge-utils </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Einrichtung">Einrichtung<a class="headerlink" href="#Einrichtung">¶</a></h2><p>
Eine Bridge kann relativ einfach über die Datei <strong>/etc/network/interfaces</strong> <sup><a href="#source-4">[4]</a></sup> eingerichtet werden <sup><a href="#source-3">[3]</a></sup>. Im großen und ganzen funktioniert die Deklaration einer Bridge dort wie die herkömmlicher Schnittstellen auch, abgesehen davon, dass Bridge-Interfaces mit <em>br</em> beginnen und es ein paar spezielle Zusatzoptionen gibt. Die Parameter müssen natürlich an die lokalen Gegebenheiten angepasst werden: 
</p><pre class="notranslate">auto br0
iface br0 inet static
    address 192.168.4.2
    netmask 255.255.255.0
    gateway 192.168.4.1
    bridge_ports eth0 wlan0
    bridge_fd 5
    bridge_stp no   # unter Umständen auf 'yes' setzen - s.u.</pre><p>
Die Option <em>bridge_ports</em> ist die wichtigste und dient zur Auflistung aller Netzwerkschnittstellen, die zur Bridge zusammengefasst werden. Alternativ möglich ist auch das Schlüsselwort <em>all</em>. Um Firewire-Schnittstellen, Loopback und ähnliche potentielle Überraschungen als Bridge-Mitglieder zu vermeiden, empfiehlt sich diese Option aber nicht. 
Wenn man nur ein rein internes Netzwerk erstellen will darf dieser Parameter nicht weggelassen werden, da sonst die Bridge nicht automatisch angelegt wird, sondern ist auf <em>none</em> zu stellen.</p><p>Die Option <em>bridge_fd</em> ist ein Timeout-Wert bei der Erstellung der Brücke. Die standardmäßigen 15 Sekunden sind meist unnötig lang und können eigentlich problemlos auf 5 Sekunden verkürzt werden. Nur wenn es dabei zu Fehlern kommt, sollte man den Wert wieder anheben.</p><p><em>bridge_stp</em> ist ein Protokoll, das Zirkelschlüsse vermeiden und Wege im LAN optimieren soll. Wer mehrere Bridges und/oder kreisförmige LAN-Konstruktionen verwendet, sollte es auf jeden Fall aktivieren. Alle anderen können das deaktivieren.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>
Es gibt noch eine Handvoll weiterer Tuning-Parameter für Bridges. Es sei hiermit auf die Datei <strong>/usr/share/doc/bridge-utils/README.Debian.gz</strong> verwiesen sowie auf die Manpage des Programms <strong>brctl</strong>.</p></div></div><p>Nach einem beherzten <strong>sudo ifup br0</strong> <sup><a href="#source-2">[2]</a></sup> sollte die Brücke jetzt funktionieren, was man mit den Befehlen <strong>ifconfig</strong> und <strong>brctl show</strong> überprüfen kann: 
</p><div class="bash"><div class="contents"><pre class="notranslate">$ ifconfig
br0       Protokoll:Ethernet  Hardware Adresse 00:0F:3D:57:BD:E7
          inet Adresse:192.168.4.2  Bcast:192.168.4.255  Maske:255.255.255.0
          inet6 Adresse: fe80::20f:3dff:fe57:bde7/64 Gültigkeitsbereich:Verbindung
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:10 errors:0 dropped:0 overruns:0 frame:0
          TX packets:15 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenlänge:0
          RX bytes:892 (892.0 b)  TX bytes:1139 (1.1 KiB)

[...]

$ brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.000f3d57bde7       no              wlan0
                                                        eth0 </pre></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Man beachte, dass die ursprünglichen Interfaces nach dem Abbau der Brücke mit <strong>sudo ifdown br0</strong> ihre ursprünglichen IP-Adressen nicht automatisch zurückerhalten. Wer also nach einem "Brückentest" nicht mehr ins Netz kommt, muss die entsprechenden Schnittstellen mit Hilfe von <strong>ifdown</strong> und <strong>ifup</strong> auf die vorherigen Werte zurücksetzen.</p><p>Für eine dauerhafte Lösung empfiehlt es sich, die Brücke in der <strong>interfaces</strong>-Datei mit einer <em>auto</em>-Zeile zu versehen und die <em>auto</em>-Zeilen der beteiligten Schnittstellen auszukommentieren.</p></div></div></div><div class="section_1"><h2 id="Konflikt-mit-NetworkManager">Konflikt mit NetworkManager<a class="headerlink" href="#Konflikt-mit-NetworkManager">¶</a></h2><p>
Sollte sich der NetworkManager  nicht von seiner Aufgabe abbringen lassen, kann man mit diesem einfachen Workaround die beteiligten interfaces in <strong>/etc/network/interfaces</strong> mit <strong>auto eth0</strong> und <strong>iface eth0 inet manual</strong> auf manuell umschalten, und wer nicht auf die GUI-Netzwerkverwaltung angewiesen ist, der kann die Pakete <strong>network-manager</strong> und <strong>network-manager-gnome</strong> einfach entfernen.</p></div><div class="section_1"><h2 id="Bruecken-in-drahtlose-Netze">Brücken in drahtlose Netze<a class="headerlink" href="#Bruecken-in-drahtlose-Netze">¶</a></h2><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Diese Funktion des Kernels wurde deaktiviert. Soll ein WLAN-Adapter in eine Brücke integriert werden, so muss sich dieser im Master-Modus befinden! Die ist so nur in Kombination mit <strong>hostapd</strong> und einer Konfiguration als <a class="internal" href="./wlan_router.html">WLAN Router</a> möglich. Alternative wäre den Kernel mit der entsprechenden Option selbst zu kompilieren.
</p></div></div><p>Wer WLANs in die Brücke mit einbeziehen will, der muss bedenken, dass der Bridge-Treiber keine Ahnung von WLAN-ESSIDs, WPA-Schlüsseln, etc. hat. Das Wireless Interface muss also vor dem Brückenbau mit dem Access Point verbunden sein. Das kann man erreichen, indem man einen ganz normalen, funktionierenden WLAN-Block in die <a class="internal" href="./interfaces.html">interfaces</a>-Datei <sup><a href="#source-4">[4]</a></sup> einträgt, jedoch ohne ein <em>auto</em>-Statement. Jetzt kann man im Abschnitt des Bridge-Devices folgende Zeile ergänzen (Gerätenamen bei Bedarf anpassen): 
</p><pre class="notranslate">    pre-up ifup wlan0</pre><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>
Für madwifi hat es mit diesem Befehl nicht funktioniert. Die Bridge wird zwar initialisiert, aber ohne das athX-Interface.</p></div></div><p>
Geklappt hat für das reine Initialisieren der Karte ohne Verschlüsselung:</p><pre class="notranslate">    pre-up iwconfig ath0 essid WLAN</pre><p>
mit einfacher WEP-Verschlüsselung dann...</p><pre class="notranslate">    pre-up iwconfig ath0 essid WLAN key s:wepkey</pre><p>
usw. pre-up kann mehrfach vorkommen...</p></div><div class="section_1"><h2 id="Einsatzszenarien">Einsatzszenarien<a class="headerlink" href="#Einsatzszenarien">¶</a></h2><p>
Neben der o.a. Möglichkeit, LAN und WLAN zu einem gemeinsamen Netz zu verbinden, warten u.a. folgende Konfigurationen darauf, getestet zu werden:
</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>
</p><ul><li><p><em>Stealth Firewall</em> <br/>In dieser Konfiguration wird die Brücke ohne IP-Adresse konstruiert, dafür läuft ein <a class="internal" href="./iptables.html">Paketfilter</a> und evtl. ein <em>Network Intrusion Detection System</em> wie <strong>snort</strong>. Diese Firewall kann nur sehr schwer angegriffen werden. Oft entgeht dem Angreifer ihre Existenz sogar ganz. </p></li><li><p><em>VPN erweitern</em> <br/>Mehrere Rechner des lokalen Netzes in ein <em>Virtual Private Network</em> einbinden. </p></li><li><p><em>Zwei Standorte zusammenschließen</em> <br/>An beiden Standorten existiert je eine Bridge. Diese sind durch eine schnelle WAN-Verbindung verbunden.(VPN) </p></li></ul></div></div></div><div class="section_1"><h2 id="Link">Link<a class="headerlink" href="#Link">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.linuxfoundation.org/collaborate/workgroups/networking/bridge" rel="nofollow">network bridge</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - distributionsunabhängiger Artikel mit mehr technischen Details </p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./netzwerkbrücke/a/revision/944360.html">Diese Revision</a> wurde am 21. Oktober 2017 20:46 von <a href="https://ubuntuusers.de/user/NikP/">NikP</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./netzwerkbrücke.html">Netzwerkbrücke</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>