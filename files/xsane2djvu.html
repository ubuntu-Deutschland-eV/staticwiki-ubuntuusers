<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>xsane2djvu › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./xsane2djvu.html">xsane2djvu</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/xsane2djvu">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./xsane2djvu/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./xsane2djvu/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./xsane2djvu/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./xsane2djvu/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./xsane2djvu/a/backlinks.html">xsane2djvu</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./programme_kompilieren.html">Pakete aus dem Quellcode erstellen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./packprogramme.html">Archive entpacken</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-7" id="source-7"></a> <a class="internal" href="./editor.html">Einen Editor verwenden</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Vorbereitung">Vorbereitung
</a></li><li><a class="crosslink" href="#Skript">Skript
</a></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a><ol class="arabic"><li><a class="crosslink" href="#Beispiele">Beispiele
</a></li><li><a class="crosslink" href="#Korrekturen-an-der-Vorlage">Korrekturen an der Vorlage
</a></li><li><a class="crosslink" href="#Nutzung-von-unpaper">Nutzung von unpaper
</a></li><li><a class="crosslink" href="#Nutzung-von-Bildbearbeitungsprogrammen">Nutzung von Bildbearbeitungsprogrammen
</a></li><li><a class="crosslink" href="#Automatisches-Drehen-der-Vorlage">Automatisches Drehen der Vorlage
</a></li><li><a class="crosslink" href="#DjVu-Dateien-ohne-Textebene">DjVu-Dateien ohne Textebene
</a></li><li><a class="crosslink" href="#Einfuegen-und-Loeschen-von-Seiten">Einfügen und Löschen von Seiten
</a></li><li><a class="crosslink" href="#Zusammenfuehren-einzelner-DjVu-Dateien">Zusammenführen einzelner DjVu-Dateien
</a></li></ol></li><li><a class="crosslink" href="#Probleme-und-Loesungen">Probleme und Lösungen
</a><ol class="arabic"><li><a class="crosslink" href="#Cuneiform">Cuneiform
</a></li><li><a class="crosslink" href="#Tesseract-ocr">Tesseract-ocr
</a></li></ol></li><li><a class="crosslink" href="#Alternativen">Alternativen
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="XSane/xsane-logo.png" class="image-left" src="./_/f2dfa6da37105e77c232b5cab004a8e96d4b3c07.png"/>
Mit xsane2djvu lassen sich farbige mehrlagige <a class="internal" href="./djvu.html">DjVu</a>-Dateien direkt aus <a class="internal" href="./xsane.html">XSane</a> heraus über die Texterkennungsfunktion realisieren. Über dieses Verfahren können ein- oder mehrseitige DjVu-Dateien erstellt werden, als Encoder können die Programme <a class="internal" href="./didjvu.html">didjvu</a> (Standard), <a class="external" href="http://djvu.sourceforge.net/doc/man/cjb2.html" rel="nofollow">cjb2</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (sinnvoll für "lineart"-Vorlagen), <a class="internal" href="./minidjvu.html">minidjvu</a> (nur für Schwarz-Weiß-Vorlagen), <a class="external" href="http://djvu.sourceforge.net/doc/man/cpaldjvu.html" rel="nofollow">cpaldjvu</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (für Vorlagen mit wenigen Farben) oder <a class="external" href="http://djvu.sourceforge.net/doc/man/c44.html" rel="nofollow">c44</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (für reine Grafik-DjVu-Dateien, keine automatische Texterkennung möglich!) eingesetzt werden. Zusammen mit der <a class="internal" href="./djvu.html#Aufbau-des-Formats">Segmentierung</a> und dem Programm <a class="internal" href="./ocrodjvu.html">ocrodjvu</a> ist es auch für "Privat"-Anwender relativ einfach möglich, die bitonale Ebene einer Bildvorlage zu extrahieren, und eine mehrlagige DjVu-Datei mit Textebene zu erstellen. Über XSane lassen sich dabei die Scan-Optionen gezielt setzen, um so eine spätere Nachbearbeitung weitestgehend zu umgehen.</p><div class="section_1"><h2 id="Vorbereitung">Vorbereitung<a class="headerlink" href="#Vorbereitung">¶</a></h2><p>
Voraussetzung ist eine Installation von <a class="internal" href="./didjvu.html">didjvu</a>, außerdem der grundlegenden DjVu-Programme, <a class="internal" href="./ocrodjvu.html">ocrodjvu</a> zur Texterkennung (mit den gewünschten OCR-Programmen, unterstützt werden <a class="internal" href="./cuneiform-linux.html">Cuneiform-Linux</a>, <a class="internal" href="./gocr.html">GOCR</a>, <a class="internal" href="./ocrad.html">Ocrad</a>, <a class="internal" href="./tesseract-ocr.html">tesseract-ocr</a>), sowie natürlich des Scanprogramms <a class="internal" href="./xsane.html">XSane</a>:</p><ul><li><p><strong>djvulibre-bin</strong> (<em>universe</em>)</p></li><li><p><strong>ocrodjvu</strong> (<em>universe</em>)</p></li><li><p><strong>xsane</strong> (<em>universe</em>)</p></li><li><p><strong>gocr</strong> (<em>universe</em>, optional)</p></li><li><p><strong>ocrad</strong> (<em>universe</em>, optional)</p></li><li><p><strong>tesseract-ocr</strong> (sowie die gewünschten Sprachpakete, optional)</p></li><li><p><strong>cuneiform</strong> (optional)</p></li><li><p><strong>didjvu</strong></p></li><li><p><strong>unpaper</strong> (optional)</p></li><li><p><strong>exactimage</strong> (optional)</p></li><li><p><strong>imagemagick</strong> (optional)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install djvulibre-bin ocrodjvu xsane gocr ocrad tesseract-ocr cuneiform didjvu unpaper exactimage imagemagick </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install djvulibre-bin ocrodjvu xsane gocr ocrad tesseract-ocr cuneiform didjvu unpaper exactimage imagemagick </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Skript">Skript<a class="headerlink" href="#Skript">¶</a></h2><p>
Das eigentliche Skript wird in einen Editor<sup><a href="#source-7">[7]</a></sup> kopiert, unter einem aussagekräftigen Namen, z.B. <strong>xsane2djvu.sh</strong> abgespeichert und ausführbar<sup><a href="#source-4">[4]</a></sup> gemacht. Alternativ kann man es auch <a class="crosslink" href="./xsane2djvu.html">herunterladen</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/>.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#    xsane2djvu - djvu directly from xsane</span>
<span class="c1">#    Copyright (C) 2010 Heinrich Schwietering</span>
<span class="c1"># </span>
<span class="c1">#    This program is free software: you can redistribute it and/or modify</span>
<span class="c1">#    it under the terms of the GNU General Public License as published by</span>
<span class="c1">#    the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">#    (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#    This program is distributed in the hope that it will be useful,</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">#    GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#    You should have received a copy of the GNU General Public License</span>
<span class="c1">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1">#                                   xsane2djvu 0.7</span>
<span class="c1">#</span>
<span class="c1">#           *** djvu made simple (well, kind of ...) ***</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##############################################################################</span>
<span class="c1"># </span>
<span class="c1"># xsane2djvu is a wrapper script to produce djvu files with xsane.</span>
<span class="c1"># It "mimics" the segmentation process used by commercial djvu products. </span>
<span class="c1"># The scan is converted into a multilayered djvu file using didjvu </span>
<span class="c1"># which depends on the gamera-framework to produce a foreground mask.</span>
<span class="c1"># Other encoders like cjb2, c44, cpaldjvu or minidjvu are possible as well.</span>
<span class="c1"># Finally a text layer is added, using ocrdjvu (OCR engines cuneiform,</span>
<span class="c1"># tesseract-ocr, gocr and ocrad) and addup the pages to a bundled djvu file.</span>
<span class="c1">#</span>

<span class="nv">TEMP_DIR</span><span class="o">=</span>/tmp/      <span class="c1"># folder for temporary files (all files)</span>
<span class="nv">ERRORLOG</span><span class="o">=</span><span class="s2">"xsane2djvu.log"</span>  <span class="c1"># file where STDERR goes </span>

<span class="k">if</span> <span class="o">[[</span> -z <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>  <span class="o">]]</span>
  <span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> [OPTIONS]</span>
<span class="s2">  run the script as OCR-application for xsane!</span>
<span class="s2">  xsane2djvu uses a ppm files, and produces a 'split' djvu file using</span>
<span class="s2">  didjvu as standard application, the result is ocred using ocrodjvu</span>
<span class="s2">  </span>
<span class="s2">  OPTIONS:</span>
<span class="s2">    -i &lt;filename&gt; - temporary XSANE file</span>
<span class="s2">    -o &lt;filename&gt; - name for the single page output</span>
<span class="s2">    -l &lt;language&gt; - define the language used for recognition</span>
<span class="s2">    -e &lt;ocr engine&gt; - ocropus or cuneiform (with libmagick++-support!), noocr</span>
<span class="s2">     disables the ocr function</span>
<span class="s2">    -a &lt;-ocrodjvu-option&gt; - additional ocrodjvu options, optional</span>
<span class="s2">    -f &lt;/path/to/final/destination&gt; -complete path to save location for </span>
<span class="s2">       multipage-djvu, optional, without it a single page djvu is created</span>
<span class="s2">    -c &lt;encoder&gt; - usable c44 (no ocr possible), cjb2, cpaldjvu, or minidjvu; </span>
<span class="s2">       parameter is optional, without didjvu is used as standard</span>
<span class="s2">    -q &lt;-option for encoder&gt; additional options for encoder used, optional</span>
<span class="s2"> </span>
<span class="s2">  Progress- &amp; error-messages will be stored in this logfile:</span>
<span class="s2">     </span><span class="nv">$TEMP_DIR$ERRORLOG</span><span class="s2"></span>

<span class="s2">  xsane2djvu depends on</span>
<span class="s2">    - XSane http://www.xsane.org/</span>
<span class="s2">    - DjVuLibre http://djvu.sourgeforge.net</span>
<span class="s2">    - minidjvu http://minidjvu.sourceforge.net/</span>
<span class="s2">    - cuneiform-linux https://launchpad.net/cuneiform-linux Cuneiform-Linux</span>
<span class="s2">    - indirectly on libmagick-++dev  http://www.imagemagick.org/</span>
<span class="s2">    - or ocropus http://code.google.com/p/ocropus</span>
<span class="s2">    - didjvu and ocrodjvu http://jwilk.net/software/</span>
<span class="s2">    - indirectly on gamera http://gamera.informatik.hsnr.de/</span>
<span class="s2">  Some coding was stolen from 'ocube'</span>
<span class="s2">  http://www.geocities.com/thierryguy/ocube.html</span>

<span class="s2">  This djvu adaption is based on xsane2tess  </span>
<span class="s2">  http://doc.ubuntu-fr.org/xsane2tess, </span>

<span class="s2">  Hints always welcome! heinrich (dot) schwietering (at) gmx (dot) de</span>
<span class="s2">"</span>
  <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># get options...</span>
<span class="k">while</span> <span class="nb">getopts</span> <span class="s2">":i:o:l:e:a:f:c:q:"</span> OPTION
  <span class="k">do</span>
  <span class="k">case</span> <span class="nv">$OPTION</span> in 
    i<span class="o">)</span>  <span class="c1"># input filename (with path)</span>
      <span class="nv">FILE_PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    o <span class="o">)</span>  <span class="c1"># output filename</span>
      <span class="nv">FILE_OUT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    l <span class="o">)</span>  <span class="c1"># recognition language</span>
      <span class="nv">REGLANG</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    e <span class="o">)</span>  <span class="c1"># engine option </span>
      <span class="nv">ENGINE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    a <span class="o">)</span>  <span class="c1"># additional ocrodjvu option  </span>
      <span class="nv">OCROPT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    f <span class="o">)</span>  <span class="c1"># final name for bundled djvu file option </span>
      <span class="nv">FINAL</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    c <span class="o">)</span>  <span class="c1"># encoder to use (standard is didjvu)</span>
      <span class="nv">ENCODER</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
    q <span class="o">)</span>  <span class="c1"># option for encoder</span>
      <span class="nv">ENCOPT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span>
    <span class="p">;;</span>
  <span class="k">esac</span>
<span class="k">done</span>

<span class="c1"># redirect STDOUT to FILE_OUT</span>
<span class="nb">exec</span> <span class="m">1</span>&gt;&gt;<span class="nv">$FILE_OUT</span>

<span class="c1"># redirect STDERR to ERRORLOG</span>
<span class="nb">exec</span> <span class="m">2</span>&gt;&gt;<span class="nv">$TEMP_DIR$ERRORLOG</span>

<span class="c1"># strip path from FILE_PATH, use filename only</span>
<span class="nv">IN_FILE</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">FILE_PATH</span><span class="p">##*/.*</span><span class="si">}</span><span class="s2">"</span>

<span class="nb">echo</span> <span class="s2">"~~~+++~~~~+++~~~"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>

<span class="c1"># check if an encoder is requested</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$ENCODER</span> !<span class="o">=</span> <span class="s1">''</span> <span class="o">]]</span>
  <span class="k">then</span>
   <span class="o">{</span> 
<span class="c1"># check if minidjvu is requested</span>
     <span class="k">if</span> <span class="o">[[</span> <span class="nv">$ENCODER</span> <span class="o">==</span> <span class="s2">"minidjvu"</span> <span class="o">]]</span>
     <span class="k">then</span>
<span class="c1"># prepare file for minidjvu</span>
     convert <span class="s2">"</span><span class="nv">$IN_FILE</span><span class="s2">"</span> <span class="s2">"minidjvu.pbm"</span>
     <span class="nb">echo</span> <span class="s2">"file converted"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="c1"># use minidjvu and rename file</span>
     minidjvu <span class="nv">$ENCOPT</span> <span class="s2">"minidjvu.pbm"</span> <span class="s2">"minidjvu.djvu"</span>
     <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ENCODER</span><span class="s2"> </span><span class="nv">$ENCOPT</span><span class="s2"> used"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
     cp <span class="s2">"minidjvu.djvu"</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span>
     <span class="k">else</span>
<span class="c1"># use other requested encoder and options</span>
    <span class="nv">$ENCODER</span> <span class="nv">$ENCOPT</span> <span class="s2">"</span><span class="nv">$IN_FILE</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ENCODER</span><span class="s2"> </span><span class="nv">$ENCOPT</span><span class="s2"> used"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
    <span class="k">fi</span> 
    <span class="o">}</span>

  <span class="k">else</span>
<span class="c1"># produce segmented djvu file with didjvu</span>
    didjvu encode <span class="nv">$ENCOPT</span> -o <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$IN_FILE</span><span class="s2">"</span>
    <span class="nb">echo</span> <span class="s2">"didjvu </span><span class="nv">$ENCOPT</span><span class="s2"> used"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="k">fi</span>

<span class="c1"># check if ocr is requested</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$ENGINE</span> <span class="o">==</span> <span class="s1">'noocr'</span> <span class="o">]]</span>
    <span class="k">then</span>
       cp <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">.djvu"</span>
       <span class="nb">echo</span> <span class="s2">"no ocr used"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
    <span class="k">else</span>
<span class="c1"># check if language is set, if not use english; language is set according to used system language setting</span>
       <span class="k">if</span> <span class="o">[[</span> <span class="nv">$REGLANG</span> <span class="o">==</span> <span class="s2">""</span> <span class="o">]]</span>
          <span class="k">then</span>
          ocrodjvu --engine<span class="o">=</span><span class="nv">$ENGINE</span> -o <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">.djvu"</span> --language eng <span class="nv">$OCROPT</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
          <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ENGINE</span><span class="s2"> used with language eng </span><span class="nv">$OCROPT</span><span class="s2">"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="c1"># use requested engine and language for ocr</span>
       <span class="k">else</span>
           ocrodjvu --engine<span class="o">=</span><span class="nv">$ENGINE</span> -o <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">.djvu"</span> --language <span class="s2">"</span><span class="nv">$REGLANG</span><span class="s2">"</span> <span class="nv">$OCROPT</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
          <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ENGINE</span><span class="s2"> used with language </span><span class="nv">$REGLANG</span><span class="s2"> </span><span class="nv">$OCROPT</span><span class="s2">"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
       <span class="k">fi</span>
<span class="k">fi</span>

<span class="c1"># check if multipage document is requested</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$FINAL</span> !<span class="o">=</span> <span class="s1">''</span> <span class="o">]]</span>
  <span class="k">then</span>
  <span class="o">{</span> 
<span class="c1"># check if final file is already existing</span>
    <span class="k">if</span> <span class="o">[[</span> ! -a <span class="s2">"</span><span class="nv">$FINAL</span><span class="s2">"</span>.djvu <span class="o">]]</span>
      <span class="k">then</span>
<span class="c1"># start final djvu file</span>
        cp <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">.djvu"</span> <span class="s2">"</span><span class="nv">$FINAL</span><span class="s2">"</span>.djvu <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
        <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$FINAL</span><span class="s2"> started"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>

<span class="c1"># insert new djvu file at the end of final file</span>
      <span class="k">else</span>
       djvm -insert <span class="s2">"</span><span class="nv">$FINAL</span><span class="s2">"</span>.djvu <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">.djvu"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span> 
       <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2"> added to </span><span class="nv">$FINAL</span><span class="s2">"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
    <span class="k">fi</span> 
<span class="c1"># remove temporary single page djvu</span>
    rm <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span>.djvu

  <span class="o">}</span>

<span class="k">fi</span>

<span class="c1"># Remove djvu without text</span>
rm <span class="s2">"</span><span class="nv">$FILE_OUT</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"~~~+++~~~~+++~~~"</span> <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</pre></div>
</td></tr></table></div><p>Das Skript ist eine Weiterentwicklung des <a class="internal" href="./tesseract-ocr.html#xsane2tess">xsane2tess</a>-Skriptes, das auf <a class="interwiki interwiki-ubuntu_fr" href="http://doc.ubuntu-fr.org/xsane2tess">ubuntu-fr.org</a> veröffentlicht worden ist.</p><p>Das Temporärverzeichnis (Zeile 36) kann entsprechend der eigenen Wünsche abgepasst werden, dort wird auch die <strong>xsane2djvu.log</strong>-Datei abgelegt. Das Log wird in der Standardeinstellung nach Abschalten des Rechners gelöscht; wer es später verwenden möchte, sollte ein anderes Verzeichnis wählen, das aber bereits existieren muss!</p></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
In <em>"XSane -&gt; Einstellung -&gt; Konfiguration -&gt; Texterkennung"</em> wird als OCR-Befehl <em>"/PFAD/ZU/xsane2djvu.sh"</em> sowie weitere Optionen zur Steuerung angegeben. Verwendbare Optionen sind:</p><p>
</p><table><tr class="titel"><td colspan="2"> Optionen für xsane2djvu </td></tr><tr class="kopf"><td> Argument </td><td> Funktion </td></tr><tr><td> <code class="notranslate">-e [OCR-PROGRAMM]</code> </td><td> <code class="notranslate">cuneiform</code>, <code class="notranslate">gocr</code>, <code class="notranslate">ocrad</code> oder <code class="notranslate">tesseract</code>; <code class="notranslate">noocr</code> schaltet die Texterkennung ab </td></tr><tr class="highlight"><td> <code class="notranslate">-l [Sprachkürzel]</code> </td><td> Legt die verwendete Sprache für den OCR-Engine fest; optional, ohne Angabe wird Englisch verwendet </td></tr><tr><td> <code class="notranslate">-a ["OCRODJVU-OPTION(EN)"]</code> </td><td> ocrodjvu-Option(en), müssen in Anführungszeichen stehen; optional </td></tr><tr class="highlight"><td> <code class="notranslate">-f [/PFAD/ZUR/MULTIPAGE-DATEI/SAMMELNAME]</code> </td><td> Option zur Erstellung eines mehrseitigen Dokumentes, Angabe des kompletten Pfads ist nötig (<strong>~</strong> oder <strong>$HOME</strong> funktionieren nicht!); ohne Pfadangabe wird das Dokument im Homeverzeichnis des Benutzers abgelegt. Optional, ohne diese Option wird jeweils ein einseitiges DjVu-Dokument erstellt. </td></tr><tr><td> <code class="notranslate">-c [ENCODER]</code> </td><td> Verwendeter Encoder, nutzbar sind <code class="notranslate">c44</code> (keine Texterkennung über ocrodjvu möglich!), <code class="notranslate">cjb2</code>, <code class="notranslate">cpaldjvu</code> oder <code class="notranslate">minidjvu</code>. Die Verwendung ist optional, ohne sie wird didjvu eingesetzt. </td></tr><tr class="highlight"><td> <code class="notranslate">-q ["-ENCODER-OPTION(EN)"]</code> </td><td> Encoder-Option(en), müssen in Anführungszeichen stehen; optional </td></tr></table><p>Als Option für die Eingabedatei in <em>"XSane -&gt; Einstellungen -&gt; Konfiguration -&gt; Texterkennung"</em> werden <em>"-i"</em>, für die Ausgabedatei <em>"-o"</em> angeben, die weiteren Felder bleiben leer. Die möglichen Sprachkürzel für ocrodjvu lassen sich über den Befehl<sup><a href="#source-5">[5]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">ocrodjvu --engine OCR-PROGRAMM --list-languages </pre></div></div><p>ausgeben (und sind abhängig von den installierten <a class="internal" href="./tesseract-ocr.html#Installation">Tesseract-Sprachpaketen</a>), für Cuneiform lassen sich alle <a class="internal" href="./cuneiform-linux.html#Sprachen">unterstützten Sprachen</a> angeben, ohne Angabe ist die Standardeinstellung Englisch (<code class="notranslate">eng</code>). Als ocrodjvu-Optionen lassen sich natürlich nur für Einzelbilder sinnvolle Parameter eintragen, also z.B. <em>-a "-t words|lines|chars"</em> oder <em>"--word-segmentation simple|uax29"</em> (siehe <a class="internal" href="./ocrodjvu.html#Optionen">ocrodjvu-Optionen</a>), die Verwendung ist optional. Ähnliches gilt für die Optionen des verwendeten Encoders, Einzelheiten in den jeweiligen <a class="internal" href="./man.html">Manpages</a>. Die Optionen müssen wie in der Tabelle angegeben in Anführungszeichen gesetzt werden.</p><p>Die Vorlage wird in XSane im <a class="internal" href="./xsane.html#Betrachter">Betrachter-Modus</a> erstellt. Als Auflösung werden 300 dpi empfohlen, die Farbeinstellung je nach Vorlage gewählt. Im Betrachter die Texterkennung (<img alt="xsane/xsane-ocr.jpg" class="image-default" src="./_/4e3625efd312583aec31a27d72d118b883c2ed49.png"/>-Taste) wählen, der Ausgabename wird <span class="underline">ohne</span> Endung im OCR-Speicher-Dialog festgelegt (für die Erstellung mehrseitige Dateien ist das unerheblich). Alternativ kann auch, wenn keine Kontrolle/zusätzliche Speicherung des Bildes erforderlich sind, im <a class="internal" href="./xsane.html#Speichern">Speichermodus</a> mit der Erweiterung <em>"TEXT"</em> direkt die Erstellung der Datei erfolgen, ohne im Betrachter-Modus die OCR-Funktion aufrufen zu müssen. Die DjVu-Datei wird dann in angegebenen Verzeichnis (Schreibrechte nötig!), wenn die Option -f verwendet wird, als <strong>SAMMELNAME.djvu</strong> abgelegt, und enthält eine durchsuchbare Textebene. Die Qualität der Texterkennung ist dabei vom Aufbau der Vorlage abhängig; je "verschachtelter" Text und Grafikelemente sind, desto schwieriger wird die exakte Zerlegung, und damit die Texterkennung. Tesseract liefert bei Tabellen die besten Ergebnisse, bei Vorlagen mit Bildern schneidet meist Cuneiform besser ab.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Verwendung der Option <em>"Mehrseitig"</em> in XSane ist für die Erstellung von djvu-Dateien nicht möglich; damit können nur <strong>.tiff</strong> , Postscript oder <strong>PDF</strong>-Dateien erstellt werden! Mehrseitige <strong>djvu</strong>-Dateien werden über die entsprechende Angabe des Pfads und Namen in der Option <code class="notranslate">-f</code> erzeugt.
</p></div></div><div class="section_2"><h3 id="Beispiele">Beispiele<a class="headerlink" href="#Beispiele">¶</a></h3><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die Angaben müssen sehr exakt erfolgen, es dürfen zwischen den Optionen <span class="underline">nur einfache</span> Leerzeichen verwendet werden, sonst kommt es zu Fehlern!
</p></div></div><p>Die Eingabe in <em>"XSane -&gt; Einstellungen -&gt; Konfiguration -&gt; Texterkennung -&gt; OCR Befehl"</em></p><pre class="notranslate">/PFAD/ZU/xsane2djvu.sh -l ger -e cuneiform</pre><p>führt zur Erstellung eines einseitgen DjVu-Dokument mit dem im OCR-Speicher-Dialog angegebenen Dateinamen und Verzeichnis; verwendet wird didjvu zur Encodierung und Cuneiform für die Texterkennung, Sprache ist Deutsch.</p><pre class="notranslate">/PFAD/ZU/xsane2djvu.sh -l deu -e tesseract -a "-t lines" -c cjb2 -q "-lossy" -f /home/BENUTZER/Archiv/Zeitschrift/2010</pre><p>erstellt die erste Seite eines mehrseitiges Dokument <strong>2010.djvu</strong> im Ordner <strong>~/Archiv/Zeitschrift</strong> (das Verzeichnis muss bereits existieren!). Verwendet wird der Encoder cjb2 (für schwarz-weiße Vorlagen sinnvoll) mit der ocrodjvu-Option <code class="notranslate">-lossy</code> (bessere Komprimierung). Zur Texterkennung wird tesseract-ocr, Sprache Deutsch, verwendet, der Text wird in Zeilen, nicht in einzelnen Wörtern gespeichert (weitere Größenersparnis). Weitere Scans mit dieser Einstellung werden dann jeweils an die Datei <strong>2010.djvu</strong> angehängt, die temporären einseitigen Dateien werden gelöscht (sie können mit Auskommentieren der Zeile 179 <code class="notranslate">rm "$FILE_OUT".djvu</code> im Skript auch erhalten werden). Das mehrseitige Dokument ḱann jederzeit wieder weiter ergänzt werden, wenn der komplette Pfad zur Datei (ohne Endung!) in der Option <code class="notranslate">-f</code> korrekt angeben ist. Es lassen sich auch  - z.B. für Seiten ohne Text, oder reine schwarz-weiße Seiten in ansonsten farbigen Vorlagen - andere Optionen im selben "Sammeldokument" verwenden.</p></div><div class="section_2"><h3 id="Korrekturen-an-der-Vorlage">Korrekturen an der Vorlage<a class="headerlink" href="#Korrekturen-an-der-Vorlage">¶</a></h3><p>
Um die Vorlagen automatisch gerade zu ziehen, und eine "Unschärfe-Maskierung" noch vor Erstellung der DjVu-Datei zu erzielen (die Erkennung wird ggf. besser, die Optik sowieso) kann im Skript nach Zeile 122 der Block</p><pre class="notranslate">## deskew and mask unsharp in-file using imagemagic
cp "$IN_FILE" zwischen.ppm  ## Temporärdatei, die convert verarbeiten kann)
convert zwischen.ppm -deskew 40% -unsharp 1x2 "$IN_FILE"  </pre><p>eingefügt werden.  Der <code class="notranslate">convert</code>-Befehl stammt aus der <a class="internal" href="./imagemagick.html">ImageMagick</a>-Suite, die Optionen können bei Bedarf auch abgewandelt werden. Die Datei muss zunächst kopiert werden, weil <code class="notranslate">convert</code> die temporäre XSane-Datei aufgrund der angehängten Zufallsbezeichnung nicht als <strong>.ppm</strong>-Datei erkennt. Leider kann es bei der Nutzung des cjb2-DjVu-Encoders zu Problemen kommen, da die Erkennung der durch <code class="notranslate">convert</code> erzeugten <strong>.ppm</strong>-Datei nicht gewährleistet ist; dann sollte man besser die unpaper-Variante nutzen.</p></div><div class="section_2"><h3 id="Nutzung-von-unpaper">Nutzung von unpaper<a class="headerlink" href="#Nutzung-von-unpaper">¶</a></h3><p>
Es ist auch möglich, die Vorlagen direkt durch <a class="internal" href="./unpaper.html">unpaper</a> einer umfassenden automatischen Korrektur unterziehen zu lassen. Dazu kann ein unpaper-Befehl mit den gewünschten Optionen am Anfang der Verarbeitung im Skript eingebaut werden. Wenn allerdings eine Seitenaufteilung (also z.B. ein doppelseitiger Scan eines Buches in zwei Einzelseiten) erfolgen soll, muss eine Schleife erstellt werden, die den gesamten DjVu-Erstellprozess für beide entstandenen Vorlagen-Seiten durchführt. Möglich ist das allerdings nur im "Sammel-Modus" für mehrseitige DjVu-Dateien mit der Option <code class="notranslate">-f</code>.</p><p>Im nachfolgenden Beispiel wird eine doppelseitige Vorlage mit eine Textverlauf von unten nach oben gedreht, gesäubert und in zwei DjVu-Seiten überführt. Der erste Block wird nach Zeile 122 eingefügt. Zunächst wird die Eingabedatei in eine für unpaper lesbare Form überführt (<strong>zwischen.ppm</strong>), dann gedreht, und in zwei "durchnummerierte" Bilder (<code class="notranslate">doppelzwischen%03d.ppm</code>, erzeugt <strong>doppelzwischen001.ppm</strong> und <strong>doppelzwischen002.ppm</strong>) aufgeteilt. Diese werden in der nachfolgenden Schleife bearbeitet.</p><pre class="notranslate">##unpaper, two pages, bottom-top-text direction
cp "$IN_FILE" zwischen.ppm
unpaper --pre-rotate -90 --layout double --output-pages 2 zwischen.ppm doppelzwischen%03d.ppm

for i in `ls doppelzwischen*`; do
...</pre><p>Innerhalb der Schleife müssen die Variablen "<code class="notranslate">$FILE_IN</code>" durch "<code class="notranslate">$i</code>", dem Schleifenzähler, ersetzt werden. Die Schleife wird direkt vor Ende des Skriptes wieder geschlossen, die nicht mehr benötigten Temporärdateien gelöscht:</p><pre class="notranslate">...
rm "$i"
done
rm zwischen.ppm
rm "$FILE_OUT"
echo "~~~+++~~~~+++~~~" 1&gt;&amp;2</pre><p>Auch eine kombinierte Nutzung mit der <a class="crosslink" href="#Automatisches-Drehen-der-Vorlage">Automatischen Drehung</a> ist machbar sein, dann benötigt man die <code class="notranslate">--pre-rotate</code>-Option von unpaper natürlich nicht.</p></div><div class="section_2"><h3 id="Nutzung-von-Bildbearbeitungsprogrammen">Nutzung von Bildbearbeitungsprogrammen<a class="headerlink" href="#Nutzung-von-Bildbearbeitungsprogrammen">¶</a></h3><p>
Die Temporärdatei können auch direkt in externen Bildbearbeitungsprogrammen nachbearbeitet werden (z.B. um ungewünschte Anmerkungen, Unterstreichungen, Kaffeeflecken etc. zu entfernen). Dazu muss allerdings der Betrachter-Modus gewählt sein. Die zu bearbeitende Datei findet man im <strong>/tmp</strong>-Verzeichnis, ihr Name wird von XSane aus dem <a class="internal" href="./sane.html#Backend">Backend</a>, der Scanner-Verbindung und angehängten Zufallszeichen, <strong>xsane-conversion-BACKEND:BUS:USBPORT:NUMMER.ppm-1000-XXXXXX</strong> gebildet, konkret so etwas wie <strong>xsane-conversion-gt68xx:libusb:003:002.ppm-1000-4rlFon</strong>. Falls im XSane-Betrachter schon Änderungen vorgenommen wurden (Drehung etc.), muss stattdessen <strong>xsane-viewer...</strong> gewählt werden. Die Datei lässt sich in Bildverarbeitungsprogrammen öffnen (z.B. im <a class="internal" href="./gimp.html">GIMP</a>), und dort bearbeiten. Sie muss dann mit dem exakten Namen wieder abgespeichert werden! Zumindest im GIMP ist das etwas fummelig, weil als gültiger Name nur der erste Teil bis einschließlich der <strong>.ppm</strong>-Endung akzeptiert wird. Man muss also die Datei nach dem Abspeichern ensprechend wieder um die <code class="notranslate">-1000-XXXXXX</code>-Zufallsbezeichnung erweitern (copy'n'paste biete sich dafür an). Diese Änderungen zeigt zwar der XSane-Betrachter nicht an, sie werden aber im weiteren Verlauf verwendet.</p></div><div class="section_2"><h3 id="Automatisches-Drehen-der-Vorlage">Automatisches Drehen der Vorlage<a class="headerlink" href="#Automatisches-Drehen-der-Vorlage">¶</a></h3><p>
</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Mit Tesseract 3.03 (ab <a class="internal" href="./trusty.html">Ubuntu 14.04</a> in den Quellen) kann man die Option <code class="notranslate">-psm 0</code>, mit der nur die Schriftrichtung einer Vorlage ausgegeben wird, direkt verwenden, um vor Bearbeitung der Scans eine automatische Drehung durchführen zu lassen.
Damit ist eine Ausgabe der Richtung des Textverlaufes möglich. In der Ausgabe gibt <code class="notranslate">Orientation in degrees: XX</code> die Ausrichtung der Schrift an. Dieser Wert kann verwendet werden, um das Bild entsprechend zu drehen. Für das <strong>xsane2djvu.sh</strong>-Skript ist das über die Ergänzung um folgende Zeilen (nach Zeile 122 einfügen) möglich:</p><pre class="notranslate">cp "$IN_FILE" zwischen.ppm
`tesseract zwischen.ppm stdout -l deu -psm 0  &gt; orientation.txt 2&gt;&amp;1`
ORIENTATION=`cat orientation.txt | head -2l | tail -1l | cut -d" " -f4`
if [[ $ORIENTATION != "0" ]]; then
	econvert -i zwischen.ppm --rotate $ORIENTATION -o zwischen.ppm
fi</pre><p>Damit wird die temporäre Datei <strong>orientation.txt</strong> erstellt, die in der 2. Zeile die benötigte Angabe <code class="notranslate">Orientation in degrees: XX</code> enthält, der XX-Wert wird ausgelesen und für die Drehung verwendet. Die Eingabedatei muss temporär umbenannt werden, weil <code class="notranslate">econvert</code> und <code class="notranslate">unpaper</code> den Dateinamen sonst nicht akzeptieren. Zum Einsatz kommt der <code class="notranslate">econvert</code>-Befehl aus <a class="internal" href="./exactimage.html">ExactImage</a>; mit dem <code class="notranslate">convert</code>-Befehl aus <a class="internal" href="./imagemagick.html">ImageMagick</a> kann es zu Problemen mit dem cjb2-Encoder kommen.</p><p>Wenn das automatische Geradeziehen (s.o.) nicht verwendet wird, muss <code class="notranslate">zwischen.ppm</code> schon hier wieder in <code class="notranslate">"$FILE_IN"</code> überführt werden (<code class="notranslate">cp zwischen.ppm "$IN_FILE"</code>).
</p></div></div></div><div class="section_2"><h3 id="DjVu-Dateien-ohne-Textebene">DjVu-Dateien ohne Textebene<a class="headerlink" href="#DjVu-Dateien-ohne-Textebene">¶</a></h3><p>
Das Skript kann auch zur Erstellung von DjVu-Dateien ohne Texterkennung verwendet werden, dazu muss als <code class="notranslate">engine</code>-Option <code class="notranslate">noocr</code> gesetzt werden. Das ist ggf. sinnvoll, wenn eine Texterstellung erst für ein gebündeltes mehrseitiges Dokument erstellt werden soll; so lassen sich z.B. einige der <a class="internal" href="./ocrodjvu.html#Optionen">ocrodjvu-Optionen</a> effektiver nutzen.</p></div><div class="section_2"><h3 id="Einfuegen-und-Loeschen-von-Seiten">Einfügen und Löschen von Seiten<a class="headerlink" href="#Einfuegen-und-Loeschen-von-Seiten">¶</a></h3><p>
Wenn man Teile in einem Dokument z.B. versehentlich vergessen hat, kann man andere DjVu-Dateien (auch mehrseitige) im Terminal mit dem Programm <a class="external" href="http://djvu.sourceforge.net/doc/man/djvm.html" rel="nofollow"><code class="notranslate">djvm</code></a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> (Teil von <strong>djvu-libre</strong>) einfügen. Der Befehl lautet:</p><div class="bash"><div class="contents"><pre class="notranslate">djvm -i HAUPTDOKUMENT.djvu  EINFÜGUNG.djvu SEITENZAHL </pre></div></div><p>Die Datei wird dann vor der eingegebenen Seitenzahl eingefügt, alle nachfolgenden Seiten verschieben sich entsprechend.</p><p>Das Löschen einzelner Seiten funktioniert ähnlich:</p><div class="bash"><div class="contents"><pre class="notranslate">djvm -d DOKUMENT.djvu SEITENZAHL </pre></div></div><p>Mehrere Seiten lassen sich allerdings nur über "Umwege" bzw. Loops entfernen; hier ein Beispiel, um die Seiten 41-49 eines Dokumentes zu entfernen:</p><div class="bash"><div class="contents"><pre class="notranslate">count=41 ; until [ $count -gt 449 ] ; do djvm -d DOKUMENT.djvu 41 ; count=`expr $count + 1` ; done </pre></div></div><p>Siehe dazu auch diesen <a class="external" href="http://tinyapps.org/blog/nix/201002150700_delete_multiple_pages_djvu_djvm.html" rel="nofollow">Blogbeitrag</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> für weitere Möglichkeiten.</p><p>Eine andere Variante, hier um die Seiten 170-174 zu entfernen, wäre</p><div class="bash"><div class="contents"><pre class="notranslate">for ( $i = 0; $i -lt 5; $i++ ) { djvm -d DOKUMENT.djvu 170 } </pre></div></div></div><div class="section_2"><h3 id="Zusammenfuehren-einzelner-DjVu-Dateien">Zusammenführen einzelner DjVu-Dateien<a class="headerlink" href="#Zusammenfuehren-einzelner-DjVu-Dateien">¶</a></h3><p>
Einzelne durchnummerierte DjVu-Dateien lassen sich auf der Kommandozeile mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">djvm -c SAMMELNAME.djvu NAME*.djvu  </pre></div></div><p>zu einem gemeinsamen Dokument unter <strong>SAMMELNAME.djvu</strong> verbinden, die Reihenfolge der Seiten ist von der kleinsten (alphanumerisch sortiert) aufsteigend. Nutzbar z.B. mit der automatischen Nummerierung, um doppelseitige Vorlagen zu scannen: erste die ungeraden Seiten, beginnend mit <code class="notranslate">001</code> und automatischer Erhöhung um +2, dann die geraden, beginnend mit <code class="notranslate">002</code> (oder von hinten beginnend, denn die Funktion lässt auch intervallweises Rückwärtszählen zu).</p></div></div><div class="section_1"><h2 id="Probleme-und-Loesungen">Probleme und Lösungen<a class="headerlink" href="#Probleme-und-Loesungen">¶</a></h2><p>
Falls Probleme auftauchen, liefert das angelegte Protokoll <strong>xsane2djvu.log</strong> ggf. Hinweise zur Lösung.</p><div class="section_2"><h3 id="Cuneiform">Cuneiform<a class="headerlink" href="#Cuneiform">¶</a></h3><p>
Wenn Cuneiform-Linux beim Konvertieren mit einer Meldung</p><pre class="notranslate">*** buffer overflow detected ***: cuneiform terminated</pre><p>und nachfolgendem Backtrace abstürzen sollte (siehe <a class="interwiki interwiki-bug" href="https://launchpad.net/bugs/609482">609482</a>), ist ggf. die Auflösung für den Scanvorgang zu hoch gewählt. Teilweise tritt das bei Farbscans auch bei einer Auflösung von 300 dpi auf. Abhilfe kann das Scannen mit niedrigerer Auflösung und nachfolgendem Skalieren der Vorlage im Betrachter von XSane schaffen; allerdings kann die Erkennungsqualität etwas leiden. Ggf. hilft es, als letzte ocrodjvu-Option <code class="notranslate">&lt;/dev/null</code> zu verwenden. Mit tesseract-ocr als OCR-Anwendung treten diese Probleme nicht auf.</p></div><div class="section_2"><h3 id="Tesseract-ocr">Tesseract-ocr<a class="headerlink" href="#Tesseract-ocr">¶</a></h3><p>
Insbesondere bei verschachtelten farbigen Vorlagen kommt es mit tesseract-ocr als OCR-Anwendung z.T. zu Abbrüchen mit Meldungen zu nicht verarbeitbaren Zeichen, in der Folge kann die Vorlage nicht verarbeitet werden. Das Problem lässt sich mit der Verwendung einer aktuellen Version von ocrodjvu aus dem Quellcode umgehen (siehe <a class="internal" href="./ocrodjvu.html#Manuelle-Installation">ocrodjvu - Manuelle Installation</a>), im Log tauchen zwar ggf. weiterhin Meldungen auf, ocrodjvu stürzt aber nicht mehr ab, die produzierten Dateien mit der Texterkennung sind voll verwendbar.</p></div></div><div class="section_1"><h2 id="Alternativen">Alternativen<a class="headerlink" href="#Alternativen">¶</a></h2><p>
</p><ul><li><p>Mit <a class="internal" href="./gscan2pdf.html">gscan2pdf</a> können auch mehrseitige DjVu-Dateien angelegt werden, allerdings ist die Segmentierung nicht möglich. Die Texterkennung (für DjVu-Daten sinnvoll einzusetzen erst ab Version 0.9.31, in der die Verwendung von Cuneiform implementiert ist) erfolgt dementsprechend auch nicht im Djvu-Dokument selbst, sondern wird vorher von der gescannten Vorlage erstellt, was gerade bei farbigen Vorlagen zu Problemen führen kann. Verglichen mit von <a class="internal" href="./didjvu.html">didjvu</a> erstellten farbigen DjVu-Dateien können bis zu 10fach große Dateien aus derselben Vorlage entstehen.</p></li></ul><p>
</p><ul><li><p><strong>pct-scanner-scripts</strong> aus dem gleichnamigen Paket ist ein vielfältig konfigurierbares Kommandozeilen-Werkzeug zum Scannen und anschließender Erstellung von <a class="internal" href="./djvu.html">DjVu</a>, <a class="internal" href="./pdf.html">PDF</a> oder JPEG-Dokumenten zur Archivierung. Das Programm bedarf etwas Einarbeitungszeit, kann dann aber auch "vollautomatisiert" z.B. mit ADF-Scannern eingesetzt werden, um mehrseitige DjVu-Dateien, auch mit Textebene, zu erstellen. Einzelheiten im Artikel <a class="internal" href="./pct-scanner-script.html">pct-scanner-script</a></p></li></ul><p>
</p><ul><li><p><a class="internal" href="./djvubind.html">djvubind</a> ist ein Kommandozeilenprogramm, mit dem aus <strong>.tiff</strong>-Vorlagen DjVu-Dokumente (z.B. als E-Books) erstellt werden können. Das Programm kann allerdings momentan nur schwarz-weiße <strong>.tiff-</strong>Dateien verarbeiten (z.B. <a class="internal" href="./scan_tailor.html">Scan Tailor</a>-Ausgaben); die Texterkennung erfolgt standardmäßig mit <a class="internal" href="./tesseract-ocr.html">tesseract-ocr</a>, <a class="internal" href="./cuneiform-linux.html">cuneiform</a> ist optional auch verwendbar..</p></li></ul><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://gamera.informatik.hsnr.de/" rel="nofollow">gamera-Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/OCRopus">OCRopus</a></p></li><li><p><a class="external" href="http://jwilk.net/software/didjvu" rel="nofollow">didjvu</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="internal" href="./djvu.html">DjVu</a></p><ul><li><p><a class="internal" href="./ocrodjvu.html">ocrodjvu</a></p></li></ul></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./xsane2djvu/a/revision/941046.html">Diese Revision</a> wurde am 11. Mai 2017 10:17 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./xsane2djvu.html">xsane2djvu</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>