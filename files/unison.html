<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Unison › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./unison.html">Unison</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Unison">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./unison/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./unison/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./unison/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./unison/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./unison/a/backlinks.html">Unison</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Unison-starten">Unison starten
</a></li><li><a class="crosslink" href="#Beispiel-einer-prf-Datei-fuer-Unison">Beispiel einer .prf-Datei für Unison
</a></li><li><a class="crosslink" href="#Automatisierung">Automatisierung
</a></li><li><a class="crosslink" href="#Alternative-Skripte">Alternative Skripte
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./briefcase.png" class="image-left" src="./_/fbc129254a95e8a505a3b91f23032b35b338c996.png"/>
<a class="external" href="http://www.cis.upenn.edu/~bcpierce/unison/" rel="nofollow">Unison</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein Programm für Linux, Windows und Mac zur Synchronisation von Dateien und Verzeichnissen auf verschiedenen Rechnern bzw. Festplatten/Datenträgern. Beim Abgleich werden nur Änderungen an den Daten synchronisiert, so dass ein erneuter Abgleich sehr schnell durchgeführt werden kann. Die größten Vorteile von Unison sind:</p><ul><li><p>das Programm ist plattformunabhängig. So lassen sich Daten über Betriebssysteme hinweg synchronisieren.  </p></li><li><p>die Synchronisation funktioniert auch dann, wenn auf beiden Rechnern Dateien geändert wurden</p></li><li><p>Unison verwendet ein eigenes Übertragungsprotokoll und hat eine (optionale) grafische Oberfläche</p></li><li><p>eine schnelle Synchronisation über Netzwerke und das Internet ist möglich</p></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Unison kann nur korrekt arbeiten, wenn die Systemzeit auf beiden Rechnern synchronisiert ist. Dazu empfiehlt es sich, beide <a class="internal" href="./systemzeit.html">Systemuhren</a> nach einem Zeitserver im Internet zu stellen.
</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Eines der beiden folgenden Pakete muss installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>unison</strong> (<em>universe</em>, auf dem Server)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install unison </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install unison </pre></div></div><p>
</p></div></div><ul><li><p><strong>unison-gtk</strong> (<em>universe</em>, auf dem Client oder Einzelplatzrechner, grafische Version)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install unison-gtk </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install unison-gtk </pre></div></div><p>
</p></div></div><p>Sollen Daten zwischen unterschiedlichen Computern synchronisiert werden, ist auf beiden Rechnern jeweils Unison und ein <a class="internal" href="./ssh.html">SSH-Server</a> zu installieren. In diesem Falle wird Unison auf dem anderen Rechner automatisch gestartet, wodurch der Vergleich der Daten sehr viel schneller abläuft. Außerdem müssen keine Laufwerke eingehängt werden. Bedingung dafür ist, dass sowohl auf dem Server als auch auf dem Client die gleiche Unison-Version installiert ist, sonst wird mit einer Fehlermeldung abgebrochen.</p><p>Für die Synchronsation zwischen internen und externen Datenträgern eines Einzelplatzrechners wird nur das Paket <strong>unison-gtk</strong> benötigt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Sollten sich die zu synchronisierenden Daten bereits auf beiden Computern befinden, ist es empfehlenswert, die Verzeichnisse einmal manuell abzugleichen, da Unison sonst beim ersten Lauf viele Fragen stellt. Bei späteren Durchläufen "merkt" das Programm dann, welche Dateien verändert oder gelöscht wurden. 
</p></div></div></div><div class="section_1"><h2 id="Unison-starten">Unison starten<a class="headerlink" href="#Unison-starten">¶</a></h2><p>
Die grafische Version von Unison kann über "<em>Anwendungen --&gt; Zubehör</em>", die Shell-Version über die Konsole mit "<code class="notranslate">unison</code>" gestartet werden. Es öffnet sich ein Fenster, in dem gespeicherte Profile angezeigt werden. Zum Erstellen eines neuen Profils werden drei Angaben benötigt:</p><ol class="arabic"><li><p>Name des Profils</p></li><li><p>Quellpfad (Datenquelle)</p></li><li><p>Zielpfad (Datenziel)</p></li></ol><p>
Dabei kann jeder der beiden einzugebenden Pfade zu einer der folgenden Kategorien gehören:</p><table style="width: 100%"><tr style="background-color: #f9eaaf"><td><strong>Methode</strong> </td><td> <strong>Pfad</strong> </td><td> <strong>Beschreibung</strong> </td><td> <strong>Sicherheit</strong> </td></tr><tr><td> <strong>ssh</strong><sup>*</sup> </td><td> <a class="external" href="ssh://benutzer@rechner//pfad/fuer/sync" rel="nofollow" title="ssh://benutzer@rechner//pfad/fuer/sync">ssh://benutzer@rechner//pfad/fuer/sync</a> </td><td> schneller wg. Unison-Serverstart auf entferntem Rechner - zusätzliche Rechenzeit für ssh; kompliziert, wenn entfernter Rechner Windows-basiert </td><td style="background-color: #98fc66"> sicherer als FTP, je nach SSH-Key-Qualität </td></tr><tr><td> <strong>fstab</strong> </td><td> /pfad/fuer/sync </td><td> für interne und externe Datenträger, langsam bei Netzwerkpfaden </td><td style="background-color: #ffff00"> je nachdem </td></tr><tr><td> <strong><a class="external" href="http://www.cis.upenn.edu/~bcpierce/unison/download/releases/stable/unison-manual.html#socketmeth" rel="nofollow">Socket</a></strong> </td><td> socket://servername:NNNN/pfad/fuer/sync </td><td> schnell, Umgehung von Firewalls </td><td style="background-color: #dddddd"> unsicher </td></tr></table><p>
<sup>*</sup> wird in unison-gtk über Ausfüllen einzelner Felder komfortabel angeboten, macht für den ersten Pfad i.d.R. keinen Sinn</p><p>Ein Profil kann ganz einfach über die Pfeiltasten und <em>"OK"</em> gestartet werden. Der Rest des Programms ist selbsterklärend. Sollte keine grafische Oberfläche vorhanden sein oder die grafische Version im Zusammenhang mit <strong>ssh</strong> nicht funktionieren, kann die Kommandozeilenversion von Unison wie folgt aufgerufen werden:</p><div class="bash"><div class="contents"><pre class="notranslate">unison-gtk -ui text PROFILNAME </pre></div></div><p>Allerdings müssen neue Profile in diesem Fall von Hand im Verzeichnis <strong>~/.unison/</strong> erstellt werden. Wird "<code class="notranslate">PROFILNAME</code>" nicht angegeben, nimmt <strong>unison</strong> automatisch das Profil <strong>default</strong>.</p><p>Alternativ kann man auch eine Erstsynchronisation so anfangen (die erste Zeile sicherheitshalber):</p><div class="bash"><div class="contents"><pre class="notranslate">mv ~/.unison/default.prf ~/.unison/default.old.prf
unison /pfad/fuer/quelle /pfad/fuer/ziel </pre></div></div><p>und nach abgeschlossener Synchronisation findet man eine neue Datei, die man beliebig benennen kann. Beispiel für eine Profildatei (<strong>.prf</strong>):</p><pre class="notranslate">root = /PFAD/ZUR/QUELLE
root = /PFAD/ZUM/ZIEL</pre><p>Diese Profildatei kann ggf. mit weiteren Einstellungen (<em>"Preferences"</em>) in der Form "Wert = Ausdruck" befüllt oder nach Wunsch umbenannt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">mv ~/.unison/default.prf ~/.unison/aktenkoffer.prf </pre></div></div><p>
Danach reicht ein:</p><div class="bash"><div class="contents"><pre class="notranslate">unison aktenkoffer </pre></div></div><p>
Achtung: hat man sich vertippt, sollte man Unison einfach die <strong>default.prf</strong> wegnehmen (wie oben geschehen).</p></div><div class="section_1"><h2 id="Beispiel-einer-prf-Datei-fuer-Unison">Beispiel einer .prf-Datei für Unison<a class="headerlink" href="#Beispiel-einer-prf-Datei-fuer-Unison">¶</a></h2><p>
Im folgenden Beispiel werden Verzeichnisse in <strong>/home/NUTZER</strong> eines Desktop-PCs mit dem Laptop synchronisiert. Mit dabei ist auch das Mailverzeichnis von Thunderbird und die Bookmarks und Einstellungen des Firefox. Damit nichts verloren geht, werden ältere Dateien vor dem synchronisieren im Unterordner <strong>alt</strong> des jeweiligen Verzeichnisses in dieser Einstellung mit bis zu drei Versionen gesichert. Bei Platznot kann dieser Faktor natürlich auch reduziert werden. Die Datei ist natürlich an die eigenen Verhältnisse anzupassen.</p><pre class="notranslate"># Roots of the synchronization
root = /home/BENUTZERNAME
root = ssh://laptop.local//home/BENUTZERNAME
# SSH und Avahi ist installiert 

# Pfade in home zu sync:
path = daten
path = Job
path = .mozilla
path = .thunderbird

# ausgenommen diesen hier:
ignore = Path {Telefon}
ignore = Path {Cache}
# liegt Cache in versteckten Verzeichnissen, ist der gesamte relative Pfad anzugeben:
ignore = Path {.mozilla/firefox/XXXXXXXX.default/Cache}

# Sicherungsdateien werden auch nicht mehr gesichert
ignore = Name *_
ignore = Name temp.*
ignore = Name *.o
ignore = Name *.tmp

# ignoriert Sicherungen 
ignore = Path {alt}
ignore = Name *~
ignore = Name .*~

# macht bis zu 3 Sicherungen im jeweiligen Unterordner alt
backuplocation = local
backup = Name *
backupprefix = alt/
maxbackups = 3
backupsuffix = .$VERSION</pre></div><div class="section_1"><h2 id="Automatisierung">Automatisierung<a class="headerlink" href="#Automatisierung">¶</a></h2><p>
Hat man sich eine Unison-Profildatei angelegt, so besteht häufig der Wunsch, dass automatisch synchronisiert wird. In diesem Abschnitt wird eine Beispielkonfiguration zwischen zwei Rechnern, typischer Weise einem Laptop und einem Desktoprechner, via SSH und Unison vorgestellt. Von einer Synchronisation zweier Linux-Rechner über <a class="internal" href="./samba.html">Samba</a> oder <a class="internal" href="./nfs.html">NFS</a> sollte abgesehen werden. Wird NFS oder Samba verwendet, müssen die Dateien zunächst vom NFS- oder Samba-Filesystem übertragen werden, bevor sie auf Änderungen abgeglichen werden können. Selbst wenn nur die Zeitstempel abgerufen werden, ist dies zeitaufwändig, wenn größere Datenmengen synchronisiert werden sollen. Wird das <a class="internal" href="./ssh.html">SSH</a>-Protokoll verwendet, kann Unison sich selbst auf dem anderen Rechner aufrufen und vor Ort auf Änderungen prüfen, da sich Unison den Stand jeder Datei merkt. Das ist insbesondere bei langsamen WLAN-Verbindungen und über das Internet entscheidend, da viel weniger Netzwerkverkehr entsteht. Dazu sind folgende Schritt notwendig:</p><div class="section_2"><h3 id="1-Schritt">1. Schritt<a class="headerlink" href="#1-Schritt">¶</a></h3><p>
</p><ul><li><p><strong>unison</strong> (openssh-client)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install unison </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install unison </pre></div></div><p>
</p></div></div><p>Des Weiteren wird auf dem Rechner, von dem die Daten auf einen anderen übertragen werden, noch die Paket</p><ul><li><p><strong>openssh-server</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install openssh-server </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install openssh-server </pre></div></div><p>
</p></div></div><p>benötigt.</p><p>Wenn man einen Laptop mit einem Desktop-PC synchronisieren möchte, sollte typischer Weise die Profildatei und die weitere Konfiguration dieses Abschnitts vom Laptop aus vorgenommen werden. Auf dem Zielrechner, z.B. dem Desktoprechner, müssen lediglich die Pakete installiert werden.</p></div><div class="section_2"><h3 id="2-Schritt">2. Schritt<a class="headerlink" href="#2-Schritt">¶</a></h3><p>
Unison wird auf dem Zielrechner konfigurieren und nach obiger Erklärung eine Profildatei anlegen. Der Pfad zum Desktoprechner wird dabei im ssh-Protokoll angegeben. Beispiel:</p><pre class="notranslate">root = /home/BENUTZER/Dokumente/
root = ssh://DNS-ODER-IP-DES_ZIELRECHNERS//home/BENUTZER/Dokumente/</pre></div><div class="section_2"><h3 id="3-Schritt">3. Schritt<a class="headerlink" href="#3-Schritt">¶</a></h3><p>
Damit nicht bei jeder Synchronisation das Passwort eingegeben werden muss und diese auch automatisch durchgeführt werden kann, sollten die PCs so konfiguriert werden, dass sich der Zielrechner per öffentlichem Schlüssel am Ausgangsrechner anmelden kann (ssh über public keys). Eine genaue Anleitung, dazu findet sich <a class="internal" href="./ssh.html#Authentifizierung-ueber-Public-Keys">im SSH-Artikel</a> hier im Wiki.</p></div><div class="section_2"><h3 id="4-Schritt">4. Schritt<a class="headerlink" href="#4-Schritt">¶</a></h3><p>
Nun sollte die Synchronisation über SSH einmalig getestet werden. Dazu kann jetzt, wie oben auch erklärt, einfach folgender Befehl ausgeführt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">unison PROFILNAME </pre></div></div><p>Die Profildatei wird dabei ohne Pfad und ohne Endung <strong>.prf</strong> aufgerufen. Unison sucht automatisch im Unterordner <strong>.unison</strong> des aktuellen Benutzers. Wie man feststellt, fragt Unison bei jeder veränderten Datei, welche Version übernommen werden soll und am Ende nochmal, ob die Dateien wirklich kopiert werden sollen. Auf diese Weise ist noch keine automatische Synchronisation möglich. Dazu werden noch zwei weitere Parameter benötigt:</p><ul><li><p><code class="notranslate">auto</code> Unison übernimmt automatisch die neue Datei, wenn die Datei an der Gegenstelle nicht verändert wird. Entspricht dem, wenn man immer <code class="notranslate">y</code> für yes/ja drückt.</p></li><li><p><code class="notranslate">batch</code> Unison stellt keine Rückfragen. Sollte es zu Konflikten kommen, weil z.B. die Datei auf beiden Rechnern editiert wurde, überspringt Unison diese einfach. </p></li><li><p><code class="notranslate">logfile</code> Zur Sicherheit ist es immer gut zu dokumentieren, wann Unison welche Version wohin kopiert hat.</p></li></ul><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Eine Synchronisierung ist kein Backup! Wenn auf einem PC eine Datei gelöscht wird und dann eine Synchronisation durchgeführt wird, wird sie auch vom anderen PC gelöscht. Es sollte auf jeden Fall eine unabhängige Backup-Lösung installiert sein.
</p></div></div><ul><li><p><code class="notranslate">backup</code> Unison kann beim Überschreiben von Dateien Backups anlegen.</p></li><li><p><code class="notranslate">maxbackups</code> Anzahl der maximalen Backups, je nach persönlichem Geschmack und wie oft man eine Datei verändert. Diese Option sollte nicht zu hoch gestellt sein, wenn es sich um große Dateien handelt, da eine vollständige Kopie aufbewahrt wird.</p></li></ul><p>
Daraus ergeben sich folgende Ergänzungen für die Profildatei:</p><pre class="notranslate">root = /home/BENUTZER/Dokumente/
root = ssh://dns-oder-ip-des-Zielrechners//home/BENUTZER/Dokumente/

batch = true
auto = true
logfile = /home/BENUTZER/.unison/logfile-PROFILNAME
backup = Name *
maxbackups=5</pre></div><div class="section_2"><h3 id="5-Schritt">5. Schritt<a class="headerlink" href="#5-Schritt">¶</a></h3><p>
Unison alle X Minuten automatisch im Hintergrund starten. Dazu verwendet man <a class="internal" href="./cron.html">Cron</a>, dessen Artikel weitere Erklärungen enthält, wie Cron funktioniert. Hier reicht es zu wissen, dass man mittels</p><div class="bash"><div class="contents"><pre class="notranslate">crontab -e </pre></div></div><p>folgende Zeile am Ende der Datei anfügen muss:</p><pre class="notranslate">*/15 * * * * test -e /var/lock/unison-PROFILNAME &amp;&amp; exit 0 || (touch /var/lock/unison-PROFILNAME;unison PROFILNAME;rm /var/lock/unison-PROFILNAME)</pre><p>Am Anfang der Zeile wird festgelegt, dass der nachfolgende Befehl alle 15 Minuten ausgeführt wird. Dann wird zunächst ein Lockfile angelegt, damit Unison nicht doppelt aufgerufen wird. Wenn z.B. via WLAN eine sehr große Datei kopiert wird und dies länger als 15 Minuten dauert, würde schon die nächste Instanz von Unison gestartet. Dies kann zu Problemen bei der Synchronisierung führen. Das Lockfile verhindert dies. Allerdings werden neue Dateien dann auch erst wieder synchronisiert, wenn der vorherige Vorgang abgeschlossen ist.</p></div><div class="section_2"><h3 id="6-Schritt-optional">6. Schritt (optional)<a class="headerlink" href="#6-Schritt-optional">¶</a></h3><p>
Möchte man nicht nur im heimischen LAN oder WLAN synchronisieren, sondern auch über das Internet, so ist eine dynamische DNS-Auflösung erforderlich. Dazu kann man sich z.B. auf <a class="external" href="http://www.no-ip.com" rel="nofollow">no-ip.com</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> kostenlos registrieren und viele Router haben einen eingebauten DynDNS-Client, sodass dort die Zugangsdaten eingetragen werden können. Kann der Router dies nicht, kann man auch einen Ubuntu-Rechner diese Aufgabe erledigen lassen. Genauere Erklärungen dazu finden sich im Wiki-Artikel <a class="internal" href="./ddns-clients.html">DDNS-Clients</a>. Allerdings muss der Rechner dann immer eingeschaltet bleiben. Viele moderne Router bieten auch die Möglichkeit, Rechner, die per LAN angeschlossen sind, über das Internet zu starten.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Wenn man seine Routeroberfläche zum Internet öffnet, MUSS ein langes und sicheres Passwort gewählt werden!
</p></div></div><p>Außerdem benötigt SSH noch eine Portweiterleitung des Ports 22 an den Desktoprechner, mit dem man synchronisieren möchte. Statt der IP wird dann in der Profildatei, die no-ip.com-Adresse eingetragen. Dies sieht dann so aus:</p><pre class="notranslate">root = /home/BENUTZER/ORDNER/	
root = ssh://XXX.no-ip.com//home/BENUTZER/ORDNER/</pre><p>Da moderne Router erkennen, wenn der Laptop im lokalen Netzwerk ist, kann auch für Synchronisierungen innerhalb der eigenen Wohnung die no-ip.com-Adresse verwendet werden, ohne Performanceverluste zu haben.</p></div></div><div class="section_1"><h2 id="Alternative-Skripte">Alternative Skripte<a class="headerlink" href="#Alternative-Skripte">¶</a></h2><p>
Eine vereinfachte Konfiguration von Unison kann mittels Sucsynct oder Zenity durchgeführt werden.</p><div class="section_2"><h3 id="Automatisierung-mit-sucsynct">Automatisierung mit sucsynct<a class="headerlink" href="#Automatisierung-mit-sucsynct">¶</a></h3><p>
</p><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
<a class="internal" href="./fremdsoftware.html">Fremdsoftware</a> kann das System gefährden.
</p></div></div><p>Das Skript <a class="interwiki interwiki-launchpad" href="https://launchpad.net/sucsynct">sucsynct</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> erleichtert die Verwaltung von Unison-Profilen und ermöglicht die automatische Synchronisation (sobald Dateien verändert werden). Damit sich das Programm zu einem kleinen Status-Icon in der Systemleiste minimieren kann, wird <a class="internal" href="./zenity.html">Zenity</a> in einer Version kleiner 3 oder das neuere <a class="internal" href="./yad.html">yad</a> benötigt (die neueren Zenity-Versionen unterstützen leider keine Icons in der Systemleiste mehr).</p><p>Für die automatische Synchronisation muss auf allen zu synchronisierenden Rechnern zusätzlich zum Paket <strong>unison-gtk</strong> noch <strong>inotify-tools</strong> installiert <sup><a href="#source-1">[1]</a></sup> sein (beide <em>universe</em>) und <strong>openssh-client</strong> bzw. <strong>ssh</strong> auf den Server-Rechnern. Auf den ausführenden Client-Rechnern wird zudem noch <strong>bzr-gtk</strong> (<em>universe</em>) installiert. Dann kann man das sucsynct-Skript wie folgt herunterladen:</p><div class="bash"><div class="contents"><pre class="notranslate">mkdir ~/bin
cd ~/bin
bzr branch lp:sucsynct </pre></div></div><p>Starten kann man sucsynct dann per:
</p><div class="bash"><div class="contents"><pre class="notranslate">~/bin/sucsynct/sucsynct </pre></div></div><p>Updates erhält man per:
</p><div class="bash"><div class="contents"><pre class="notranslate">bzr pull lp:sucsynct </pre></div></div></div><div class="section_2"><h3 id="Zenity">Zenity<a class="headerlink" href="#Zenity">¶</a></h3><p>
Hier wird ein älteres Skript vorgestellt, bei dem der Vergleich der Dateien allerdings vergleichsweise langsam vonstatten geht. Dazu muss das folgende Paket installiert werden <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>zenity</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install zenity </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install zenity </pre></div></div><p>
</p></div></div><div class="section_3"><h4 id="Unison-einrichten">Unison einrichten<a class="headerlink" href="#Unison-einrichten">¶</a></h4><p>
Die Konfigurationsdateien liegen (nachdem man als Benutzer Unison einmal gestartet hat) im versteckten Verzeichnis <strong>~/.unison/</strong> im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a>. Dort legt man eine Datei <strong>Aktenkoffer.prf</strong> an <sup><a href="#source-2">[2]</a></sup>, die folgende Zeilen enthält:</p><pre class="notranslate">root = /home/BENUTZERNAME/Ablage/ 
root = /home/BENUTZERNAME/Aktenkoffer/</pre></div><div class="section_3"><h4 id="Das-Skript-anlegen">Das Skript anlegen<a class="headerlink" href="#Das-Skript-anlegen">¶</a></h4><p>
Mit einem Skript erleichtert man sich die Arbeit ein wenig. Es hängt die Freigabe erst ein, führt dann die Synchronisation aus, und hängt dann die Freigabe wieder aus. Außerdem kann man auch nur den lokalen Ordner ohne zu synchronisieren öffnen, um z.B. Dateien hinzuzufügen.</p><p>Folgender Text ist in einer Datei <strong>Aktenkoffer.sh</strong> zu speichern <sup><a href="#source-2">[2]</a></sup>:</p><pre class="notranslate">#!/bin/bash
# Dieses Script vergleicht die Aktenkoffer lokal und auf dem Laptop
tmpfile=/tmp/zen.$$
mounten () {
 mount ~/Aktenkoffer/
  if [ $? = "32" ] ; then
   zenity --error --text="Kann Laptop nicht mounten!"
   exit 2
  fi
}
unmounten () {
 umount ~/Aktenkoffer/
}
# Auswahl der gewünschten Aktion.
zenity --list \
        --title="Aktion wählen" \
        --text="Bitte die gewünschte Aktion wählen:" \
        --column="Aktion" \
        "lokalen Aktenkoffer öffnen" \
        "Aktenkoffer synchronisieren" \
        &gt;&gt; $tmpfile
if [ $? == "1" ] ; then
 rm -f $tmpfile
 exit 1
fi
aktion=`cat $tmpfile`
case $aktion in
# Lokalen Aktenkoffer öffnen
 "lokalen Aktenkoffer öffnen") nautilus --no-desktop /home/BENUTZERNAME/Ablage;;
# Verzeichnis mounten und synchronisieren
 "Aktenkoffer synchronisieren") mounten
  unison-gtk Aktenkoffer.prf
  unmounten;;
 *) zenity --info --text="Keine Aktion gewählt!";;
esac
rm -f $tmpfile</pre><p>Auch hier müssen wiederum die Pfade und "<code class="notranslate">BENUTZERNAME</code>" entsprechend angepasst werden. Das Skript muss nun noch ausführbar gemacht werden <sup><a href="#source-3">[3]</a></sup>.</p></div><div class="section_3"><h4 id="Einen-Starter-anlegen">Einen Starter anlegen<a class="headerlink" href="#Einen-Starter-anlegen">¶</a></h4><p>
Um die Verwendung zu erleichtern, legt man sich noch einen Starter entweder auf dem Desktop oder im Panel an. Dies geht über Rechtsklick -&gt; "<em>Starter anlegen...</em>" bzw. Rechtsklick -&gt; "<em>Zum Panel hinzufügen... -&gt; Benutzerdefinierter Anwendungsstarter</em>". Dort macht man folgende Angaben:</p><table><tr><td><strong>Name</strong>: </td><td>Aktenkoffer </td></tr><tr><td><strong>Kommentar</strong>: </td><td>Synchronisiert den Aktenkoffer zwischen Desktop und Laptop </td></tr><tr><td><strong>Befehl</strong>: </td><td> /Pfad/zum/Aktenkoffer.sh </td></tr><tr><td><strong>Typ</strong>: </td><td>Anwendung </td></tr></table><p>
Als Symbol kann beispielsweise das obige Logo als <a class="interwiki interwiki-attachment" href="./unison.html">SVG-Datei</a> verwendet werden.</p></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Unterschiedliche-Dateisysteme">Unterschiedliche Dateisysteme<a class="headerlink" href="#Unterschiedliche-Dateisysteme">¶</a></h3><p>
Wer einen externen Datenträger nutzt, steht evtl. vor dem Problem, dass die Dateisysteme von Quelle und Ziel der Sicherung abweichen. Dies wird insbesondere dann zum Problem, wenn das <a class="internal" href="./dateisystem.html">Dateisystem</a> des Ziels mit <em>FAT32</em> formatiert ist und daher die <a class="internal" href="./rechte.html">Dateirechte</a> von Linux nicht unterstützt. Für den häufigen Fall einer Quelle mit <em>ext3</em> und einem Ziel mit <em>FAT32</em> dann in die jeweilige <strong>.prf</strong> folgende Zeile einfügen <sup><a href="#source-2">[2]</a></sup>:</p><pre class="notranslate">perms = 0</pre></div><div class="section_2"><h3 id="Mehrere-Ordner">Mehrere Ordner<a class="headerlink" href="#Mehrere-Ordner">¶</a></h3><p>
In der Grundeinstellung synchronisiert Unison den angegebenen Ordner rekursiv. Das kann man ändern. Dazu folgendes Beispiel einer <strong>.prf</strong>-Datei:</p><pre class="notranslate">root = /home/BENUTZERNAME
root = /PFAD/ZUM/ZIEL

path = Bilder
path = Dokumente
path = Musik</pre><p>Nun werden ausschließlich die via "<code class="notranslate">path = ...</code>" definierten Ordner von "<code class="notranslate">BENUTZERNAME</code>" berücksichtigt. Bei Bedarf kann man auch "<code class="notranslate">ignore = Path ...</code>" nutzen, um bestimmte Ordner bewusst auszuschließen.</p></div><div class="section_2"><h3 id="SSH-Server-laeuft-auf-anderem-Port-als-22">SSH-Server läuft auf anderem Port als 22<a class="headerlink" href="#SSH-Server-laeuft-auf-anderem-Port-als-22">¶</a></h3><p>
Wenn man den SSH-Server auf einem anderen Port als 22 laufen hat, muss man in dessen Profil den Pfad anpassen. Dazu öffnet man mit dem Editor <sup><a href="#source-2">[2]</a></sup> das entsprechende Profil und ändert den SSH-Pfad folgendermaßen:</p><pre class="notranslate">ssh://benutzer@rechner:Port//pfad/fuer/sync</pre></div><div class="section_2"><h3 id="Unterschiedliche-Unison-Versionen">Unterschiedliche Unison-Versionen<a class="headerlink" href="#Unterschiedliche-Unison-Versionen">¶</a></h3><p>
Je nach Ubuntu-Distribution (z.B. 14.04. oder 16.04.) kann eine andere / neuere Version von unison in der Paketverwaltung hinterlegt sein. Diese sind üblicherweise nicht zueinander kompatibel. Die erste Nummer hinter dem Punkt muss übereinstimmen, z.B.</p><ul><li><p>2.32.12 und 2.32.52 - funktioniert</p></li><li><p>2.32.12 und 2.40.61 - funktioniert nicht</p></li><li><p>2.40.61 und 2.40.102 - funktioniert</p></li></ul><p>
<strong>Option 1</strong> (einfach): Man installiert das Paket unison-all welches neue und alte Versionen enthält.</p><ul><li><p><strong>unison-all</strong> (<em>universe</em>, auf dem Server)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install unison-all </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install unison-all </pre></div></div><p>
</p></div></div><p><strong>Option 2</strong> (fortgeschritten): Man fügt den Parameter "servercmd" in seine PRF-Konfiguration und kopiert eine funktionierende (Versions-)Binärdatei auf die andere Maschine.</p><pre class="notranslate">root = /home/BENUTZERNAME
root = /PFAD/ZUM/ZIEL

servercmd=/home/BENUTZERNAME/bin/unison</pre></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="Intern">Intern<a class="headerlink" href="#Intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./datensicherung.html#Programme">Datensicherung</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Übersicht über die möglichen Methoden und Programme</p></li><li><p>Alternativen:</p><ul><li><p><a class="internal" href="./synkron.html">Synkron</a> - Alternative zu FreeFileSync mit größerem Funktionsumfang</p></li><li><p><a class="internal" href="./rsync.html">rsync</a> - Das mächtige Standard-Werkzeug von Linux zur unidirektionalen Synchronisation und Datensicherung. Arbeitet durch inkrementelle Synchronisation und optionale Kompression in Netzwerken sehr schnell.</p></li><li><p><a class="internal" href="./freefilesync.html">FreeFileSync</a> - Grafisches Werkzeug für verschiedene Plattformen (Linux, Windows)</p></li><li><p><a class="internal" href="./sbackup.html">sbackup</a> - Werkzeug speziell zur automatischen Erstellung von komprimierten Sicherungskopien von Systemkonfiguration und Benutzerdaten</p></li></ul></li></ul></div><div class="section_2"><h3 id="Extern">Extern<a class="headerlink" href="#Extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="http://www.cis.upenn.edu/~bcpierce/unison/" rel="nofollow">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="internal" href="./rsync.html">rsync</a> - wird intern zur Synchronisation verwendet</p></li><li><p><a class="external" href="http://www.linux-magazin.de/Online-Artikel/Synchronisation-mit-Unison-und-Conduit?category=0" rel="nofollow">Synchronisation mit Unison und Conduit</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Artikel Linux-Magazin 01/2008</p></li><li><p><a class="external" href="http://www.linux-magazin.de/Heft-Abo/Ausgaben/2007/08/Unisono-Verkuendigung" rel="nofollow">Aus dem Alltag eines Sysadmin: Unison</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Artikel Linux-Magazin 08/2007</p></li><li><p><a class="external" href="http://stesind.blogspot.com/2009/05/mehr-als-ein-verzeichnis-mit-unison.html" rel="nofollow">Mehr als ein Verzeichnis mit Unison abgleichen</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Blogbeitrag 05/2009</p></li><li><p><a class="external" href="http://www.ict.griffith.edu.au/anthony/info/apps/unison.hints" rel="nofollow">Unison Hint and Tips</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Tipps zu "<code class="notranslate">ignore = Path</code>", "<code class="notranslate">ignorenot</code>" etc.</p></li></ul><p>
</p></div></div></div>
<p class="meta">
<a href="./unison/a/revision/943722.html">Diese Revision</a> wurde am 20. September 2017 23:43 von <a href="https://ubuntuusers.de/user/Vej/">Vej</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./unison.html">Unison</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>