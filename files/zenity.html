<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Zenity › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./zenity.html">Zenity</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Zenity">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./zenity/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./zenity/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./zenity/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./zenity/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./zenity/a/backlinks.html">Zenity</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./autostart.html">Programme automatisch starten</a>, <em>optional</em> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Beispielskript">Beispielskript
</a></li><li><a class="crosslink" href="#Weitere-Optionen">Weitere Optionen
</a></li><li><a class="crosslink" href="#Programmumschalter">Programmumschalter
</a></li><li><a class="crosslink" href="#Zenity-als-Abfrage-fuer-dd-Backup-nutzen">Zenity als Abfrage für dd-Backup nutzen
</a></li><li><a class="crosslink" href="#Grafische-Passwort-Abfrage-mit-Zenity">Grafische Passwort-Abfrage mit Zenity
</a></li><li><a class="crosslink" href="#Fortschrittsanzeige">Fortschrittsanzeige
</a></li><li><a class="crosslink" href="#Probleme-und-Loesungen">Probleme und Lösungen
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/terminal.png" class="image-left" src="./_/e81889fd6e485dd32e1cde611eabc18abced7993.png"/>
Wer <a class="internal" href="./shell.html">Shell</a>-Skripte schreibt und nutzt, möchte Rückmeldungen oder Fragen unter Umständen mit grafischen Elementen kombinieren. Benutzerabfragen in einem eigenen Dialog anzuzeigen wäre da ein erster Schritt. Für <a class="internal" href="./gtk.html">GTK</a>-Dialoge gibt es dafür das Programm <a class="interwiki interwiki-gnomeprojects" href="https://wiki.gnome.org/Projects/Zenity">Zenity</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p><p>Für <a class="internal" href="./kde.html">KDE</a> bzw. <a class="internal" href="./qt.html">Qt</a>-Dialoge gibt es das Programm <a class="internal" href="./kdialog.html">KDialog</a> mit ähnlicher Funktionalität. Die Abspaltung (Fork) <a class="internal" href="./yad.html">yad</a> bietet dagegen erweiterte Möglichkeiten bei Darstellung und Benutzerinteraktion.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Zuerst muss folgendes Paket installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>zenity</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install zenity </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install zenity </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Beispielskript">Beispielskript<a class="headerlink" href="#Beispielskript">¶</a></h2><p>
Anhand eines kleines Skriptes sollen die Möglichkeiten des Programms aufgezeigt werden. Das Beispielskript ist recht simpel aufgebaut: Es soll zuerst eine Warnung zum Programm angezeigt werden, dann wird vom Benutzer eine Texteingabe und eine Passworteingabe gefordert und alles am Ende wieder angezeigt. Die Quellcodezeilen sind nummeriert, um sie später besser erklären zu können.</p><div class="section_2"><h3 id="Allgemeine-Informationen">Allgemeine Informationen<a class="headerlink" href="#Allgemeine-Informationen">¶</a></h3><p>
Zuvor ein paar allgemeine Informationen zur Shell-Programmierung: In der Regel reicht es in der ersten Zeile die Standardshell unter <strong>/bin/sh</strong> zu benutzen. Die if-then-Konstrukte werden benutzt, um festzustellen, ob der Benutzer auf <em>"Abbrechen"</em> bzw. <em>"Nein"</em> geklickt hat. Der Befehl "exit" beendet in so einem Fall das Skript. Ein "\n" in einer Textzeile sorgt für einen Zeilenumbruch. Die Variablenzuweisung mit "=" kann später per "$" wieder ausgelesen werden.</p><p>Damit die Skripte starten, muss man diese nach dem Speichern ausführbar machen <sup><a href="#source-3">[3]</a></sup>.</p></div><div class="section_2"><h3 id="Quellcode">Quellcode<a class="headerlink" href="#Quellcode">¶</a></h3><p>
Folgendes Skript gibt man (ohne Zeilennummern) in einem Editor <sup><a href="#source-2">[2]</a></sup> ein und speichert es an einen beliebigen Ort:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">if</span> ! zenity --warning --text <span class="s2">"Dieses Programm ist eigentlich harmlos\!\nTrotzdem fortfahren?"</span><span class="p">;</span> <span class="k">then</span>
  exit<span class="p">;</span>
<span class="k">fi</span>

<span class="k">if</span> ! <span class="nv">NAME</span><span class="o">=</span><span class="k">$(</span>zenity --entry --text <span class="s2">"Bitte geben Sie Ihren Namen ein:"</span> --title <span class="s2">"Wer sind Sie?"</span><span class="k">)</span><span class="p">;</span> <span class="k">then</span>
  exit<span class="p">;</span>
<span class="k">fi</span>

<span class="k">if</span> ! <span class="nv">PASS</span><span class="o">=</span><span class="k">$(</span>zenity --entry --hide-text --text <span class="s2">"Bitte geben Sie das Passwort ein:"</span> --title <span class="s2">"Und das Passwort?"</span><span class="k">)</span><span class="p">;</span> <span class="k">then</span>
  exit<span class="p">;</span>
<span class="k">fi</span>

<span class="o">(</span>
<span class="nb">echo</span> <span class="s2">"25"</span><span class="p">;</span> sleep <span class="m">1</span>
<span class="nb">echo</span> <span class="s2">"# Statusmeldung 1"</span>
<span class="nb">echo</span> <span class="s2">"50"</span><span class="p">;</span> sleep <span class="m">1</span>
<span class="nb">echo</span> <span class="s2">"# Statusmeldung 2"</span>
<span class="nb">echo</span> <span class="s2">"100"</span>
<span class="o">)</span> <span class="p">|</span> zenity --progress --text <span class="s2">"Vorgang wird bearbeitet"</span> --percentage<span class="o">=</span><span class="m">0</span>

zenity --info --text <span class="s2">"Ihr Name: </span><span class="nv">$NAME</span><span class="s2">\nIhr Passwort: </span><span class="nv">$PASS</span><span class="s2">"</span> --title <span class="s2">"Das Ergebnis!"</span>
</pre></div>
</td></tr></table></div></div><div class="section_2"><h3 id="Erlaeuterungen">Erläuterungen<a class="headerlink" href="#Erlaeuterungen">¶</a></h3><p>
</p><ul><li><p><strong>Zeile 3:</strong> Die Option <code class="notranslate">--warning</code> zeigt eine Warnung mit den Optionen <em>"Ok"</em> und <em>"Abbrechen"</em> an. Den angezeigten Text kann man immer mit der Option <code class="notranslate">--text</code> beeinflussen. Bei neueren Versionen bekommt man jedoch nur noch eine Warnung angezeigt. Dort muss die Option <code class="notranslate">--question</code> für einen Fragedialog genutzt werden. </p></li><li><p><strong>Zeile 7</strong> - Die Option <em>--entry</em> zeigt ein Texteingabefeld mit den Optionen <em>"Ok"</em> und <em>"Abbrechen"</em> an. </p></li><li><p><strong>Zeile 11:</strong> - Dies zeigt wieder ein Texteingabefeld, die Option <code class="notranslate">--hide-text</code> verschlüsselt dabei aber die Eingabe durch Sternchen. </p></li><li><p><strong>Zeilen 15-21</strong> - Es wird ein Fortschrittsbalken mit dem Startwert 0% angezeigt, dessen Prozentzahl wird in 25er Schritten hochgezählt und der Anzeigetext <em>"Statusmeldung X"</em> bei jedem Schritt verändert. </p></li><li><p><strong>Zeile 23</strong> - Am Ende wird per <code class="notranslate">--info</code> ein Informationsfenster mit den eingegebenen Daten angezeigt. </p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Weitere-Optionen">Weitere Optionen<a class="headerlink" href="#Weitere-Optionen">¶</a></h2><p>
<img alt="./zenity.png" class="image-right" src="./_/3359e211a3e21f678df6bd91f595f28de298721a.png"/>
<img alt="./zenity1.png" class="image-right" src="./_/68f1ddf2fbd2b9fee56475e589ba4672ce102d1f.png"/></p><p>
</p><table><tr class="kopf"><td> Option </td><td> <strong>Aktion</strong> </td></tr><tr><td> <code class="notranslate">--info</code> </td><td> Information </td></tr><tr><td> <code class="notranslate">--warning</code> </td><td> Warnung </td></tr><tr><td> <code class="notranslate">--error</code> </td><td> Fehler </td></tr><tr><td> <code class="notranslate">--question</code> </td><td> Frage </td></tr><tr><td> <code class="notranslate">--notification</code> </td><td> Benachrichtungsfeld </td></tr><tr><td> <code class="notranslate">--entry</code> </td><td> Texteingabe </td></tr><tr><td> <code class="notranslate">--file-selection</code> </td><td> Dateiauswahl </td></tr><tr><td> <code class="notranslate">--list</code> </td><td> Listenauswahl </td></tr><tr><td> <code class="notranslate">--progress</code> </td><td> Fortschrittsanzeige </td></tr><tr><td> <code class="notranslate">--scale</code> </td><td> Schieberegler </td></tr><tr><td> <code class="notranslate">--password</code> </td><td> Passwort </td></tr><tr><td> <code class="notranslate">--entry --hide-text</code> </td><td> Texteingabe mit verstecktem Text </td></tr><tr><td> <code class="notranslate">--calendar</code> </td><td> Kalender </td></tr></table><p>Dies ist natürlich nur ein Teil von dem, was Zenity kann. Genaueres erfährt man im Terminal per</p><div class="bash"><div class="contents"><pre class="notranslate">zenity --help </pre></div></div><p>oder in der <a class="internal" href="./man.html">Manpage</a> zu Zenity.</p></div><div class="section_1"><h2 id="Programmumschalter">Programmumschalter<a class="headerlink" href="#Programmumschalter">¶</a></h2><p>
Öfters möchte man mit einem simplen Skript zwei gegenteilige Aktionen ausführen, z.B. ein Programm starten und beenden oder sich ins Internet ein- und wieder auswählen. Eine Lösungsmöglichkeit wären zwei getrennte Skripte, die das erledigen. Aus Platzgründen wäre es aber komfortabler, dies mit einem einzigen Icon (welches sich je nach Status verändert) im Panel zu erreichen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Der Befehl <code class="notranslate">zenity --notify</code> erzeugt mit aktuellen Versionen von zenity keine Panel-Icons mehr, sondern Benachrichtigungen, deren Verhalten von der Arbeitsumgebung abhängig ist.  Der Programmumschalter funktioniert daher nicht unter allen Desktopumgebungen.
</p></div></div><div class="section_2"><h3 id="Grundgeruest-erstellen">Grundgerüst erstellen<a class="headerlink" href="#Grundgeruest-erstellen">¶</a></h3><p>
Das Skript wird in einem Editor <sup><a href="#source-2">[2]</a></sup> erstellt. Hier fügt man das Grundgerüst ein:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="k">while</span><span class="o">(</span><span class="nb">true</span><span class="o">)</span>
<span class="k">do</span>
   zenity --notification --window-icon<span class="o">=</span><span class="nv">$HOME</span>/.icons/status1.png
   <span class="c1"># Befehl 1</span>
   zenity --notification --window-icon<span class="o">=</span><span class="nv">$HOME</span>/.icons/status2.png
   <span class="c1"># Befehl 2</span>
<span class="k">done</span>
</pre></div>
</td></tr></table></div><p>Danach muss das Skript ausführbar gemacht werden <sup><a href="#source-3">[3]</a></sup>.</p><div class="section_3"><h4 id="Erklaerung">Erklärung<a class="headerlink" href="#Erklaerung">¶</a></h4><p>
Das Skript ist eine Endlosschleife, die zwischen zwei Modi hin- und herschaltet. Zuerst wird zenity aufgerufen und präsentiert im Benachrichtigungsfeld des Panels das Symbol <strong>status1.png</strong>. Klickt man auf dieses, wird <code class="notranslate">Befehl 1</code> ausgeführt und sofort wieder zenity gestartet, dieses mal aber mit <strong>status2.png</strong> als Bild. Klickt man wieder darauf, wird <code class="notranslate">Befehl 2</code> abgearbeitet und die Schleife fängt von vorne an. Dies stellt einen simplen Umschalter dar.</p></div></div><div class="section_2"><h3 id="Befehle-einfuegen">Befehle einfügen<a class="headerlink" href="#Befehle-einfuegen">¶</a></h3><p>
Anstelle der beiden Kommentare muss man die Befehle (es sind natürlich auch mehrere Zeilen möglich) einfügen, die abgearbeitet werden sollen.</p></div><div class="section_2"><h3 id="Symbole-waehlen">Symbole wählen<a class="headerlink" href="#Symbole-waehlen">¶</a></h3><p>
Symbole werden im versteckten Ordner <strong>~/.icons</strong> im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> gespeichert. Die Wahl ist dabei willkürlich und kann nach Belieben geändert werden. Manchmal existiert dieser Ordner bereits, ansonsten legt man ihn neu an.</p><p>Sinnvolle Symbole sind z.B. simple rote und grüne Schaltflächen: <img alt="./status_off.png" class="image-default" src="./_/c91d2a23cb7276aafd94b581d5efdb3f445d0f80.png"/> <img alt="./status_on.png" class="image-default" src="./_/d6861afbed620c83551511366d28f80a43d26976.png"/></p></div><div class="section_2"><h3 id="Autostart">Autostart<a class="headerlink" href="#Autostart">¶</a></h3><p>
Die fertige Datei kann man dann bei der Anmeldung automatisch ausführen lassen <sup><a href="#source-4">[4]</a></sup>.</p></div><div class="section_2"><h3 id="Beispiele">Beispiele<a class="headerlink" href="#Beispiele">¶</a></h3><p>
<a class="crosslink anchor" href="#DSL" id="DSL"></a>
</p><div class="section_3"><h4 id="Internet-Einwahl">Internet-Einwahl<a class="headerlink" href="#Internet-Einwahl">¶</a></h4><p>
Eine sehr gute Anwendung findet man, wenn man sich ins Internet einwählen möchte. Nicht jeder Benutzer möchte DSL sofort beim PC-Start laufen lassen, für ISDN-Benutzer kommt dies sowieso nicht in Frage. Voraussetzung ist, dass die Internetverbindung mit <code class="notranslate">pppoeconf</code> eingerichtet wurde und die automatische Einwahl nicht aktiviert ist. Der Provider heißt hier <code class="notranslate">dsl-provider</code> und muss ggf. angepasst werden.</p><p>Als Symbole kann man die zwei Netzwerk-Bilder aus Ubuntu nehmen: <img alt="./dsl_stat_off.png" class="image-default" src="./_/5f7ba7decebfd4bdc2d5ffe4389da5963e712889.png"/> <img alt="./dsl_stat_on.png" class="image-default" src="./_/cadcf0e8a53a2e79a871f9f188fb1ee3fb8a010e.png"/></p><p>Nach dem Speichern beider Bilder im <strong>.icons</strong>-Ordner lautet das Skript dann:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="k">while</span><span class="o">(</span><span class="nb">true</span><span class="o">)</span>
<span class="k">do</span>
   zenity --notification --window-icon<span class="o">=</span><span class="nv">$HOME</span>/.icons/dsl_stat_off.png
   pon dsl-provider
   zenity --notification --window-icon<span class="o">=</span><span class="nv">$HOME</span>/.icons/dsl_stat_on.png
   poff -a
<span class="k">done</span>
</pre></div>
</td></tr></table></div><p>Dieses dann z.B. als <strong>dsl-dial.sh</strong> speichern, ausführbar machen und im Autostart eintragen.</p></div></div></div><div class="section_1"><h2 id="Zenity-als-Abfrage-fuer-dd-Backup-nutzen">Zenity als Abfrage für dd-Backup nutzen<a class="headerlink" href="#Zenity-als-Abfrage-fuer-dd-Backup-nutzen">¶</a></h2><p>
Mit diesem kleinen Script lassen sich die notwendigen Eingaben für das Erstellen eines Partitonsimage abfragen. Es ist besonders für unerfahrene Benutzer brauchbar, da es nahezu selbsterklärend ist.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
zenity --info --text <span class="s2">"Im folgenden Auswahlfenster das zu sichernde Laufwerk auswählen. Der Syntax lautet sdx.x"</span> --title <span class="s2">"Quelle"</span>
<span class="nb">cd</span> / <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /dev <span class="o">&amp;&amp;</span>  <span class="nv">Quelle</span><span class="o">=</span><span class="k">$(</span>zenity --file-selection<span class="k">)</span>
zenity --info --text <span class="s2">"Jetzt den Ort ausgewählen, wohin das Image gespeichert werden soll"</span> --title <span class="s2">"Zielordner"</span>
<span class="nb">cd</span> / <span class="o">&amp;&amp;</span> <span class="nv">Ziel</span><span class="o">=</span><span class="k">$(</span>zenity --file-selection --directory .<span class="k">)</span>
zenity --info --text <span class="s2">"Dateiname des Images festlegen. Das Image muss mit der Dateiendung .img (backup.img) gespeichert werden."</span> --title <span class="s2">"Imagename festlegen"</span>
<span class="nv">Dateiname</span><span class="o">=</span><span class="k">$(</span>zenity --entry --title <span class="s2">"Dateiname"</span> --text <span class="s2">"Beispiel: backup-sda1.img"</span><span class="k">)</span>
sudo dd <span class="k">if</span><span class="o">=</span><span class="nv">$Quelle</span> <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">of</span><span class="o">=</span><span class="nv">$Ziel</span>/<span class="nv">$Dateiname</span> <span class="p">&amp;</span> <span class="nv">ddpid</span><span class="o">=</span><span class="nv">$!</span> <span class="p">;</span> <span class="k">while</span> <span class="o">[</span> <span class="s2">"</span><span class="k">$(</span>ps -a <span class="p">|</span> grep <span class="nv">$ddpid</span><span class="k">)</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span> sudo <span class="nb">kill</span> -SIGUSR1 <span class="nv">$ddpid</span><span class="p">;</span> sleep <span class="m">5</span><span class="p">;</span> <span class="k">done</span>  
</pre></div>
</td></tr></table></div><p>Nachdem man das Skript auf dem Rechner gespeichert hat, z.B. als <strong>backups.sh</strong>, muss man es noch ausführbar machen.</p></div><div class="section_1"><h2 id="Grafische-Passwort-Abfrage-mit-Zenity">Grafische Passwort-Abfrage mit Zenity<a class="headerlink" href="#Grafische-Passwort-Abfrage-mit-Zenity">¶</a></h2><p>
<a class="internal" href="./zenity.html">Zenity</a> bietet eine Möglichkeit, das <a class="internal" href="./sudo.html">sudo</a>-Passwort grafisch zu erfragen. Hier wird das Passwort in eine Variable <code class="notranslate">PASSW</code> zwischen gespeichert und per Pipe an sudo übergeben. Im unteren Beispiel wird eine <a class="internal" href="./samba.html">Samba</a>-Freigabe per Skript gemountet. Hierbei ist zu beachten, dass das Passwort für sudo und für dem Samba-Login gleich sein muss.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#! /bin/bash</span>
<span class="nv">PASSW</span><span class="o">=</span><span class="k">$(</span>zenity --entry --hide-text --text <span class="s2">"Bitte Passwort eingeben:"</span> --title <span class="s2">"SMB/CIFS Passwort?"</span><span class="k">)</span>
<span class="nb">echo</span> -e <span class="s2">"</span><span class="nv">$PASSW</span><span class="s2">\n"</span> <span class="p">|</span> sudo -S -s -- mount -t cifs //meinServer/smbQuelle /mnt/smbZiel -o <span class="nv">iocharset</span><span class="o">=</span>utf8 -o <span class="nv">user</span><span class="o">=</span>derUsername -o <span class="nv">pass</span><span class="o">=</span><span class="nv">$PASSW</span>
<span class="nv">PASSW</span><span class="o">=</span><span class="s2">""</span>
sudo -k
</pre></div>
</td></tr></table></div></div><div class="section_1"><h2 id="Fortschrittsanzeige">Fortschrittsanzeige<a class="headerlink" href="#Fortschrittsanzeige">¶</a></h2><p>
</p><div class="section_2"><h3 id="Mit-Statussymbol">Mit Statussymbol<a class="headerlink" href="#Mit-Statussymbol">¶</a></h3><p>
Das Benachrichtigungsfeld kann auch über einen Dateideskriptor angesteuert werden. Damit Zenity auf Eingaben wartet, muss die Option <em>--listen</em> gesetzt werden. Dadurch kann man den Status einer länger dauernden Aktion, z.B. Herunter-/Hochladen von größeren Datenmengen oder das Konvertieren vieler Dateien, fortlaufend aktualisieren.</p><div class="section_3"><h4 id="Quellcode-2">Quellcode<a class="headerlink" href="#Quellcode-2">¶</a></h4><p>
Das Skript wird in einem Editor <sup><a href="#source-2">[2]</a></sup> erstellt. Hier fügt man das Grundgerüst ein: 
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">exec</span> <span class="m">3</span>&gt; &gt;<span class="o">(</span>zenity --notification --listen<span class="o">)</span>

<span class="k">for</span> datei in <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>/*
<span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">"tooltip:Aktionen für </span><span class="si">${</span><span class="nv">datei</span><span class="si">}</span><span class="s2"> werden durchgeführt"</span> &gt;<span class="p">&amp;</span><span class="m">3</span>
  <span class="c1">#Befehle für aktuelle Datei abarbeiten</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">"message:Vorgang abgeschlossen"</span> &gt;<span class="p">&amp;</span><span class="m">3</span>

<span class="nb">exec</span> <span class="m">3</span>&gt;<span class="p">&amp;</span>-
</pre></div>
</td></tr></table></div></div><div class="section_3"><h4 id="Erlaeuterungen-2">Erläuterungen<a class="headerlink" href="#Erlaeuterungen-2">¶</a></h4><p>
</p><ul><li><p><strong>Zeile 2:</strong> - Hier wird der Dateideskriptor <code class="notranslate">3</code> geöffnet und Zenity gestartet. Es kann auch ein anderer Dateideskriptor &gt;=3 verwendet werden. </p></li><li><p><strong>Zeilen 4-8:</strong> -  Für alle Dateien im Verzeichnis <code class="notranslate">$1</code> werden die entsprechenden Befehle abgearbeitet. Zeile 7 muss durch die jeweiligen echten Befehle ersetzt werden. </p></li><li><p><strong>Zeile 6:</strong> - Der Tooltip für das Symbol wird bei jedem Durchgang aktualisiert</p></li><li><p><strong>Zeile 10:</strong> - unter dem Benachrichtigungssymbol wird eine Sprechblase angezeigt</p></li><li><p><strong>Zeile 12:</strong> - Der Dateideskriptor wird geschlossen und Zenity beendet. </p></li></ul><p>
</p></div><div class="section_3"><h4 id="Kommandos">Kommandos<a class="headerlink" href="#Kommandos">¶</a></h4><p>
Das Benachrichtigungssymbol lässt sich über folgende Kommandos steuern. Das Format ist immer</p><pre class="notranslate">&lt;Kommando&gt;:&lt;Wert&gt;</pre><p>
</p><table><tr class="kopf"><td> <strong>Option</strong> </td><td> <strong>Aktion</strong> </td></tr><tr><td> <code class="notranslate">icon</code> </td><td> Das anzuzeigende Icon. Als Wert gibt man den Pfad zum jeweiligen Icon an.  </td></tr><tr><td> <code class="notranslate">visible</code> </td><td> Soll ein Symbol angezeigt werden? Mögliche Werte sind <code class="notranslate">true</code> und <code class="notranslate">false</code> </td></tr><tr><td> <code class="notranslate">tooltip</code> </td><td> Text des Tooltips </td></tr><tr><td> <code class="notranslate">message</code> </td><td> Eine Sprechblase wird unterhalb des Symbols angezeigt. Der anzuzeigende Text wird als Wert erwartet. </td></tr></table></div></div><div class="section_2"><h3 id="Mit-Fenster">Mit Fenster<a class="headerlink" href="#Mit-Fenster">¶</a></h3><p>
</p><div class="section_3"><h4 id="Quellcode-3">Quellcode<a class="headerlink" href="#Quellcode-3">¶</a></h4><p>
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">exec</span> <span class="m">3</span>&gt; &gt;<span class="o">(</span>zenity --progress --title<span class="o">=</span><span class="s2">"Sicherung"</span> --percentage<span class="o">=</span><span class="m">0</span> --auto-close --width<span class="o">=</span><span class="m">400</span><span class="o">)</span>

<span class="nb">echo</span> <span class="s2">"# Ermittle Dateien..."</span> &gt;<span class="p">&amp;</span><span class="m">3</span>
<span class="nv">count</span><span class="o">=</span><span class="k">$(</span>find <span class="si">${</span><span class="nv">1</span><span class="p">-.</span><span class="si">}</span> <span class="p">|</span> wc -l<span class="k">)</span> <span class="c1"># Anzahl der Dateien</span>

<span class="nv">IFS</span><span class="o">=</span><span class="s1">'</span>
<span class="s1">'</span> <span class="c1"># wegen Dateien mit Leerzeichen</span>
<span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="k">for</span> file in <span class="k">$(</span>find <span class="si">${</span><span class="nv">1</span><span class="p">-.</span><span class="si">}</span><span class="k">)</span>
<span class="k">do</span>
        <span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="nv">$i</span><span class="o">+</span><span class="m">1</span><span class="k">))</span><span class="p">;</span>
        <span class="nb">echo</span> <span class="k">$((</span><span class="nv">$i</span><span class="o">*</span><span class="m">100</span><span class="o">/</span><span class="nv">$count</span><span class="k">))</span> &gt;<span class="p">&amp;</span><span class="m">3</span><span class="p">;</span>
        <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$file</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="k">continue</span><span class="p">;</span> <span class="k">fi</span> <span class="c1">#Verzeichnisse überspringen</span>
        <span class="nb">echo</span> <span class="s2">"# Datei '</span><span class="nv">$file</span><span class="s2">' wird gesichert..."</span> &gt;<span class="p">&amp;</span><span class="m">3</span><span class="p">;</span>
        <span class="nb">echo</span> <span class="s2">"Datei '</span><span class="nv">$file</span><span class="s2">' wird gesichert..."</span><span class="p">;</span>
        <span class="c1"># hier das einsetzen was mit der Datei gemacht werden soll.</span>
<span class="k">done</span>

<span class="nb">echo</span> Fertig.
<span class="nb">exec</span> <span class="m">3</span>&gt;<span class="p">&amp;</span>-
</pre></div>
</td></tr></table></div></div><div class="section_3"><h4 id="Erlaeuterungen-3">Erläuterungen<a class="headerlink" href="#Erlaeuterungen-3">¶</a></h4><p>
</p><ul><li><p>Zenity wird geöffnet (Bedeutung der Optionen siehe Manpage) </p></li><li><p><code class="notranslate">find ${1-.} | wc -l</code> - Die Anzahl der Dateien für die Fortschrittsanzeige wird ermittelt und das Ergebnis der Variablen <code class="notranslate">$count</code> zugewiesen </p></li><li><p>In einer Schleife werden alle Dateien verarbeitet (<code class="notranslate">$IFS</code> bestimmt, an welchen Zeichen eine neue Datei beginnt) </p></li><li><p><code class="notranslate">$(($i*100/$count))</code> - Errechnung der Prozentzahl </p></li><li><p><code class="notranslate">echo "# Datei '$file' wird gesichert..." &gt;&amp;3;</code> - Zahlen werden von Zenity als Prozentsatz interpretiert, <code class="notranslate"># Text</code> bestimmt den Anzeigetext </p></li></ul><p>
</p></div></div></div><div class="section_1"><h2 id="Probleme-und-Loesungen">Probleme und Lösungen<a class="headerlink" href="#Probleme-und-Loesungen">¶</a></h2><p>
Bei jedem Aufruf von Zenity erscheint im Terminal eine Warnung
</p><pre class="notranslate">Gtk-Message: GtkDialog mapped without a transient parent. This is discouraged.</pre><p>
Der Eintrag an sich ist harmlos, stört ggf. aber die Übersicht erheblich. Man wird ihn los, indem man im Skript jeden zenity-Aufruf mit einem ans jeweilige Zeilenende gesetztem
</p><pre class="notranslate">2&gt; dev/null</pre><p>
die Meldung ins Nirvana schickt.</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-gnomeprojects" href="https://wiki.gnome.org/Projects/Zenity">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p><a class="external" href="https://help.gnome.org/users/zenity/stable/index.html.de" rel="nofollow">Handbuch</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li></ul></li><li><p><a class="internal" href="./scrot.html#Skripte">Bildschirmfotos mit Zenity-Oberfläche</a> - Skriptbeispiel</p></li><li><p><a class="external" href="http://homepages.ihug.co.nz/~trmusson/programs.html#gxmessage" rel="nofollow">gxmessage</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Hinweise ohne Interaktionsmöglichkeit ausgeben</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./zenity/a/revision/941159.html">Diese Revision</a> wurde am 14. Mai 2017 12:14 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./zenity.html">Zenity</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>