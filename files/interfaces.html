<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>interfaces › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./interfaces.html">interfaces</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/interfaces">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./interfaces/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./interfaces/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./interfaces/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./interfaces/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./interfaces/a/backlinks.html">interfaces</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./artful_aardvark.html">Ubuntu 17.10</a> Artful Aardvark</p></li><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./sudo.html">Root-Rechte erlangen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a>, <em>optional</em></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Aufbau">Aufbau
</a><ol class="arabic"><li><a class="crosslink" href="#Statische-IP-Konfiguration-static">Statische IP-Konfiguration (static)
</a></li><li><a class="crosslink" href="#Dynamische-IP-Konfiguration-dhcp">Dynamische IP-Konfiguration (dhcp)
</a></li><li><a class="crosslink" href="#Manuelle-Konfiguration-manual">Manuelle Konfiguration (manual)
</a></li><li><a class="crosslink" href="#Automatische-Konfiguration-auto">Automatische Konfiguration (auto)
</a></li></ol></li><li><a class="crosslink" href="#Anwendung-der-Konfigurationen">Anwendung der Konfigurationen
</a></li><li><a class="crosslink" href="#Schluesselworte">Schlüsselworte
</a><ol class="arabic"><li><a class="crosslink" href="#iface">iface
</a></li><li><a class="crosslink" href="#allow-GRUPPENNAME">allow-GRUPPENNAME
</a></li><li><a class="crosslink" href="#mapping">mapping
</a></li><li><a class="crosslink" href="#source-und-source-directory">source und source-directory
</a></li><li><a class="crosslink" href="#no-auto-down">no-auto-down
</a></li><li><a class="crosslink" href="#no-scripts">no-scripts
</a></li></ol></li><li><a class="crosslink" href="#Anwendungsbeispiele">Anwendungsbeispiele
</a><ol class="arabic"><li><a class="crosslink" href="#Roaming">Roaming
</a></li><li><a class="crosslink" href="#Mehrere-IP-Adressen">Mehrere IP-Adressen
</a></li><li><a class="crosslink" href="#Buendeln-von-Netzwerkschnittstellen">Bündeln von Netzwerkschnittstellen
</a></li><li><a class="crosslink" href="#Netzwerkbruecke">Netzwerkbrücke
</a></li><li><a class="crosslink" href="#WLAN-Konfiguration">WLAN-Konfiguration
</a></li><li><a class="crosslink" href="#VPN">VPN
</a></li></ol></li><li><a class="crosslink" href="#Start-Stopp-Skripte">Start/Stopp-Skripte
</a><ol class="arabic"><li><a class="crosslink" href="#Befehle-in-interfaces">Befehle in interfaces
</a></li><li><a class="crosslink" href="#Skripte-in-etc-network-if-d">Skripte in /etc/network/if-*.d/
</a></li><li><a class="crosslink" href="#inherits-Konfigurationen-vererben">inherits – Konfigurationen vererben
</a></li></ol></li><li><a class="crosslink" href="#Aktivierung">Aktivierung
</a></li><li><a class="crosslink" href="#Zusaetzliche-Aspekte">Zusätzliche Aspekte
</a><ol class="arabic"><li><a class="crosslink" href="#Eigenschaften-der-beiden-Methoden">Eigenschaften der beiden Methoden
</a></li><li><a class="crosslink" href="#Entscheidungskriterien">Entscheidungskriterien
</a></li><li><a class="crosslink" href="#NetworkManager-deaktivieren">NetworkManager deaktivieren
</a></li></ol></li><li><a class="crosslink" href="#Programm-Dokumentation">Programm-Dokumentation
</a></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#Intern">Intern
</a></li><li><a class="crosslink" href="#Extern">Extern
</a></li></ol></li></ol></div><p>Dieser Artikel beschreibt die Datei <strong>/etc/network/interfaces</strong>, die Konfigurationsdatei für den Debian ifupdown-Mechanismus. Die hier gemachten Einstellungen werden beispielsweise beim Systemstart genutzt, um eine Netzwerkverbindung schon beim Hochfahren des Systems herzustellen.</p><p>Ubuntu verwendet jedoch in einer Standard-Installation zur Konfiguration der Netzwerk-Schnittstellen zusätzlich den NetworkManager. Alternativen zum NetworkManager können bei Bedarf installiert werden. In diesem Artikel wird jedoch eine Standard-Installation vorausgesetzt und insbesondere die Wechselwirkungen zwischen <strong>/etc/network/interfaces</strong> und NetworkManager beschrieben.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei Verwendung des <a class="internal" href="./networkmanager.html">NetworkManagers</a> (NM) oder einer anderen Netzwerk-Management-Software (z.B. <a class="internal" href="./wicd.html">Wicd</a>, <a class="internal" href="./systemd/networkd.html">systemd-networkd</a>) sollte von einer Bearbeitung der <strong>/etc/network/interfaces</strong> abgesehen werden. Diese Programme verwenden eigene Konfigurationsdateien, weshalb die Bearbeitung der Datei <strong>/etc/network/interfaces</strong> zur Konfiguration von Netzwerk-Verbindungen nicht sinnvoll ist.</p><p>Es ist jedoch möglich, eine Konfiguration zu erstellen, die den „klassischen Weg“ und bei Bedarf die Verwendung des NetworkManagers erlaubt. Siehe hierzu <a class="crosslink" href="#NetworkManager-deaktivieren">NetworkManager deaktivieren</a> und <a class="crosslink" href="#Aufbau">Aufbau</a>.
</p></div></div><p>Die beiden Methoden verwenden gegensätzliche Strategien:
</p><ul><li><p><strong>ifupdown</strong> macht genau das, was man ihm über die Datei <strong>/etc/network/interfaces</strong> erlaubt.</p></li><li><p>NetworkManager macht, was ihm sinnvoll erscheint und man ihm nicht explizit verbietet.</p></li></ul><p>
Die Wahl zwischen einer Konfiguration über <strong>/etc/network/interfaces</strong> oder NetworkManager kann für jede Netzwerk-Schnittstelle separat getroffen werden. Dem NetworkManager muss unbedingt mitgeteilt werden, um welche Schnittstellen er sich <span class="underline">nicht</span> kümmern darf, da eine unklare Zuständigkeitsverteilung in der Regel zu gar nicht oder nicht zufriedenstellend funktionierendem Netzwerk führt. Siehe hierzu: <a class="crosslink" href="#NetworkManager-deaktivieren">NetworkManager deaktivieren</a></p><p>Die in der Datei <strong>/etc/network/interfaces</strong> hinterlegten Konfigurationen werden mit dem Programm <code class="notranslate">ifup</code> aktiviert („Schnittstelle starten“) bzw. mit dem Programm <code class="notranslate">ifdown</code> deaktiviert („Schnittstelle stoppen“). Siehe hierzu die Abschnitte: <a class="crosslink" href="#Anwendung-der-Konfigurationen">Anwendung der Konfigurationen</a> und <a class="crosslink" href="#Aktivierung">Aktivierung</a></p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Im folgenden Text wird die Schreibweise <code class="notranslate">SEMANTIK</code> zur Kennzeichnung einer semantischen Variablen verwendet. An diesen Stellen ist unbedingt die Zeichenfolge in Großbuchstaben zu ersetzen durch die Angabe eines Namens für ein Objekt mit der geforderten Bedeutung, also beispielsweise:</p><p><code class="notranslate">SCHNITTSTELLEN-NAME</code> ist zu ersetzen durch den Namen einer Schnittstelle wie <code class="notranslate">eth0</code>.
</p></div></div><div class="section_1"><h2 id="Aufbau">Aufbau<a class="headerlink" href="#Aufbau">¶</a></h2><p>
Die Datei <strong>/etc/network/interfaces</strong> kann in einem Editor <sup><a href="#source-1">[1]</a></sup> mit Root-Rechten <sup><a href="#source-2">[2]</a></sup> bearbeitet werden. In dieser Datei können folgende <a class="crosslink" href="#Schluesselworte">Schlüsselworte</a> verwendet werden:
</p><ul><li><p><a class="crosslink" href="#iface">iface</a></p></li><li><p>allow-auto (Synonym zur Spezialform auto), allow-hotplug, <a class="crosslink" href="#allow-Gruppenname">allow-GRUPPENNAME</a></p></li><li><p><a class="crosslink" href="#mapping">mapping</a></p></li><li><p><a class="crosslink" href="#source-und-source-directory">source, source-directory</a></p></li><li><p><a class="crosslink" href="#no-auto-down">no-auto-down</a> (erst ab 16.04)</p></li><li><p><a class="crosslink" href="#no-scripts">no-scripts</a> (erst ab 16.04)</p></li></ul><p>
Kommentarzeilen werden mit einem Rauten-Zeichen # in der ersten Spalte eingeleitet. Zeilenend-Kommentare sind in dieser Datei nicht möglich. Leerzeilen können zur Gliederung verwendet werden.</p><p>Für eine benutzbare Datei <strong>/etc/network/interfaces</strong> benötigt man nur Konfigurationsblöcke vom Typ <code class="notranslate">iface</code> und ggf. – nur wenn man Schnittstellen beim Rechnerstart automatisch einrichten lassen möchte – die <code class="notranslate">allow-GRUPPENNANME</code>-Anweisungen. Hier folgt ein Beispiel einer solchen Datei:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span># /etc/network/interfaces - Beispieldatei 1 aus wiki.ubuntuusers.de
# interfaces(5) file used by ifup(8) and ifdown(8)
auto lo
iface lo inet loopback

iface dhcp inet dhcp

iface lan inet static
  address 192.168.0.97/24
  gateway 192.168.0.1
  dns-nameservers 192.168.0.1 203.0.113.203
  dns-search example.net

iface enp63s0 inet manual
  hwaddress     random
# hwaddress     12:34:56:78:9a:bc
  up            dhclient $IFACE
auto enp63s0
</pre></div>
</td></tr></table></div><p>Zeilen 3 und 4: Jede interfaces-Datei beginnt traditionell mit den Einträgen für <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Loopback">lo</a> (Loopback). Obwohl diese Angaben heutzutage (Stand Ubuntu 16.04) nicht mehr grundsätzlich erforderlich sind, sollte man sie nicht entfernen oder verändern.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die Netzwerkschnittstelle lo ist elementarer Bestandteil von Linux. Fehlt diese Schnittstelle oder ist sie falsch konfiguriert, so können Programme nicht mehr untereinander kommunizieren. 
</p></div></div><p>Jeder Konfigurationsblock beginnt mit einer Zeile nach folgendem Muster:</p><pre class="notranslate">iface KONFIGURATIONS-NAME PROTOKOLL METHODE</pre><p>Er kann ggf. zusätzliche Zeilen umfassen und endet vor einer Zeile mit einem der o.g. Schlüsselwörter. Die Beispieldatei enthält also vier Konfigurationsblöcke mit den Namen lo (nur Zeile 4), dhcp (nur Zeile 6), lan (Zeilen 8-12) und enp63s0 (Zeilen 14-17). Es ist gute Praxis, zur Verbesserung der Lesbarkeit die Folgezeilen zu einer iface-Zeile einzurücken; dies wird aber von der Software ignoriert.</p><ul><li><p>Für <code class="notranslate">KONFIGURATIONS-NAME</code> kann eine beliebige Bezeichnung verwendet werden. Grundsätzlich kann jede Konfiguration für jede vorhandene Schnittstelle verwendet werden. Bei einer Konfiguration, die nur für eine ganz bestimmte physische Schnittstelle <code class="notranslate">SCHNITTSTELLEN-NAME</code> angewendet werden soll, wählt man zweckmäßigerweise als <code class="notranslate">KONFIGURATIONS-NAME</code> den Namen dieser Schnittstelle.     </p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Exkurs: Eine Liste aller Netzwerk-Schnittstellen erhält man mit dem Befehl: <code class="notranslate">ip link</code>
</p></div></div></li><li><p>Für <code class="notranslate">PROTOKOLL</code> muss ein Netzwerkprotokoll ausgewählt werden, welches <code class="notranslate">ifup</code> beherrscht (<code class="notranslate">inet</code>, <code class="notranslate">inet6</code>, <code class="notranslate">ipx</code> oder <code class="notranslate">can</code>). Dies ist abhängig von den Geräten, mit denen kommuniziert werden soll. Außerdem muss <code class="notranslate">ifup</code> ein low-level-Konfigurationsprogramm zur Verfügung stehen: Für <code class="notranslate">inet</code> und <code class="notranslate">inet6</code> ist dies das auf jedem Standard-Ubuntu-System installierte Programm <code class="notranslate">ip</code>, für die anderen Protokolle müsste es noch installiert<sup><a href="#source-3">[3]</a></sup> werden.</p></li><li><p>Die zulässigen Werte für <code class="notranslate">METHODE</code> sind abhängig vom gewählten Wert für <code class="notranslate">PROTOKOLL</code>:</p><ul><li><p><code class="notranslate">inet</code> kennt u.a. <code class="notranslate">static</code> für eine statische Konfiguration, <code class="notranslate">dhcp</code> für eine dynamische Konfiguration via DHCP, <code class="notranslate">manual</code> als allgemeinste Form.</p></li><li><p><code class="notranslate">inet6</code> kennt zusätzlich zu den für <code class="notranslate">inet</code> genannten Methoden noch <code class="notranslate">auto</code> für die bei IPv6 mögliche <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/IPv6#Autokonfiguration">„zustandslose Autokonfiguration“ (SLAAC)</a> nach RFC4862.</p></li><li><p>Weiterhin sind auch Sonderfälle wie <code class="notranslate">ppp</code> (für <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Point-to-Point_Protocol">Point-to-Point-Protocol</a>) als <code class="notranslate">METHODE</code> möglich, werden in diesem Artikel jedoch nicht weiter behandelt.</p></li></ul></li></ul><p>
</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2"> Protokoll </td></tr><tr class="kopf"><td style="text-align: center">Netzwerkprotokoll </td><td> Beschreibung </td></tr><tr><td> inet </td><td> <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Ipv4">IP Version 4</a> IPv4 nach IETF Standard RFC791 </td></tr><tr><td> inet6 </td><td> <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Ipv6">IP Version 6</a> IPv6 nach IETF Standard RFC2460 </td></tr><tr><td> ipx </td><td> <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Internetwork_Packet_Exchange">IPX/SPX</a> Netzwerkprotokoll von Novell </td></tr><tr><td> can </td><td> <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Controller_Area_Network">Controller Area Network</a> CAN-Bus, serielles Feldbus-System </td></tr></table><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Im Folgenden beschränkt sich dieser Artikel, aus Gründen der Übersichtlichkeit und Verbreitung, auf IP.
</p></div></div><div class="section_2"><h3 id="Statische-IP-Konfiguration-static">Statische IP-Konfiguration (static)<a class="headerlink" href="#Statische-IP-Konfiguration-static">¶</a></h3><p>
Beispiel <code class="notranslate">lan</code>, Zeilen 8-12: Für eine statische IP-Konfiguration wählt man die Methode <code class="notranslate">static</code>. Eine statische IP-Konfiguration ist nötig, wenn es im lokalen Netzwerk keinen DHCP-Server gibt. Dazu muss man in der Konfiguration mindestens zwei, in der Praxis aber oft bis zu fünf Angaben machen:</p><ul><li><p><code class="notranslate">address</code> – Die Adresse des eigenen Rechners. Diese Angabe ist erforderlich. Bei Heimnetzen wählt man meistens eine Adresse aus dem Bereich der <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Private_IP-Adresse">Privaten IP-Adressen</a>, also beispielsweise aus dem Bereich <code class="notranslate">192.168.0.1</code> bis <code class="notranslate">192.168.0.254</code>. Die erste und die letzte Adressse eines IP-Netzwerks, also im Beispiel <code class="notranslate">192.168.0.0</code> und <code class="notranslate">192.168.0.255</code>, gehören zwar ebenfalls zum Netzwerk <code class="notranslate">192.168.0.0/24</code>, sind aber beide als „Broadcast-Adresse“ reserviert und grundsätzlich nicht als Unicast-Adressen nutzbar. Man sollte die moderne Schreibweise <code class="notranslate">192.168.0.97/24</code> mit Angabe der Länge des Netzwerkteils bzw. der Prefixlänge (hier /24) benutzen, da man dann keine Netzmaske angeben muss.</p></li><li><p><code class="notranslate">netmask</code> – Bezeichnet die <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Netzmaske">Netzmaske</a> des Netzwerks. Diese Angabe ist nur dann erforderlich, wenn man unter <code class="notranslate">adresse</code> die Prefixlänge nicht angegeben hat. Im Beispiel lautet die Netzmaske <code class="notranslate">255.255.255.0</code>, d.h.  alle Rechner, bei denen die ersten drei Tripel (also in diesem Beispiel <code class="notranslate">192.168.0.</code>) der IP-Adresse identisch sind, gehören zum selben Netzwerk. Mit anderen Netzmasken sind andere Bereiche möglich, siehe hierzu <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/CIDR">Classless Internet Domain Routing</a></p></li><li><p><code class="notranslate">gateway</code> – Die IP des <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Gateway_(Computer)">Gateways</a>, also im Normalfall die IP des Routers, über den man in das Internet geht, oder sich mit anderen IP-Netzwerken verbindet. Diese optionale Angabe ist funktionaler Sicht sehr oft erforderlich, weil mit dieser Angeabe die Default-Route des Systems definiert wird.</p></li><li><p><code class="notranslate">dns-nameservers</code> – Optional kann man noch die Auflösung von DNS-Namen zu IP-Adressen durch Angabe von einem oder bis zu drei DNS-Server (vgl. Zeile 11) und ggf. durch Angabe von Suchdomänen (vgl. Zeile 12, <code class="notranslate">dns-search</code>) konfigurieren. Das hierfür erforderliche Paket <strong>resolvconf</strong> ist bei Ubuntu bereits installiert.</p></li></ul><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>NetworkManager überwacht die Default-Route des Systems und wird jede fremde Änderung korrigieren; aus diesem Grund muss man bei der Einrichtung eines Gateway über <strong>interfaces</strong> den NetworkManager deaktivieren.</p><p>Auch der NetworkManager benutzt <strong>resolvconf</strong> und beeinflusst darüber die Datei <strong>/etc/resolv.conf</strong> – dies kann zu unübersichtlichen Konfliktsituationen mit Störung der Namensauflösung führen. Wenn man über die Datei <strong>/etc/network/interfaces</strong> DNS-Server definieren möchte, sollte man deshalb vorher den NetworkManager deaktivieren.
</p></div></div></div><div class="section_2"><h3 id="Dynamische-IP-Konfiguration-dhcp">Dynamische IP-Konfiguration (dhcp)<a class="headerlink" href="#Dynamische-IP-Konfiguration-dhcp">¶</a></h3><p>
Beispiel <code class="notranslate">dhcp</code>, Zeile 6: Für eine dynamische IP-Konfiguration wählt man die Methode <code class="notranslate">dhcp</code> (siehe auch <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/DHCP">DHCP</a>). Weitere Einträge in der <strong>/etc/network/interfaces</strong> sind für eine solche Konfiguration nicht erforderlich, aber möglich. Der DHCP-Client benutzt ebenfalls <strong>resolvconf</strong> zur Konfiguration der Namensauflösung; somit sind auch in diesem Fall Konflikte mit NetworkManager möglich!</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Methode <code class="notranslate">dhcp</code> kann in Verbindung mit dem Schüsselwort <code class="notranslate">auto</code> dazu führen, dass der Rechner beim Start hängen bleibt oder erst nach einer langen Wartezeit den Startvorgang fortsetzt. Dies geschieht, wenn der DHCP-Client keine Adresse erhält.
</p></div></div></div><div class="section_2"><h3 id="Manuelle-Konfiguration-manual">Manuelle Konfiguration (manual)<a class="headerlink" href="#Manuelle-Konfiguration-manual">¶</a></h3><p>
Beispiel <code class="notranslate">enp63s0</code>, Zeilen 14-17: Wählt man als <code class="notranslate">METHODE</code> <code class="notranslate">manual</code>, so wird <code class="notranslate">ifup</code> keine IP-Adresse konfigurieren, aber die Schnittstelle operativ und administrativ einschalten. Dies ist z.B. sinnvoll, wenn eine Netzwerkschnittstelle entweder keine IP-Adresse benötigt (z.B. bei Ports von bridges), oder man die Adresse selbst (z.B. durch eine Berechnung in einem Skript) festlegen will oder auch, wenn man einer Schnittstelle mehrere Adressen zuweisen möchte.</p><p>Siehe Abschnitt über die <a class="crosslink" href="#Start-Stopp-Skripte">Start/Stopp-Skripte</a> für weitere Beispiele.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Bei den Methoden <code class="notranslate">static</code>, <code class="notranslate">dhcp</code> und <code class="notranslate">manual</code>, aber nicht bei <code class="notranslate">auto</code> kann man die <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/MAC-Adresse">MAC-Adresse</a> der Netzwerkkarte ändern durch Hinzufügen folgender Zeile zum iface-Konfigurationsblock: (vgl. Zeilen 14ff der Beispieldatei)</p><div><div class="contents"><pre class="notranslate">hwaddress 12:34:56:78:9a:bc </pre></div></div><p>Die hier beispielhaft genannte MAC-Adresse ist nach eigenem Bedarf anzupassen. Wichtig ist es, eine unicast-Adresse zu verwenden, d.h. der erste (ganz links stehende) Wert muss gerade (hier 12) sein.</p><p>Anstelle einer konkreten Adresse kann man auch durch Angabe des Spezialwortes <code class="notranslate">random</code> sich eine pseudozufällige Adresse generieren lassen.
</p></div></div></div><div class="section_2"><h3 id="Automatische-Konfiguration-auto">Automatische Konfiguration (auto)<a class="headerlink" href="#Automatische-Konfiguration-auto">¶</a></h3><p>
Dies ist nur beim Protokoll <code class="notranslate">inet6</code> möglich und bedeutet die automatische Konfiguration der IPv6-Addressen nach Angaben des Routers (<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Neighbor_Discovery_Protocol#Router_Advertisement_.E2.80.93_Type_134">router advertisement</a>). Über Zusatzangaben kann man die Methode der Adressgenerierung beeinflussen:
</p><ul><li><p>EUI64 nach IETF-Standard RFC4291</p><ul><li><p><code class="notranslate">privext 0</code> – Der schnittstellenspezifische Teil der Adresse (<em>"interface identifier"</em>), also die niederwertigen 64 Bit werden aus der Ethernet-Adresse abgeleitet. Beim Surfen mit einer solchen Adresse ist man leicht verfolgbar. Für Server ist in aller Regel aber eine zeitlich konstante Adresse vorteilhaft.</p></li></ul></li></ul><p>
</p><ul><li><p>Privacy extensions nach IETF-Standard RFC4941</p><ul><li><p><code class="notranslate">privext 1</code> – Es werden zwei global gültige Adressen erzeugt, und zwar zum ersten die zuvor beschriebene zeitlich konstante Adresse und eine zweite mit pseudozufälligem "interface identifier". Die zeitlich konstante Adresse wird bevorzugt, was diese Variante meist uninteressant macht.</p></li><li><p><code class="notranslate">privext 2</code> – Es werden wie bei <code class="notranslate">privext 1</code> zwei Adressen erzeugt, jedoch wird die mit pseudozufälligem "interface identifier" bevorzugt.</p></li></ul></li></ul><p>
</p><ul><li><p>Stable privacy nach IETF RFC7217 (erst ab 16.04)</p><ul><li><p>ohne "stable secret": Diese Methode benutzt unter Ubuntu 16.04 der NetworkManager als Vorgabe. Bei der Konfiguration über <strong>interfaces</strong> erreicht man diesen Modus über </p><pre class="notranslate">pre-up ip link set addrgenmode none dev $IFACE</pre><p>   Solange man kein dauerhaftes "stable secret" definiert, wird bei jedem Rechnerstart ein pseudozufälliges erzeugt. Die hieraus abgeleiteten Adressen, sowohl die link-local wie die globalen, sind also – entgegen der Benennung als "stable" – höchst variabel!</p></li><li><p>mit "stable secret": Ein permanentes "stable secret" setzt man mit Root-Rechten<sup><a href="#source-2">[2]</a></sup> in einer Datei im Verzeichnis <strong>/etc/sysctl.d/</strong> </p><pre class="notranslate"># /etc/sysctl.d/60-ipv6-stable-secret.conf
net.ipv6.conf.default.stable_secret=fd00:1:2:3:4:5:6:7     # IPv6-Adresse beliebig wählbar, sollte vertraulich bleiben!</pre><p>    oder in der Datei <strong>/etc/network/interfaces</strong> per <code class="notranslate">sysctl</code>:     </p><pre class="notranslate"># /etc/network/interfaces
iface RFC4291 inet6 auto
  privext 0
iface RFC4941fix inet6 auto
  privext 1
iface RFC4941var inet6 auto
  privext 2
iface RFC7217var inet6 auto
  privext 0
  pre-up ip link set addrgenmode none dev $IFACE
iface RFC7217fix inet6 auto
  privext 0
  pre-up ip link set addrgenmode none dev $IFACE
  pre-up sysctl -w net.ipv6.conf.$IFACE.stable_secret=fd00:1:2:3:4:5:6:7</pre></li></ul></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>
</p><ul><li><p>Die Methode <code class="notranslate">auto</code> hat nichts mit dem Schlüsselwort <code class="notranslate">auto</code> zu tun!</p></li><li><p>Die Methode <code class="notranslate">manual</code> darf nicht als Gegensatz zum Schlüsselwort <code class="notranslate">auto</code> aufgefasst werden!</p></li></ul></div></div></div></div><div class="section_1"><h2 id="Anwendung-der-Konfigurationen">Anwendung der Konfigurationen<a class="headerlink" href="#Anwendung-der-Konfigurationen">¶</a></h2><p>
</p><ul><li><p>Mit einer Zeile in der Datei <strong>/etc/network/interfaces</strong> der folgenden Form wird die Schnittstelle beim Bootvorgang durch den Init-Prozess gestartet, vgl. Zeilen 3 und 18 der Beispieldatei.    </p><pre class="notranslate">auto SCHNITTSTELLEN-NAME</pre><p>    Für <code class="notranslate">SCHNITTSTELLEN-NAME</code> ist der richtige Name zu verwenden und man benötigt einen iface-Konfigurationsblock, dessen <code class="notranslate">KONFIGURATIONS-NAME</code> gleich lautet mit <code class="notranslate">SCHNITTSTELLEN-NAME</code>.</p></li><li><p>Soll eine Schnittstelle nicht beim Bootvorgang gestartet werden, so lässt man diese Zeile weg.</p></li><li><p>Jede noch nicht konfigurierte Schnittstelle (hier beispielhaft <code class="notranslate">enp7s9</code>) kann im laufenden Betrieb über einen Befehl nach folgendem Muster konfiguriert werden <sup><a href="#source-4">[4]</a></sup>:   </p><div class="bash"><div class="contents"><pre class="notranslate">#sudo ifup SCHNITTSTELLEN-NAME=KONFIGURATIONS-NAME
sudo ifup enp7s9=lan   # verwendet Zeilen 8-12 aus Beispieldatei 1 </pre></div></div><p> </p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Zu Beachten ist: Der Name der Schnittstelle <code class="notranslate">enp7s9</code> kommt in der Beispieldatei gar nicht vor! NetworkManager wird deshalb diese Schnittstelle als seine Aufgabe betrachten, sofern man es ihm nicht verbietet. Beachte <a class="crosslink" href="#NetworkManager-deaktivieren">NetworkManager deaktivieren</a>, sonst Fehlfunktion möglich!
</p></div></div></li><li><p>Wenn man eine Konfiguration mit dem Namen der Schnittstelle benannt hat, kann man den Start dieser Schnittstelle vereinfachten zu: </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup enp63s0     # Kurzform von ifup enp63s0=enp63s0 </pre></div></div></li><li><p>Zum Stoppen einer Schnittstelle verwendet man <strong>ifdown</strong>:  </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifdown enp63s0 </pre></div></div></li><li><p>Man kann im laufenden Betrieb die Konfiguration jeder Schnittstelle ändern, indem man sie zuerst mit <code class="notranslate">ifdown</code> stoppt und dann mit anderer Konfiguration mittels <code class="notranslate">ifup</code> wieder startet:   </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifdown enp63s0
sudo ifup enp63s0=lan </pre></div></div></li></ul><p>
<code class="notranslate">ifup</code> und <code class="notranslate">ifdown</code> kann man mit den zusätzlichen Optionen <code class="notranslate">--force</code> und <code class="notranslate">-v</code> aufrufen:
</p><ul><li><p><code class="notranslate">ifup --force SCHNITTSTELLEN-NAME</code> wird die Schnittstelle konfigurieren, obwohl diese bereits durch <strong>ifupdown</strong> konfiguriert wurde.</p></li><li><p><code class="notranslate">ifdown --force SCHNITTSTELLEN-NAME</code> wird die Schnittstelle dekonfigurieren, obwohl sie nach Meinung von <strong>ifupdown</strong> nicht konfiguriert ist.</p></li><li><p><code class="notranslate">ifup -v SCHNITTSTELLEN-NAME</code> bzw. <code class="notranslate">ifdown -v SCHNITTSTELLEN-NAME</code> (<code class="notranslate">-v</code> wie verbose) berichten ausführlich, was sie machen.</p></li></ul><p>
Die Befehle <code class="notranslate">ifup</code> und <code class="notranslate">ifdown</code> funktionieren nur bei Netzwerk-Schnittstellen mit Eintrag in <strong>/etc/network/interfaces</strong>. Bei Schnittstellen, die mit einem anderen Netzwerk-Konfigurationsprogramm verwaltet werden, sind sie unwirksam.</p><p>Die vorstehenden Ausführungen reichen bereits aus, um mit der Datei <strong>/etc/network/interfaces</strong> sinnvoll arbeiten zu können.</p><p>Die diesem Hinweis folgenden Informationen richten sich an fortgeschrittene und erfahrene Benutzer.</p></div><div class="section_1"><h2 id="Schluesselworte">Schlüsselworte<a class="headerlink" href="#Schluesselworte">¶</a></h2><p>
Im Folgenden werden Schlüsselworte und ihre Verwendung erklärt:</p><div class="section_2"><h3 id="iface">iface<a class="headerlink" href="#iface">¶</a></h3><p>
Mit dem Schlüsselwort <code class="notranslate">iface</code> leitet man einen Konfigurationsblock ein. Er kann ggf. zusätzliche Zeilen umfassen und endet vor einer Zeile mit einem der o.g. Schlüsselwörter. In den zusätzlichen Zeilen kann man Konstante mit symbolischem Namen und Wert vereinbaren sowie für jede Phase des Konfigurationsvorganges (<code class="notranslate">pre-up</code>, <code class="notranslate">post-up</code>, <code class="notranslate">pre-down</code>, <code class="notranslate">post-down</code>) ausführbare Kommandos hinterlegen. Man darf ausserdem <code class="notranslate">up</code> als Synonym für <code class="notranslate">post-up</code> und <code class="notranslate">down</code> als Synonym für <code class="notranslate">pre-down</code> verwenden. Die vereinbarten Konstanten und einige weitere Informationen werden als Shell-Variablen an die ausführbaren Kommandos und die Start/Stopp-Skripte übergeben; zur Erläuterung dient folgendes Beispiel:</p><pre class="notranslate">iface config1 inet dhcp
  const-1 Muster-ohne-Wert
  pre-up sysctl -w net.ipv6.conf.$IFACE.disable_ipv6=0
  up ip -6 addr replace 2001:db8::1/64 dev $IFACE || true
  up ip -4 addr replace 192.168.255.255/32 dev $IFACE || true
  up ip -4 addr replace 192.168.178.22/24 dev $IFACE || true
  down ip addr flush dev $IFACE</pre><p>Als ausführbare Programme sind prädestiniert: <code class="notranslate">sysctl</code> zur Änderung von Kernel-Variablen und <code class="notranslate">ip</code>, das allgemeine Dienstprogramm für Netzwerkaufgaben unter Linux. Im Grunde ist jede ausführbare Datei möglich, ausgenommen jedoch <code class="notranslate">ifup</code> und <code class="notranslate">ifdown</code>!</p><p>Das Beispiel zeigt die Zuweisung mehrerer – hier insgesamt vier – IP-Adressen; eine wird beim Start mit <code class="notranslate">ifup</code> per DHCP bezogen und 3 weitere werden statisch über die Kommandos in den mit <code class="notranslate">up</code> beginnenden Zeilen definiert. Die Kernel-Variable <code class="notranslate">disable_ipv6=0</code> ist erforderlich, weil sonst keine IPv6-Adresse zugewiesen werden kann. Beim Stopp mit <code class="notranslate">ifdown</code> werden wegen der mit <code class="notranslate">down</code> beginnenden Zeile alle IP-Adressen von der Schnittstelle entfernt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Form <code class="notranslate">up BEFEHL || true</code> ist ein oft angewendetes Idiom. Es verhindert den Fehlschlag des gesamten Konfigurationsvorgangs, wenn ein einzelner Befehl fehlschlägt.
</p></div></div><p>Bei der Aktivierung dieser Konfiguration, z.b. für eine Schnittstelle enp63s0 mittels</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup enp63s0=config1 </pre></div></div><p>werden von <strong>ifup</strong> zunächst die Konstanten als Shell-Variablen gesetzt:</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="3">Shell-Variablen für Start-/Stopp-Skripte </td></tr><tr class="kopf"><td>Konstante </td><td> Shell-Variable </td><td> Wert im Beispiel </td></tr><tr><td>KONFIGURATIONS-NAME </td><td> $LOGICAL </td><td> <code class="notranslate">config1</code> </td></tr><tr><td>PROTOKOLL </td><td> $ADDRFAM </td><td> <code class="notranslate">inet</code> </td></tr><tr><td>METHODE </td><td> $METHOD </td><td> <code class="notranslate">dhcp</code> </td></tr><tr><td>SCHNITTSTELLEN-NAME </td><td> $IFACE </td><td> <code class="notranslate">enp63s0</code> </td></tr><tr><td> Phase </td><td> $PHASE </td><td> <code class="notranslate">pre-up</code>, <code class="notranslate">post-up</code>, <code class="notranslate">pre-down</code>, <code class="notranslate">post-down</code> (in zeitlicher Folge) </td></tr><tr><td> const-1 </td><td> $IF_CONST_1 </td><td> <code class="notranslate">Muster-ohne-Wert</code> </td></tr><tr><td>EIGENE KONSTANTE </td><td colspan="2">Bildung des Namens der Shell-Variablen: Aus dem Namen der Konstanten werden alle nicht-ASCII-Buchstaben und alle Sonderzeichen außer Binde- und Unterstrich entfernt. Kleinbuchstaben werden zu Großbuchstaben. Der Bindestrich „-“ wird zum Unterstrich „_“. „$IF_“ wird voran gestellt. </td></tr></table><p>Es gibt noch einige weitere, hier nicht behandelte Konstanten.</p><p>Anschließend werden die ausführbaren Kommandos in folgender Reihenfolge durchlaufen:</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="3">Reihenfolge der Befehle beim Start (ifup) einer Schnittstelle </td></tr><tr class="kopf"><td>Phase </td><td> Aktion (bei Ubuntu 16.04) </td><td> Aktion (bei Ubuntu 14.04, sofern abweichend von 16.04) </td></tr><tr><td rowspan="2">pre-up </td><td> Kommandos aus der Datei <strong>interfaces</strong>, die mit <code class="notranslate">pre-up</code> beginnen </td></tr><tr><td> Skripte im Verzeichnis <strong>/etc/network/if-pre-up.d/</strong> </td></tr><tr><td rowspan="4">up </td><td> interne Aktionen von <code class="notranslate">ifup</code> gemäß <code class="notranslate">PROTOKOLL</code> und <code class="notranslate">METHODE</code>, insbesondere: </td></tr><tr><td> stets: <code class="notranslate">/bin/ip link set dev $IFACE up 2&gt;/dev/null || true</code> </td><td> <code class="notranslate">/bin/ip link set dev $IFACE up 2&gt;/dev/null        </code> </td></tr><tr><td> zusätzlich bei Methode <code class="notranslate">dhcp</code>: DHCP-Client starten </td></tr><tr><td> zusätzlich bei Methode <code class="notranslate">static</code>: Setzen von IP-Adresse und Leitwegen aus den Variablen $ADDRESS und $GATEWAY </td></tr><tr><td rowspan="2">post-up </td><td> Kommandos aus der Datei <strong>interfaces</strong>, die mit <code class="notranslate">post-up</code> oder nur mit <code class="notranslate">up</code> beginnen </td></tr><tr><td> Skripte im Verzeichnis <strong>/etc/network/if-up.d/</strong> </td></tr></table><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="3">Reihenfolge der Befehle beim Stopp (ifdown) einer Schnittstelle </td></tr><tr class="kopf"><td>Phase </td><td> Aktion (bei Ubuntu 16.04) </td><td> Aktion (bei Ubuntu 14.04, sofern abweichend von 16.04) </td></tr><tr><td rowspan="2">pre-down </td><td> Kommandos aus der Datei <strong>interfaces</strong>, die mit <code class="notranslate">pre-down</code> oder nur mit <code class="notranslate">down</code> beginnen </td></tr><tr><td> Skripte im Verzeichnis <strong>/etc/network/if-down.d/</strong> </td></tr><tr><td rowspan="2">down </td><td> interne Aktionen von <code class="notranslate">ifdown</code> gemäß <code class="notranslate">PROTOKOLL</code> und <code class="notranslate">METHODE</code>, insbesondere: </td></tr><tr><td> <code class="notranslate">/bin/ip link set dev $IFACE down 2&gt;/dev/null || true</code> </td><td> <code class="notranslate">/bin/ip link set dev $IFACE down 2&gt;/dev/null        </code> </td></tr><tr><td rowspan="2">post-down </td><td> Kommandos aus der Datei <strong>interfaces</strong>, die mit <code class="notranslate">post-down</code> beginnen </td></tr><tr><td> Skripte im Verzeichnis <strong>/etc/network/if-post-down.d/</strong> </td></tr></table><p>Beispiele zur Anwendung selbst definierter Konstanten finden sich im Abschnitt <a class="crosslink" href="#mapping">Schlüsselwort mapping</a> und im Abschnitt <a class="crosslink" href="#Start-Stopp-Skripte">Start/Stopp-Skripte</a>.</p></div><div class="section_2"><h3 id="allow-GRUPPENNAME">allow-GRUPPENNAME<a class="headerlink" href="#allow-GRUPPENNAME">¶</a></h3><p>
Schnittstellen können mit Hilfe des Schlüsselwortes <code class="notranslate">allow-</code> zu Gruppen zusammengefasst werden. Im folgenden Beispiel werden die beiden Gruppen <code class="notranslate">auto</code> und <code class="notranslate">hotplug</code> definiert:</p><pre class="notranslate">auto lo
allow-auto eth0 enp63s0
auto wlp3s0
allow-hotplug wlp3s0 wlan1</pre><p>Zur Gruppe <code class="notranslate">auto</code> gehören als Mitglieder die Schnittstellen lo, eth0, enp63s3 und wlp3s0; zur Gruppe <code class="notranslate">hotplug</code> gehören die Schnittstellen wlp3s0 und wlan1. Beim Gruppennamen <code class="notranslate">auto</code> gilt die Besonderheit, dass <code class="notranslate">allow-auto</code> und <code class="notranslate">auto</code> Synonyme sind.</p><p>Der Gruppenname ist aus Sicht von ifupdown beliebig und haben für ifupdown selbst keinerlei Bedeutung, abgesehen dass man Konfigurationen für alle Gruppenmitglieder mit einem Befehl auslösen kann:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup -a --allow=hotplug </pre></div></div><p>Voraussetzung hierfür ist, dass <code class="notranslate">ifup</code> für jede Schnittstelle aus der Gruppe eine Konfiguration ermitteln kann. Dies erreicht man entweder, indem man als Konfigurationsname den Namen der Schnittstelle wählt oder über einen im nächsten Abschnitt beschriebenen mapping-Block.</p><p>Dennoch sind insbesondere die Gruppennamen <code class="notranslate">auto</code> und <code class="notranslate">hotplug</code> wichtige Elemente in der Datei <strong>/etc/network/interfaces</strong>, da
</p><ul><li><p>der Init-Prozess beim Rechnerstart (<strong>systemd</strong> bei Ubuntu 16.04 bzw. <strong>upstart</strong> bei Ubuntu 14.04) <code class="notranslate">ifup -a --allow=auto</code> ausführt und</p></li><li><p>das für Hotplug zuständige Subsystem (<strong>udev</strong> mit <strong>systemd</strong>) die Schnittstellen aus der Gruppe <code class="notranslate">hotplug</code> betreut und diese automatisch durch Aufruf von <code class="notranslate">ifup</code> konfiguriert.</p></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Bezeichnung <code class="notranslate">allow</code> nimmt Bezug auf folgende Semantik:
</p><ul><li><p><code class="notranslate">ifup -a --allow=hotplug</code> bedeutet: „Ich erlaube (<code class="notranslate">allow</code>) die Bearbeitung aller (<code class="notranslate">-a</code>) Schnittstellen, sofern diese zur Gruppe <code class="notranslate">hotplug</code> gehören.“</p></li><li><p><code class="notranslate">ifup enp63s0 --allow=hardware</code> bedeutet: „Ich erlaube die Bearbeitung der Schnittstelle <code class="notranslate">enp63s0</code>, sofern diese zur Gruppe <code class="notranslate">hardware</code> gehört.“</p></li></ul></div></div><p>Zu beachten ist die inkonsistente Schreibweise!
</p><ul><li><p>In der Datei <strong>/etc/network/interfaces</strong> wird <code class="notranslate">allow-</code> mit einem Bindestrich geschrieben.</p></li><li><p>Im Terminal benutzt man beim Aufruf mit <code class="notranslate">ifup</code> traditionell ein Gleichheitszeichen: <code class="notranslate">ifup -a --allow=auto</code>. (Das Gleichheitszeichen darf man durch ein Leerzeichen ersetzen.)</p></li></ul><p>
</p></div><div class="section_2"><h3 id="mapping">mapping<a class="headerlink" href="#mapping">¶</a></h3><p>
Die beim Start einer Schnittstelle zu verwendende Konfiguration wird entweder explizit angegeben (<code class="notranslate">ifup SCHNITTSTELLEN-NAME=KONFIGURATIONS-NAME</code>) oder sie wird von ifupdown automatisch berechnet. Diese Berechnung ist durch einen mapping-Block in der Datei <strong>interfaces</strong> beeinflussbar. Falls man dort keinen mapping-Block definiert, so verwendet ifupdown effektiv als Vorgabe:</p><pre class="notranslate"># Vorgabe-Mapping von ifup:
mapping *
  script echo

# Allgemeine Struktur eines mapping-Blocks:
# mapping SUCHMUSTER
#  script PROGRAMM
#  map DATEN
#  map …</pre><p>Als Suchmuster kann man alles verwenden, was die Shell als solches versteht (<a class="interwiki interwiki-wikipedia_en" href="https://en.wikipedia.org/wiki/Glob_(programming)">Shell Glob</a>).<code class="notranslate">SUCHMUSTER</code> wird mit <code class="notranslate">SCHNITTSTELLEN-NAME</code> verglichen; nur falls es passt, wird der mapping-Block auf diese Schnittstelle angewendet, indem das nach <code class="notranslate">script</code> angegebene Programm mit <code class="notranslate">SCHNITTSTELLEN-NAME</code> als einzigem Argument aufgerufen wird. Das Programm muss auf seine Standard-Ausgabe den für diese Schnittstelle zuständigen <code class="notranslate">KONFIGURATIONS-NAME</code> drucken und darf dort sonst nichts ausgeben.</p><p>Beim Vorgabe-Mapping passt natürlich <code class="notranslate">*</code> auf jede Schnittstelle und <code class="notranslate">echo</code> als Programm sorgt dann dafür, dass aus dem Aufruf <code class="notranslate">ifup SCHNITTSTELLEN-NAME</code> effektiv <code class="notranslate">ifup SCHNITTSTELLEN-NAME=SCHNITTSTELLEN-NAME</code> wird.</p><p>Der mapping-Block kann noch um beliebig viele mit <code class="notranslate">map</code> beginnende Zeilen ergänzt werden. Das für das Mapping zuständige Programm bzw. Skript kann die Angaben nach dem Wort <code class="notranslate">map</code> von seiner Standard-Eingabe lesen und in seiner Entscheidung berücksichtigen.</p><p>Hier folgt ein etwas anspruchsvolleres Beispiel, welches viele kabelgebundene Schnittstellen mit derselben Konfiguration versorgt:</p><pre class="notranslate">mapping en*
  script /root/Skripte/conf-mapper
  map uplink enp63s0
  map bridge-port

iface uplink inet dhcp

iface bridge-port inet manual
  master switch
  pre-up    ip link add name $IF_MASTER type bridge    || true
  pre-up    ip link set  dev $IF_MASTER up             || true
  pre-up    ip link set  dev $IFACE   master $IF_MASTER
  post-down ip link set  dev $IFACE nomaster</pre><p>Im Beispiel wird von den vielen physischen Schnittstellen eine (<code class="notranslate">enp63s0</code>) vom Router per DHCP konfiguriert, alle anderen werden zu Ports einer Bridge. Auch die Bridge als Schnittstelle wird mit dem Namen <code class="notranslate">switch</code> durch diese Datei automatisch erzeugt. Die Magie steckt im Skript <strong>conf-mapper</strong>:</p><pre class="notranslate">#!/bin/sh -e
# /root/Skripte/conf-mapper
: ${1:?}
while read conf pattern _   # erwarte Zeilen '&lt;conf-name&gt; &lt;if-name-pattern&gt;'
  do case $1 in ( ${pattern:-*} ) break; esac; done
echo ${conf:-$1}</pre><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Man kann hinter <code class="notranslate">script</code> nur einen Programm-Namen (ggf. inklusive Pfad), aber keine Verkettung von Programmen und auch kein Programm mit irgendeiner Option oder einem Parameter angeben – man muss die Logik der Konfigurationsfindung leider in ein separates Skript packen!
</p></div></div></div><div class="section_2"><h3 id="source-und-source-directory">source und source-directory<a class="headerlink" href="#source-und-source-directory">¶</a></h3><p>
Mit Hilfe der Schlüsselworte <code class="notranslate">source</code> bzw. <code class="notranslate">source-directory</code> kann eine andere Text-Datei in die Datei <strong>interfaces</strong> eingebunden werden bzw. es können alle Dateien aus einem Verzeichnis eingebunden werden. Durch die Aufteilung ergeben sich aber keine neuen Konfigurationsmöglichkeiten. NetworkManager ist auf eine derartige Aufteilung der Datei <strong>/etc/network/interfaces</strong> nicht vorbereitet; daher wird von einer Nutzung dieser Möglichkeiten abgeraten.</p></div><div class="section_2"><h3 id="no-auto-down">no-auto-down<a class="headerlink" href="#no-auto-down">¶</a></h3><p>
Eine Schnittstelle mit dieser Kennzeichnung wird beim Herunterfahren des Rechners von der Wirkung des dann ausgeführten Befehls <code class="notranslate">ifdown -a --allow=auto</code> ausgenommen. Dies kann bei Netzwerk-Laufwerken wichtig sein.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Ubuntu 14.04 kennt <code class="notranslate">no-auto-down</code> und <code class="notranslate">no-scripts</code> noch nicht.
</p></div></div></div><div class="section_2"><h3 id="no-scripts">no-scripts<a class="headerlink" href="#no-scripts">¶</a></h3><p>
Mit <code class="notranslate">no-scripts</code> beginnende Zeilen listen die Schnittstellen auf, für die die Start/Stopp-Skripte in den Verzeichnissen <strong>/etc/network/ip-*.d/</strong> nicht ausgeführt werden sollen.</p></div></div><div class="section_1"><h2 id="Anwendungsbeispiele">Anwendungsbeispiele<a class="headerlink" href="#Anwendungsbeispiele">¶</a></h2><p>
In diesem Abschnitt werden mehrere Punkte, die in der Praxis relevant sein können, zusammengefasst.</p><div class="section_2"><h3 id="Roaming">Roaming<a class="headerlink" href="#Roaming">¶</a></h3><p>
Dies betrifft Rechner, die sich mit ein- und derselben Netzwerk-Schnittstelle (hier beispielhaft <code class="notranslate">eth0</code>) wechselweise mit unterschiedlichen Netzwerken verbinden sollen. Für jedes Netzwerk kann man eine eigene Konfiguration in der Datei <strong>/etc/network/interfaces</strong> hinterlegen.</p><pre class="notranslate">### "auto  eth0" darf nicht aktiviert sein!
### "iface eth0" darf nicht aktiviert sein!
iface home inet dhcp
iface work inet static
    address 10.51.20.42/20</pre><p>Hierbei wird die Netzwerkschnittstelle <code class="notranslate">eth0</code> beim Systemstart unkonfiguriert belassen (Keine Zeile <code class="notranslate">auto eth0</code>, keine Zeile <code class="notranslate">iface eth0</code>!).
</p><ul><li><p>Manuelles Roaming: Nun kann mit dem Befehl <sup><a href="#source-4">[4]</a></sup> </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup eth0=work </pre></div></div><p> die statische Konfiguration, für das Netzwerk am Arbeitsplatz, gestartet werden. Alternativ dazu ist es auch möglich, mit </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup eth0=home </pre></div></div><p> die dynamische Konfiguration (z.B. für das Netzwerk zu Hause) zu starten.</p></li><li><p>Ein Wechsel zwischen den Konfigurationen, sofern gleichzeitig mehrere Netze grundsätzlich verfügbar sind, erfolgt nach dem Muster: (Hier beispielhaft: work --&gt; home)     </p><div class="bash"><div class="contents"><pre class="notranslate">#sudo ifdown SCHNITTSTELLEN-NAME
sudo ifdown eth0
#sudo ifup SCHNITTSTELLEN-NAME=NEUER_KONFIGURATIONS-NAME
sudo ifup eth0=home </pre></div></div></li><li><p>Automatisches Roaming ermöglicht z.B. ein <a class="crosslink" href="#mapping">mapping-Block</a>.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Mehrere-IP-Adressen">Mehrere IP-Adressen<a class="headerlink" href="#Mehrere-IP-Adressen">¶</a></h3><p>
Möglichkeiten, einer Schnittstelle gleichzeitig mehr als eine IP-Adresse zuzuweisen:</p><ul><li><p>Adressen durch Aufruf des Programmes <code class="notranslate">ip</code> in mehreren mit <code class="notranslate">up</code> beginnenden Optionszeilen konfigurieren, siehe Beispiel beim <a class="crosslink" href="#iface">Schlüsselwort iface</a>.</p></li><li><p>Mehrere iface-Zeilen mit demselben Konfigurations-Namen in Kombination mit mehreren Optionen <code class="notranslate">address</code> verwenden, zum Beispiel: </p><pre class="notranslate">   iface multi-addr inet static
     address 192.0.2.44/24
   iface multi-addr inet6 static
     address 2001:db8:dead:beef::197/64
   iface multi-addr inet static
     address 192.168.255.254/30   </pre></li><li><p>Zur physischen Schnittstelle (hier beispielhaft <code class="notranslate">eth0</code>) sogenannte virtuelle Schnittstellen definieren: Dieses Verfahren ist veraltet, bietet aber den Vorteil gegenüber den vorgenannten Verfahren, dass man hier für jede Adresse einen eigenen symbolischen Namen erhält. Die virtuellen Schnittstellen müssen mit einem Doppelpunkt und Folgenummer (hier beispielhaft <code class="notranslate">eth0:1</code>) notiert werden: </p><pre class="notranslate">   iface eth0 inet static
     address 192.0.2.254/24
   iface eth0:1 inet static 
     address 198.51.100.1/24
   auto eth0 eth0:1   </pre><p>    Eine solche Konfiguration könnte man für einen Server verwenden, der gleichzeitig auf mehreren IP-Adressen unterschiedliche Dienste bereitstellt, z.B.  auf <code class="notranslate">192.0.2.254</code> einen Webserver und auf <code class="notranslate">198.51.100.1</code> einen E-Mail-Server. <code class="notranslate">iptables</code> ist in der Lage, die Schnittstellen über die Namen voneinander zu unterscheiden und ermöglicht damit dienst-spezifische Filtersätze.     Für die physische Schnittstelle <code class="notranslate">eth0</code> wäre auch eine dynamische Konfiguration per DHCP denkbar. Die virtuellen Schnittstellen können nur statische Konfigurationen erhalten und keine andere Rahmenlänge als die physikalische Schnittstelle haben.</p></li><li><p>Eine weitere Möglichkeit zur Konfiguration mehrerer IP-Adressen bietet das im Abschnitt <a class="crosslink" href="#Start/Stopp-Skripte">Start/Stopp-Skripte</a> erläuterte Beispiel.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Buendeln-von-Netzwerkschnittstellen">Bündeln von Netzwerkschnittstellen<a class="headerlink" href="#Buendeln-von-Netzwerkschnittstellen">¶</a></h3><p>
Zur Erhöhung der Bandbreite kann man mehrere physische Schnittstellen bündeln und dies auch über die Datei <strong>/etc/network/interfaces</strong> konfigurieren, siehe hierzu: <a class="internal" href="./netzwerkkarten_bündeln.html">Netzwerkkarten bündeln</a></p></div><div class="section_2"><h3 id="Netzwerkbruecke">Netzwerkbrücke<a class="headerlink" href="#Netzwerkbruecke">¶</a></h3><p>
Siehe <a class="internal" href="./netzwerkbrücke.html">Netzwerkbrücke</a> zum Verbinden mehrerer Netzwerke oder auch das <a class="crosslink" href="#mapping">Beispiel beim Schlüsselwort mapping</a>.</p></div><div class="section_2"><h3 id="WLAN-Konfiguration">WLAN-Konfiguration<a class="headerlink" href="#WLAN-Konfiguration">¶</a></h3><p>
Die Einrichtung von Funknetzwerken erfolgt unter Linux heutzutage (Stand: Ubuntu 16.04) fast ausschließlich über <a class="internal" href="./wlan/wpa_supplicant.html">wpa_supplicant</a>. Dieses Programm wird auch vom NetworkManager (Version 1.2.2, Ubuntu 16.04) und von Wicd verwendet. Es kann auch direkt über die Datei <strong>/etc/network/interfaces</strong> aufgerufen werden.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Neben <code class="notranslate">wpa_supplicant</code> gibt es auch noch <a class="internal" href="./wireless-tools.html">wireless-tools</a>, die jedoch in Bezug auf Verschlüsselung nicht mehr dem Stand der Technik entsprechen, weil nur das leicht durchbrechbare Verfahren WEP unterstützt wird. Wegen Sicherheitsbedenken wird von <code class="notranslate">wireless-tools</code> abgeraten und diese werden hier nicht weiter behandelt.
</p></div></div><p><code class="notranslate">wpa_supplicant</code> arbeitet mit dem Treiber der WLAN-Interface-Hardware zusammen und kümmert sich selber nur um die Bereitstellung des Netzwerkmediums (layer 2), nicht um die IP-Konfiguration (layer 3). Die IP-Konfiguration erfolgt über Angaben in der Datei <strong>/etc/network/interfaces</strong>; dabei muss der Name der Konfiguration mit dem Namen der Schnittstelle übereinstimmen:</p><ul><li><p>Grundschema einer <strong>interfaces</strong> für ein einziges WLAN (managed-mode von <code class="notranslate">wpa_supplicant</code>): </p><pre class="notranslate">iface wlan0 inet dhcp
  wpa-conf /root/wpa_supplicant.conf
auto wlan0</pre><p>   Man gibt einfach über die Konstante <code class="notranslate">wpa-conf</code> dem Skript von <code class="notranslate">wpa_supplicant</code> den (grundsätzlich beliebigen, sofern beim Rechnerstart erreichbaren) Speicherort einer Konfigurationsdatei für ein einzelnes WLAN an. Diese Konfigurationsdatei muss man natürlich gemäß dem <a class="internal" href="./wlan/wpa_supplicant.html">Wiki-Artikel für wpa_supplicant</a> mit Inhalt füllen.</p></li><li><p>mehrere WLAN (roaming-mode von <code class="notranslate">wpa_supplicant</code>)     </p><pre class="notranslate">iface wlan1 inet manual
  wpa-roam /root/wpa_supplicant_multi.conf
auto wlan1
iface default inet6 auto
iface default inet  dhcp</pre><p>   Die Konfigurationsdatei <strong>wpa_supplicant_multi.conf</strong> enthält die Daten (SSID, Passwort, etc.) für mehrere Netzwerke. Die Netzwerke kann man in dieser Datei mit einem eigenen ID-String (id_str) kennzeichnen; <code class="notranslate">wpa_supplicant</code> startet dann  <code class="notranslate">/sbin/ip -v --force $IFACE=ID-STR-WERT</code>. Andernfalls verwendet <code class="notranslate">wpa_supplicant</code> den Wert <code class="notranslate">default</code> als <code class="notranslate">id_str</code> und startet <code class="notranslate">/sbin/ip -v --force $IFACE=default</code>. Die iface-Konfigurationen mit dem jeweiligen, dem <code class="notranslate">id_str</code> entsprechendem Namen müssen in der Datei <strong>interfaces</strong> existieren. Der <a class="internal" href="./wlan/wpa_supplicant.html">Wiki-Artikel für wpa_supplicant</a> enthält weitere Angaben. Die Konstante <code class="notranslate">wpa-roam</code> funktioniert nur in einer iface-Konfiguration mit der Methode <code class="notranslate">manual</code>.           </p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das Beispiel wlan1 kann man noch durch die graphische Oberfläche <a class="internal" href="./wlan/wpa_gui.html">wpa_gui</a> aufwerten.
</p></div></div></li><li><p>Bei der Verwendung von <code class="notranslate">wpa_supplicant</code> ist es ebenfalls möglich, die gesamte Konfiguration in der <strong>/etc/network/interfaces</strong> zu hinterlegen. Hierzu werden die Optionen, die üblicherweise in die <strong>wpa_supplicant.conf</strong> eingetragen werden, mit einem vorangestelltem <code class="notranslate">wpa-</code> eingetragen.  </p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Von dieser Vorgehensweise wird abgeraten, weil dann die WLAN-Passworte für jeden lesbar in der (traditionell world-readable!) Datei <strong>/etc/network/interfaces</strong> stehen.
</p></div></div><p> </p></li></ul><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Zur Nutzung von <code class="notranslate">wpa_supplicant</code> muss manchmal noch ein „Treiber“ (driver) gewählt werden. Hiermit ist nicht das Kernel-Modul für die Hardware der WLAN-Schnittstelle gemeint, sondern die „Sprache“, die <code class="notranslate">wpa_supplicant</code> zur Kommunikation mit diesem Hardware-Treiber und dem Kernel verwendet. Unter Ubuntu 16.04 kennt <code class="notranslate">wpa_supplicant</code> die in folgender Tabelle genannten Treiber.</p><p>Wird kein Treiber angegeben, wird das Start/Stopp-Skript von <code class="notranslate">wpa_supplicant</code> automatisch den NETLINK-Treiber <code class="notranslate">nl80211</code> und den generischen Treiber <code class="notranslate">wext</code> (in dieser Reihenfolge) aussuchen. Das funktioniert bei vielen Karten sehr gut (und ist auch empfohlen).</p><p>Wenn es mit dieser Standardeinstellung nicht funktioniert, kann man einen in der Tabelle genannten Treiber mittels der Konstante <code class="notranslate">wpa-driver</code> explizit angeben oder <code class="notranslate">wpa_supplicant</code> selbst aus den Quellen übersetzen:
</p><pre class="notranslate">iface wlan4 inet dhcp
        wpa-driver wext
        wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</pre><p>
</p></div></div><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2">Software-Schnittstellen (driver) von wpa_supplicant in Ubuntu 16.04 </td></tr><tr class="kopf"><td style="text-align: center">Treiber </td><td> Beschreibung </td></tr><tr><td> nl80211 </td><td> Linux nl80211/cfg80211 </td></tr><tr><td> wext </td><td> Linux wireless extensions (generic) </td></tr><tr><td> wired </td><td> wired Ethernet driver </td></tr><tr><td> none </td><td> no driver (RADIUS server/WPS ER) </td></tr><tr><td> (weitere) </td><td> erfordert Kompilierung von wpa_supplicant aus den Quellen </td></tr></table></div><div class="section_2"><h3 id="VPN">VPN<a class="headerlink" href="#VPN">¶</a></h3><p>
Es gibt sehr viele Verfahren für VPN. Gemeinsam ist allen der Aufbau einer <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Tunnel_(Rechnernetz)">getunnelten Verbindung</a> über eine gesonderte Netzwerk-Schnittstelle und eine Änderung der Default-Route. Meistens will man den getunnelten Verkehr auch verschlüsseln.</p><p>Wegen der Vielfalt der Verfahren ist hier nur ein allgemeiner Überblick zur Konfiguration über <strong>interfaces</strong> möglich.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bei der Konfiguration eines VPN über die Datei <strong>/etc/network/interfaces</strong> darf NetworkManager auf keinen Fall parallel mitlaufen!</p><p>NetworkManager überwacht die Default-Route des Systems und wird jede fremde Änderung korrigieren; aus diesem Grund wird eine VPN-Einrichtung über <strong>interfaces</strong> bei aktivem NetworkManager höchstens fehlerhaft funktionieren.
</p></div></div><p>Grundschema:</p><pre class="notranslate">iface VPN inet manual
# pre-up     ip link add dev CHNITTSTELLEN-NAME type SCHNITTSTELLEN-TYP
  up         &lt;Befehl zum Aufbau des VPN&gt;
  down       &lt;Befehl zum Abbau des VPN&gt;
# post-down  ip link del dev SCHNITTSTELLEN-NAME</pre><p>Die Befehle zum Auf- und Abbau des VPN sind spezifisch für die ausgewählte VPN-Technik und enthalten auch die benötigten Optionen und Angaben zu Konfigurationsdateien. Meistens übernehmen diese Befehle auch die Aufgabe der vorherigen Erzeugung und nachträglichen Vernichtung der Tunnel-Schnittstelle, so dass die <code class="notranslate">pre-up</code>- und <code class="notranslate">post-down</code>-Zeilen entfallen.</p><p>Für das bei deutschen Hochschulen oft verwendete Verfahren Cisco-IPsec sieht das konkret z.B. so aus:</p><pre class="notranslate">iface UNI inet manual
  up    vpnc-connect    VPN-UNI
  down  vpnc-disconnect</pre><p>Die Programme <strong>vpnc-connect</strong> und <strong>vpnc-disconnect</strong> gehören zum Paket <strong>vpnc</strong>, welches zusätzlich zum Standard installiert<sup><a href="#source-3">[3]</a></sup> werden muss. Seine Konfiguration liest <code class="notranslate">vpnc</code> aus der Datei <strong>/etc/vpnc/VPN-UNI.conf</strong>, welche man gemäß dem <a class="internal" href="./vpnc.html">Wiki-Artikel zu vpnc</a> mit Inhalt füllen muss.</p><p>Bei einer bereits bestehenden IP-Verbindung, beispielsweise über <code class="notranslate">wlan0</code>, verbindet man sich mit dem VPN der Uni über den Befehl<sup><a href="#source-4">[4]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifup UNI                 # bei Ubuntu 16.04
sudo ifup --force wlan0=UNI   # bei Ubuntu 14.04 </pre></div></div><p>Die verschiedenen Versionen von Ubuntu verhalten sich hier ziemlich unterschiedlich:
</p><ul><li><p>Bei 16.04 kann man das VPN als zusätzliche Verbindung auf- und dann auch wieder mittels <code class="notranslate">sudo ifdown UNI</code> sanft abbauen und zur Verbindung über wlan0 zurückkehren.</p></li><li><p>Bei 14.04 muss man die bestehende Verbindung über wlan0 brutal überschreiben. Beim Abbau der Verbindung über <code class="notranslate">sudo ifdown wlan0</code> verliert man die Verbindung zum Netzwerk.</p></li></ul><p>
VPN-Roaming wird im Beispiel zu <code class="notranslate">inherits</code> im Abschnitt Start/Stopp-Skripte behandelt.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bei der Nutzung eines VPN: Vergiss IPv6 nicht! 
</p></div></div></div></div><div class="section_1"><h2 id="Start-Stopp-Skripte">Start/Stopp-Skripte<a class="headerlink" href="#Start-Stopp-Skripte">¶</a></h2><p>
Es gibt mehrere Methoden, über die Datei <strong>interfaces</strong> Skripte oder Shell-Befehle auszuführen. Dieser Abschnitt stellt die Methoden durch Beispiele vor. Für das Verständnis werden die Abschnitte <a class="crosslink" href="#iface">Schlüsselwort iface</a> und <a class="crosslink" href="#mapping">Schlüsselwort mapping</a> benötigt.</p><div class="section_2"><h3 id="Befehle-in-interfaces">Befehle in interfaces<a class="headerlink" href="#Befehle-in-interfaces">¶</a></h3><p>
</p><ul><li><p>Mit dem Beispiel   </p><pre class="notranslate">iface wan inet static
  address 203.0.113.99/32
  up   systemctl restart apache2
  down systemctl    stop apache2</pre><p>   wird der Webserver <code class="notranslate">apache2</code> neu gestartet, sobald eine Netzwerkschnittstelle mit der Konfiguration <code class="notranslate">wan</code> gestartet wurde. Im Falle von Ubuntu 14.04 muss man anstelle des systemd-Dienstprogrammes <code class="notranslate">systemctl</code> das Dienstprogramm von upstart <code class="notranslate">initctl</code> verwenden.</p></li><li><p>Weitere Beispiele siehe beim <a class="crosslink" href="#iface">Schlüsselwort iface</a> und <a class="crosslink" href="#mapping">Schlüsselwort mapping</a>.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Skripte-in-etc-network-if-d">Skripte in /etc/network/if-*.d/<a class="headerlink" href="#Skripte-in-etc-network-if-d">¶</a></h3><p>
Dies sind Start/Stopp-Skripte im engeren Sinne. Etliche Programme hinterlegen ihre Skripte in den Verzeichnissen <strong>/etc/network/if-*.d/</strong> und man kann dort auch eigene Skripte ablegen. Diese Skripte werden von der System-Shell, bei Ubuntu <code class="notranslate">dash</code> (nicht: <code class="notranslate">bash</code>!), ausgeführt.</p><p>Hier folgt beispielhaft ein Skript zur Zuweisung mehrerer Adressen zu einer Netzwerkschnittstelle, welches aus der <strong>interfaces</strong> aufgerufen wird durch:</p><pre class="notranslate">iface config inet manual
  addresses 2001:db8::1/64  192.168.255.255/32  192.168.178.22/24</pre><p>Das folgende Skript muss in alle vier Verzeichnisse <strong>/etc/network/if-*.d/</strong> kopiert werden oder besser durch Symlinks verfügbar sein; es wertet die Konstante <code class="notranslate">addresses</code> aus <strong>interfaces</strong> als Shell-Variable <code class="notranslate">$IF_ADDRESSES</code> aus:</p><pre class="notranslate">#!/bin/sh -e
# assign addresses from line 'addresses …' in iface-stanza to interface
test -n "$IF_ADDRESSES" || exit 0
case "$PHASE"
in ( pre-up  )	# enable IPv6 iff IPv6-address given
		echo "$IF_ADDRESSES" | grep -q -e':' \
		  &amp;&amp; sysctl -w net.ipv6.conf.$IFACE.disable_ipv6=0
;; (post-up  )	for addr in $IF_ADDRESSES
		  do ip addr replace "$addr" dev "$IFACE" || true ; done
;; ( pre-down)	ip addr flush dev "$IFACE"
;; (post-down)	# reset disable_ipv6 to default
		X=$( sysctl -n net.ipv6.conf.default.disable_ipv6 )
		sysctl -w net.ipv6.conf.$IFACE.disable_ipv6=$X
esac</pre><p>Dieses Skript verzichtet bewusst auf einige sinnvolle Blockierungen unsinniger Eingaben, damit das Prinzip dieser Skripte deutlich wird.</p></div><div class="section_2"><h3 id="inherits-Konfigurationen-vererben">inherits – Konfigurationen vererben<a class="headerlink" href="#inherits-Konfigurationen-vererben">¶</a></h3><p>
Ab Ubuntu 16.04 kennt ifupdown das Spezialwort <code class="notranslate">inherits</code>, mit dessen Hilfe man aus einem iface-Konfigurationsblock auf einen anderen, bereits definierten iface-Konfigurationsblock verweisen und dessen Konstanten und Optionen einbinden kann.</p><p>Damit ist beispielsweise leicht eine Umschaltung zwischen mehreren VPN-Konfigurationen von <code class="notranslate">vpnc</code> möglich:</p><pre class="notranslate">iface VPNC inet manual
  up    vpnc-connect    --ifname $LOGICAL $IF_VPN_CONF
  down  vpnc-disconnect
iface UNI inherits VPNC
  VPN-conf  UNI
iface work inherits VPNC
  VPN-conf  Arbeit
iface R2D2 inherits VPNC
  VPN-conf  Kino</pre><p>Nach diesem Schema macht man beliebig viele VPN-Konfigurationen in der <strong>interfaces</strong> verfügbar und spart sich das Kopieren der gemeinsamen Aktivierungs-/Deaktivierungsbefehle in jede Konfiguration. Die Aktivierung des einzelnen VPN erfolgt wie gewohnt über „<code class="notranslate">sudo ifup UNI</code>“ usw.</p><p>Luxus, aber manchmal hilfreich ist hier die Benennung der Tunnel-Schnittstelle nach dem VPN über den optionalen Zusatz <code class="notranslate">--ifname $LOGICAL</code>.</p><p>Das hier gezeigte Muster kann man auch auf das WLAN-Roaming übertragen.</p></div></div><div class="section_1"><h2 id="Aktivierung">Aktivierung<a class="headerlink" href="#Aktivierung">¶</a></h2><p>
</p><ul><li><p>Damit die neuen Einstellungen sofort wirksam werden, wird oft empfohlen, den Job <code class="notranslate">networking</code> mit einem <strong>SysV-Init</strong>-Befehl neu zu starten <sup><a href="#source-4">[4]</a></sup>:   </p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/networking restart    # Nicht verwenden! Veraltet, gefährlich und unnötig </pre></div></div><p>   Diese Methode ist veraltet, gefährlich und unnötig. Bei über Netzwerk eingebundenen Dateisystemen besteht die Gefahr von Datenverlusten. Dies betrifft sowohl den Rechner, dessen Datei <strong>interfaces</strong> man ändern möchte als auch jeden Rechner, der mit diesem verbunden ist!</p></li><li><p>Auch die Dienstprogramme von <strong>upstart</strong> bzw. <strong>systemd</strong> sollte man nicht verwenden.</p></li><li><p>Stattdessen sollte man für jede einzelne Schnittstelle, deren Konfiguration man verändern will, vor der Bearbeitung der Datei <strong>interfaces</strong></p><ul><li><p>alle Netzwerkverbindungen beenden und danach</p></li><li><p>die Schnittstelle stoppen und</p></li><li><p>nach der Bearbeitung wieder starten:   </p><div class="bash"><div class="contents"><pre class="notranslate"># sudo umount NETZWERK-DATEISYSTEM   # für jedes eingebundene Netzwerk-Dateisystem
sudo ifdown eth0
# (jetzt Konfiguration für eth0 in der interfaces bearbeiten.)
sudo ifup eth0 </pre></div></div></li></ul></li><li><p>Wenn man nach sorgfältigem Nachdenken wirklich alle Schnittstellen in der Gruppe <code class="notranslate">auto</code> neu starten möchte, sollte man dabei jedenfalls die Schnittstelle lo nicht stoppen:   </p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifdown -a --exclude=lo
sudo ifup -a </pre></div></div></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Der Jobname <code class="notranslate">networking</code> bezieht sich bei SysV, Upstart und systemd nur auf das ifupdown-System. NetworkManager und andere Netzwerk-Konfigurationsprogramme werden durch einen Neustart von <code class="notranslate">networking</code> entgegen seines mehr versprechenden Namens <span class="underline">nicht</span> neu gestartet.
</p></div></div></div><div class="section_1"><h2 id="Zusaetzliche-Aspekte">Zusätzliche Aspekte<a class="headerlink" href="#Zusaetzliche-Aspekte">¶</a></h2><p>
Die folgenden Abschnitte enthalten Zusatzinformationen und Grundlagenwissen. Sie können für die Bearbeitung der Datei <strong>/etc/network/interfaces</strong> hilfreich sein.</p><div class="section_2"><h3 id="Eigenschaften-der-beiden-Methoden">Eigenschaften der beiden Methoden<a class="headerlink" href="#Eigenschaften-der-beiden-Methoden">¶</a></h3><p>
Die beiden bei Ubuntu verwendeten Methoden zur Netzwerk-Konfiguration haben sehr unterschiedliche Eigenschaften und ergänzen sich daher:</p><p>ifupdown …
</p><ul><li><p>ist die klassische Methode von Debian und dessen Derivaten, somit auch Ubuntu,</p></li><li><p>besteht aus den Komponenten</p><ul><li><p>dem Programm <code class="notranslate">ifup</code> (welches auch als <code class="notranslate">ifdown</code> bzw <code class="notranslate">ifquery</code> aufgerufen werden kann),</p></li><li><p>dessen Konfigurationsdatei <strong>/etc/network/interfaces</strong>,</p></li><li><p>einen Satz von Skripten in den Unterverzeichnissen <strong>if-pre-up.d/, if-up.d/, if-down.d/ und if-post-down.d/</strong> im Verzeichnis <strong>/etc/network/</strong>, die spezielle Aufgaben bei die Initialisierung einer Netzwerkverbindung übernehmen,</p></li><li><p>einigen weiteren Dateien, mit denen sich <strong>ifupdown</strong> seinen inneren Status merkt,</p></li></ul></li><li><p>ermöglicht eine sehr „systemnahe“ Konfiguration mit allen überhaupt vom Linux-Kernel bereitgestellten Feinheiten,</p></li><li><p>macht nichts von sich aus, sondern nur nach explizitem Aufruf,</p></li><li><p>hat selbst kaum Netzwerk-Knowhow fest eingebaut,</p></li><li><p>kümmert sich nur um die ihm explizit genannten Netzwerk-Schnittstellen,</p></li><li><p>ist nur über eine Kommandozeile bedienbar.</p></li></ul><p>
NetworkManager …
</p><ul><li><p>besteht aus</p><ul><li><p>einem daemon, also ständig aktivem Hintergrund-Prozess und</p></li><li><p>mehreren Front-ends zur Beobachtung und Bedienung des Hintergrund-Prozesses,</p></li></ul></li><li><p>versucht sich, um alle Netzwerk-Schnittstellen des Systems zu kümmern, konfiguriert diese und überwacht sie auch im Betrieb,</p></li><li><p>versucht eine einmal aktivierte Verbindung ständig verfügbar zu erhalten und weitere mögliche Verbindungen aufzubauen,</p></li><li><p>verfügt über eigene nichttriviale Prozeduren zum Aufbau von Verbindungen,</p></li><li><p>ist über eine Kommandozeile bedienbar, bietet zusätzlich aber auch eine grafische Bedienschnittstelle,</p></li><li><p>benutzt einige vom ifupdown-Mechanismus bereitgestellte Ressourcen: die o.g. Skripte in <strong>/etc/network/if-up.d/</strong> (bzw. <strong>/etc/network/if-post-down.d/</strong>) werden auch vom NetworkManager aufgerufen.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Entscheidungskriterien">Entscheidungskriterien<a class="headerlink" href="#Entscheidungskriterien">¶</a></h3><p>
Für die Entscheidung, ob man eine Netzwerk-Schnittstelle über <code class="notranslate">ifup</code> oder über den NetworkManager konfigurieren sollte, können folgende Hinweise hilfreich sein:</p><p>Für Arbeitsstationen ist in der Regel der NetworkManager die bessere Wahl. Dies trifft in besonderem Maße zu für Laptops bzw. bewegliche Geräte, mit denen man bewusst wechselweise verschiedene WLANs benutzen möchte; jedoch ist auch in diesem Fall eine Netzwerk-Konfiguration über <strong>interfaces</strong> möglich, sogar mit graphischer Unterstützung. Bei Desktop-Rechnern, die stets über ein LAN-Kabel mit immer demselben Netzwerk gekoppelt werden, kann auch eine Konfiguration über <strong>interfaces</strong> nützlich sein. Bei Servern und Routern ist meist NetworkManager eine schlechte Idee, da man hier Wert auf eine präzise Kontrolle aller Netzwerk-Eigenschaften legt.</p></div><div class="section_2"><h3 id="NetworkManager-deaktivieren">NetworkManager deaktivieren<a class="headerlink" href="#NetworkManager-deaktivieren">¶</a></h3><p>
Hierfür gibt es mehrere Möglichkeiten:</p><ul><li><p>Den NetworkManager kann man über das Dienstprogramm des Init-Prozesses zeitweise stoppen und wieder starten. Von dieser Methode wird bei der Arbeit mit <strong>interfaces</strong> ausdrücklich abgeraten, da NetworkManager beim Stopp sich kompliziert verhält:</p><ul><li><p>Netzwerk-Schnittstellen werden nicht wieder in den Zustand beim Rechnerstart zurück versetzt.</p></li><li><p>Verbindungen werden manchmal, aber nicht immer beendet.</p></li><li><p>Die von ihm gestarteten Dienste (dnsmasq, resolvconf) werden manchmal, aber nicht immer beendet.</p></li><li><p>Das konkrete Verhalten des NetworkManagers hängt ab von seiner Programmversion, aber auch von der konkreten Situation des Systems.</p></li></ul></li></ul><p>
</p><ul><li><p>NM komplett abschalten: Wenn der NetworkManager beim Rechnerstart nicht wieder starten soll, muss man den Init-Prozess konfigurieren <sup><a href="#source-4">[4]</a></sup>:     </p><div class="bash"><div class="contents"><pre class="notranslate"># Für Systeme mit systemd als Init-Prozess, z.B. Ubuntu 16.04:
sudo systemctl disable MetworkManager.service
sudo systemctl disable network-manager

# Für Systeme mit upstart als Init-Prozess, z.B. Ubuntu 14.04:
echo manual | sudo tee /etc/init/network-manager.override </pre></div></div><p>     Alternativ kann man auch den NetworkManager komplett deinstallieren.</p></li></ul><p>
</p><ul><li><p>NM für bestimmte Schnittstellen deaktivieren: Hierfür benötigt man den Namen oder die aktive Ethernet-Adresse der Schnittstelle. </p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Exkurs: Eine Liste aller Schnittstellen des Systems erhält man mit dem Befehl <sup><a href="#source-4">[4]</a></sup>: <code class="notranslate">ip link</code>
</p></div></div><ul><li><p>Unter Ubuntu 16.04 legt man im Verzeichnis <strong>/etc/NetworkManager/conf.d/</strong> mit Root-Rechten <sup><a href="#source-2">[2]</a></sup> mittels eines Editors <sup><a href="#source-1">[1]</a></sup> eine Datei (hier als Beispiel mit dem Namen <strong>unmanaged-devices.conf</strong>, der Name vor der obligatorischen Endung <strong>.conf</strong> kann aber beliebig lauten) an:     </p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span># /etc/NetworkManager/conf.d/unmanaged-devices.conf
[keyfile]
unmanaged-devices=mac:00:22:68:1c:59:b1;mac:00:1E:65:30:D1:C4;interface-name:eth2
</pre></div>
</td></tr></table></div><p>     NetworkManager muss nun seine geänderte Konfiguration neu einlesen. Dies erreicht man im laufenden Betrieb durch     </p><div class="bash"><div class="contents"><pre class="notranslate">sudo systemctl restart NetworkManager </pre></div></div></li><li><p>Unter Ubuntu 14.04 muss man die vorstehend genannten Angaben in die Datei <strong>/etc/NetworkManager/NetworkManager.conf/</strong> schreiben und den NetworkManager miitels upstart neu starten:              </p><div class="bash"><div class="contents"><pre class="notranslate">sudo initctl restart network-manager </pre></div></div></li></ul></li></ul><p>
</p><ul><li><p>NM für alle in <strong>interfaces</strong> genannten Schnittstellen deaktivieren: Dies ist durch die Standardeinstellung des NM vorgeben: NM wertet die Datei <strong>/etc/network/interfaces</strong> aus und verwaltet die dort genannten Schnittstellen nicht. Man sollte allerdings beachten, dass man durchaus Netzwerk-Schnittstellen über die Datei <strong>/etc/network/interfaces</strong> konfigurieren kann, obwohl der Name der Schnittstelle nicht in der Datei auftaucht!</p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Programm-Dokumentation">Programm-Dokumentation<a class="headerlink" href="#Programm-Dokumentation">¶</a></h2><p>
Die <a class="internal" href="./man.html">manpages</a> zu <strong>ifupdown</strong> auf dem eigenen Rechner liefern wertvolle Informationen und sollten vor einer Bearbeitung der Datei <strong>/etc/network/interfaces</strong> stets konsultiert werden. Dies ist insbesondere wichtig, wenn man mit unterschiedlichen Versionen arbeitet.</p><div class="bash"><div class="contents"><pre class="notranslate">man ifup
man interfaces </pre></div></div><p>
</p><table><tr class="titel"><td colspan="3"> Verwendete Programmversionen beim Test im Feb. 2017 </td></tr><tr class="kopf"><td> Abfrage der Programmversion </td><td> Ausgabe für 14.04 </td><td> Ausgabe für 16.04 </td></tr><tr><td> <code class="notranslate">lsb_release -ds</code> </td><td> <code class="notranslate">Ubuntu 14.04.5 LTS</code> </td><td> <code class="notranslate">Ubuntu 16.04.2 LTS</code> </td></tr><tr><td> <code class="notranslate">date -I</code> </td><td> <code class="notranslate">2017-02-28</code> </td><td> <code class="notranslate">2017-02-28</code> </td></tr><tr><td> <code class="notranslate">ifup --version			| head -n1</code> </td><td> <code class="notranslate">ifup version 0.7.47.2ubuntu4.4</code> </td><td> <code class="notranslate">ifup version 0.8.10ubuntu1.2</code> </td></tr><tr><td> <code class="notranslate">nmcli --version			| head -n1</code> </td><td> <code class="notranslate">nmcli-Werkzeug, Version 0.9.8.8</code> </td><td> <code class="notranslate">nmcli-Werkzeug, Version 1.2.2</code> </td></tr><tr><td> <code class="notranslate">ip -V				| head -n1</code> </td><td> <code class="notranslate">ip utility, iproute2-ss131122</code> </td><td> <code class="notranslate">ip utility, iproute2-ss151103</code> </td></tr><tr><td> <code class="notranslate">wpa_supplicant -v		| head -n1</code> </td><td> <code class="notranslate">wpa_supplicant v2.1</code> </td><td> <code class="notranslate">wpa_supplicant v2.4</code> </td></tr><tr><td> <code class="notranslate">sysctl -V			| head -n1</code> </td><td> <code class="notranslate">sysctl from procps-ng 3.3.9</code> </td><td> <code class="notranslate">sysctl von procps-ng 3.3.10</code> </td></tr><tr><td> <code class="notranslate">vpnc --version			| head -n1</code> </td><td> <code class="notranslate">vpnc version 0.5.3r512</code> </td><td> <code class="notranslate">vpnc version 0.5.3r550-2build1</code> </td></tr></table></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="Intern">Intern<a class="headerlink" href="#Intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./networkmanager.html">NetworkManager</a> – das Standardprogramm unter Ubuntu zur automatischen Einrichtung von Netzwerk-Verbindungen</p></li><li><p><a class="internal" href="./wicd.html">Wicd</a> – alternativer Netzwerkmanager</p></li><li><p><a class="internal" href="./wlan.html">WLAN</a> – Übersicht zum Thema WLAN</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Extern">Extern<a class="headerlink" href="#Extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="http://www.debian.org/doc/manuals/reference/ch-gateway.de.html" rel="nofollow">Kapitel 5. Netzwerkkonfiguration</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> – Debian-Referenz</p></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Netzklasse">Netzklassen</a></p></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/CIDR">Classless Internet Domain Routing</a></p></li></ul><p>
</p></div></div></div>
<p class="meta">
<a href="./interfaces/a/revision/946447.html">Diese Revision</a> wurde am 15. Januar 2018 21:19 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./interfaces.html">interfaces</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>