<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>USV/NUT › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../usv/nut.html">NUT</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/USV/NUT">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../usv/nut/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../usv/nut/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../usv/nut/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../usv/nut/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../usv/nut/a/backlinks.html">NUT</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../packprogramme.html">Archive entpacken</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../rechte.html">Rechte für Dateien und Ordner ändern</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration-Server">Konfiguration Server
</a></li><li><a class="crosslink" href="#Installation-Client">Installation Client
</a></li><li><a class="crosslink" href="#Konfiguration-Client">Konfiguration Client
</a></li><li><a class="crosslink" href="#Administrative-Werkzeuge">Administrative Werkzeuge
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./nut_logo.png" class="image-left" src="../_/c2ca646eeb366987b6e5e600c3c6ec3cb323bcf8.png"/>
<a class="external" href="http://www.networkupstools.org/" rel="nofollow">NUT</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein Client/Server-Framework zur Ansteuerung und Verwaltung einer <a class="internal" href="../usv.html">USV</a> (unterbrechungsfreie Stromversorgung, englisch: UPS). Unterstützt werden über 100 verschiedene <a class="external" href="http://www.networkupstools.org/stable-hcl.html" rel="nofollow">Hersteller</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> und Modelle. Einige Programmkomponenten arbeiten normalerweise als <a class="internal" href="../dienste.html">Systemdienst</a> (Daemon), d.h. diese werden automatisch beim Einschalten des Rechners gestartet.</p><p>Zunächst sollte geklärt werden, ob man ein zur USV passendes (serielles oder USB-) Kabel hat. Bauanleitungen für evtl. fehlende Kabel findet man auf der <a class="external" href="http://www.networkupstools.org/cables.html" rel="nofollow">Projektseite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p><p>Das Konfigurieren und Testen der USV sollte anfangs nur passiv geschehen. Das heißt, dass die USV nur über das Datenkabel angeschlossen ist. Diese Anleitung behandelt beispielhaft eine "APC Smart-UPS", deshalb müssen einige Angaben entsprechend angepasst werden.</p><p>Folgende Programme werden verwendet:</p><ul><li><p><strong>upsd</strong> - verwaltet Treiber und Zugriffsrechte</p></li><li><p><strong>upsmon</strong> - überwacht die USV</p></li><li><p><strong>upssched</strong> - Scheduler (Zeitplaner) für den upsmon</p></li></ul><p>
</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="section_2"><h3 id="Server">Server<a class="headerlink" href="#Server">¶</a></h3><p>
Folgendes Paket wird für die Installation benötigt <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>nut</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nut </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nut </pre></div></div><p>
</p></div></div><p>Optional können weitere Zusatzpakete installiert werden:</p><ul><li><p><strong>nut-cgi</strong> (Weboberfläche, <a class="crosslink" href="#Administrative-Werkzeuge">siehe unten</a>)</p></li><li><p><strong>nut-snmp</strong> (<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Simple_Network_Management_Protocol">SNMP</a>-Überwachung)</p></li><li><p><strong>nut-xml</strong> (<em>universe</em>, für spezielle Modelle von Eaton oder MGE)</p></li><li><p><strong>nut-ipmi</strong> (<em>universe</em>, für <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Intelligent_Platform_Management_Interface">IPMI</a>, erst ab <a class="internal" href="../trusty.html">Ubuntu 14.04</a>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nut-cgi nut-snmp nut-xml nut-ipmi </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nut-cgi nut-snmp nut-xml nut-ipmi </pre></div></div><p>
</p></div></div><p>Danach sollte man (wenn noch nicht vorhanden) die Beispieldateien aus <strong>/usr/share/doc/nut/examples/</strong> nach <strong>/etc/nut/</strong> kopieren. Damit die Dateien auch genutzt werden können, müssen sie nur noch umbenannt werden: <strong>.sample</strong> im Dateinamen löschen. Das Konfigurationsbeispiel von <strong>upsmon</strong> muss gegebenenfalls noch entpackt <sup><a href="#source-2">[2]</a></sup> werden. Dies geschieht z.B. mit <sup><a href="#source-3">[3]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">gzip -d upsmon.conf.sample.gz  </pre></div></div><p>Damit ist die Installation des Servers abgeschlossen und es kann mit der Konfiguration begonnen werden.</p></div></div><div class="section_1"><h2 id="Konfiguration-Server">Konfiguration Server<a class="headerlink" href="#Konfiguration-Server">¶</a></h2><p>
</p><div class="section_2"><h3 id="Server-in-den-Autostart-aufnehmen">Server in den Autostart aufnehmen<a class="headerlink" href="#Server-in-den-Autostart-aufnehmen">¶</a></h3><p>
Dazu editiert <sup><a href="#source-4">[4]</a></sup> man <strong>/etc/default/nut</strong> wie folgt:</p><pre class="notranslate">START_UPSD=yes
UPSD_OPTIONS=""
START_UPSMON=yes
UPSMON_OPTIONS=""</pre></div><div class="section_2"><h3 id="Treiber-konfigurieren">Treiber konfigurieren<a class="headerlink" href="#Treiber-konfigurieren">¶</a></h3><p>
Dazu editiert man die <strong>/etc/nut/ups.conf</strong>:</p><pre class="notranslate">[apc]
  driver = apcsmart		# Treiber der verwendet werden soll
  port = /dev/ttyS0		# Port, an dem die USV angeschlossen ist (hier COM1)
  desc = "APC Smart-UPS"  	# Beschreibung der USV</pre><p>Es gibt noch weitere Parameter, die man hier angeben kann. Diese kann man in der <a class="internal" href="../man.html">man</a>-Page von <strong>ups.conf</strong> nachlesen. Eine Liste unterstützter USVs findet man unter <a class="external" href="http://www.networkupstools.org/stable-hcl.html" rel="nofollow">Hardware compatibility list</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p></div><div class="section_2"><h3 id="Systemdienst-konfigurieren">Systemdienst konfigurieren<a class="headerlink" href="#Systemdienst-konfigurieren">¶</a></h3><p>
Dazu editiert man die <strong>/etc/nut/upsd.conf</strong>. Hier braucht nichts geändert werden, wenn die USV nur einen einzigen Rechner (Host) versorgt. Ansonsten kann man hier die Zugriffsrechte für das Netzwerk konfigurieren. Das sieht beispielsweise so aus:</p><pre class="notranslate">ACL all 0.0.0.0/0			# komplettes Netzwerk
ACL localhost 127.0.0.1/32		# eigener Rechner
ACL netz 192.168.1.0/24		        # Netzwerksegment 1
ACL netz2 192.168.2.0/24		# Netzwerksegment 2

ACCEPT localhost			# erlaubt Zugriff von localhost
ACCEPT netz				# erlaubt Zugriff von netz
ACCEPT netz2		        	# erlaubt Zugriff von netz2
REJECT all				# verweigert Zugriff von all</pre><p>Mit der Option LISTEN kann man noch eine bestimmte Netzwerkkarte angeben werden, auf der nur der Zugriff gestattet wird.</p></div><div class="section_2"><h3 id="Benutzer-einrichten">Benutzer einrichten<a class="headerlink" href="#Benutzer-einrichten">¶</a></h3><p>
Dazu editiert man <strong>/etc/nut/upsd.users</strong>. Es bietet sich hier an, drei Benutzer anzulegen, und zwar einen "upsmaster" (der auf dem Server die Überwachung übernimmt), einen "upsslave" (der von den Clients die Überwachung übernimmt) und einen "upsadmin" (der Verwaltungsaufgaben übernehmen darf).</p><pre class="notranslate">[upsmaster]				# Benutzername
  password = upsmaster    		# Passwort für den Benutzer
  allowfrom = localhost			# Zugriff von (man kann die ACLs verwenden)
  upsmon master		         	# Art des Zugriffs

[upsslave]
  password = upsslave
  allowfrom = netz netz2 localhost
  upsmon slave

[upsadmin]
  password = upsadmin
  allowfrom = localhost
  actions = SET
  instcmds = ALL</pre><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Die Benutzer in dieser Datei müssen nicht zwingend lokal auf dem Rechner existieren.
</p></div></div></div><div class="section_2"><h3 id="Statusdienst-Monitor-einrichten">Statusdienst (Monitor) einrichten<a class="headerlink" href="#Statusdienst-Monitor-einrichten">¶</a></h3><p>
Dazu editiert man die <strong>/etc/nut/upsmon.conf</strong>:</p><pre class="notranslate">RUN_AS_USER root</pre><p>Da das vorkompilierte NUT unter der Benutzerkennung <em>nut</em> erzeugt wurde, kann man einige Funktionen nicht richtig nutzen (z.B. den Zugriff auf den seriellen Port). Man kann zwar die Rechte und die dazugehörigen Benutzer auf dem Port zwar ändern, aber diese werden nach dem Neustart des PCs durch <a class="internal" href="../apparmor.html">AppArmor</a> wieder zurückgesetzt. Genau das selbe passiert auch unter <strong>/var/run/nut</strong>.</p><p>Als nächstes sagt man dem Monitor, was er sich anschauen soll:</p><pre class="notranslate">MONITOR apc@localhost 1 upsmaster upsmaster master</pre><p>Dies sagt dem Monitor, dass die USV "apc" am lokalen Rechner (wobei mind. 1 USV vorhanden sein muss) mit den Benutzer "upsmaster" und dem Passwort "upsmaster" abgefragt wird.</p><pre class="notranslate">MINSUPPLIES 1</pre><p>
Gibt an, wie viele USVs mindestens verfügbar sein müssen.</p><pre class="notranslate">SHUTDOWNCMD “/sbin/shutdown -h +0“</pre><p>Der Befehl zum Herunterfahren des Systems.</p><pre class="notranslate">NOTIFYCMD /sbin/upssched</pre><p>Gibt an welches Programm gestartet werden soll, wenn ein bestimmtes Ereignis eintritt. Zu <strong>upsched</strong> später mehr.</p><pre class="notranslate">POLLFREQ 5</pre><p>Ist das Intervall in Sekunden, in dem der Monitor die USV abfragt.</p><pre class="notranslate">POLLFREQALERT 5</pre><p>Ist das Intervall in Sekunden, in dem der Monitor die USV abfragt, wenn die USV auf Alarm steht (bspw. die USV auf Batterie läuft).</p><pre class="notranslate">HOSTSYNC 15</pre><p>Ist die Zeit, die der Server wartet, dass die Clients ihre Verbindung trennen können, wenn FSD gesetzt worden ist (FSD wird gesetzt wenn z.B. die Batterie fast leer ist).</p><pre class="notranslate">DEADTIME 15</pre><p>Die Zeit die gewartet wird, wenn die USV nicht erreichbar ist (bevor sie als nicht verfügbar gilt). Sollte das 3-fache von <code class="notranslate">POLLFREQ</code> und <code class="notranslate">POLLFREQALERT</code> sein.</p><pre class="notranslate">POWERDOWNFLAG /etc/killpower</pre><p>Diese Datei wird vom Monitor erstellt, wenn der Rechner herunterfahren soll.</p><pre class="notranslate">NOTIFYMSG ONLINE "USV-ONLINE"
NOTIFYMSG ONBATT "USV-AUF-BATTERIE"
# und so weiter ...</pre><p>Hier werden die Nachrichten für bestimmte Ereignisse deklariert. Ereignisse können sein:</p><ul><li><p>ONLINE</p></li><li><p>ONBATT</p></li><li><p>LOWBATT</p></li><li><p>FSD</p></li><li><p>COMMOK</p></li><li><p>COMMBAD</p></li><li><p>SHUTDOWN</p></li><li><p>REPLBATT</p></li><li><p>NOCOMM</p></li><li><p>NOPARENT</p></li></ul><p>
</p><pre class="notranslate">NOTIFYFLAG ONLINE SYSLOG+WALL+EXEC
NOTIFYFLAG ONBATT SYSLOG+WALL+EXEC
# und so weiter ...</pre><p>Dies sind die Aktionen, die durchgeführt werden, wenn ein Ereignis eintritt. <code class="notranslate">SYSLOG</code> gibt an, das das Ereignis ins Systemprotokoll geschrieben wird. <code class="notranslate">WALL</code> sendet Nachrichten an alle angemeldeten Benutzer am lokalen PC (siehe auch <a class="internal" href="../wall.html">wall</a>). <code class="notranslate">EXEC</code> gibt den Status an das Programm von <code class="notranslate">NOTIFYCMD</code> weiter. Wenn z.B. nur Nachrichten gesendet werden sollen, reicht <code class="notranslate">WALL</code> aus. Hier werden die selben Ereignisse verwendet wie bei <code class="notranslate">NOTIFYMSG</code>.</p><pre class="notranslate">RBWARNTIME 43200</pre><p>Ist die Zeit in Sekunden bevor die Meldung für den Batteriewechsel kommt.</p><pre class="notranslate">NOCOMMWARNTIME 300</pre><p>Ist die Zeit in Sekunden, wo die Meldung kommt das die USV nicht erreichbar ist. Diese Meldung wiederholt sich so lange bis die USV wieder erreichbar ist.</p><pre class="notranslate">FINALDELAY 5</pre><p>Ist die Zeit die gewartet wird, nachdem der SHUTDOWNCMD aufgerufen wird bevor er ausgeführt wird.</p></div><div class="section_2"><h3 id="upssched-verwenden">upssched verwenden<a class="headerlink" href="#upssched-verwenden">¶</a></h3><p>
Bevor man die Datei <strong>/etc/nut/upssched.conf</strong> editiert, sollte man einen Ordner unter <strong>/etc/nut/</strong> mit dem Namen <strong>upssched</strong> anlegen.</p><pre class="notranslate">CMDSCRIPT /etc/nut/upssched/upsscript</pre><p>
Ist der Pfad zu dem Skript, was ausgeführt werden soll, wenn die Trigger (Schalter) gesetzt werden.</p><pre class="notranslate">PIPEFN /etc/nut/upssched/upssched.pipe
LOCKFN /etc/nut/upssched/upssched.lock</pre><p>
Diese Dateien werden genutzt, um mit den Prozessen zu agieren. Sie werden automatisch erzeugt und gelöscht.</p><pre class="notranslate">AT ONBATT * START-TIMER onbatt 90
AT ONLINE * CANCEL-TIMER onbatt
AT LOWBATT * EXEC battleer</pre><p>In diesem Fall wird ein Timer gestartet, wenn die USV auf Batterie umschaltet. Dieser wartet 90 Sekunden, bevor er den Parameter <code class="notranslate">onbatt</code> an das <code class="notranslate">CMDSCRIPT</code> weiter gibt. Schaltet die USV wieder ONLINE, so wird der Timer abgebrochen. Wenn die USV Batterie niedrig ist, wird sofort das Skript mit dem Parameter <code class="notranslate">battleer</code> ausgeführt.</p></div><div class="section_2"><h3 id="Beispiel-Skript-fuer-upssched">Beispiel Skript für upssched<a class="headerlink" href="#Beispiel-Skript-fuer-upssched">¶</a></h3><p>
Das Skript ist ein einfaches Beispiel für die Konfiguration:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#! /bin/sh</span>
<span class="k">case</span> <span class="nv">$1</span> in
  onbatt<span class="o">)</span>
    /sbin/shutdown -h +0<span class="p">;;</span>
  battleer<span class="o">)</span>
    /sbin/upssched fsd<span class="p">;;</span>
  *<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">"Falscher Parameter"</span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</td></tr></table></div></div><div class="section_2"><h3 id="Rechte-aendern">Rechte ändern<a class="headerlink" href="#Rechte-aendern">¶</a></h3><p>
Im Ordner <strong>/etc/nut</strong> sollten alle Dateien <em>root</em> gehören und die Gruppe <em>nut</em> Leserechte <sup><a href="#source-5">[5]</a></sup> haben. Dies geschieht mit</p><div class="bash"><div class="contents"><pre class="notranslate">chmod -R 740 /etc/nut/*
chown -R root:nut /etc/nut/*
chmod -R 750 /etc/nut/upssched </pre></div></div></div><div class="section_2"><h3 id="Testen-der-Einstellungen">Testen der Einstellungen<a class="headerlink" href="#Testen-der-Einstellungen">¶</a></h3><p>
Wenn man alles nach seinen Wünschen eingestellt hat, kann man nun den Rechner neu starten. Dann kann man mit “upsc apc“ den Status seiner USV auslesen. Als nächstes zieht man die Stromversorgung der USV ab, um zu sehen ob alles so funktioniert wie gewünscht. Wenn alles funktioniert, kann man nun die USV richtig an den Rechner anschließen.</p></div></div><div class="section_1"><h2 id="Installation-Client">Installation Client<a class="headerlink" href="#Installation-Client">¶</a></h2><p>
Folgendes Paket wird für die Installation benötigt:</p><ul><li><p><strong>nut-client</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nut-client </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nut-client </pre></div></div><p>
</p></div></div><p>
In der Datei <strong>/etc/default/nut</strong> muss der Monitor auf <strong><code class="notranslate">YES</code></strong> gesetzt werden, der <code class="notranslate">upsd</code> muss auf <strong><code class="notranslate">no</code></strong> stehen.</p></div><div class="section_1"><h2 id="Konfiguration-Client">Konfiguration Client<a class="headerlink" href="#Konfiguration-Client">¶</a></h2><p>
</p><div class="section_2"><h3 id="Daemon-einrichten">Daemon einrichten<a class="headerlink" href="#Daemon-einrichten">¶</a></h3><p>
Beim Client muss hier nichts eingetragen sein, also alles auskommentieren.</p></div><div class="section_2"><h3 id="Monitor-einrichten">Monitor einrichten<a class="headerlink" href="#Monitor-einrichten">¶</a></h3><p>
Im Prinzip genau wie beim Server, nur das die Zeile von Monitor anders ist.</p><pre class="notranslate">MONITOR apc@192.168.1.1 1 upsslave upsslave slave</pre><p>
Anstatt der IP-Adresse kann hier auch der Hostname angegeben werden, falls er aufgelöst werden kann.</p></div><div class="section_2"><h3 id="upssched-einrichten">upssched einrichten<a class="headerlink" href="#upssched-einrichten">¶</a></h3><p>
Kann hier genau so genutzt werden wie beim Server.</p></div><div class="section_2"><h3 id="Testen-der-Einstellungen-2">Testen der Einstellungen<a class="headerlink" href="#Testen-der-Einstellungen-2">¶</a></h3><p>
Rechner neu starten und mit:</p><div class="bash"><div class="contents"><pre class="notranslate">upsc apc@192.168.1.1  </pre></div></div><p>
testen, ob die Daten ausgelesen werden können.</p></div></div><div class="section_1"><h2 id="Administrative-Werkzeuge">Administrative Werkzeuge<a class="headerlink" href="#Administrative-Werkzeuge">¶</a></h2><p>
Man kann eine Web-Oberfläche für Nut installieren, um diese von einen beliebigen Ort im Netzwerk zu kontrollieren und Testläufe zu starten. Voraussetzung ist ein laufender Webserver.</p><p>Folgendes Paket wird für die Installation benötigt:</p><ul><li><p><strong>nut-cgi</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install nut-cgi </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install nut-cgi </pre></div></div><p>
</p></div></div><p>
Ist dies installiert, so kann man mit einem Webbrowser auf die gerade erstellte Seite von NUT zugreifen. Zum Beispiel:</p><pre class="notranslate">http://localhost/nut</pre><p>
Für die Anmeldung gelten die Benutzernamen, die in <strong>ups.users</strong> eingerichtet wurden.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Der Webserver sollte so eingerichtet werden, dass der Zugriff auf die Web-Oberfläche nur vom lokalen Netz erlaubt ist.
</p></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://networkupstools.org/" rel="nofollow">Projektseite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p><a class="external" href="http://www.networkupstools.org/stable-hcl.html" rel="nofollow">Liste unterstützter USVs</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li></ul></li><li><p><a class="external" href="http://www.linux-user.de/ausgabe/2007/10/088-revolt-usv/index.html" rel="nofollow">250W-USV für zuhause</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Artikel LinuxUser 10/2007</p></li><li><p><a class="internal" href="../usv.html">USV</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Übersichtsartikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../usv/nut/a/revision/940130.html">Diese Revision</a> wurde am 7. Mai 2017 12:02 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../usv.html">USV</a></li>
<li><a href="../usv/nut.html">NUT</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>