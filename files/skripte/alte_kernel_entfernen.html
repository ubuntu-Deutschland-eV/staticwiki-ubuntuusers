<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Skripte/Alte_Kernel_entfernen › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../skripte/alte_kernel_entfernen.html">Alte Kernel entfernen</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Skripte/Alte_Kernel_entfernen">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../skripte/alte_kernel_entfernen/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../skripte/alte_kernel_entfernen/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../skripte/alte_kernel_entfernen/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../skripte/alte_kernel_entfernen/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../skripte/alte_kernel_entfernen/a/backlinks.html">Alte Kernel entfernen</a></h1>
<div id="page"><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../editor.html">Einen Editor verwenden</a>, <em>optional</em></p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Voraussetzungen">Voraussetzungen
</a></li><li><a class="crosslink" href="#Zu-entfernende-Kernel-ermitteln">Zu entfernende Kernel ermitteln
</a></li><li><a class="crosslink" href="#Deinstallation-alter-Kernel">Deinstallation alter Kernel
</a></li><li><a class="crosslink" href="#Bestimmte-Kernel-behalten">Bestimmte Kernel behalten
</a></li><li><a class="crosslink" href="#Kein-Speicherplatz-mehr-frei">Kein Speicherplatz mehr frei
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Betreibt man ein Ubuntu-System über einen längeren Zeitraum, so häufen sich die verschiedenen Kernel-Versionen an. Da ein <a class="internal" href="../kernel.html">Kernel</a> zusammen mit Header-Dateien und Kernel-Modulen einiges an Platz auf der Festplatte belegen kann (ca. 200 MiB), sollte man im Rahmen der <a class="internal" href="../systempflege.html">Systempflege</a> bei Gelegenheit ältere Kernelversionen, die man nicht mehr nutzt, von Hand deinstallieren. Besonders wichtig ist das bei verschlüsselten Systemen, die für <strong>/boot</strong> eine eigene Partition nutzen: ist diese voll belegt, können Kernel-Aktualisierungen nicht mehr automatisch installiert werden.</p><p>Zum Entfernen nicht mehr benötigter Kernel gibt es mehrere Möglichkeiten. Wenn die <a class="internal" href="../kernel.html#Kernel-deinstallieren">Standard-Methoden</a> nicht zum gewünschten Ergebnis führen und sehr viele alte Kernel vorhanden sind, dann ist es relativ zeitaufwendig, diese einzeln zu entfernen. Hier kann die folgende Anleitung weiterhelfen.</p><div class="section_1"><h2 id="Voraussetzungen">Voraussetzungen<a class="headerlink" href="#Voraussetzungen">¶</a></h2><p>
Zuerst ermittelt man den aktiven Kernel, damit dieser nicht versehentlich entfernt wird:</p><div class="bash"><div class="contents"><pre class="notranslate">uname -a </pre></div></div></div><div class="section_1"><h2 id="Zu-entfernende-Kernel-ermitteln">Zu entfernende Kernel ermitteln<a class="headerlink" href="#Zu-entfernende-Kernel-ermitteln">¶</a></h2><p>
Mit dem Befehl <sup><a href="#source-1">[1]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg -l 'linux-[ihs]*' | sed '/^ii/!d;/'"$(uname -r | sed "s/\([-0-9]*\)-\([^0-9]\+\)/\1/")"'/d;s/^[^ ]* [^ ]* \([^ ]*\).*/\1/;/[0-9]/!d' | tee zu_entfernende_Kernel </pre></div></div><p>
werden alle alten Kernel einschließlich der Header-Dateien bis auf den aktuellen aufgelistet sowie eine Kopie dieser Liste in der Datei <strong>zu_entfernende_Kernel</strong> gespeichert.</p></div><div class="section_1"><h2 id="Deinstallation-alter-Kernel">Deinstallation alter Kernel<a class="headerlink" href="#Deinstallation-alter-Kernel">¶</a></h2><p>
Die Deinstallation der veralteten Kernel-Versionen leitet man nun mittels</p><div class="bash"><div class="contents"><pre class="notranslate">cat zu_entfernende_Kernel | xargs sudo apt-get -y purge </pre></div></div><p>
ein, um das System von nicht mehr benötigten Kernel-Versionen zu bereinigen. Nach erfolgter Deinstallation wird die temporär angelegte Liste gelöscht:</p><div class="bash"><div class="contents"><pre class="notranslate">rm zu_entfernende_Kernel </pre></div></div></div><div class="section_1"><h2 id="Bestimmte-Kernel-behalten">Bestimmte Kernel behalten<a class="headerlink" href="#Bestimmte-Kernel-behalten">¶</a></h2><p>
Möchte man mehrere der aufgelisteten Kernel behalten, um z.B. im Notfall auf bestimmte stabil laufende Kernel zurückgreifen zu können, öffnet man die erzeugte Liste <strong>zu_entfernende_Kernel</strong> mit einem Editor <sup><a href="#source-2">[2]</a></sup> und entfernt dort die Einträge derjenigen Kernel-Versionen, welche man behalten möchte. Hierbei ist zu beachten, dass zu einer Kernel-Version in der Regel mehrere Einträge gehören. Enthält die Liste schließlich nur noch Kernel-Versionen, welche man entfernen möchte, speichert man sie und verlässt den Editor.</p></div><div class="section_1"><h2 id="Kein-Speicherplatz-mehr-frei">Kein Speicherplatz mehr frei<a class="headerlink" href="#Kein-Speicherplatz-mehr-frei">¶</a></h2><p>
In der Praxis kann es auch zu folgendem Sonderfall kommen: Es sollen Aktualisierungen installiert werden, aber auf der separaten <a class="internal" href="../manuelle_partitionierung.html#Vorueberlegungen">/boot-Partition</a> ist kein Speicherplatz mehr frei oder es sind keine freien Inodes mehr vorhanden. Die Paketverwaltung <a class="internal" href="../apt.html">APT</a> meldet beim Versuch, einen älteren Kernel zu deinstallieren, folgenden Fehler:</p><pre class="notranslate">gzip: stdout: No space left on device</pre><p>
Nicht mehr benötigte Kernel sollten dann mittels <a class="internal" href="../dpkg.html">dpkg</a> entfernt werden. Dazu ermittelt man zunächst die nicht mehr benötigten Kernelversionen:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg -l 'linux-[ihs]*' | sed '/^ii/!d;/'"$(uname -r | sed "s/\([-0-9]*\)-\([^0-9]\+\)/\1/")"'/d;s/^[^ ]* [^ ]* \([^ ]*\).*/\1/;/[0-9]/!d' </pre></div></div><p>
Nach Prüfung können die Kernelversionen dann entfernt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg -l 'linux-[ihs]*' | sed '/^ii/!d;/'"$(uname -r | sed "s/\([-0-9]*\)-\([^0-9]\+\)/\1/")"'/d;s/^[^ ]* [^ ]* \([^ ]*\).*/\1/;/[0-9]/!d' | xargs sudo dpkg -P </pre></div></div><p>
Anschließend sollte noch kontrolliert werden, ob ggf. fehlerhafte oder unvollständig installierte Pakete vorhanden sind:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg -l linux-[ihs]* | sed '1,6d'| grep -vE '^ii|^un|^rc' </pre></div></div><p>
Falls die Ausgabe nicht leer ist, sollten die fehlenden/unkonfigurierten Pakete mittels:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get -f install </pre></div></div><p>
nachinstalliert werden.</p><p>Je nachdem, wie lange bereits keine Aktualisierungen mehr eingespielt werden können, kann es vorkommen, dass nach der getätigten Aktualisierung erneut kein Speicherplatz mehr zur Verfügung steht. Dann sollten die aufgeführten Schritte wiederholt werden.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>In manchen Situationen (keine Inodes frei) können mit <code class="notranslate">dpkg</code> keine Pakete entfernt werden. Wie man dann Abhilfe schafft, steht im Artikel <a class="internal" href="../festplatten_problembehebung.html#Dateisystem-voll">Festplatten Problembehebung</a>.
</p></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="../kernel.html">Kernel</a> - Hauptartikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../skripte/alte_kernel_entfernen/a/revision/922798.html">Diese Revision</a> wurde am 3. Dezember 2016 08:19 von <a href="https://ubuntuusers.de/user/aasche/">aasche</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../skripte.html">Skripte</a></li>
<li><a href="../skripte/alte_kernel_entfernen.html">Alte Kernel entfernen</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>