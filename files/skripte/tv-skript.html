<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Skripte/TV-Skript › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../skripte/tv-skript.html">TV-Skript</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Skripte/TV-Skript">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../skripte/tv-skript/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../skripte/tv-skript/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../skripte/tv-skript/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../skripte/tv-skript/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../skripte/tv-skript/a/backlinks.html">TV-Skript</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
Dieser Artikel ist mit keiner aktuell unterstützten Ubuntu-Version getestet! Bitte diesen Artikel testen und das getestet-Tag entsprechend anpassen.
</p></div></div><p>
</p><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../rechte.html">Zugriffsrechte von Dateien und Ordner ändern</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../programme_starten.html">Ein Programm starten</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../menüeditor.html">Programme zum Menü hinzufügen</a> </p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Vorbereitung">Vorbereitung
</a></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a></li><li><a class="crosslink" href="#Alternative-mit-MPlayer-und-TS-Format">Alternative mit MPlayer und .TS-Format
</a><ol class="arabic"><li><a class="crosslink" href="#Konvertierung-des-TS-Format-in-herkoemmliche-MPEG2-Programm-Streams">Konvertierung des .TS-Format in herkömml...</a></li><li><a class="crosslink" href="#Time-Shift">"Time-Shift"
</a></li></ol></li><li><a class="crosslink" href="#Probleme">Probleme
</a></li><li><a class="crosslink" href="#Alternativen">Alternativen
</a></li></ol></div><p><img alt="Wiki/Icons/tv2.png" class="image-left" src="../_/cafffe6a6c71b1d1d96c088ac20cf7981d2e6f18.png"/> Dieses Skript erlaubt es, TV-Aufnahmen komfortabel zu starten. Die Bedienung ist intuitiv zu erfassen. Die GUI fragt alle nötigen Informationen zum Sender, zur Aufnahmedauer und zum Aufnahmestart (mit Kalenderfunkton) sowie zum Titel und Speicherort ab.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Folgende Pakete müssen installiert <sup><a href="#source-1">[1]</a></sup> sein:
</p><ul><li><p><strong>mplayer</strong></p></li><li><p><strong>mencoder</strong></p></li><li><p><strong>zenity</strong></p></li></ul><p>
</p></div><div class="section_1"><h2 id="Vorbereitung">Vorbereitung<a class="headerlink" href="#Vorbereitung">¶</a></h2><p>
Um das Skript von <a class="crosslink user" href="https://ubuntuusers.de/user/stw0815/">stw0815</a> nutzen zu können, muss man natürlich mit <a class="internal" href="../mplayer.html">MPlayer</a> DVB-Fernsehen schauen können, es muss also eine <a class="internal" href="../dvb-utils.html#channels-conf">channels-conf</a> im Verzeichnis <strong> ~/.mplayer</strong> vorhanden sein,</p><p>In einem Editor <sup><a href="#source-2">[2]</a></sup> fügt man die folgenden Zeilen ein und speichert das Skript unter einem aussagekräftigen Titel, z.B. <strong>TV-Aufnahme.sh</strong> z.B. in <strong>~/bin/</strong> ab.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">## Author stw0815</span>
<span class="c1">## http://forum.ubuntuusers.de/topic/70377/</span>
<span class="nv">MCD</span><span class="o">=</span>/usr/bin/mencoder
zenity --help &gt; /dev/null <span class="o">||</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"Fehler: Du benötigst \"zenity\" um dieses Script nutzen zu können."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nb">test</span> -e <span class="nv">$MCD</span> <span class="o">||</span> <span class="o">{</span> zenity --error --text <span class="s2">"Fehler: Du benötigst \"mencoder\" um dieses Script nutzen zu können."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nb">test</span> ! -e ~/.mplayer/channels.conf <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"~/.mplayer/channels.conf wurde nicht gefunden"</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
<span class="nv">SENDER</span><span class="o">=</span><span class="sb">`</span>cat ~/.mplayer/channels.conf <span class="p">|</span> cut -d <span class="s2">":"</span> -f <span class="m">1</span> <span class="p">|</span> zenity --list --title <span class="s2">"Bitte Sender auswählen"</span> --column <span class="s2">"Sender:"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nb">test</span> <span class="s2">"</span><span class="nv">$SENDER</span><span class="s2">"</span> <span class="o">||</span> <span class="o">{</span> zenity --error --text <span class="s2">"Es wurde kein Sender ausgewählt."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nv">DAUER</span><span class="o">=</span><span class="sb">`</span>zenity --entry --title <span class="s2">"Dauer"</span> --entry-text <span class="s2">"60"</span> --text <span class="s2">"Bitte die Aufnahmedauer in Minuten eingeben"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">LENGTH</span><span class="o">=</span><span class="k">$((</span><span class="nv">$DAUER</span><span class="o">*</span><span class="m">60</span><span class="o">*</span><span class="m">25</span><span class="k">))</span>
<span class="nb">test</span> <span class="s2">"</span><span class="nv">$LENGTH</span><span class="s2">"</span> -lt <span class="m">1</span> <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"Die Aufnahmedauer ist fehlerhaft."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
<span class="nv">FILE</span><span class="o">=</span><span class="sb">`</span>zenity --file-selection --save --confirm-overwrite --title <span class="s2">"Name und Ort zum Speichern auswählen"</span> --filename<span class="o">=</span><span class="s2">"</span><span class="nv">$SENDER</span><span class="s2">"</span>.mpg<span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">REC</span><span class="o">=</span><span class="s2">"dvb://\"</span><span class="nv">$SENDER</span><span class="s2">\" -of mpeg -mpegopts format=dvd -ovc copy -oac copy -frames </span><span class="nv">$LENGTH</span><span class="s2"> -o \"</span><span class="nv">$FILE</span><span class="s2">\""</span>
zenity --question --text <span class="s2">"Soll die Aufnahme sofort gestartet werden?"</span> <span class="o">&amp;&amp;</span> <span class="nb">eval</span> <span class="s2">"</span><span class="nv">$MCD</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$REC</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">DAY</span><span class="o">=</span><span class="sb">`</span>zenity --calendar --title <span class="s2">"Aufnahmedatum"</span> --text <span class="s2">"Bitte das Datum der Aufnahme festlegen"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">TIME</span><span class="o">=</span><span class="sb">`</span>zenity --entry --title <span class="s2">"Aufnahmestart (HH:MM)"</span> --text <span class="s2">"Bitte den Startzeitpunkt der Aufnahme festlegen"</span> --entry-text <span class="s2">"</span><span class="k">$(</span>date --date<span class="o">=</span><span class="s2">"5 minutes"</span> +%H:%M<span class="k">)</span><span class="s2">"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$MCD</span><span class="s2"> </span><span class="nv">$REC</span><span class="s2">"</span> <span class="p">|</span> at <span class="nv">$TIME</span> <span class="nv">$DAY</span> <span class="p">&amp;</span>&gt; /tmp/recerror
<span class="nb">test</span> <span class="nv">$?</span> -gt <span class="m">0</span> <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"</span><span class="k">$(</span>cat /tmp/recerror<span class="k">)</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> rm /tmp/recerror <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
zenity --info --text <span class="s2">"Sender: </span><span class="nv">$SENDER</span><span class="s2">\nBeginn: </span><span class="nv">$DAY</span><span class="s2">, </span><span class="nv">$TIME</span><span class="s2"> Uhr\nDauer: </span><span class="nv">$DAUER</span><span class="s2"> Minuten, </span><span class="nv">$LENGTH</span><span class="s2"> Einzelbilder\nDateiname: </span><span class="nv">$FILE</span><span class="s2">\n\nStatus: OK\n</span><span class="k">$(</span>cat /tmp/recerror<span class="k">)</span><span class="s2">"</span>
<span class="nb">test</span> -e /tmp/recerror <span class="o">&amp;&amp;</span> rm /tmp/recerror
</pre></div>
</td></tr></table></div><p>
Die Datei nun ausführbar <sup><a href="#source-3">[3]</a></sup> machen und anschließend starten <sup><a href="#source-4">[4]</a></sup>. Komfortabler ist es das Programm im Menü <sup><a href="#source-5">[5]</a></sup> zu hinterlegen bzw. mit einem Desktop-Icon zu verlinken.</p><p>Ein anderes Standardverzeichnis für den Speicherort kann man einfach dadurch erreichen, dass man bei der Zeile "<code class="notranslate">FILE=...</code>" die Variable "<code class="notranslate">--filename</code>" um den Pfad zum gewünschten Verzeichnis erweitert, also beispielsweise "<code class="notranslate">--filename=/home/"USER"/Aufnahmen/"$SENDER".mpg</code>"
Der Stream wird als DVD-kompatible MPEG-Datei aufgezeichnet und lässt sich direkt bzw. nach der Aufnahme betrachten oder mit <a class="internal" href="../avidemux.html">Avidemux</a> bearbeiten.</p></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
Im Senderauswahlmenü sind die Sender aufgelistet, die in der Datei <strong>channels.conf</strong> im Verzeichnis <strong>~/.mplayer</strong> eingetragen sind. Ist diese nicht vorhanden, kann sie mit <a class="internal" href="../dvb-utils.html">dvb-utils</a> für DVB-fähige Geräte erstellt werden.</p><p>Als nächstes wird die Aufnahmelänge in Minuten eingegeben. Es empfiehlt sich immer, die Dauer der Aufnahme etwas länger als die Dauer der Sendung zu wählen. Nach Bestätigung wird folgend nach dem Speicherort und dem Dateinamen gefragt. Dieser heißt standardmäßig <strong>SENDER.mpg</strong>.</p><p>Der Aufnahmestart kann für jeden beliebigen Zeitpunkt festgelegt werden. So kann die Aufnahme im einfachsten Fall direkt beginnen. Alternativ kann eine Uhrzeit und ein Datum für den Aufnahmebeginn eingegeben werden. Wird der Dialog zum sofortigem Aufnahmebeginn abgebrochen (<code class="notranslate">Cancel</code>), wird der Kalender der Oberfläche eingeblendet. Hier muss der Aufnahmetag auswählt werden, ansonsten bricht das Skript vorzeitig ab.</p><p>Abschließend wird der Beginn der Aufnahme angegeben. Das Format ist "<code class="notranslate">HH:MM</code>" bzw. "<code class="notranslate">HH.MM</code>", z.B. "<code class="notranslate">17:15</code>" bzw. "<code class="notranslate">17.15</code>" (alternative Zeitangaben finden sich in der <a class="internal" href="../man.html">Manpage</a> von <a class="internal" href="../at.html">at</a>). Zu guter Letzt erscheint ein Infofenster mit den Details der programmierten Aufnahme. Neben der Bestätigung, dass der Termin erfolgreich gespeichert ist, findet sich auch die zugehörige Jobnummer.</p><p>Es können so beliebig viele Aufnahmetermine erstellt werden. In der Konsole <sup><a href="#source-6">[6]</a></sup> können die programmierten Aufnahmezeitpunkte mit dem Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">atq </pre></div></div><p>nochmals abgefragt werden. Es wird an erster Stelle immer eine Jobnummer ausgegeben, anhand derer sich die geplante Aufnahme auch wieder löschen lässt. Dazu in der Konsole <sup><a href="#source-6">[6]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">atrm &lt;jobnummer&gt; </pre></div></div><p>eingeben.</p><p>Eine leicht abgewandelte Form des Skripts, welches die Aufnahmen mit dem Dateinamenmuster <strong>"Sender-Datum-Uhrzeit".mpg</strong> abspeichert, findet sich im <a class="crosslink post" href="https://forum.ubuntuusers.de/post/1255148/">Forum</a>. Falls die Dateien auch unter Windows verwendet werden sollen, empfiehlt es sich, bei der Zeitangabe darauf zu achten, keine Doppelpunkte im Dateinamen zu verwenden.</p></div><div class="section_1"><h2 id="Alternative-mit-MPlayer-und-TS-Format">Alternative mit MPlayer und .TS-Format<a class="headerlink" href="#Alternative-mit-MPlayer-und-TS-Format">¶</a></h2><p>
Wenn es mit den Aufnahmen Probleme (in Form von Asynchronität zwischen Ton und Bild) gibt, kann alternativ dieses Skript verwendet werden, das die Aufnahme im .<strong>TS</strong>-Format erstellt. Damit sollten keine Bild-Ton-Verschiebungen mehr vorkommen.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">## Author stw0815; revised by Heinrich Schwietering</span>
<span class="c1">## http://forum.ubuntuusers.de/topic/70377/; http://forum.ubuntuusers.de/topic/155644</span>
<span class="nv">MCD</span><span class="o">=</span>/usr/bin/mplayer
<span class="nv">USER</span><span class="o">=</span>~/Videos
zenity --help &gt; /dev/null <span class="o">||</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"Fehler: Du benötigst \"zenity\" um dieses Script nutzen zu können."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nb">test</span> -e <span class="nv">$MCD</span> <span class="o">||</span> <span class="o">{</span> zenity --error --text <span class="s2">"Fehler: Du benötigst \"mplayer\" um dieses Script nutzen zu können."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nb">test</span> ! -e ~/.mplayer/channels.conf <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"~/.mplayer/channels.conf wurde nicht gefunden"</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
<span class="nv">SENDER</span><span class="o">=</span><span class="sb">`</span>cat ~/.mplayer/channels.conf <span class="p">|</span> cut -d <span class="s2">":"</span> -f <span class="m">1</span> <span class="p">|</span> zenity --list --title <span class="s2">"Bitte Sender auswählen"</span> --column <span class="s2">"Sender:"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nb">test</span> <span class="s2">"</span><span class="nv">$SENDER</span><span class="s2">"</span> <span class="o">||</span> <span class="o">{</span> zenity --error --text <span class="s2">"Es wurde kein Sender ausgewählt."</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span> <span class="p">;</span> <span class="o">}</span>
<span class="nv">DAY</span><span class="o">=</span><span class="sb">`</span>zenity --calendar --title <span class="s2">"Aufnahmedatum"</span> --text <span class="s2">"Bitte das Datum der Aufnahme festlegen"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">TIME</span><span class="o">=</span><span class="sb">`</span>zenity --entry --title <span class="s2">"Aufnahmestart (HH.MM)"</span> --text <span class="s2">"Bitte den Startzeitpunkt der Aufnahme festlegen"</span> --entry-text <span class="s2">"</span><span class="k">$(</span>date --date<span class="o">=</span><span class="s2">"30 seconds"</span> +%H.%M<span class="k">)</span><span class="s2">"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">END</span><span class="o">=</span><span class="sb">`</span>zenity --entry --title<span class="o">=</span><span class="s2">"Endzeit"</span> --entry-text<span class="o">=</span><span class="s2">"20.00"</span> --text<span class="o">=</span><span class="s2">"Endzeit im Format HH.MM eingeben."</span><span class="sb">`</span>
<span class="nv">DAY2</span><span class="o">=</span><span class="sb">`</span>zenity --calendar --title <span class="s2">"Ende der Aufnahme"</span> --text <span class="s2">"Wichtig: Bitte den Folgetag angeben, falls die Aufnahmezeit über Mitternacht hinaus geht"</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">FILE</span><span class="o">=</span><span class="sb">`</span>zenity --file-selection --save --confirm-overwrite --title <span class="s2">"Name und Ort zum Speichern auswählen"</span> --filename<span class="o">=</span>/<span class="s2">"</span><span class="nv">$USER</span><span class="s2">"</span>/<span class="s2">"</span><span class="nv">$SENDER</span><span class="s2">"</span>-<span class="s2">"</span><span class="nv">$DAY</span><span class="s2">"</span>-<span class="s2">"</span><span class="nv">$TIME</span><span class="s2">"</span>-<span class="s2">"</span><span class="nv">$END</span><span class="s2">"</span>.TS<span class="sb">`</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">0</span>
<span class="nv">REC</span><span class="o">=</span><span class="s2">"dvb://\"</span><span class="nv">$SENDER</span><span class="s2">\" -dumpstream -dumpfile \"</span><span class="nv">$FILE</span><span class="s2">\""</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$MCD</span><span class="s2"> </span><span class="nv">$REC</span><span class="s2">"</span> <span class="p">|</span> at <span class="nv">$TIME</span> <span class="nv">$DAY</span> <span class="p">&amp;</span>&gt; /tmp/recerror
<span class="nb">test</span> <span class="nv">$?</span> -gt <span class="m">0</span> <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"</span><span class="k">$(</span>cat /tmp/recerror<span class="k">)</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> rm /tmp/recerror <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
<span class="nb">echo</span> <span class="s2">"killall </span><span class="nv">$MCD</span><span class="s2">"</span> <span class="p">|</span> at <span class="nv">$END</span> <span class="nv">$DAY2</span> <span class="p">&amp;</span>&gt; /tmp/recerror1
<span class="nb">test</span> <span class="nv">$?</span> -gt <span class="m">0</span> <span class="o">&amp;&amp;</span> zenity --error --text <span class="s2">"</span><span class="k">$(</span>cat /tmp/recerror1<span class="k">)</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> rm /tmp/recerror1 <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
zenity --info --text <span class="s2">"Sender: </span><span class="nv">$SENDER</span><span class="s2">\nBeginn: </span><span class="nv">$DAY</span><span class="s2">, </span><span class="nv">$TIME</span><span class="s2"> Uhr\nEnde: </span><span class="nv">$DAY2</span><span class="s2">, </span><span class="nv">$END</span><span class="s2"> Uhr, Dateiname: </span><span class="nv">$FILE</span><span class="s2">\n\nStatus: OK\n</span><span class="k">$(</span>cat /tmp/recerror<span class="k">)</span><span class="s2">\n</span><span class="k">$(</span>cat /tmp/recerror1<span class="k">)</span><span class="s2">\n\nTermin mit \"atq\" im Terminal überprüfbar;\nmit \"atrm 'jobnr'\" löschbar!"</span>
<span class="nb">test</span> -e /tmp/recerror <span class="o">&amp;&amp;</span> rm /tmp/recerror
<span class="nb">test</span> -e /tmp/recerror1 <span class="o">&amp;&amp;</span> rm /tmp/recerror1
</pre></div>
</td></tr></table></div><p>Das Skript herunterladen, abspeichern (ggf. die Zeile 5 "<code class="notranslate">USER=~/Videos</code>" zum Speicherort den eigenen Wünschen anpassen, standardmäßig wird  in <strong>/home/"user"/Videos</strong> abgespeichert) und ausführbar machen. In diesem Skript wird statt <a class="internal" href="../mencoder.html">MEncoder</a> das Programm <a class="internal" href="../mplayer.html">MPlayer</a> zum Encodieren und Speichern verwendet, der Stream wird <strong>.TS</strong>-Format (Transport Stream) abgespeichert</p><p>Die Bedienung ist ähnlich einfach. Ggf. gibt es beim Ausführen Fehlermeldung wegen unzulänglicher utf-Kodierungen in Pango, das hat aber keinen Einfluss auf die Gebrauchsfähigkeit des Skriptes. Probleme gibt es allenfalls mit Umlauten in Sendernamen; die sollte man dann in der <strong>channels.conf</strong> entfernen.</p><p>Die Startzeit für die "Sofort-Aufnahme" ist um 30 Sekunden verzögert, damit genügend Zeit bleibt, das Ende der Aufnahme anzugeben - sonst kommt es ggf. zu Meldungen, dass <a class="internal" href="../at.html">at</a>-Jobs, die in der Vergangenheit liegen, nicht angenommen werden können, oder die Ausführung des Jobs wird gleich auf den nächstfolgenden Tag verschoben. Eine leicht abgewandelte Version, bei der statt des Endzeitpunkts/Tages nur die Länge der Aufnahme in Minuten angegeben werden muss, findet sich im <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2092643/">Forum</a>.</p><div class="section_2"><h3 id="Konvertierung-des-TS-Format-in-herkoemmliche-MPEG2-Programm-Streams">Konvertierung des .TS-Format in herkömmliche MPEG2 Programm Streams<a class="headerlink" href="#Konvertierung-des-TS-Format-in-herkoemmliche-MPEG2-Programm-Streams">¶</a></h3><p>
Verarbeitet man die per MPlayer aufgenommenen TS-Dateien in reinem Streamcopy zum Beispiel mit AVIDemux, so sind die resultierenden Dateien in Bild und Ton häufig asynchron. Für rein MPEG2-basierte Aufnahmen (DVB-S / DVB-T / DVB-C) kann es helfen die TS-Dateien vor dem Schneiden in  MPEG2-Dateien zu konvertieren. Dies funktioniert sehr einfach mit diesem Shellskript:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># Parameter 1: TS file</span>
<span class="c1"># Konvertiert DVB-T Transport Stream zu MPEG2 und beseitigt A/V Asynchronität</span>
<span class="c1"># Benötigt installiertes project-x und mplex</span>

<span class="nv">DIR</span><span class="o">=</span><span class="k">$(</span>dirname <span class="nv">$1</span><span class="k">)</span>
<span class="nv">FILENAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="nv">$1</span><span class="k">)</span>
<span class="nv">NAME</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$FILENAME</span><span class="s2">"</span> <span class="p">|</span> cut -d<span class="s1">'.'</span> -f1<span class="sb">`</span>

projectx <span class="nv">$1</span>

<span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$DIR</span><span class="s2">/</span><span class="nv">$NAME</span><span class="s2">.ac3"</span> <span class="o">]</span>
<span class="k">then</span>
	mplex -f <span class="m">8</span> -o <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.mpg <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.ac3 <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.m2v <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.mp2
	rm <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.ac3
<span class="k">else</span>
	mplex -f <span class="m">8</span> -o <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.mpg <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.m2v <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.mp2
<span class="k">fi</span>

rm <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.m2v
rm <span class="nv">$DIR</span>/<span class="nv">$NAME</span>.mp2
rm <span class="nv">$DIR</span>/<span class="s2">"</span><span class="nv">$NAME</span><span class="s2">"</span>_log.txt
</pre></div>
</td></tr></table></div><p>Da das Script ProjectX zum Demuxen benötigt, funktioniert das Ganze leider nur MPEG2-Videos. HDTV-Streams sind in h264 encodet, womit ProjectX nicht zurechtkommt.</p></div><div class="section_2"><h3 id="Time-Shift">"Time-Shift"<a class="headerlink" href="#Time-Shift">¶</a></h3><p>
Da alle MPlayer-Instanzen beim Beenden der Aufnahme abgebrochen werden, kann MPlayer nicht zum unmittelbaren Wiedergeben des aufgezeichneten Streams verwendet werden (bzw. nur bis zum Ende der Aufnahmezeit). Allerdings lässt sich ein "Timeshift" mit MPlayer mit einen kleinen Trick realisieren: statt "<code class="notranslate">mplayer</code>" im Skript eine "Kopie" verwenden; also z.B. <strong>/usr/bin/tvmplayer</strong>. Dieses "Programm" muss natürlich erst erstellt werden, indem man <strong>/usr/bin/mplayer</strong> kopiert und als <strong>/usr/bin/tvmplayer</strong> wieder abspeichert. Damit wird bei Beenden der Aufnahme nicht "<code class="notranslate">mplayer</code>" beendet, sondern nur "<code class="notranslate">tvmplayer</code>", und der MPlayer kann ungestört weiter laufen. Noch komfortabler ist zur Wiedergabe der <a class="internal" href="../mplayer.html#SMPlayer">SMPlayer</a>, der "merkt" sich nämlich auch noch, wo man ggf. stoppt, und fängt bei Neustart an der Stelle wieder an, wo man aufgehört hat zu schauen (greift allerdings auch auf <strong>/usr/bin/mplayer</strong> zurück, deshalb auch da der "Umweg" mit dem "<code class="notranslate">tvmplayer</code>").</p><p>Eine Variante des Skripts, die das sofortige Mischauen optional ermöglicht, findet sich im <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2106026/">Forum</a>.</p></div></div><div class="section_1"><h2 id="Probleme">Probleme<a class="headerlink" href="#Probleme">¶</a></h2><p>
Falls beim Start des Skriptes eine Fehlermeldung der Art "<code class="notranslate">Can't open /var/run/atd.pid to signal atd. No atd running?</code>" erscheint, ist ggf. der Dienst <strong>atd</strong> nicht aktiv; Abhilfe siehe <a class="internal" href="../dienste.html">Dienste</a>. Ggf. akzeptiert das Skript keine Sendernamen mit Leerstellen; hier hilft es, die Sendernamen in der <strong>channels.conf</strong> umzubenennen bzw. die Leerstellen zu entfernen.</p><p>Probleme können auch auftreten, wenn die Werte in der <strong>channels.conf</strong> in folgender Form vorliegen:
</p><pre class="notranslate">arte:482000:I999B8C23D12M16T8G4Y0:T:27500:201:202=DEU,203=FRE:204:0:2:8468:3329:0</pre><p>
Mplayer erkennt dann die Kanäle nicht; es erfolgt keine Aufnahme. Die Kanal-Daten müssen in folgender Form abgespeichert sein:
</p><pre class="notranslate">arte:482000000:INVERSION_AUTO:BANDWIDTH_8_MHZ:FEC_2_3:FEC_1_2:QAM_16:TRANSMISSION_MODE_8K:GUARD_INTERVAL_1_4:HIERARCHY_NONE:201:202:2</pre></div><div class="section_1"><h2 id="Alternativen">Alternativen<a class="headerlink" href="#Alternativen">¶</a></h2><p>
</p><ul><li><p>In <a class="internal" href="../me_tv.html">Me TV</a>  lassen sich TV-Sender über <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Electronic_Program_Guide">EPG</a>-Einträge starten oder Aufnahmen programmieren. </p></li><li><p>Auch in <a class="internal" href="../kaffeine.html#Aufnahme-und-Wiedergabe-von-Sendungen">Kaffeine</a> lassen sich Aufnahmen nach EPG programmieren.</p></li><li><p><a class="internal" href="../tvtr_tv_timer.html">tvtr TV Timer</a> erlaubt zeitgesteuerte DVB-Aufnahmen via Tray-Applet, gleichzeitiges Anschauen ist mit <a class="internal" href="../xine.html">xine</a> vorgesehen.</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../skripte/tv-skript/a/revision/941181.html">Diese Revision</a> wurde am 14. Mai 2017 14:55 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../skripte.html">Skripte</a></li>
<li><a href="../skripte/tv-skript.html">TV-Skript</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>