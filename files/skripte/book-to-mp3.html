<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Skripte/Book-To-MP3 › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../skripte/book-to-mp3.html">Book-To-MP3</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Skripte/Book-To-MP3">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../skripte/book-to-mp3/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../skripte/book-to-mp3/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../skripte/book-to-mp3/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../skripte/book-to-mp3/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../skripte/book-to-mp3/a/backlinks.html">Book-To-MP3</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../paketinstallation_deb.html">Ein einzelnes Paket installieren</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../packprogramme.html">Ein Archiv entpacken</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../rechte.html">Rechte für Dateien und Ordner ändern</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-7" id="source-7"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Voraussetzungen">Voraussetzungen
</a></li><li><a class="crosslink" href="#Stimmen">Stimmen
</a></li></ol></li><li><a class="crosslink" href="#Funktionsweise">Funktionsweise
</a><ol class="arabic"><li><a class="crosslink" href="#Skript">Skript
</a></li></ol></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a></li><li><a class="crosslink" href="#Anpassungen">Anpassungen
</a><ol class="arabic"><li><a class="crosslink" href="#Andere-Stimmen-verwenden">Andere Stimmen verwenden
</a></li><li><a class="crosslink" href="#Weitere-eSpeak-Parameter-verwenden">Weitere eSpeak-Parameter verwenden
</a></li></ol></li><li><a class="crosslink" href="#Direkte-Sprachausgabe">Direkte Sprachausgabe
</a></li><li><a class="crosslink" href="#Alternativen">Alternativen
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Um sich elektronische Dokumente "vorlesen" zu lassen, stehen momentan unter Ubuntu nur wenige Möglichkeiten zur Verfügung. Insbesondere lassen sich meist nur <strong>.txt</strong>-Dateien unmittelbar in "gesprochenen Sprache" umsetzen.</p><p>Das hier vorgestellte <strong>book2mp3.sh</strong> ist ein Skript, das es ermöglicht, eine Vielzahl von Dokumenttypen einfach in <strong>.mp3</strong>-Dateien bzw <strong>.ogg</strong>-Dateien umzuwandeln. Momentan werden die Formate <strong>.pdf</strong>, <strong>.doc</strong>, <strong>.html</strong>, .<strong>htm</strong>, <strong>.rtf</strong>, <strong>.txt</strong>,<strong>.lit</strong> und auch <strong>.epub</strong> unterstützt. Die Ausgabe erfolgt in Mono (kein Stereo). Standardmäßig wird die Aufnahme in handliche Stücke aufgeteilt.</p><p>Wer aus Audio-CDs ein Hörbuch erstellen möchte, kann auf <a class="internal" href="../abcde.html#Hoerbuecher-als-MP3">abcde</a> zurückgreifen.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das Skript kann beim ersten Aufruf die fehlenden Pakete ermitteln und auf Wunsch automatische über <code class="notranslate">apt-get install</code> installieren.
</p></div></div><div class="section_2"><h3 id="Voraussetzungen">Voraussetzungen<a class="headerlink" href="#Voraussetzungen">¶</a></h3><p>
Zuerst müssen folgende Pakete installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>lame</strong> (<em>multiverse</em>)</p></li><li><p><strong>espeak</strong></p></li><li><p><strong>mbrola</strong> (<em>multiverse</em>)</p></li><li><p><strong>mp3splt</strong> (<em>universe</em>, optional)</p></li><li><p><strong>poppler-utils</strong> (für PDF-Dokumente)</p></li><li><p><strong>catdoc</strong> (<em>universe</em>, für <strong>.doc</strong>- und <strong>.rtf</strong>-Dokumente)</p></li><li><p><strong>html2text</strong> (für <strong>.html</strong>-, <strong>.htm</strong>- und <strong>.lit</strong>-Dokumente)</p></li><li><p><strong>convlit</strong> (<em>universe</em>, für <strong>.lit</strong>-Dokumente)</p></li><li><p><strong>vorbis-tools</strong> (<em>multiverse</em>, <strong>.ogg</strong>-Ausgabe)</p></li><li><p><strong>zenity</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install lame espeak mbrola mp3splt poppler-utils catdoc html2text convlit vorbis-tools zenity </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install lame espeak mbrola mp3splt poppler-utils catdoc html2text convlit vorbis-tools zenity </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Stimmen">Stimmen<a class="headerlink" href="#Stimmen">¶</a></h3><p>
Die verwendeten Stimmen liegen in den Paketquellen vor:</p><ul><li><p><strong>mbrola-de6</strong> (<em>multiverse</em>)</p></li><li><p><strong>mbrola-en1</strong> (<em>multiverse</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mbrola-de6 mbrola-en1 </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install mbrola-de6 mbrola-en1 </pre></div></div><p>
</p></div></div></div></div><div class="section_1"><h2 id="Funktionsweise">Funktionsweise<a class="headerlink" href="#Funktionsweise">¶</a></h2><p>
Das Skript ermittelt zunächst den Dateityp und wandelt dann den Inhalt in reinen Text um. Zum Einsatz kommen je nach Dateityp <code class="notranslate">pdftotext</code>, <code class="notranslate">clit</code>, <code class="notranslate">html2text</code> oder <code class="notranslate">catdoc</code>. Außerdem werden eventuell vorhandene Seitenzahlen sowie Formatierungen entfernt, um später den Textfluss nicht zu stören.</p><p>Dieser Text wird daraufhin anhand der verwendeten Artikel (<code class="notranslate">the</code> bzw <code class="notranslate">der</code>) auf die verwendete Sprache überprüft (englisch oder deutsch). Danach wird der Text mit <a class="internal" href="../espeak.html">eSpeak</a> mit der passenden Stimme in Sprache umgesetzt. Die Ausgabe wird mittels <a class="internal" href="../audiodateien_umwandeln.html#lame">lame</a> oder <a class="internal" href="../vorbis.html">oggenc</a> in eine <strong>mp3</strong>- oder <strong>ogg</strong>-Datei umgewandelt, die dann mit <a class="internal" href="../mp3splt.html">mp3splt</a> in handliche Längen unterteilt wird. Das Ergebnis wird im neu erstellten Unterordner <strong>Dateiname</strong> abgelegt.</p><div class="section_2"><h3 id="Skript">Skript<a class="headerlink" href="#Skript">¶</a></h3><p>
Diese Version 1.3 wurde unter Ubuntu 16.10 <a class="internal" href="../xenial_xerus.html">Xenial Xerus</a> getestet und kann heruntergeladen werden: <a class="crosslink" href="../skripte/book-to-mp3.html">book2hb_v1-3.sh</a> <img alt="{dl}" src="../_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/>, nach dem Herunterladen ggf. in <strong>book2mp3.sh</strong> umbenennen.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#Version 1.3</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Umwandeln von Text in Sprache     #</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#</span>
<span class="c1">#Name des Buches</span>
<span class="nv">NAMEOF</span><span class="o">=</span><span class="s2">""</span>
<span class="c1">#Graphischer- oder Konsolenmodus (-n)</span>
<span class="nv">GRAPHIC</span><span class="o">=</span><span class="nb">true</span>
<span class="nv">TXT</span><span class="o">=</span>
<span class="nv">MP3</span><span class="o">=</span><span class="nb">true</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Anzeige des Fortschrittbalkens    #</span>
<span class="c1">#------------------------------------#</span>
spanner<span class="o">(){</span>
<span class="c1">#Starten nach Beginn der Umwandlung</span>
<span class="k">while</span> <span class="o">[</span> <span class="s2">"`pidof mbrola`"</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>
  sleep <span class="m">2</span>.0
<span class="k">done</span>
<span class="c1">#Berechnen der wahrscheinlichen Größe</span>
<span class="nv">ANZW</span><span class="o">=</span><span class="k">$(</span>cat spc.txt <span class="p">|</span> wc -w<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">"Anzahl der Wörter (word count)   : </span><span class="nv">$ANZW</span><span class="s2"> Wörter"</span>
<span class="nv">BEGR</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"scale=5 ; </span><span class="nv">$ANZW</span><span class="s2">*3.5"</span> <span class="p">|</span> bc<span class="k">)</span>
<span class="nv">PROC</span><span class="o">=</span><span class="nv">$1</span><span class="p">;</span><span class="nv">COUNT</span><span class="o">=</span><span class="m">0</span>
<span class="nv">DGR2</span><span class="o">=</span><span class="m">0</span>
<span class="c1">#Graphischer Fortschrittsbalken</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">BEGR</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"scale=5 ; </span><span class="nv">$ANZW</span><span class="s2">*3.36"</span> <span class="p">|</span> bc<span class="k">)</span>
  <span class="nb">echo</span> <span class="s2">"Geschätzte Größe  (mp3 size)     : </span><span class="nv">$BEGR</span><span class="s2"> kB"</span>
  <span class="nv">ENDUNG</span><span class="o">=</span><span class="s2">"mp3"</span>
<span class="k">else</span>
  <span class="nv">BEGR</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"scale=5 ; </span><span class="nv">$ANZW</span><span class="s2">*1.92"</span> <span class="p">|</span> bc<span class="k">)</span>
  <span class="nb">echo</span> <span class="s2">"Geschätzte Größe  (ogg size)     : </span><span class="nv">$BEGR</span><span class="s2"> kB"</span>
  <span class="nv">ENDUNG</span><span class="o">=</span><span class="s2">"ogg"</span>
<span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="o">(</span>
  <span class="k">while</span> <span class="o">([</span> <span class="s2">"`pidof mbrola`"</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="nv">$COUNT</span> -le <span class="m">2</span> <span class="o">])</span><span class="p">;</span><span class="k">do</span>
    <span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.</span><span class="nv">$ENDUNG</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">DGR</span><span class="o">=</span><span class="k">$(</span>du <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.</span><span class="nv">$ENDUNG</span><span class="s2">"</span> <span class="p">|</span> cut -f <span class="m">1</span><span class="k">)</span>
      sleep <span class="m">3</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$DGR2</span> -ge <span class="nv">$DGR</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">COUNT</span><span class="o">=</span><span class="m">3</span>
      <span class="k">else</span>
        <span class="nv">PROZ</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"scale=0 ; </span><span class="nv">$DGR</span><span class="s2">*100/</span><span class="nv">$BEGR</span><span class="s2">"</span> <span class="p">|</span> bc<span class="k">)</span>
        <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$PROZ</span><span class="s2">"</span>
        <span class="nb">echo</span> <span class="s2">"# Hörbuch wird erzeugt: </span><span class="nv">$PROZ</span><span class="s2">%"</span>
      <span class="k">fi</span>
      <span class="nv">DGR2</span><span class="o">=</span><span class="nv">$DGR</span>
    <span class="k">else</span>
      <span class="nv">COUNT</span><span class="o">=</span><span class="m">3</span>
    <span class="k">fi</span>
  <span class="k">done</span>  
  <span class="o">)</span> <span class="p">|</span> zenity --progress --text <span class="s2">"Hörbuch wird erzeugt"</span><span class="se">\</span>
   --title  <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span> --auto-close --no-cancel --percentage<span class="o">=</span><span class="m">0</span>
<span class="c1">#Text Fortschrittsbalken</span>
<span class="k">else</span>
  <span class="nb">echo</span> -n <span class="s2">"      "</span>
  <span class="k">while</span> <span class="o">([</span> <span class="s2">"`pidof mbrola`"</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="nv">$COUNT</span> -le <span class="m">2</span> <span class="o">])</span><span class="p">;</span><span class="k">do</span>
    <span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.</span><span class="nv">$ENDUNG</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">DGR</span><span class="o">=</span><span class="k">$(</span>du <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.</span><span class="nv">$ENDUNG</span><span class="s2">"</span> <span class="p">|</span> cut -f <span class="m">1</span><span class="k">)</span>
      sleep <span class="m">3</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$DGR2</span> -ge <span class="nv">$DGR</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">COUNT</span><span class="o">=</span><span class="m">3</span>
      <span class="k">else</span>
        <span class="nv">PROZ</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"scale=0 ; </span><span class="nv">$DGR</span><span class="s2">*100/</span><span class="nv">$BEGR</span><span class="s2">"</span> <span class="p">|</span> bc<span class="k">)</span>
        <span class="nb">echo</span> -n -e <span class="s2">"\010\010\010\010\010\010\010\010\010\010\010\010\010"</span>
        <span class="nb">echo</span> -n -e <span class="s2">"\010\010\010\010\010\010\010\010\010\010\010\010\010"</span>
        <span class="nb">echo</span> -n <span class="s2">"</span><span class="nv">$PROZ</span><span class="s2"> %     "</span>
      <span class="k">fi</span>
    <span class="nv">DGR2</span><span class="o">=</span><span class="nv">$DGR</span>
    <span class="k">else</span>
      <span class="nv">COUNT</span><span class="o">=</span><span class="m">3</span>
    <span class="k">fi</span>
  <span class="k">done</span>
<span class="k">fi</span>
<span class="o">}</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Überprüfen der ext. Anwendunggen  #</span>
<span class="c1">#------------------------------------#</span>
<span class="nv">CHECK</span><span class="o">=</span>
checkdep<span class="o">(){</span>
  <span class="k">for</span> QUELLE in <span class="nv">$*</span><span class="p">;</span> <span class="k">do</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"`whereis </span><span class="nv">$QUELLE</span><span class="s2"> | grep /`"</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">CHECK</span><span class="o">=</span><span class="nb">true</span>
    <span class="k">fi</span>
  <span class="k">done</span>
<span class="o">}</span>
<span class="c1">#------------------------------------#</span>
<span class="c1"># Installiert externe Abhängigkeiten #</span>
<span class="c1">#------------------------------------#</span>
instdep<span class="o">(){</span>
  checkdep <span class="s2">"`echo </span><span class="nv">$*</span><span class="s2"> | sed 's/mbrola-de6 mbrola-en1//g'`"</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$CHECK</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">PAKETE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$*</span> <span class="p">|</span> sed <span class="s1">'s/pdftotext/poppler-utils/g'</span> <span class="p">|</span> sed <span class="s1">'s/clit/convlit/g'</span> <span class="p">|</span> sed <span class="se">\</span>
     <span class="s1">'s/oggenc/vorbis-tools/g'</span><span class="sb">`</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      <span class="k">if</span> <span class="o">[</span> <span class="s2">"`whereis gksudo | grep /`"</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        gksudo apt-get -y install <span class="nv">$PAKETE</span> <span class="p">|</span> zenity --progress  --pulsate <span class="se">\</span>
         --auto-close --no-cancel <span class="se">\</span>
         --text <span class="s2">"Zusätzliche Quellen installieren:\n </span><span class="nv">$PAKETE</span><span class="s2">"</span> --title  <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span>
      <span class="k">else</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">"`whereis kdesudo | grep /`"</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
          kdesudo apt-get -y install <span class="nv">$PAKETE</span> <span class="p">|</span> zenity --progress <span class="se">\</span>
           --pulsate --auto-close --no-cancel <span class="se">\</span>
           --text <span class="s2">"Zusätzliche Quellen installieren:\n </span><span class="nv">$PAKETE</span><span class="s2">"</span> --title  <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span>
        <span class="k">else</span> 
          zenity --warning --text <span class="s2">"gksudo und kdesudo nicht gefunden\</span>
<span class="s2">           Bitte ext. Quellen manuell intallieren oder \"book2mp3 -n\" (Konsole) verwenden"</span>
          <span class="nb">exit</span> <span class="m">1</span>
        <span class="k">fi</span>
      <span class="k">fi</span>
    <span class="k">else</span>
      sudo apt-get install <span class="nv">$PAKETE</span>
    <span class="k">fi</span>
  <span class="k">fi</span>
  <span class="nv">CHECK</span><span class="o">=</span>
  checkdep <span class="s2">"`echo </span><span class="nv">$*</span><span class="s2"> | sed 's/mbrola-de6 mbrola-en1//g'`"</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$CHECK</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      zenity --warning --text <span class="s2">"Bitte ext. Quellen: </span><span class="nv">$*</span><span class="s2"> \n manuell intallieren"</span>
    <span class="k">else</span>
      <span class="nb">echo</span> <span class="s2">"Bitte ext. Quellen: </span><span class="nv">$*</span><span class="s2"> \n manuell intallieren"</span>
    <span class="k">fi</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">else</span>
    <span class="c1">#Prüfen ob mbrola Stimmen installiert sind</span>
    <span class="k">if</span> <span class="o">(</span> <span class="o">[</span> ! -f <span class="s2">"/usr/share/mbrola/de6"</span> <span class="o">]</span> <span class="se">\</span>
     <span class="o">&amp;&amp;</span> <span class="o">[</span> ! -f <span class="s2">"/usr/share/mbrola/de6/de6"</span> <span class="o">]</span> <span class="o">)</span>
    <span class="k">then</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        zenity --warning --text <span class="s2">"/usr/share/mbrola/ Deutsche Stimmen nicht gefunden"</span>
      <span class="k">else</span> 
        <span class="nb">echo</span> <span class="s2">"/usr/share/mbrola/ Deutsche Stimmen nicht gefunden"</span>
      <span class="k">fi</span>
      <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">fi</span>
    <span class="k">if</span> <span class="o">(</span> <span class="o">[</span> ! -f <span class="s2">"/usr/share/mbrola/en1"</span> <span class="o">]</span> <span class="se">\</span>
     <span class="o">&amp;&amp;</span> <span class="o">[</span> ! -f <span class="s2">"/usr/share/mbrola/en1/en1"</span> <span class="o">]</span> <span class="o">)</span>
    <span class="k">then</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        zenity --warning --text <span class="s2">"/usr/share/mbrola/ Englische Stimmen nicht gefunden"</span>
      <span class="k">else</span> 
        <span class="nb">echo</span> <span class="s2">"/usr/share/mbrola/ Englische Stimmen nicht gefunden"</span>
      <span class="k">fi</span>
      <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">fi</span>    
  <span class="k">fi</span>  
  <span class="nv">CHECK</span><span class="o">=</span>
<span class="o">}</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Parameter Behandlung              #</span>
<span class="c1">#------------------------------------#</span>
<span class="k">while</span> <span class="nb">getopts</span> hntTo opt
<span class="k">do</span>
  <span class="k">case</span> <span class="s2">"</span><span class="nv">$opt</span><span class="s2">"</span> in
    h<span class="o">)</span>            <span class="nb">echo</span> <span class="s2">"book2mp3 -n -o -t -T &lt;pdf, doc, html, htm, rtf, txt or lit file&gt;"</span><span class="p">;</span><span class="se">\</span>
    <span class="nb">echo</span> <span class="s2">"-n nur console modus"</span> <span class="p">;</span><span class="nb">echo</span> <span class="s2">"-t txt Datei erzeugen"</span> <span class="p">;</span><span class="nb">echo</span> <span class="s2">"-T nur die txt Datei\</span>
<span class="s2">     erzeugen"</span> <span class="p">;</span><span class="nb">echo</span> <span class="s2">"-o ogg statt mp3 ausgeben erzeugen"</span> <span class="p">;</span><span class="nb">exit</span> <span class="m">1</span><span class="p">;;</span>
    n<span class="o">)</span>            <span class="nv">GRAPHIC</span><span class="o">=</span><span class="p">;;</span>
    t<span class="o">)</span>            <span class="nv">TXT</span><span class="o">=</span>true<span class="p">;;</span>
    T<span class="o">)</span>            <span class="nv">TXT</span><span class="o">=</span><span class="s2">"only"</span><span class="p">;;</span>
    o<span class="o">)</span>            <span class="nv">MP3</span><span class="o">=</span><span class="p">;;</span>
    <span class="se">\?</span><span class="o">)</span> <span class="nb">exit</span> <span class="m">1</span><span class="p">;;</span>
  <span class="k">esac</span>
<span class="k">done</span>
<span class="nb">shift</span> <span class="k">$((</span><span class="nv">$OPTIND</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">SOURCE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span>
  <span class="nb">shift</span>
<span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  instdep lame espeak mbrola mp3splt mbrola-de6 mbrola-en1
<span class="k">else</span>
  instdep oggenc espeak mbrola mp3splt mbrola-de6 mbrola-en1
<span class="k">fi</span>
<span class="c1">#Hauptabhängigkeiten prüfen</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Parameter Behandlung Dateiauswahl #</span>
<span class="c1">#------------------------------------#</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> <span class="o">=</span>  <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> ! <span class="nv">NAME</span><span class="o">=</span><span class="k">$(</span>zenity --file-selection --file-filter<span class="o">=</span><span class="s2">"Buecher | *.pdf *.doc *.html \</span>
<span class="s2">    *.htm *.rtf *.txt *.lit *.epub"</span> --text <span class="s2">"Bitte geben Sie den Dateipfad des Buches\</span>
<span class="s2">     ein:"</span> --title <span class="s2">"Bitte eBook auswählen"</span><span class="k">)</span><span class="p">;</span> <span class="k">then</span>
      <span class="nb">exit</span>
    <span class="k">fi</span>
    <span class="nv">SOURCE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$NAME</span><span class="s2">"</span>
  <span class="k">fi</span>
<span class="k">else</span>  
  <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> <span class="o">=</span>  <span class="s2">""</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">fi</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  spez. Buchtyp in Text umwandeln   #</span>
<span class="c1">#------------------------------------#</span>
<span class="nv">ENDOFF</span><span class="o">=</span><span class="si">${</span><span class="nv">SOURCE</span><span class="p">##*.</span><span class="si">}</span>
<span class="nv">DIROF</span><span class="o">=</span><span class="k">$(</span>dirname <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$DIROF</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"."</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
  <span class="nv">DIROF</span><span class="o">=</span><span class="s2">"`pwd`"</span>
<span class="k">fi</span>
<span class="nv">NAMEOF</span><span class="o">=</span><span class="k">$(</span> basename <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> <span class="p">|</span> sed <span class="s1">'s/\.[^\.]\{1,\}$//g'</span> <span class="k">)</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
<span class="nv">SOURCE</span><span class="o">=</span><span class="s2">"`echo "</span><span class="nv">$DIROF</span>/<span class="nv">$NAMEOF</span>.<span class="nv">$ENDOFF</span><span class="s2">"`"</span>
<span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">cd</span> <span class="s2">"</span><span class="nv">$DIROF</span><span class="s2">"</span>
  mkdir tmp
  <span class="nb">cd</span> tmp
  <span class="nv">ENDOFFLOW</span><span class="o">=</span><span class="k">$(</span> <span class="nb">echo</span> <span class="nv">$ENDOFF</span> <span class="p">|</span> tr <span class="s2">"'[:upper:]'"</span> <span class="s2">"'[:lower:]'"</span> <span class="k">)</span>
  <span class="nb">echo</span> <span class="s2">"Dateityp: </span><span class="nv">$ENDOFFLOW</span><span class="s2"> umwandeln."</span>
<span class="k">else</span>
  <span class="nb">echo</span> keine Datei
  <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
<span class="k">case</span> <span class="nv">$ENDOFFLOW</span> in
  pdf<span class="o">)</span>            instdep pdftotext<span class="p">;</span>pdftotext <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> sp.txt<span class="p">;;</span>
  lit<span class="o">)</span>            instdep clit<span class="p">;</span>clit <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> .<span class="p">;</span>html2text -utf8 *.htm* &gt; sp.txt<span class="p">;;</span>
  txt<span class="o">)</span>            cp <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> sp.txt<span class="p">;;</span>
  htm<span class="o">)</span>            instdep <span class="p">;</span>html2text -utf8 <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> &gt; sp.txt<span class="p">;;</span>
  html<span class="o">)</span>           instdep <span class="p">;</span>html2text -utf8 <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> &gt; sp.txt<span class="p">;;</span>
  rtf<span class="o">)</span>            instdep catdoc<span class="p">;</span>catdoc <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> &gt; sp.txt<span class="p">;;</span>
  doc<span class="o">)</span>            instdep catdoc<span class="p">;</span>catdoc <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> &gt; sp.txt<span class="p">;;</span>
  epub<span class="o">)</span>           instdep unzip<span class="p">;</span>unzip -qq -j <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span><span class="p">;</span>html2text -utf8 *.htm* &gt; sp.txt<span class="p">;;</span>
  <span class="se">\?</span><span class="o">)</span> <span class="nb">echo</span> <span class="s2">"Dateityp </span><span class="nv">$ENDOFFLOW</span><span class="s2"> unbekannt. Beende Verarbeitung."</span><span class="p">;</span><span class="nb">exit</span> <span class="m">1</span><span class="p">;;</span>
<span class="k">esac</span>
<span class="c1">#-------------------------------------------#</span>
<span class="c1">#  Formatierung und Filter von Rückständen  #</span>
<span class="c1">#-------------------------------------------#</span>
<span class="nb">echo</span> <span class="s2">"Löschen der Seitennummern und Formatierung des Textes"</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
<span class="c1"># löschen von Seitennummern</span>
sed -e <span class="s1">'s/^[ »«\.,":\!\?+-0123456789]*$|^[ »«\.,":\!\?+-0123456789]*[Ss]eite[ »«\.,":\!\?+-0123456789]*$|^[ »«\.,":\!\?+-0123456789]*[Pp]age[ »«\.,":\!\?+-0123456789]*$//g'</span> sp.txt &gt; spc.txt
sed -e <span class="s1">'s/[^ A-Za-z0-9!@&amp;\(\)\\\/\.\,\&lt;\&gt;\?+=-]//g'</span> spc.txt &gt; sp.txt
<span class="c1">#reste von xml entfernen</span>
sed -e <span class="s1">'s/&lt;?.*?&gt;//g'</span> sp.txt &gt; spc.txt
sed -e <span class="s1">'s/&lt;?.*$//g'</span> spc.txt &gt; sp.txt
sed -e <span class="s1">'s/^.*?&gt;//g'</span> sp.txt &gt; spc.txt
<span class="c1">#url entfernen</span>
sed -e <span class="s1">'s/\(http\|https\|ftp\)\{0,1\}:\{0,1\}\(\/\)\{0,2\}\(www\)\{0,1\}\.\{0,1\}[A-Za-z0-9!@&amp;\.\?+=-]\{1,\}\.\(HTM\|HTML\|htm\|html\|com\|org\|net\|mil\|edu\|COM\|ORG\|NET\|MIL\|EDU\|de\|DE\|org\|ORG\)\{1,1\}[A-Za-z0-9!@&amp;\(\)\\\/\.\,\&lt;\&gt;\?+=-]\{0,\}//g'</span> spc.txt &gt; sp.txt
<span class="c1">#zeilen mit zahlen entfernen</span>
sed -e <span class="s1">'s/^[ 0-9!@&amp;\(\)\\\/\.\,\&lt;\&gt;\?+=-]\{0,\}$//g'</span> sp.txt &gt; spc.txt

<span class="c1">#cat sp1.txt | tr -c '[:alnum:].,!?äöüÄÖÜß\n' ' ' &gt; spc.txt</span>
<span class="c1">#exit</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  ermitteln der Sprache des Buches  #</span>
<span class="c1">#------------------------------------#</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$TXT</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  cp spc.txt <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.txt"</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$TXT</span> <span class="o">=</span> <span class="s2">"only"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">cd</span> ..
    rm tmp/*
    rmdir tmp
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">fi</span>
<span class="nv">ENTXT</span><span class="o">=</span><span class="k">$(</span>cat spc.txt <span class="p">|</span> grep -c <span class="s2">" the "</span><span class="k">)</span>
<span class="nv">DETXT</span><span class="o">=</span><span class="k">$(</span>cat spc.txt <span class="p">|</span> grep -c <span class="s2">" der "</span><span class="k">)</span>
<span class="nb">echo</span> <span class="s2">"Artikelzahl (article count):       en </span><span class="nv">$ENTXT</span><span class="s2"> : de </span><span class="nv">$DETXT</span><span class="s2">"</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
spanner <span class="p">&amp;</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Umwandlung:   Text in Sprache     #</span>
<span class="c1">#------------------------------------#</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$ENTXT</span> -le <span class="nv">$DETXT</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    espeak -p <span class="m">42</span> -s <span class="m">150</span> -v mb-de6 -f spc.txt --stdout <span class="p">|</span> lame --tt <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span><span class="se">\</span>
     --ta Hoerbuch -b <span class="m">16</span> -h -V2 - <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span>
  <span class="k">else</span>
    espeak -p <span class="m">42</span> -s <span class="m">150</span> -v mb-de6 -f spc.txt --stdout <span class="p">|</span> oggenc -t <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span><span class="se">\</span>
     -a Hoerbuch -q <span class="m">3</span> -o <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span> -
  <span class="k">fi</span>
<span class="k">else</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    espeak -p <span class="m">42</span> -s <span class="m">130</span> -v mb-en1 -f spc.txt --stdout <span class="p">|</span> lame --tt <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span><span class="se">\</span>
     --ta Audiobook -b <span class="m">16</span> -h -V2 - <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span>
  <span class="k">else</span>
    espeak -p <span class="m">42</span> -s <span class="m">150</span> -v mb-de6 -f spc.txt --stdout <span class="p">|</span> oggenc -t <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span><span class="se">\</span>
     -a Hoerbuch -q <span class="m">3</span> -o <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span> -
  <span class="k">fi</span>
<span class="k">fi</span>
<span class="nb">cd</span> ..
rm tmp/*
rmdir tmp
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Aufteilen der MP3/OGG-Datei           #</span>
<span class="c1">#------------------------------------#</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
<span class="nv">BNR</span><span class="o">=</span><span class="k">$(</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">"</span> <span class="p">|</span> sed <span class="s1">'s/[^0123456789]*//g'</span> <span class="k">)</span>
<span class="nb">echo</span> <span class="s2">"Starten des audio-Splittens"</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$GRAPHIC</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="k">if</span> ! zenity --question --text <span class="s2">"Hörbuch in 15 min Teile\naufsplitten?"</span><span class="p">;</span> <span class="k">then</span>
    exit<span class="p">;</span>
  <span class="k">else</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      mp3splt -q -O <span class="m">0</span>.4 -t <span class="m">15</span>.0 -d <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span> -o track_<span class="s2">"</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="s2">_</span><span class="nv">$BNR</span><span class="s2">"</span>_@N <span class="se">\</span>
       <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span> <span class="p">|</span> zenity --progress  --pulsate --auto-close --no-cancel <span class="se">\</span>
       --text <span class="s2">"Hörbuch splitten ..."</span> --title  <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span>
       rm <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span>
    <span class="k">else</span>
      oggsplt -q -O <span class="m">0</span>.4 -t <span class="m">15</span>.0 -d <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span> -o track_<span class="s2">"</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="s2">_</span><span class="nv">$BNR</span><span class="s2">"</span>_@N <span class="se">\</span>
       <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span> <span class="p">|</span> zenity --progress  --pulsate --auto-close --no-cancel <span class="se">\</span>
       --text <span class="s2">"Hörbuch splitten ..."</span> --title  <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span>
       rm <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span>
    <span class="k">fi</span>
  <span class="k">fi</span>
<span class="k">else</span>
  <span class="c1"># nachfolgende Zeilen auskommentieren falls nur eine große mp3-Datei erwünscht ist</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$MP3</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    mp3splt -q -O <span class="m">0</span>.4 -t <span class="m">15</span>.0 -d <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span> -o track_<span class="s2">"</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="s2">_</span><span class="nv">$BNR</span><span class="s2">"</span>_@N <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span>
    <span class="c1"># auskommentieren falls auch eine große mp3-Datei erwünscht ist</span>
    rm <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.mp3"</span>
  <span class="k">else</span>
    oggsplt -q -O <span class="m">0</span>.4 -t <span class="m">15</span>.0 -d <span class="s2">"</span><span class="nv">$NAMEOF</span><span class="s2">"</span> -o track_<span class="s2">"</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="s2">_</span><span class="nv">$BNR</span><span class="s2">"</span>_@N <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span>
    <span class="c1"># auskommentieren falls auch eine große mp3-Datei erwünscht ist</span>
    rm <span class="s2">"</span><span class="nv">$SOURCE</span><span class="s2">.ogg"</span>
  <span class="k">fi</span> 
<span class="k">fi</span>
<span class="nb">echo</span> -e <span class="s2">"\033\01330;34m------------------------------------------------------------\033\01330m"</span>
<span class="nb">echo</span> Fertig.
<span class="nb">exit</span> <span class="m">0</span>
</pre></div>
</td></tr></table></div></div></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
Um das Skript systemweit nutzen zu können, ohne jeweils den Pfad dazu einsetzen zu müssen, empfiehlt es sich, es mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> nach <strong>/usr/local/bin/</strong> zu kopieren und die Rechte <sup><a href="#source-5">[5]</a></sup> zum Ausführen korrekt zu setzen. Die Endung <strong>.sh</strong> kann dabei auch entfernt werden.</p><p><img alt="erzeugen.jpg" class="image-right" src="../_/79dcff95f5f479d942739d2d0d40550905b100a8.jpg"/>
Der Aufruf erfolgt dann im Terminal <sup><a href="#source-6">[6]</a></sup> über</p><div class="bash"><div class="contents"><pre class="notranslate">book2mp3.sh [OPTIONEN] [Datei.pdf, -.doc, -.html, -.htm, -.rtf, -.txt, -.lit, -.epub] </pre></div></div><p>Ohne Option oder Dateiangabe öffnet sich ein Auswahldialog/Dateibrowserfenster, in dem alle Dateien der unterstützten Formate angezeigt werden, dort kann die gewünschte Datei ausgewählt werden. Sie wird dann direkt umgewandelt, auf Wunsch kann die Ausgabedatei gleich auch auf 15-min-Teile aufgesplittet werden.
<img alt="frage.jpg" class="image-right" src="../_/89248a76d60e0b6de43a2acce48bb3fb2ce3c671.jpg"/>
Verwendbare Optionen sind</p><ul><li><p>Parameter <code class="notranslate">-o</code> für ogg-Vorbis-ausgabe (statt <strong>mp3</strong>)</p></li><li><p>Parameter <code class="notranslate">-t</code> erstellt zusätzlich eine Text-Version des Buches und <code class="notranslate">-T</code> erstellt ausschließlich das Textdokument</p></li><li><p>Parameter <code class="notranslate">-n</code> Kommandozeilen-Modus</p></li></ul><p>
Beispiel:</p><div class="bash"><div class="contents"><pre class="notranslate">book2mp3.sh "/home/niemand/Homer - Odyssee.pdf" </pre></div></div></div><div class="section_1"><h2 id="Anpassungen">Anpassungen<a class="headerlink" href="#Anpassungen">¶</a></h2><p>
Um die Länge der gesplitteten <strong>mp3</strong>-Dateien festzulegen, kann in einem Editor<sup><a href="#source-7">[7]</a></sup> in den Zeilen</p><pre class="notranslate">mp3splt -q -O 0.4 -t 15.0 -d "$NAMEOF" -o track_"$(date +%s)_$BNR"_@N "$SOURCE.mp3"</pre><p>der Wert <code class="notranslate">-t</code> angepasst werden, die erste Zahl steht für die Minuten, die zweite für die Sekunden. <code class="notranslate">-t 5.30</code> würde also eine 5 1/2 Minuten lange <strong>.mp3</strong>-Dateien erzeugen.</p><div class="section_2"><h3 id="Andere-Stimmen-verwenden">Andere Stimmen verwenden<a class="headerlink" href="#Andere-Stimmen-verwenden">¶</a></h3><p>
Grunsätzlich lassen sich alle Stimme einsetzen, die auch unter <a class="internal" href="../espeak.html">eSpeak</a> verwendbar sind, also auch weitere <a class="external" href="http://tcts.fpms.ac.be/synthesis/mbrola/mbrcopybin.html" rel="nofollow">mbrola-Stimmen</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>. Dazu müssen in den eSpeak-Kommado-Zeilen (neue Version)</p><pre class="notranslate">espeak -p 42 -s 150 -v mb-de6 -f spc.txt --stdout | lame --tt "$NAMEOF" --ta Hoerbuch -b 16 -h -V2 - "$SOURCE.mp3"</pre><p>bzw.</p><pre class="notranslate">espeak -p 42 -s 130 -v mb-en1 -f spc.txt --stdout | lame --tt "$NAMEOF" --ta Audiobook -b 16 -h -V2 - "$SOURCE.mp3"</pre><p>hinter der Option <code class="notranslate">-v</code> die entsprechenden Namen angegeben werden.</p></div><div class="section_2"><h3 id="Weitere-eSpeak-Parameter-verwenden">Weitere eSpeak-Parameter verwenden<a class="headerlink" href="#Weitere-eSpeak-Parameter-verwenden">¶</a></h3><p>
Die Stimmen lassen sich durch Veränderung der verwendeten bzw. Einsatz weiterer <a class="internal" href="../espeak.html#Optionen">eSpeak-Optionen</a> auch an die eigenen Bedürfnisse anpassen, so z.B. in der Geschwindigkeit, der Tonhöhe, Lautstärke oder Pausenlänge zwischen den Wörtern. Dazu müssen in den angegebene Zeilen die Optionen verändert bzw. ergänzt werden.</p></div></div><div class="section_1"><h2 id="Direkte-Sprachausgabe">Direkte Sprachausgabe<a class="headerlink" href="#Direkte-Sprachausgabe">¶</a></h2><p>
Um Textdateien oder Text direkt wiederzugeben kann das hier folgende kleine Skript verwendet werden.</p><p>Beispiel:</p><p><code class="notranslate">./sayit.sh "Hallo Welt"</code></p><p>oder</p><p><code class="notranslate">./sayit.sh "hallo_welt.txt</code></p><p>Auch dieses Skript kann wie oben beschrieben nach <strong>/usr/local/bin/</strong> kopiert werden.</p><p>Das fertige Skript <a class="crosslink" href="../skripte/book-to-mp3.html">sayit.sh</a> <img alt="{dl}" src="../_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> kann auch heruntergeladen werden.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#clear</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#  Umwandeln von Text in Sprache     #</span>
<span class="c1">#------------------------------------#</span>
<span class="c1">#------------------------------------#</span>
<span class="k">if</span> <span class="o">[</span> -f <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">]</span>
<span class="k">then</span>
  <span class="nv">TEXT</span><span class="o">=</span><span class="s2">"</span><span class="k">$(</span> cat <span class="nv">$*</span> <span class="k">)</span><span class="s2">"</span>
<span class="k">else</span>
  <span class="nv">TEXT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span>
<span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="k">$(</span> pidof espeak <span class="k">)</span><span class="s2">"</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">"Zu viele Instanzen"</span>
<span class="k">else</span>
  <span class="nv">ENTXT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$TEXT</span><span class="s2">"</span> <span class="p">|</span> grep -c <span class="s2">" the "</span><span class="k">)</span>
  <span class="nv">DETXT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$TEXT</span><span class="s2">"</span> <span class="p">|</span> grep -c <span class="s2">" der "</span><span class="k">)</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$ENTXT</span> -le <span class="nv">$DETXT</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">TEXT</span><span class="o">=</span><span class="k">$(</span> <span class="nb">echo</span> <span class="nv">$TEXT</span> <span class="p">|</span> sed <span class="s1">'s/-/ minus /g'</span>  <span class="p">|</span> sed <span class="s1">'s/\// släsch /g'</span> <span class="p">|</span> sed <span class="s1">'s/:/ Doppelpunkt /g'</span> <span class="p">|</span> sed <span class="s1">'s/[&lt;&gt;]/ /g'</span> <span class="k">)</span>
    espeak -p <span class="m">38</span> -s <span class="m">150</span> -v mb-de6 <span class="s2">"</span><span class="nv">$TEXT</span><span class="s2">"</span> <span class="m">2</span>&gt; /dev/null
  <span class="k">else</span>
    <span class="nv">TEXT</span><span class="o">=</span><span class="k">$(</span> <span class="nb">echo</span> <span class="nv">$TEXT</span> <span class="p">|</span> sed <span class="s1">'s/-/ minus /g'</span> <span class="p">|</span> sed <span class="s1">'s/\// slash /g'</span> <span class="p">|</span> sed <span class="s1">'s/:/ double dot /g'</span> <span class="p">|</span> sed <span class="s1">'s/[&lt;&gt;]/ /g'</span> <span class="k">)</span>
    espeak -p <span class="m">38</span> -s <span class="m">130</span> -v mb-en1 <span class="s2">"</span><span class="nv">$TEXT</span><span class="s2">"</span> <span class="m">2</span>&gt; /dev/null
  <span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</td></tr></table></div></div><div class="section_1"><h2 id="Alternativen">Alternativen<a class="headerlink" href="#Alternativen">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="../sprachausgabe.html">Sprachausgabe</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Übersichtsseite</p></li><li><p><a class="internal" href="../abtool.html">abtool</a> - Weiterentwicklung mit weiteren Möglichkeiten</p></li><li><p><a class="internal" href="../gespeaker.html">Gespeaker</a> - die Stimmen sind einfacher zu konfigurieren, kann allerdings nur <strong>.txt</strong> in <strong>.wav</strong> umwandeln</p></li><li><p><a class="internal" href="../skripte/pdf2mp3.html">Skripte/pdf2mp3</a> -  <a class="internal" href="../python.html">Python</a>-Skript, das <a class="internal" href="../pdf.html">PDF</a>- und ASCII-Vorlagen in <strong>.mp3</strong>- oder <strong>.wav</strong>-Dateien umwandelt.</p></li><li><p><a class="internal" href="../kmouth.html">KMouth</a> -  KDE-Programm zur Stimmausgabe</p></li><li><p><a class="internal" href="../playitslowly.html">PlayItSlowly</a> kann zur Wiedergabe der <strong>mp3</strong>-Dateien verwendet werden, um dort auch während der Laufzeit Anpassungen an Tonhöhe und Geschwindigkeit vorzunehmen</p></li></ul><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="crosslink post" href="https://forum.ubuntuusers.de/post/2327762/">Direkte Wiedergabe</a>, Verwendung des Skriptes über <a class="internal" href="../nautilus-actions.html">Nautilus</a>-Kontexmenü mit <code class="notranslate">aplay</code> (ALSA)</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../skripte/book-to-mp3/a/revision/941313.html">Diese Revision</a> wurde am 16. Mai 2017 09:57 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../skripte.html">Skripte</a></li>
<li><a href="../skripte/book-to-mp3.html">Book-To-MP3</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>