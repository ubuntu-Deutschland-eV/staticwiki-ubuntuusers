<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Apache/mod_geoip2 › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../apache/mod_geoip2.html">mod geoip2</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Apache/mod_geoip2">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../apache/mod_geoip2/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../apache/mod_geoip2/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../apache/mod_geoip2/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../apache/mod_geoip2/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../apache/mod_geoip2/a/backlinks.html">mod geoip2</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../editor.html">Einen Editor verwenden</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Vorbereitung">Vorbereitung
</a></li><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Kontrolle">Kontrolle
</a></li><li><a class="crosslink" href="#Problembehandlung">Problembehandlung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Dieser Artikel beschränkt sich auf die Sicherung des Webservers <a class="internal" href="../apache.html">Apache</a> durch das Modul <a class="external" href="http://dev.maxmind.com/geoip/mod_geoip2" rel="nofollow">mod_geoip2</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>. Einen übergeordneten Artikel findet man im Wiki unter <a class="internal" href="../apache/sicherheit.html">Apache/Sicherheit</a>.</p><p>mod_geoip2 ist ein Modul, welches die Suche nach dem Land, aus dem eine Web-Anfrage stammt, ermöglicht. Es nutzt die Bibliothek und Datenbank GeoIP, um eine Suche durchzuführen. Das Modul ermöglicht die Bearbeitung der Clientzugriffe basierend auf ihrem Ursprungsland. Ursprungsländer werden anhand ihrer <a class="external" href="https://www.maxmind.com/en/iso3166" rel="nofollow">Ländercodierung</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> identifiziert. Darüber hinaus kann man mit entsprechenden Datenbanken auch per <a class="external" href="http://dev.maxmind.com/geoip/geolite" rel="nofollow">Städtecode</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> selektieren .</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Apache-Module sollte man immer in ihren <strong>/etc/apache2/mods-available/*.conf</strong> Dateien ändern, nie in ihren <strong>/etc/apache2/mods-enabled/*.load</strong> Dateien!
</p></div></div><div class="section_1"><h2 id="Vorbereitung">Vorbereitung<a class="headerlink" href="#Vorbereitung">¶</a></h2><p>
Um überprüfen zu können, ob dieses Modul auch richtig arbeitet, gibt es eine denkbar einfache Lösung. Man erstellt im Document-root (Standard: <strong>/var/www/</strong>) eine Datei <strong>geoiptest.php</strong> und folgendem Inhalt <sup><a href="#source-1">[1]</a></sup><sup><a href="#source-2">[2]</a></sup>.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
<span class="o">&lt;?</span><span class="nx">php</span>

<span class="cm">/*</span>

<span class="cm">    Uses mod-geoip to query the</span>

<span class="cm">    MaxMind GeoLite City</span>

<span class="cm">    binary database and returns</span>

<span class="cm">    geographic information based</span>

<span class="cm">    on the client's IP address</span>

<span class="cm">*/</span>

 

<span class="nv">$country_code</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_COUNTRY_CODE"</span><span class="p">);</span>

<span class="nv">$country_name</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_COUNTRY_NAME"</span><span class="p">);</span>

<span class="nv">$city_name</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_CITY"</span><span class="p">);</span>

<span class="nv">$region</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_REGION"</span><span class="p">);</span>

<span class="nv">$metro_code</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_DMA_CODE"</span><span class="p">);</span>

<span class="nv">$area_code</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_AREA_CODE"</span><span class="p">);</span>

<span class="nv">$latitude</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_LATITUDE"</span><span class="p">);</span>

<span class="nv">$longitude</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_LONGITUDE"</span><span class="p">);</span>

<span class="nv">$postal_code</span> <span class="o">=</span> <span class="nb">apache_note</span><span class="p">(</span><span class="s2">"GEOIP_POSTAL_CODE"</span><span class="p">);</span>

 

<span class="k">echo</span> <span class="s1">'Country code: '</span><span class="o">.</span><span class="nv">$country_code</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Country name: '</span><span class="o">.</span><span class="nv">$country_name</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'City name: '</span><span class="o">.</span><span class="nv">$city_name</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Region: '</span><span class="o">.</span><span class="nv">$region</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Metro code: '</span><span class="o">.</span><span class="nv">$metro_code</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Area code: '</span><span class="o">.</span><span class="nv">$area_code</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Latitude: '</span><span class="o">.</span><span class="nv">$latitude</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Longitude: '</span><span class="o">.</span><span class="nv">$longitude</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

<span class="k">echo</span> <span class="s1">'Postal code: '</span><span class="o">.</span><span class="nv">$postal_code</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>

 
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div><p>Nach einem reload ist dieses Dokument nun geladen und verfügbar <sup><a href="#source-3">[3]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service apache2 reload </pre></div></div><p>Ruft man in einem beliebigen Browser die URL <code class="notranslate">http://SERVER_IP_ODER_NAME/geoiptest.php</code> auf, bleibt das Browserfenster vorerst leer.</p></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
mod_geoip2 ist direkt in den Paketquellen von Ubuntu enthalten. Benötigt wird folgendes Paket <sup><a href="#source-4">[4]</a></sup>:</p><ul><li><p><strong>libapache2-mod-geoip</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install libapache2-mod-geoip </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install libapache2-mod-geoip </pre></div></div><p>
</p></div></div><p>Anschließend muss das Modul noch aktiviert werden. Dies geschieht am einfachsten mit den folgenden Befehlen im Terminal:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo a2enmod geoip </pre></div></div><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
Zusätzliche <a class="internal" href="../fremdquellen.html">Fremdquellen</a> können das System gefährden. 
</p><hr/><p><strong>Anmerkung:</strong> <a class="external" href="https://dev.maxmind.com/geoip/legacy/geolite/" rel="nofollow" title="https://dev.maxmind.com/geoip/legacy/geolite/">https://dev.maxmind.com/geoip/legacy/geolite/</a>
</p></div></div><p>
Um die Funktion zur Erkennung des Städtecodes zu nutzen, muss man die Datenbank von der <a class="external" href="https://maxmind.com/" rel="nofollow">Website</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> des Entwicklers herunterladen.</p><p>Man navigiert in das Verzeichnis <strong>/usr/share/GeoIP</strong>, lädt die Städtedatenbank von der <a class="external" href="https://maxmind.com/" rel="nofollow">Website</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> des Entwicklers herunter und entpackt diese.
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>cd /usr/share/GeoIP
sudo wget geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz
sudo gunzip GeoLiteCity.dat.gz
</pre></div>
</td></tr></table></div><p>Nun editiert man noch die Konfigurationsdatei <strong>/etc/apache2/mods-available/geoip.conf</strong>. In dieser Datei enthaltene Ländercodes werden vom Webserver verweigert. Diese sind individuell anzupassen.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nt">&lt;IfModule</span> <span class="s">mod_geoip.c</span><span class="nt">&gt;</span>
  <span class="nb">GeoIPEnable</span> <span class="k">On</span>                                      ## Lädt die GeoIP-Datenbank
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoLiteCity.dat</span>              ## GeoIPCity-Daten
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoLiteCity.dat</span> MemoryCache  ## Speichercaching der Datenbank
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoLiteCity.dat</span> CheckCache  ## Bevor die DB überprüft wird, prüft GeoIP die locale DB auf eine Änderung. Sollte dies der Fall sein, wird die lokale DB neugeladen ohne der Notwendigkeit den Webserver neu zu laden.
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoIP.dat</span>              ## GeoIP-Daten
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoIP.dat</span> MemoryCache  ## Speichercaching der Datenbank
  <span class="nb">GeoIPDBFile</span> <span class="sx">/usr/share/GeoIP/GeoIP.dat</span> CheckCache   ## Bevor die DB überprüft wird, prüft GeoIP die locale DB auf eine Änderung. Sollte dies der Fall sein, wird die lokale DB neugeladen ohne der Notwendigkeit den Webserver neu zu laden.
  <span class="nb">GeoIPScanProxyHeaders</span> <span class="k">On</span>                            ## Per Standard, prüft dieses Modul nur die IP des Clients. Wird ein Proxy verwendet wird die IP des Proxys überprüft.

  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE AE BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE AF BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE AL BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE AM BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE AZ BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE BA BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE BD BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE BG BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE BY BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE CD BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE CF BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE CN BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE GR BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE HK BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE IL BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE IQ BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE IR BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE JO BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE KE BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE KG BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE KR BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE KZ BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE LB BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE LY BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE MA BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE MD BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE ME BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE MN BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE OM BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE PK BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE RU BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE SA BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE SD BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE SN BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE SY BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE TJ BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE TM BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE TN BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE TW BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE UA BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE UZ BlockCountry
  <span class="nb">SetEnvIf</span> GEOIP_COUNTRY_CODE VN BlockCountry
<span class="nt">&lt;/Ifmodule&gt;</span>
</pre></div>
</td></tr></table></div><p>Zum Schluss muss man die gesetzte <strong>SetEnvIf</strong> Direktive im document-root <strong>/etc/apache2/sites-available/default</strong> setzen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
        <span class="nb">ServerAdmin</span> root@meinedomain.net
        <span class="nb">ServerName</span> meinedomain.net
        <span class="nb">DocumentRoot</span> <span class="sx">/var/www</span>
        <span class="nt">&lt;Directory</span> <span class="s">/</span><span class="nt">&gt;</span>
                <span class="nb">Options</span> FollowSymLinks
                <span class="nb">AllowOverride</span> <span class="k">None</span>
        <span class="nt">&lt;/Directory&gt;</span>
        <span class="nt">&lt;Directory</span> <span class="s">/var/www/</span><span class="nt">&gt;</span>
                <span class="nb">Options</span> Indexes FollowSymLinks MultiViews
                <span class="nb">AllowOverride</span> FileInfo
                <span class="nb">Order</span> allow,deny
                <span class="nb">allow</span> from <span class="k">all</span>
                <span class="nb">Deny</span> from env=BlockCountry
        <span class="nt">&lt;/Directory&gt;</span>
....
...
..
.
</pre></div>
</td></tr></table></div><p>Nach einem neuerlichen Laden der Konfiguration ist das Modul in gewünschter Weise aktiv:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service apache2 restart
sudo service apache2 force-reload </pre></div></div></div><div class="section_1"><h2 id="Kontrolle">Kontrolle<a class="headerlink" href="#Kontrolle">¶</a></h2><p>
Ruft man in einem beliebigen Browser die URL <code class="notranslate">http://SERVER_IP_ODER_NAME/geoiptest.php</code> auf, erhält man eine Ausgabe wie in etwa</p><pre class="notranslate">Country code: US
Country name: United States
City name: Saginaw
Region: MI
Metro code: 513
Area code: 989
Latitude: 43.444099
Longitude: -84.025497
Postal code: 48603</pre><p>Möchte man prüfen, ob der eigene Ländercode blockiert wird, editiert man gemäß dem eigenen Ländercode die <strong>geoip.conf</strong>. Man erhält bei einem neuerlichen Aufruf der <strong>geoiptest.php</strong> einen</p><blockquote><p>"http 403 - access denied"</p></blockquote><p>
</p></div><div class="section_1"><h2 id="Problembehandlung">Problembehandlung<a class="headerlink" href="#Problembehandlung">¶</a></h2><p>
Dieses Modul arbeitet nur mit dem Webserver Apache. Fehler sind in den folgenden Log-Dateien ersichtlich:
</p><ul><li><p><strong>/var/log/syslog</strong></p></li><li><p><strong>/var/log/apache2/access.log</strong></p></li><li><p><strong>/var/log/apache2/error.log</strong></p></li></ul><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://dev.maxmind.com/geoip/mod_geoip2" rel="nofollow">mod_geoip</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://www.maxmind.com/en/iso3166" rel="nofollow">Ländercodierung</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://dev.maxmind.com/geoip/geolite" rel="nofollow">Städtecodes</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="internal" href="../apache.html">Apache 2.2</a> und <a class="internal" href="../apache_2.4.html">Apache 2.4</a> - Hauptartikel</p></li><li><p><a class="internal" href="../apache/sicherheit.html">Apache/Sicherheit</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Übersichtsartikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../apache/mod_geoip2/a/revision/938965.html">Diese Revision</a> wurde am 3. Mai 2017 19:56 von <a href="https://ubuntuusers.de/user/frustschieber/">frustschieber</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../apache.html">Apache</a></li>
<li><a href="../apache/mod_geoip2.html">mod geoip2</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>