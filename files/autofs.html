<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Autofs › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./autofs.html">Autofs</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Autofs">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./autofs/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./autofs/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./autofs/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./autofs/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./autofs/a/backlinks.html">Autofs</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./programme_starten.html">Starten von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./sudo.html">mit Administrator-Rechten arbeiten</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./mount.html">mount (Partitionen temporär einbinden)</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./fstab.html">fstab (Partitionen statisch einbinden)</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Die-Master-Map-Datei">Die Master-Map-Datei
</a></li><li><a class="crosslink" href="#Map-Dateien">Map-Dateien
</a></li></ol></li><li><a class="crosslink" href="#Anwendung">Anwendung
</a><ol class="arabic"><li><a class="crosslink" href="#Starten-und-Beenden">Starten und Beenden
</a></li><li><a class="crosslink" href="#Das-Programm-automount">Das Programm "automount"
</a></li><li><a class="crosslink" href="#udev">udev
</a></li></ol></li><li><a class="crosslink" href="#Beispiele">Beispiele
</a><ol class="arabic"><li><a class="crosslink" href="#USB-Stick-mit-NTFS">USB-Stick mit NTFS
</a></li><li><a class="crosslink" href="#NFS-Freigabe">NFS-Freigabe
</a></li><li><a class="crosslink" href="#NFS-Freigaben-browsen">NFS-Freigaben browsen
</a></li><li><a class="crosslink" href="#Samba-Freigabe">Samba-Freigabe
</a></li><li><a class="crosslink" href="#Mehrere-Samba-Freigaben">Mehrere Samba-Freigaben
</a></li><li><a class="crosslink" href="#Ganzes-Samba-Netz">Ganzes Samba-Netz
</a></li></ol></li><li><a class="crosslink" href="#Problembehandlung">Problembehandlung
</a><ol class="arabic"><li><a class="crosslink" href="#Mountpunkte-sind-nicht-sichtbar">Mountpunkte sind nicht sichtbar
</a></li><li><a class="crosslink" href="#Samba-Server-wird-nicht-gefunden">Samba-Server wird nicht gefunden
</a></li><li><a class="crosslink" href="#Konstellation-Schlafendes-NAS-im-WLAN">Konstellation: 'Schlafendes' NAS im WLAN...</a></li><li><a class="crosslink" href="#Sonderzeichen">Sonderzeichen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#intern">intern
</a></li><li><a class="crosslink" href="#extern">extern
</a></li></ol></li></ol></div><p>Mit <strong>Autofs</strong> lassen sich Partitionen bei Bedarf automatisch einhängen (mounten) und bei längerer Nichtbenutzung auch automatisch wieder aushängen. Autofs verwendet kein <a class="internal" href="./gvfs-mount.html">GVFS</a>. Es lässt sich deshalb auch unter <a class="internal" href="./kde.html">KDE</a> (Kubuntu) einsetzen. Im Gegensatz zum GVFS können Benutzer die Mountpunkte frei festlegen.</p><p>Der übliche Weg, Partitionen beim Systemstart automatisch statisch einzubinden, ist ein Eintrag in der Datei <strong>/etc/fstab</strong> <sup><a href="#source-6">[6]</a></sup>. Im Gegensatz dazu werden die Partitionen mit Autofs erst dann automatisch eingehängt, wenn auf sie zugegriffen wird. Außerdem lässt sich Autofs so konfigurieren, dass eingehängte Partitionen nach einer frei wählbaren Zeit automatisch wieder ausgehängt werden, wenn kein Zugriff mehr erfolgt.</p><p>Autofs wurde vor allem zum Einhängen von Netzwerk-Freigaben (z.B. <a class="internal" href="./nfs.html">NFS</a> oder <a class="internal" href="./samba.html">Samba</a>) konzipiert. Im Vergleich zum Statischen Einbinden <sup><a href="#source-6">[6]</a></sup> verringert es die Belastung des Netzwerks und verbessert damit angeblich dessen Durchsatz. Weil das Einhängen zu einem späteren Zeitpunkt geschieht als die Abarbeitung von <strong>/etc/fstab</strong>, besteht keine Gefahr, dass das Netzwerk noch nicht funktioniert. Auch "Shutdown-Probleme" (z.B. beim <a class="internal" href="./samba_client_cifs.html">cifs-vfs</a> im WLAN) werden durch das automatische Aushängen vermieden.NFS</p><p>Ein weiterer Anwendungsbereich von Autofs ist das automatische Einbinden externer Datenträger (USB-Sticks und -Platten) mit frei wählbaren Optionen. Die Möglichkeit, den Datenträger bei Nichtbenutzung automatisch rasch wieder auszuhängen, kann einen zusätzlichen (aber keineswegs vollständigen!) Schutz vor Datenverlusten bei unbedachtem Ausstecken bewirken.</p><p>Für interne Laufwerke bzw. Partitionen bietet Autofs gegenüber dem statischen Einhängen mittels <strong>fstab</strong>-Eintrag keine Vorteile.</p><p>Eine Alternative mit vergleichbarer Funktionalität ist der <a class="interwiki interwiki-wikipedia_en" href="https://en.wikipedia.org/wiki/Berkeley%20Automounter">Berkeley-Automounter (amd)</a>, der im Paket <strong>am-utils</strong> enthalten ist.</p><p>Der seit <a class="internal" href="./xenial.html">Ubuntu 16.04 LTS</a> standardmäßig verwendete Sitzungs-Manager <a class="internal" href="./systemd.html">systemd</a> enthält bereits einen einfachen Automounter, mit dem sich einige (aber nicht alle) Funktionen von autofs ausführen lassen. Siehe hierzu auch die <a class="internal" href="./man.html">Manpage</a> <code class="notranslate">man systemd.mount</code>.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Zuerst muss aus den Paketquellen das folgende Paket installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>autofs</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install autofs </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install autofs </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
Die Grundeinstellungen für Autofs werden in der Datei <strong>/etc/default/autofs</strong> festgelegt. Normalerweise besteht kein Grund, diese Datei zu editieren und Änderungen daran vorzunehmen.</p><p>Die Konfiguration wird in zwei Stufen vorgenommen. Die Master-Map-Datei (Master Map File) enthält die Ordner für alle Mountpunkte und ordnet diesen jeweils eine eigene Map-Datei zu. Sowohl die Master-Map-Datei als auch die einzelnen Map-Dateien sind gewöhnliche Textdateien, die mit einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> erstellt und bearbeitet werden können.</p><div class="section_2"><h3 id="Die-Master-Map-Datei">Die Master-Map-Datei<a class="headerlink" href="#Die-Master-Map-Datei">¶</a></h3><p>
Die Master-Map-Datei ist eine reine Textdatei, bei der die einzelnen Zeilen folgende Struktur haben:</p><pre class="notranslate">KEY MAP -OPTIONS</pre><p>Die drei Felder sind durch Leerzeichen oder Tabulatoren voneinander getrennt. Das erste Feld ("KEY") bezeichnet ein Mount-Verzeichnis. Dies ist ein Ordner, in dem die einzelnen Mountpunkte beim Einbinden dann automatisch generiert werden. Im zweiten Feld ("MAP") wird dem betreffenden Mount-Verzeichnis eine Map-Datei mit den jeweils gültigen Mount-Optionen zugeordnet. Die in den einzelnen Map-Dateien angegebenen Namen für die einzelnen Mountpunkte gelten dann relativ zum in der Master-Map-Datei angegebenen Mount-Verzeichnis. Im dritten Feld ("OPTIONS") können dann bei Bedarf noch - durch Kommas getrennt - Optionen angegeben werden, die für alle in der Map-Datei aufgeführten Mountpunkte gelten. Dieses Feld beginnt immer mit dem Zeichen "-" (Minus). Die Master-Map-Datei wird standardmäßig unter <strong>/etc/auto.master</strong> angelegt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Steht an der ersten Stelle in einem Optionen-Feld eine Option, die selbst schon mit einem Minus-Zeichen beginnt (z.B. <code class="notranslate">-strict</code>), so ergeben sich daraus zwei aufeinander folgende Minus-Zeichen (also z.B. <code class="notranslate">--strict</code>).
</p></div></div><p>Beispiel:
</p><pre class="notranslate">/media/nfs   /etc/auto.nfs 
/usb  /etc/auto.usb --strict</pre><p>
Die Map-Dateien zu den Verzeichnissen <strong>/media/nfs</strong> und <strong>/usb</strong> sind die Dateien <strong>/etc/auto.nfs</strong> und <strong>/etc/auto.usb</strong>. Die dort angegebenen Namen für die Mountpunkte sind relative Angaben bezüglich dieser Ordner.</p><p>Die in der Master-Map-Datei eingetragenen Verzeichnisse müssen existieren bzw. von Hand mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> eingerichtet werden.</p><p>Beispiel:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir /media/nfs </pre></div></div><p>Alternativ ist es auch möglich, in der Master-Map-Datei keine explizite Ordner-Angabe zu machen, sondern statt eines Ordners nur <code class="notranslate">/-</code> einzutragen. Dann müssen in den entsprechenden Map-Dateien für die Mountpunkte jeweils die kompletten, d.h. absoluten, Pfade eingetragen werden.</p><p>Beispiel:
</p><pre class="notranslate">/-   /etc/auto.backup</pre><p>Als Optionen kommen die für das betreffende Dateisystem möglichen Mount-Optionen in Frage. Zusätzlich gibt es noch spezifische Optionen für Autofs, von denen die wichtigsten in folgender Tabelle aufgeführt sind. Zur Unterscheidung von den Mount-Optionen beginnen diese mit dem Zeichen "-" (Minus).</p><p>
</p><table><tr class="titel"><td colspan="3"> Besondere Optionen für Map-Dateien </td></tr><tr class="kopf"><td> Kurzform </td><td> Langform </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">-t=NUM</code> </td><td> <code class="notranslate">-timeout=NUM</code> </td><td> Zahlenwert. Nach <code class="notranslate">NUM</code> Sekunden ohne Zugriff wird die Partition ausgehängt. <code class="notranslate">NUM=0</code> bedeutet, dass die Partition nicht automatisch ausgehängt wird. Defaultwert: 300 (5 Minuten). </td></tr><tr><td> (keine) </td><td> <code class="notranslate">-strict</code> </td><td> Bewirkt, dass Fehler beim Einbinden von Partitionen oder Freigaben als "fatal" gelten und dass folglich dann auch alle anderen Dateisysteme nicht eingebunden werden. Default: <code class="notranslate">-nonstrict</code>. </td></tr><tr><td> <code class="notranslate">-f=FSTYPE</code> (?) </td><td> <code class="notranslate">-fstype=FSTYPE</code> </td><td> Präzisiert den Dateisystem-Typ. Beispiele: <code class="notranslate">fstype=cifs</code> oder auch <code class="notranslate">fstype=auto</code> für automatisch erkennbare Dateisysteme. </td></tr><tr><td> (keine) </td><td> <code class="notranslate">nosymlink</code> </td><td> Dies ist eine Pseudo-Mount-Option, die deshalb nicht mit dem Zeichen "-" (Minus) beginnt. Im Wesentlichen bewirkt diese, dass auf gemounteten Netzwerk-Freigaben symbolischen Links nicht gefolgt wird.  </td></tr></table><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Es ist nicht sinnvoll, in der Master-Map-Datei als Verzeichnisse Systemordner wie <strong>/media</strong> oder <strong>/mnt</strong> einzutragen, da diese dann ausschließlich von Autofs verwaltet werden und somit nicht mehr anderweitig benutzbar sind. Besser ist es, innerhalb von <strong>/media</strong> oder im Wurzelverzeichnis für Autofs eigene Ordner anzulegen, z.B. <strong>/media/nfs</strong> oder <strong>/usb</strong>. 
</p></div></div></div><div class="section_2"><h3 id="Map-Dateien">Map-Dateien<a class="headerlink" href="#Map-Dateien">¶</a></h3><p>
Auch die Map-Dateien sind gewöhnliche Textdateien. Im Prinzip können diese an jedem beliebigen Ort angelegt werden. Üblich (und empfohlen) ist jedoch, diese im Systemordner <strong>/etc</strong> anzulegen und sie mit <strong>/etc/auto.XXX</strong> zu bezeichnen, wobei <strong>XXX</strong> einen die jeweilige Map-Datei einprägsam charakterisierenden Dateinamen darstellt. Bei der Installation von Autofs werden standardmäßig  die Map-Dateien <strong>auto.misc, auto.net</strong> und <strong>auto.smb</strong> eingerichtet. Es besteht aber keinerlei Notwendigkeit, diese zu benutzen; man kann sich genau so gut selbst mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> eigene Map-Dateien anlegen.</p><p>Eine Map-Datei kann auf verschiedene Arten angelegt werden. Die einfachste Art ist, in ähnlicher Weise wie in der Datei <strong>/etc/fstab</strong>, für jede einzubindende Partition oder Freigabe eine eigene Zeile vorzusehen. Man kann aber auch mehrere verwandte Freigaben in einem "Mehrfach-Mount" zusammenfassen oder mit einem Skript kollektive Angaben für eine Gruppe von Freigaben machen. Dieses Verfahren bietet vor allem bei größeren Netzwerken Vorteile, ist aber wesentlich anspruchsvoller.</p><div class="section_3"><h4 id="Zeilen-Struktur">Zeilen-Struktur<a class="headerlink" href="#Zeilen-Struktur">¶</a></h4><p>
Für jede einzubindende Partition oder Freigabe wird eine Zeile eingetragen, die wieder aus drei Feldern nach folgendem Schema besteht:</p><pre class="notranslate">KEY -OPTIONS LOCATION</pre><p>
Im ersten Feld (<code class="notranslate">KEY</code>) wird der Mountpunkt eingetragen. Ist in der Master-Map-Datei ein Mount-Verzeichnis angegeben, gilt die Angabe relativ zu diesem; andernfalls ist der komplette Pfad anzugeben. Für das zweite Feld (<code class="notranslate">OPTIONS</code>) gilt das Gleiche wie bei der Master-Map-Datei, nur dass die hier eingetragenen Optionen nur für diese eine Partition oder Freigabe gelten. Die Angabe von Optionen darf auch ganz entfallen. In das dritte Feld (<code class="notranslate">LOCATION</code>) ist eine Ortsbezeichnung für die Partition oder Freigabe einzutragen, gewöhnlich beginnend mit einem Kolon ("Doppelpunkt"). Beispiele sind <code class="notranslate">:/dev/sda5</code>, <code class="notranslate">://192.168.1.101/Musik</code> (Samba) oder <code class="notranslate">192.168.1.101:/Musik</code> (NFS). Anstatt des Eintrags in der Gerätedatei <strong>/dev</strong> kann bei lokalen Partitionen auch die UUID (ohne Kolon) angegeben werden). Dies ist vor allem bei USB-Datenträgern zu empfehlen.</p><p>Die Inhalte der drei Felder, nicht jedoch deren Anordnung, entsprechen weitgehend den den Regeln für die Datei <strong>/etc/fstab</strong> <sup><a href="#source-6">[6]</a></sup>.</p><p>Achtung: Dateien mit dieser Struktur dürfen <strong>nicht</strong> als ausführbar markiert sein.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Namen, die Trenn- oder Strukturzeichen (Leerzeichen, $ usw.) enthalten, müssen in Anführungszeichen gesetzt werden ("NAME").
</p></div></div></div><div class="section_3"><h4 id="Mehrfach-Mount">Mehrfach-Mount<a class="headerlink" href="#Mehrfach-Mount">¶</a></h4><p>
Bei einem Mehrfach-Mount ("Multiple Mounts") lassen sich ganze Serien von Mount-Vorgängen in einer einzigen Zeile beliebiger Länge zusammenfassen. Diese besteht dann aus einer Serie von durch Leerzeichen oder Tabulatoren voneinander getrennten Feldern, die nach folgendem Schema aufgebaut ist:</p><pre class="notranslate">KEY -OPTIONS /MPOINT1 -OPTIONS1 LOCATION1 /MPOINT2 -OPTIONS2 LOCATION2 ...</pre><p>Dabei bedeutet <code class="notranslate">KEY</code> jetzt einen gemeinsamen Ordner, in dem sich dann die einzelnen Mountpunkte <code class="notranslate">MPOINT1</code>, <code class="notranslate">MPOINT2</code> usw. befinden. Im zweiten Feld <code class="notranslate">-OPTIONS</code> können gemeinsame Optionen eingetragen werden, und die Felder <code class="notranslate">-OPTIONS1</code>, <code class="notranslate">-OPTIONS2</code> usw. enthalten Optionen, die nur für den jeweiligen Mountpunkt gelten. Nicht benötigte Optionen-Felder dürfen einfach ausgelassen werden.</p><p>Solche Mehrfach-Mount-Zeilen können sehr lang und unhandlich werden. Übersichtlicher wird es, wenn man sie in mehrere kurze Einzelzeilen aufspaltet, wobei dann die Zeilenwechsel durch einen Backslash (\) unterdrückt ("escaped") werden müssen:</p><pre class="notranslate">KEY -OPTIONS \
 /MPOINT1 -OPTIONS1 LOCATION1 \
 /MPOINT2 -OPTIONS2 LOCATION2 \
...</pre><p>Ein Beispiel findet sich <a class="crosslink" href="#Mehrere-Samba-Freigaben">weiter unten</a>.</p></div><div class="section_3"><h4 id="Skript-Struktur">Skript-Struktur<a class="headerlink" href="#Skript-Struktur">¶</a></h4><p>
Eine Map-Datei kann auch ein Skript enthalten. Dieses muss in der Regel die Partitionen oder Freigaben ermitteln, die nach bestimmten Vorgaben einzuhängen sind, und das dann für diese eine dem obigen Schema entsprechende Mehrfach-Mount-Zeile (oder einen Fehler-Code) zurückgibt.</p><p>Ein Beispiel für eine solche Map-Datei ist <a class="crosslink" href="#Ganzes-Samba-Netz">unten</a> aufgeführt. Weitere Beispiele für solche Map-Dateien sind die im Paket <strong>autofs</strong> enthaltenen Dateien <strong>/etc/auto.smb</strong> und<strong>/etc/auto.net</strong>.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das aktuelle Paket <strong>autofs5</strong> enthält leider keine Beispieldateien mehr.
</p></div></div><p>Map-Dateien, die ein Skript enthalten, müssen ausführbar sein. Empfohlen wird für diese der <a class="internal" href="./chmod.html#Oktal-Modus">Modus 0755</a>.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die Erstellung eigener Skripte für Map-Dateien erfordert vertiefte Kenntnisse in Linux. Deshalb wird dies hier nicht weiter erläutert. Weniger erfahrene Benutzer können trotzdem die beiden Dateien <strong>/etc/auto.smb</strong> und <strong>/etc/auto.net</strong> benutzen oder diese nötigenfalls geringfügig verändern.
</p></div></div><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Alternativ kann Autofs auch über <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Lightweight%20Directory%20Access%20Protocol">LDAP</a> konfiguriert werden. Siehe hierzu <a class="external" href="https://help.ubuntu.com/community/AutofsLDAP" rel="nofollow" title="https://help.ubuntu.com/community/AutofsLDAP">https://help.ubuntu.com/community/AutofsLDAP</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.
</p></div></div></div></div></div><div class="section_1"><h2 id="Anwendung">Anwendung<a class="headerlink" href="#Anwendung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Starten-und-Beenden">Starten und Beenden<a class="headerlink" href="#Starten-und-Beenden">¶</a></h3><p>
Autofs kann nur Partitionen oder Freigaben einhängen, die nicht bereits eingebunden sind. Welche Geräte eingebunden sind, erfährt man, wenn man den Befehl <code class="notranslate">mount</code> ohne Parameter aufruft. Nötigenfalls müssen diese einzeln mit <code class="notranslate">sudo umount PARTITION</code> ausgehängt werden, bevor man Autofs von Hand starten kann. Weil Autofs beim Bootvorgang automatisch gestartet wird, müssen außerdem in <strong>/etc/fstab</strong> alle Einträge für über Autofs einzubindende Partitionen und Freigaben beseitigt oder mit dem Zeichen "#" auskommentiert werden.</p><p>Mit Autofs einzubindende Partitionen und Freigaben sind systemweit verfügbar. Deshalb wird Autofs beim Bootvorgang bereits vor dem Anmelden eines Benutzers mit Root-Rechten automatisch gestartet. Um Autofs direkt aufzurufen, benötigt man ebenfalls Root-Rechte <sup><a href="#source-4">[4]</a></sup>. Die dafür nötige Befehlszeile lautet</p><div class="bash"><div class="contents"><pre class="notranslate">sudo service autofs KOMMANDO </pre></div></div><p>Dabei bedeutet KOMMANDO eines der in folgender Tabelle aufgeführten Kommandos:
</p><p>
</p><table><tr class="titel"><td colspan="2"> Kommandos für Autofs </td></tr><tr class="kopf"><td> Kommando </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">stop</code> </td><td> Autofs wird angehalten. Eingehängte Partitionen und Freigaben werden regulär ausgehängt. Bei Partitionen, auf die gerade zugegriffen wird, wird gewartet, bis der Zugriff beendet ist. </td></tr><tr><td> <code class="notranslate">start</code> </td><td> Autofs wird gestartet </td></tr><tr><td> <code class="notranslate">reload</code> </td><td> Veränderte Map-Dateien werden übernommen und zukünftig beim Einbinden berücksichtigt. Bereits eingebundene Partitionen bleiben davon bis zum neuen Einhängen unberührt. </td></tr><tr><td> <code class="notranslate">restart</code> </td><td> Autofs wird angehalten und - ggf. mit veränderter Master-Map-Datei und veränderten Map-Dateien - neu gestartet. Das Kommando <code class="notranslate">restart</code> ist anstatt <code class="notranslate">reload</code> auszuführen, falls auch Änderungen an der Master-Map-Datei vorgenommen wurden. </td></tr><tr><td> <code class="notranslate">status</code> </td><td> Der Status von Autofs und ggf. die Prozess-Identifikation wird ausgegeben. </td></tr></table></div><div class="section_2"><h3 id="Das-Programm-automount">Das Programm "automount"<a class="headerlink" href="#Das-Programm-automount">¶</a></h3><p>
Wenn das Programm "autofs" gestartet wird, startet dieses gemäß den in den in den Map-Dateien vorliegenden Einträgen für jede dort eingetragene Partition eine Instanz des Programms "automount" als <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Daemon">Daemon</a>, der diese bei Bedarf ein- und wieder aushängt. Die Funktion dieser Dämonen wird vom Programm "autofs" gesteuert.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Der Wiki-Artikel <a class="internal" href="./automount.html">Automount</a> bezieht sich allgemein auf das automatische Einbinden (Mounten) von Partitionen und nicht etwa auf das hier beschriebene Programm "<em>automount</em>".
</p></div></div></div><div class="section_2"><h3 id="udev">udev<a class="headerlink" href="#udev">¶</a></h3><p>
In manchen Anleitungen steht, dass noch die <a class="internal" href="./udev.html">udev-Regeln</a> entsprechend angepasst werden müssen, damit Autofs USB-Geräte beim Ein- und Ausstecken erkennen kann. Für bereits bekannte USB-Geräte, für die man bereits einen Eintrag in einer Map-Datei vorgenommen hat, ist dies nicht nötig. Mittels udev die Anwendung von Autofs auch automatisch auf bisher unbekannte, neue USB-Geräte auszudehnen, erfordert mehr Erfahrung im Umgang mit Linux und überschreitet den Rahmen dieses Artikels.</p></div></div><div class="section_1"><h2 id="Beispiele">Beispiele<a class="headerlink" href="#Beispiele">¶</a></h2><p>
</p><div class="section_2"><h3 id="USB-Stick-mit-NTFS">USB-Stick mit NTFS<a class="headerlink" href="#USB-Stick-mit-NTFS">¶</a></h3><p>
USB-Sticks und externe Datenträger werden standardmäßig beim Booten des Systems oder beim Einstecken automatisch eingebunden. Ist auf diesen ein <a class="internal" href="./ntfs.html">NTFS</a>-Dateisystem vorhanden, so werden für dieses die <a class="internal" href="./ntfs-3g.html#Standard-Einstellungen">Standard-Einstellungen</a> verwendet (USER:USER, Mode 0750 bzw. 0640). Eine UNIX-Rechteverwaltung wird dann dort nicht eingerichtet, sodass man die Dateirechte nicht nachträglich noch verändern kann, wie dies z.B. dann nötig ist, wenn man dort öffentliche <a class="internal" href="./samba.html">Samba</a>-Freigaben (mit Gast-Zugang) einrichten will. Will man die USB-Partitionen mit anderen Einstellungen einbinden, so ist dies außer über einen <strong>fstab</strong>-Eintrag auch mittels Autofs möglich. Der folgende Eintrag in der Map-Datei <strong>/etc/auto.usb</strong>
</p><pre class="notranslate">usb-stick --timeout=5,fstype=ntfs,permissions UUID=222CEC912CEC60F1</pre><p> 
bewirkt, dass die Partition mit der UUID 222CEC912CEC60F1 beim Zugriff im Mount-Punkt <strong>usb-stick</strong> mit einer echten UNIX-Dateiverwaltung eingebunden wird (Mount-Option <code class="notranslate">permissions</code>). Nach 5 Sekunden Untätigkeit wird die Partition automatisch korrekt ausgehängt.</p><p>Das Einbinden mit Autofs kann natürlich nur dann funktionieren, wenn vorher das automatische Mounten über die GUI (z.B. GNOME/Nautilus) deaktiviert wird. Siehe hierzu <a class="internal" href="./automount.html#Automount-deaktivieren">Automount</a>. Die Map-Datei darf nicht ausführbar sein und wird noch in der Master-Map-Datei <strong>/etc/auto.master</strong> mit folgender Zeile eingetragen
</p><pre class="notranslate">/media/usb /etc/auto.usb</pre><p>
Der Stick wird dann nach <strong>/media/usb/usb-stick</strong> gemountet.</p></div><div class="section_2"><h3 id="NFS-Freigabe">NFS-Freigabe<a class="headerlink" href="#NFS-Freigabe">¶</a></h3><p>
Zum Einbinden der <a class="internal" href="./nfs.html">NFS</a>-Freigabe "Musik" auf dem Server (hier ein QNAP-NAS) mit der IP "192.168.1.101" eignet sich z.B. folgende Zeile in der Map-Datei <strong>/etc/auto.QNAP</strong>:
</p><pre class="notranslate">Musik -fstype=nfs,rw,retry=0 192.168.1.101:/Musik</pre><p>
Mit folgendem Eintrag in <strong>/etc/auto.master</strong>
</p><pre class="notranslate">/QNAP /etc/auto.QNAP</pre><p>
Wichtig ist in diesem Fall die mount-Option retry=0. Diese sorgt dafür, dass mount sofort aufgibt, falls der Server nicht erreichbar ist. Anderenfalls würde mount für zwei Minuten versuchen den Server zu erreichen und so lange blockieren. Dieses Verhalten ist an sich kein Problem. Wenn man aber ein Lesezeichen in Nautilus erstellt, so wird dadurch der Start von gnome sowie vielen gnome-Anwendungen (wie gedit) eben diese zwei Minuten lang blockiert. Das  Dateisystem-Backend von gnome versucht anscheinend den Verzeichnisinhalt des Links abzurufen und muss dabei auf den von autofs gestarteten mount-Befehl warten. Läuft der Server, so ist der erste Zugriff sofort erfolgreich, und es tritt keine Blockade auf.</p></div><div class="section_2"><h3 id="NFS-Freigaben-browsen">NFS-Freigaben browsen<a class="headerlink" href="#NFS-Freigaben-browsen">¶</a></h3><p>
Weil NFS vom <a class="internal" href="./gvfs-mount.html">GVFS</a> nicht unterstützt wird, können die Dateimanager <a class="internal" href="./nautilus.html">Nautilus</a>, <a class="internal" href="./thunar.html">Thunar</a> und andere leider Netzwerke nicht nach NFS-Freigaben durchsuchen. Hier bietet die aktuelle Version Autofs-5 nun mit der Option <code class="notranslate">-hosts</code> eine gute Alternative.</p><p>Um die NFS-Freigaben aller erreichbarer Server automatisch aufzulisten und nötigenfalls einzubinden, genügt es, z.B. folgende Zeile in die <a class="crosslink" href="#Die-Master-Map-Datei">Master-Map-Datei</a> einzutragen:
</p><pre class="notranslate">/net -hosts --timeout=60</pre><p>
Natürlich muss dafür das Paket <strong>nfs-common</strong> installiert sein. Die Option <code class="notranslate">-hosts</code> verwendet zum Auffinden der Netzwerk-Freigaben ein ein ähnliches Verfahren wie der Befehl <code class="notranslate">showmount</code>.</p></div><div class="section_2"><h3 id="Samba-Freigabe">Samba-Freigabe<a class="headerlink" href="#Samba-Freigabe">¶</a></h3><p>
Zum Einbinden der <a class="internal" href="./samba.html">Samba</a>-Freigabe "Musik" auf dem Server mit der IP "192.168.1.101" eignet sich z.B. folgende Zeile in der Map-Datei <strong>/etc/auto.cifs-shares</strong>:
</p><pre class="notranslate">Musik -fstype=cifs,uid=1000,credentials=/home/Simon/.smbcredentials ://192.168.1.101/Musik</pre><p>
Mit folgendem Eintrag in <strong>/etc/auto.master</strong>
</p><pre class="notranslate">/media/cifs /etc/auto.cifs-shares --timeout=60 --ghost</pre><p>
wird die Freigabe dann nach <strong>/media/cifs/Musik</strong> gemountet. Näheres zum Einbinden mittels cifs-vfs siehe <a class="internal" href="./samba_client_cifs.html">Samba Client cifs</a>. Der Schalter --timeout definiert wie viele Sekunden gewartet wird, bis ein ungenutztes Dateisystem unmounted wird. Die Option --ghost erzeugt leere Dateiverzeichnisse in <strong>/media/cifs/Musik</strong> für alle Shares in <strong>/etc/auto.cifs-shares</strong>, damit der Verbindungsaufbau auch nach einem Timeout wieder erzeugt werden kann.</p></div><div class="section_2"><h3 id="Mehrere-Samba-Freigaben">Mehrere Samba-Freigaben<a class="headerlink" href="#Mehrere-Samba-Freigaben">¶</a></h3><p>
Durch folgenden Mehrfach-Mount werden alle Mountpunkte als Unterordner im Ordner <strong>Media</strong> zusammengeführt, obwohl sich die Freigaben auf verschiedenen Servern befinden. Die Mount-Optionen sind jedoch identisch:
</p><pre class="notranslate">Media \
-fstype=cifs,credentials=/home/Simon/.smbcredentials \
  "/Eigene Bilder" ://192.168.1.101/Bilder \
  "/Monas Bilder" ://192.168.1.102/Bilder \
  /Musik ://192.168.1.101/Musik \
  /Videos ://192.168.1.113/Videos \</pre></div><div class="section_2"><h3 id="Ganzes-Samba-Netz">Ganzes Samba-Netz<a class="headerlink" href="#Ganzes-Samba-Netz">¶</a></h3><p>
Das folgende Beispiel ist eine für Ubuntu angepasste Vereinfachung des Beispiel-Skripts <strong>auto.smb</strong>.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># Dieses Skript muss ausführbar sein (chmod 755)!</span>
<span class="nv">key</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>

<span class="c1"># Hier ggf. die eigene credentials-Datei und weitere</span>
<span class="c1"># Mount-Optionen eintragen:</span>
<span class="nv">opts</span><span class="o">=</span><span class="s2">"-fstype=cifs,credentials=/home/USER/.smbcredentials"</span>

<span class="nv">SMBCLIENT</span><span class="o">=</span><span class="s2">"/usr/bin/smbclient"</span>
<span class="o">[</span> -x <span class="nv">$SMBCLIENT</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
<span class="c1"># Wenn smbclient nicht installiert ist, dann geht nichts!</span>

<span class="nv">$SMBCLIENT</span> -gNL <span class="nv">$key</span> <span class="m">2</span>&gt;/dev/null<span class="p">|</span> awk -v <span class="nv">key</span><span class="o">=</span><span class="s2">"</span><span class="nv">$key</span><span class="s2">"</span> -v <span class="nv">opts</span><span class="o">=</span><span class="s2">"</span><span class="nv">$opts</span><span class="s2">"</span> -F<span class="s1">'|'</span> -- <span class="s1">'</span>
<span class="s1"># Die Ausgabe von smbclient wird nun mit AWK aufbereitet</span>
<span class="s1">	BEGIN	{ ORS=""; first=1 }</span>
<span class="s1">	/Disk/	{</span>
<span class="s1">		  if (first) { print opts; first=0 }</span>
<span class="s1">		  dir = $2</span>
<span class="s1">		  loc = $2</span>
<span class="s1">		  # Spezielle Zeichen "$" und "&amp;" im Namen escapen</span>
<span class="s1">		  gsub(/\$$/, "\\$",loc);</span>
<span class="s1">		  gsub(/\&amp;/,"\\\\&amp;",loc)</span>
<span class="s1">		  print " \\\n\t /" dir, "://" key "/" loc</span>
<span class="s1">		}</span>
<span class="s1">	END 	{ if (!first) print "\n"; else exit 1 </span>
<span class="s1">	'</span>
</pre></div>
</td></tr></table></div><p>
Vom aufrufenden Programm Autofs wird der Server als Parameter an das Skript übergeben. Dieses durchsucht mit dem Befehl <code class="notranslate">smbclient -gNL</code> den Server nach Freigaben. Die Ergebnisse werden mit dem Text-Bearbeitungsprogramm AWK aufgearbeitet und so an Autofs zurückgegeben, dass dieses für alle Freigaben Mountpunkte generieren und ggf. die Freigaben mounten kann. Freigaben mit Sonderzeichen (z.B. Umlaute, Klammern, Satzzeichen) im Namen werden dabei ignoriert (<a class="crosslink" href="#Sonderzeichen">s.u.</a>). Das Skript kann man z.B. als <strong>/etc/auto.cifs</strong> ablegen; der entsprechende Eintrag in <strong>/etc/auto.master</strong> könnte dann so lauten:
</p><pre class="notranslate">/media/cifs /etc/auto.cifs --timeout=5 --ghost</pre><p>
Da das cifs-vfs zur Namensauflösung keinen Rundspruch (broadcast) vornimmt, funktioniert das Einbinden über den Servernamen nur dann, wenn der Servername auf andere Art (z.B. über einen WINS-Server oder einen Eintrag in <strong>/etc/hosts</strong>) aufgelöst werden kann. Andernfalls ist für den Server dessen IP (z.B. 192.168.1.101) anzugeben.</p></div></div><div class="section_1"><h2 id="Problembehandlung">Problembehandlung<a class="headerlink" href="#Problembehandlung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Mountpunkte-sind-nicht-sichtbar">Mountpunkte sind nicht sichtbar<a class="headerlink" href="#Mountpunkte-sind-nicht-sichtbar">¶</a></h3><p>
Weil Autofs die Mountpunkte erst beim ersten Zugriffs-Versuch einrichtet, erscheinen diese nach dem Systemstart zunächst nicht im Dateimanager. Dies ist lästig, denn dann kann der erste Zugriff auch nicht wie gewohnt per Mausklick erfolgen. Möchte man nicht das Einrichten der Mountpunkte vom Terminal<sup><a href="#source-3">[3]</a></sup> aus z.B. mit dem Befehl <code class="notranslate">ls MOUNTPUNKT</code> erzwingen, bietet sich folgender Ausweg an:
</p><ul><li><p>Man richtet die eingetragenen Mountpunkte für die Server (für die einzelnen Freigaben ist das nicht nötig) <span class="underline">vor</span> dem Start von Autofs von Hand ein. Eventuell muss dazu Autofs mit dem Befehl <code class="notranslate">sudo service autofs stop</code> angehalten und anschließend mit <code class="notranslate">sudo service autofs start</code> neu gestartet werden.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Samba-Server-wird-nicht-gefunden">Samba-Server wird nicht gefunden<a class="headerlink" href="#Samba-Server-wird-nicht-gefunden">¶</a></h3><p>
Beim <a class="crosslink" href="#Ganzes-Samba-Netz">Einbinden eines ganzen Samba-Netzes</a> muss Autofs den Namen bzw. die IP des Servers als Parameter an das Skript übergeben. Dies setzt voraus, dass der entsprechende Mountpunkt schon eingerichtet ist. Nötigenfalls muss man also genau so vorgehen, wie <a class="crosslink" href="#Mountpunkte-sind-nicht-sichtbar">oben</a> beschrieben.</p></div><div class="section_2"><h3 id="Konstellation-Schlafendes-NAS-im-WLAN">Konstellation: 'Schlafendes' NAS im WLAN<a class="headerlink" href="#Konstellation-Schlafendes-NAS-im-WLAN">¶</a></h3><p>
Bei dieser verbreiteten Konstellation kommen zwei Probleme zusammen: Man möchte auf einem Notebook über WLAN eine NAS einbinden, die sich im Schlafmodus befindet. Nach dem Starten des Notebooks möchte man so schnell wie möglich auf das NAS zugreifen können. Negativbeispiele wären z.B. ein Nautilus, der lange braucht, bis er startet, oder Rhythmbox, das ohne ersichtlichen Grund eine Minute lang eine graue Benutzeroberfläche zeigt (bis endlich die Musikdateien auf dem NAS zur Verfügung stehen). Eine Möglichkeit, dies zu erreichen, ist, das NAS zum Aufwachen zu zwingen, sobald das Notebook eine WLAN-Verbindung aufgebaut hat.</p><p>Zuerst muss sichergestellt sein, dass die WLAN Verbindung aufgebaut wurde. Dazu kann folgendes Autostart-Shell-Skript verwendet werden:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># check if online</span>
<span class="c1">#</span>
<span class="nv">PING_URL</span><span class="o">=</span>www.google.com
<span class="nv">WAIT_FOR</span><span class="o">=</span><span class="m">30</span> <span class="c1"># seconds</span>
<span class="c1">#</span>
<span class="nb">trap</span> <span class="s2">"exit 1"</span> SIGTERM
sleep <span class="nv">$WAIT_FOR</span> <span class="o">&amp;&amp;</span> <span class="nb">kill</span> <span class="nv">$$</span> <span class="p">&amp;</span>
<span class="k">while</span> ! ping -c1 <span class="nv">$PING_URL</span> <span class="m">2</span>&gt;/dev/null <span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
	<span class="k">do</span>		
		sleep <span class="m">1</span>
	<span class="k">done</span>
<span class="nb">kill</span> %-
<span class="c1"># programms to start as soon as we are online</span>
/home/user/skripts/wakeupnas.sh <span class="p">&amp;</span>           <span class="c1"># ACHTUNG: dieser Pfad muss angepasst werden!</span>
<span class="nb">exit</span> <span class="m">0</span>
</pre></div>
</td></tr></table></div><p>
Das Skript lässt man nach dem Booten durch <a class="internal" href="./autostart.html">Autostart</a> automatisch starten; es testet 30 Sekunden lang, ob eine WLAN-Verbindung besteht- indem fortwährend <code class="notranslate">www.google.com</code> aufgerufen wird. Wenn die Verbindung besteht, können andere Programme oder Skripte aufgerufen werden, die auf eine WLAN-Verbindung angewiesen sind (z.B. Thunderbird). Im o.a. Beispiel wird das Shell-Skript 'wakeupnas.sh' gestartet, um das NAS zu wecken.</p><p>Im nächsten Schritt sorgt das Shell-Skript <strong>wakeupnas.sh</strong> für das Aufwachen und automatische Einbinden des NAS in das Dateisystem:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># fire ls at NAS until auto-mounted</span>
<span class="c1">#</span>
<span class="nb">echo</span> <span class="s1">'wake up NAS'</span>
<span class="k">until</span> ls /media/nfs/nas/ein_Verzeichnis     <span class="c1"># ACHTUNG: dieser Pfad muss angepasst werden!</span>
	<span class="k">do</span>
		<span class="nb">echo</span> <span class="s1">'still waking up NAS'</span>
		sleep <span class="m">5</span>
	<span class="k">done</span>
</pre></div>
</td></tr></table></div><p>
Das Skript führt solange ein <code class="notranslate">ls</code> Kommando auf ein bestehendes Verzeichnis des NAS aus, bis das NAS aufwacht und von autofs eingebunden wird. Wie oben beschrieben, bindet autofs ein Laufwerk erst beim Erstzugriff in das Dateisystem ein. Das <code class="notranslate">ls</code> Kommando erledigt diesen Erstzugriff. Der Pfad hinter dem 'ls' Kommando muss durch ein Verzeichnis ersetzt werden, welches es auf dem eigenen NAS tatsächlich gibt. Man kann auch versuchen, das NAS durch ein einziges <code class="notranslate">ls</code> Kommando zu wecken (beim Autor war das nie ausreichend; vermutlich weil automount noch nicht bereit ist).</p></div><div class="section_2"><h3 id="Sonderzeichen">Sonderzeichen<a class="headerlink" href="#Sonderzeichen">¶</a></h3><p>
Autofs kann leider keine Partitionen oder Freigaben einbinden, in deren Namen Sonderzeichen (z.B. Umlaute, Akzente, Klammern, Satzzeichen usw.) vorkommen. Namen von Partitionen und Freigaben sollten deshalb nur aus den Zeichen <code class="notranslate">A..Z, a..z, -,_</code> bestehen. Datei- und Ordnernamen innerhalb von Partitionen und Freigaben dürfen jedoch alle Zeichen enthalten, die auch ohne Autofs dafür zulässig sind.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="intern">intern<a class="headerlink" href="#intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./usb-datenträger_automatisch_einbinden.html">USB-Datenträger automatisch einbinden</a></p></li><li><p><a class="internal" href="./fstab.html">fstab</a> Die klassische Methode, systemweit statisch zu mounten.</p></li><li><p><a class="internal" href="./systemd.html">systemd</a> Der seit Ubuntu 16.04 LTS standardmäßig verwendete Sitzungs-Manager.</p></li></ul><p>
</p></div><div class="section_2"><h3 id="extern">extern<a class="headerlink" href="#extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="https://help.ubuntu.com/community/Autofs" rel="nofollow" title="https://help.ubuntu.com/community/Autofs">https://help.ubuntu.com/community/Autofs</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://selflinux.org/selflinux/html/autofs.html" rel="nofollow" title="http://selflinux.org/selflinux/html/autofs.html">http://selflinux.org/selflinux/html/autofs.html</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="external" href="http://linux.die.net/man/8/autofs" rel="nofollow" title="http://linux.die.net/man/8/autofs">http://linux.die.net/man/8/autofs</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://linux.die.net/man/8/automount" rel="nofollow" title="http://linux.die.net/man/8/automount">http://linux.die.net/man/8/automount</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://wiki.archlinux.org/index.php/Autofs" rel="nofollow" title="https://wiki.archlinux.org/index.php/Autofs">https://wiki.archlinux.org/index.php/Autofs</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li></ul><p>
</p><ul><li><p><a class="external" href="http://www.am-utils.org/" rel="nofollow" title="http://www.am-utils.org/">http://www.am-utils.org/</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> Homepage des Berkley-Automounters (amd)</p></li></ul><p></p></div></div></div>
<p class="meta">
<a href="./autofs/a/revision/940720.html">Diese Revision</a> wurde am 9. Mai 2017 00:30 von <a href="https://ubuntuusers.de/user/ubot/">ubot</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./autofs.html">Autofs</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>