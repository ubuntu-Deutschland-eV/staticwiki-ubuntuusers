<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>FreeRADIUS › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./freeradius.html">FreeRADIUS</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/FreeRADIUS">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./freeradius/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./freeradius/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./freeradius/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./freeradius/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./freeradius/a/backlinks.html">FreeRADIUS</a></h1>
<div id="page"><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Diese Seite wird aktuell überarbeitet. Bitte hier keine Änderungen mehr vornehmen, sondern in <a class="internal" href="./baustelle/freeradius.html">Baustelle/FreeRADIUS</a>!
</p></div></div><p>
</p><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
Dieser Artikel ist mit keiner aktuell unterstützten Ubuntu-Version getestet! Bitte diesen Artikel testen und das getestet-Tag entsprechend anpassen.
</p></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Verfahrensprinzip-Begriffsklaerung">Verfahrensprinzip / Begriffsklärung
</a></li><li><a class="crosslink" href="#Einsatzgebiete">Einsatzgebiete
</a><ol class="arabic"><li><a class="crosslink" href="#Im-Umfeld-grosser-Netzwerke">Im Umfeld großer Netzwerke
</a></li><li><a class="crosslink" href="#Sonderfall-WLAN">Sonderfall WLAN
</a></li></ol></li><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#sites-enabled-default-inner-tunnel">sites-enabled/default|inner-tunnel
</a></li><li><a class="crosslink" href="#module-ldap">module/ldap
</a></li><li><a class="crosslink" href="#module-krb5">module/krb5
</a></li><li><a class="crosslink" href="#huntgroups">huntgroups
</a></li><li><a class="crosslink" href="#users">users
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/service.png" class="image-left" src="./_/afb6c1869d3e3412cb022363511bce77dccf937a.png"/>
Die Server-Komponente von <a class="external" href="http://freeradius.org/" rel="nofollow">FreeRADIUS</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist laut eigener Angabe „der am häufigsten genutzte RADIUS-Server der Welt“ und unterstützt das <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Extensible_Authentication_Protocol">EAP</a>- und das <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/IEEE_802.1X">IEEE 802.1X</a>-Protokoll. Im Kern geht es beim "<strong>R</strong>emote <strong>A</strong>uthentication <strong>D</strong>ial-<strong>I</strong>n <strong>U</strong>ser <strong>S</strong>ervice" um die Authentisierung und Autorisierung von Clients (<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Supplikant_(Computer)">Supplicants</a>), noch bevor eine „richtige“ Verbindung aufgebaut wird. Dies erhöht die Sicherheit und Wartbarkeit des Netzwerkes.</p><p>Prinzipiell gibt es verschiedene IEEE-802.1X-Backend-Implementierungen. Die RADIUS-Server sind jedoch die am weitesten verbreitete Variante.</p><div class="section_1"><h2 id="Verfahrensprinzip-Begriffsklaerung">Verfahrensprinzip / Begriffsklärung<a class="headerlink" href="#Verfahrensprinzip-Begriffsklaerung">¶</a></h2><p>
</p><table style="float: right; clear: both; border: none"><tr style="background-color: #E2C889"><td style="text-align: center; border-width: 0 10px 0 0; border-color: #FFFFFF"> <a class="crosslink" href="invalid-url"></a> </td></tr><tr style="background-color: #F9EAAF"><td style="text-align: center; border-width: 0 10px 0 0; border-color: #FFFFFF"> 802.11X Funktionsprinzip (<a class="interwiki interwiki-wikimedia" href="https://commons.wikimedia.org/wiki/"></a><a class="external" href="http://de.wikipedia.org/w/index.php?title=Datei:8021X-Overview.svg" rel="nofollow">Bildquelle</a>) </td></tr></table><p>
</p><p>Das IEEE-802.1X-Protokoll beschreibt ein Verfahren, bei dem ein Endgerät (Supplicant=Bittsteller) authentisiert werden kann, bevor es in das Netzwerk gelassen wird. Dazu müssen der Zugangspunkt (Switch, WLAN-AP oder VPN-Server) und das Endgerät das 802.1X-Protokoll unterstützen. Der Supplicant weist sich zunächst gegenüber dem Zugangspunkt (Authenticator) aus. Dieser reicht dann diese Information an einen RADIUS-Server (Authentication Server) weiter.</p><p>Die Kommunikation des RADIUS-Server über den Zugangspunkt zum Supplicant erfolgt <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Transport_Layer_Security">TLS</a>-verschlüsselt, sie kann entsprechend auch über „unsichere“ Netze erfolgen. Wichtig ist dabei: der Supplicant kommuniziert nie mit dem RADIUS-Server direkt, sondern nur mit dem Zugangspunkt. Dieser setzt die Pakete dann um und kommuniziert seinerseits mit dem RADIUS-Server. Die gesamte Sicherheit basiert auf der Vertrauenswürdigkeit des Zugangspunkts und des RADIUS-Servers.</p><p>Nach dem initialen „Handshake“ zwischen Supplicant, Zugangspunkt und RADIUS-Server kommt das "Extensible Authentication Protocol" (EAP) zum Einsatz, um den Client zu authentifizieren. Hinter EAP stecken, je nach Implementierung auf RADIUS- und Client-Seite, verschiedene Verfahren. Das zu verwendende Verfahren kann während der Übertragung (OnTheFly) zwischen Client und RADIUS-Server ausgehandelt werden. Hier eine kleine Auswahl der über 40 Möglichkeiten:</p><ul><li><p>EAP-TLS: Der Client wird über Zertifikate authentisiert</p></li><li><p>PAP-TTLS: Einfache Passwort-Abfrage durch einen gesicherten TLS-Tunnel</p></li><li><p>CHAP-TTLS: <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/CHAP">CHAP</a>-Authentisierung durch einen gesicherten TLS-Tunnel</p></li><li><p>MSCHAP-TTLS: <a class="interwiki interwiki-wikipedia_en" href="https://en.wikipedia.org/wiki/MS-CHAP">MS-CHAP</a>-Authentisierung durch einen gesicherten TLS-Tunnel</p></li></ul><p>
Hat die Authentisierung des Clients stattgefunden, schickt der RADIUS-Server eine Autorisierung an den Zugangspunkt und der Client wird freigeschaltet oder abgelehnt. Dies geschieht zum Beispiel dadurch, dass an einem Switch der entsprechende Port freigeschaltet wird oder bei einem AP beispielsweise ein Zertifikat an den Client gesendet wird (siehe unten).</p></div><div class="section_1"><h2 id="Einsatzgebiete">Einsatzgebiete<a class="headerlink" href="#Einsatzgebiete">¶</a></h2><p>
</p><div class="section_2"><h3 id="Im-Umfeld-grosser-Netzwerke">Im Umfeld großer Netzwerke<a class="headerlink" href="#Im-Umfeld-grosser-Netzwerke">¶</a></h3><p>
RADIUS-Authentisierung wird häufig im Umfeld großer Netzwerke eingesetzt. Durch die Unterstützung unterschiedlicher Backend-Datenbanken können beliebige Organisations-Strukturen im Netzwerk abgebildet werden. So können Clients unabhängig von Standort oder Verbindungstechnik (Kabel, WLAN, VPN) immer ins gleiche Zielnetz/VLAN „gebeamt“ werden bzw. die Zugriffe verwaltet werden.</p><p>Zusätzlich erzeugt 802.1x einen Sicherheitsvorteil: Switches öffnen nicht mehr jedem Client ihre Netzwerkports. Nur noch „bekannte“ Clients bekommen Zugang zum Netz. Auch das Abstecken/Ersetzen eines validen Clients durch einen unbekannten Clients ist nicht mehr möglich. Voraussetzung ist, dass alle Switches richtig konfiguriert sind und alle Endgeräte 802.1x unterstützen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Daneben bietet RADIUS die Möglichkeit des Accountings für Abrechnungs- oder Monitoring-Zwecke, was in diesem Artikel aber nicht weiter behandelt wird.
</p></div></div></div><div class="section_2"><h3 id="Sonderfall-WLAN">Sonderfall WLAN<a class="headerlink" href="#Sonderfall-WLAN">¶</a></h3><p>
Die bisher genannten Eigenschaften kommen eher im Umfeld von größeren Firmennetzen zum Tragen. Das Zusammenspiel zwischen (Free)RADIUS-Server und WLAN-AP kann aber auch in Klein- bzw Heimnetzwerken echte Sicherheitsvorteile bieten. Betreibt man ein WLAN, hat man – unabhängig vom Verschlüsselungsalgorithmus – immer das Problem des ersten Schlüsselaustauschs: Sowohl WEP, WPA als auch WPA2 setzen auf symmetrische (schnelle) Verschlüsselungsalgorithmen. Der dafür benötigte Schlüssel wird vom AP „zufällig“ generiert. Zum Austausch des Schlüssels kommt dabei das sogenannte PSK-Verfahren (PreSharedKey) zum Einsatz: Ein Client initiiert einen Handshake verschlüsselt mit dem PSK und bekommt vom AP den symmetrischen Schlüssel als Ergebnis.</p><p>Das PSK-Verfahren hat mehrere Sicherheitsprobleme:
</p><ul><li><p>Der PSK ist das Geheimnis, auf dem die Sicherheit des Netzwerkes basiert. Je mehr Clients im Netzwerk unterwegs sind, umso mehr wird dieses „Geheimnis“ geteilt. In der Folge wird es immer wahrscheinlicher, dass der PSK bald kein Geheimnis mehr ist.</p></li><li><p>Spätestens bei Verlust/Diebstahl eines Gerätes muss der PSK auf allen Geräten geändert werden. Das kann mit wachsender Anzahl von Endgeräten beliebig schwierig werden.</p></li><li><p>Beim Verfahren ist der Handshake vom Client zum AP der Schwachpunkt: Ein Angreifer, der diesen mitschneidet, kennt sowohl den Klar- (aus dem Protokoll) als auch den chiffrierten Text. Daraus lässt sich der PSK errechnen. Es ist nur eine Frage der Zeit oder des Geldes (beim Einsatz von Cloud-Diensten), bis der PSK im Klartext vorliegt.</p></li></ul><p>
Beim Einsatz des 802.1x-Protokolles muss an allen Clients ein Root-Zertifikat hinterlegt werden. Der RADIUS-Server verfügt selber über ein Zertifikat, das von der Root-CA signiert ist. Beim initialen Handshake wird mit Hilfe dieser Zertifikate eine <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Transport_Layer_Security">TLS</a>-Verbindung „aufgebaut“. Ein Angreifer muss nun anstatt eines PSKs einen RSA-Private-Key errechnen. Damit wird die Zeitspanne bis zum „Bruch“ von „in wenigen Wochen/Tagen“ auf „sehr lange“ erhöht.</p><p>Es obliegt dem Administrator, wie der Client autorisiert wird. Im einfachsten Fall wird am Client ein Client-Zertifikat hinterlegt, das ebenfalls von der Root-CA signiert ist. Der RADIUS-Server überprüft die Gültigkeit des Zertifikates und gibt den Client dann frei. Prinzipbedingt können Client und Server aber nur überprüfen, ob ein Zertifikat korrekt signiert ist – nicht aber, ob das Zertifikat zum Server/Client passt. So ist es möglich, allen Clients mit nur einem Zertifikat Zugriff auf das Netzwerk zu geben.</p><p>Besser ist es jedoch, jedem Client ein eigenes Zertifikat auszustellen. Bei Verlust eines Gerätes muss nur das entsprechende Zertifikat im RADIUS-Server gesperrt werden und nicht auf allen Clients ein neues Zertifikat installiert werden. Noch flexibler wird das Verfahren, wenn weitere Verfahren wie PAP, CHAP, MSCHAP usw. zum Einsatz kommen.</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Die Server-Komponente von FreeRADIUS ist in den offiziellen Paketquellen enthalten <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>freeradius</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install freeradius </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install freeradius </pre></div></div><p>
</p></div></div><p>Nach der Korrektur der Zertifikatsberechtigungen kann der Server gestartet werden. Unabhängig davon, ob der Server gestartet werden kann oder nicht, sollte man den Server in einer getrennten Konsole im Debugmodus hochfahren. So lassen sich die Anmeldevorgänge leichter debuggen.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo -u freerad freeradius -fxX </pre></div></div><p>Als Basis setzt FreeRADIUS auf eine funktionierende Zertifikats-Kette. Während der Installation wird ein Zertifikat erzeugt und bei einer Certification Authority (CA) hinterlegt. Zur Verwaltung kann auf man die Tool-Kette von OpenSSL (wie im Artikel <a class="internal" href="./ca.html">CA</a> beschrieben) zurückgreifen oder gleich auf eine bestehende CA wechseln.</p><p>Will man nur auf Client-Zertifikate für die Authentifizierung zurückgreifen, ist keine weitere Konfiguration notwendig. An den Clients muss nur das Root-Zertifikat und ein Client-Zertifikat hinterlegt werden und PAE-TLS als Authentifizierung-Methode eingestellt werden.</p></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
FreeRADIUS bietet sehr komplexe Konfigurations-Möglichkeiten. Ähnlich der <a class="internal" href="./apache.html">Apache</a>-Konfiguration gibt es eine Hauptdatei <strong>/etc/freeradius/radiusd.conf</strong>, die ihrerseits weitere Konfig-Dateien direkt oder indirekt einliest. Laut Aussage der Entwickler wird FreeRADIUS mit einer „Best-Practice“-Konfiguration ausgeliefert, die so wenig wie möglich geändert werden sollte – bzw. nur, wenn man genau weiß, was man macht. Weiter wird empfohlen, eine Versionsverwaltung einzusetzen, um Änderungen schnell rückgängig machen zu können.</p><p>Im Folgenden wird nur auf Dateien eingegangen, die für Änderungen vorgesehen sind.</p><div class="section_2"><h3 id="sites-enabled-default-inner-tunnel">sites-enabled/default|inner-tunnel<a class="headerlink" href="#sites-enabled-default-inner-tunnel">¶</a></h3><p>
Standardmäßig sind zwei „Virtuelle“ Server eingerichtet: Default und Inner-Tunnel. In Abhängigkeit vom gewählten Modus des Clients wird der Default (TLS) oder Inner-Tunnel (TTLS) genutzt. Die Konfiguration ist in folgende Kategorien unterteilt:</p><ul><li><p><em>"authorize"</em>: Erster „echter“ Einstiegspunkt. Die eingetragenen Module werden von oben nach unten abgearbeitet. Die Module können sich untereinander beeinflussen, indem sie Umgebungsparameter setzen. Im einfachsten Fall wird der Auth-Type gesetzt (REJECT,ACCEPT, usw), in komplexeren Fällen werden neue dynamische Parameter hinzugefügt. Die Reihenfolge ist dabei entscheidend. Parameter sind nur verfügbar, wenn das entsprechende Modul durchlaufen wurde.</p></li><li><p><em>"authenticate"</em>: Während der erfolgreichen Authorize-Phase wird ein Auth-Type gesetzt oder der Client fordert selber einen Auth-Type an. Wird ein Auth-Type angefordert, der nicht angeboten wird, führt das zu einem REJECT. Das Auth-Module entscheidet anhand eines Identifikationsmerkmales (Password, Geheimnis, etc), ob der Client in das Netzwerk gelassen werden darf.</p></li><li><p><em>"post-auth"</em>: In diesen Sektionen können nachträgliche Überprüfungen wie zum Beispiel die Prüfung der Gruppenzugehörigkeit durchgeführt werden.</p></li></ul><p>
Eine Beispieldatei für eine Datei im Ordner <strong>/etc/freeradius/sites-enabled</strong> oder <strong>/etc/freeradius/sites-avaible</strong>. Das Beispiel ist um Kommentare bereinigt und enthält nur die wesentlichen Sektionen:</p><pre class="notranslate">authorize {
	preprocess
	auth_log
	chap
	mschap
#	digest
	eap {
		ok = return
	}
	unix
	ldap
        files
  #	sql
        expiration
	logintime
	pap
}

authenticate {
	Auth-Type PAP {
		pap
	}

	Auth-Type CHAP {
		chap
	}

	Auth-Type MS-CHAP {
		mschap
	}
 
	unix

	Auth-Type LDAP {
		ldap
	}
	eap
}

...

post-auth {
  if (LDAPGroup == "forbidden") {
    nok
  }

  exec
  Post-Auth-Type REJECT {
    attr_filter.access_reject
  }
}</pre></div><div class="section_2"><h3 id="module-ldap">module/ldap<a class="headerlink" href="#module-ldap">¶</a></h3><p>
Neben einfacher „User-Existiert“-Anfragen können auch die Gruppenzugehörigkeit oder diverse Attribute abgefragt werden. Es wird auch ein eigenes LDAP-Schema angeboten; dies wird jedoch nur für erweiterte Parameterzuweisung benötigt. Für eine einfache Autorisierung/Authentisierung reicht das Standard-PosixAccount-Schema.</p><p>Das Modul benötigt einen lesenden Zugang auf das LDAP-Verzeichnis, ggf. auch auf die Secrets für diverse Auth-Types (MSCHAP).</p><pre class="notranslate">ldap {
        #
        #  Note that this needs to match the name in the LDAP
        #  server certificate, if you're using ldaps.
        server = "ldap.example.com"
        identity = "cn=radius,dc=example,dc=com"
        password = "very-secret-password"
        basedn = "dc=example,dc=com"
        filter = "(&amp;(cn=%{%{Stripped-User-Name}:-%{User-Name}})(objectClass=posixAccount)))"
        ldap_connections_number = 5
        timeout = 4
        net_timeout = 1
        tls {
                start_tls = no
        }
        dictionary_mapping = ${confdir}/ldap.attrmap
        edir_account_policy_check = no
        keepalive {
                idle = 60
                probes = 3
                interval = 3
        }
}</pre><p>Zusätzlich bietet das Modul auch den Support für das Abfragen der „Usergruppen“.</p><pre class="notranslate">        groupname_attribute = cn
        groupmembership_filter = "(objectClass=posixGroup)(memberUid=%{%{Stripped-User-Name}:-%{User-Name}})"</pre><p>Im Code kann man die LDAP-Gruppe wie folgt einsetzen:</p><pre class="notranslate">DEFAULT Ldap-Group != "Wireless", Auth-Type := Reject</pre></div><div class="section_2"><h3 id="module-krb5">module/krb5<a class="headerlink" href="#module-krb5">¶</a></h3><p>
Beim Kerberos handelt es sich nur um ein Authentisierung-Modul. Ein Benutzer muss erst über ein anderes Modul autorisiert werden, um anschließend über Kerberos authentisiert werden zu können.</p><p>Für den Betrieb wird eine eigene Keytab samt einem Hostkey benötigt.</p><p>Beispiel für <strong>/etc/freeradius/modules/krb5</strong>
</p><pre class="notranslate">krb5 {
        keytab = /etc/freeradius/keytab 
        service_principal = radius/radius.example.com
}</pre><p>Anschließend kann das Modul aktiviert und vom Client angefordert werden. Man kann allerdings auch eine Ersetzung vornehmen. So kann man z.B. PAP so umkonfigurieren, dass Kerberos genutzt wird. Prinzipbedingt funktioniert das nur mit Verfahren, bei dem FreeRADIUS das Password/Secret nicht verschlüsselt oder es im Klartext vorliegen muss. MSCHAP oder ähnliches lassen sich so nicht anbinden.</p><pre class="notranslate">authenticate {
        # PAP auf krb5 umleiten.
        Auth-Type PAP {
                krb5
        }
        # Einen eigenen Auth-Type anlegen.
        Auth-Type Kerberos {
                krb5
        }
}</pre></div><div class="section_2"><h3 id="huntgroups">huntgroups<a class="headerlink" href="#huntgroups">¶</a></h3><p>
Diese Datei wird vom Modul <code class="notranslate">preprocess</code> eingelesen. Standardmäßig erfolgt dies am Beginn der Verarbeitung. Huntgroups dienen dazu, NAS-Geräte nach gewissen Eigenschaften zu gruppieren. Im späteren Verlauf kann über den Select-Operator „Huntgroup-Name“ auf diese Information zugegriffen werden.</p><pre class="notranslate">access-points   NAS-IP-Address == 192.168.3.2, NAS-Port == 1
access-points   NAS-IP-Address == 192.168.2.1, NAS-Port == 2
access-points   NAS-IP-Address == 192.168.1.1, NAS-Port == 3</pre></div><div class="section_2"><h3 id="users">users<a class="headerlink" href="#users">¶</a></h3><p>
Diese Datei erfüllt zwei Aufgaben. Zum einen können hier direkt Benutzer-Informationen hinterlegt werden. Diese Angaben können einfache Login-Password Kombinationen oder komplexe Kombinationen wie Protokoll-Parameter, Auth-Methoden usw. sein. Beispiele sind in der Datei hinterlegt.</p><p>Die zweite Aufgabe wird über den „DEFAULT“-User erfüllt. Dieser „matched“ auf alle Benutzer, auch solche, die schon über andere Module autorisiert wurden. So kann man einfache „Regeln“ definieren. Alternativ kann man das etwas komplizierter in der Post-Auth-Sektion in der Default oder Inner-Tunnel-Datei realisieren.</p><p>In folgendem Beispiel werden alle Anfragen, die über die APs angenommen wurden, darauf überprüft, ob der zugeordnete Benutzer der LDAP-Group „Wireless“ angehören. Falls dies nicht der Fall ist, wird der Auth-Type auf EAP (Zertifikate) gesetzt. So haben nur Geräte mit gültigen Client-Zertifikaten oder der richtigen Gruppen-Zuordnung Zugriff auf das WLAN.</p><pre class="notranslate">DEFAULT Huntgroup-Name == access-points, Ldap-Group != "Wireless", Auth-Type := eap</pre></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/RADIUS">RADIUS</a> – Wikipedia</p></li><li><p><a class="internal" href="./serverdienste.html">Serverdienste</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> – Übersichtsseite</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./freeradius/a/revision/945722.html">Diese Revision</a> wurde am 25. Dezember 2017 16:42 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./freeradius.html">FreeRADIUS</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>