<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Wake_on_LAN › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./wake_on_lan.html">Wake on LAN</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Wake_on_LAN">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./wake_on_lan/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./wake_on_lan/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./wake_on_lan/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./wake_on_lan/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./wake_on_lan/a/backlinks.html">Wake on LAN</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./paketquellen_freischalten.html">Bearbeiten von Paketquellen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#WOL-im-BIOS-aktivieren">WOL im BIOS aktivieren
</a></li><li><a class="crosslink" href="#Ubuntu-fuer-WOL-vorbereiten">Ubuntu für WOL vorbereiten
</a><ol class="arabic"><li><a class="crosslink" href="#WOL-dauerhaft-aktivieren">WOL dauerhaft aktivieren
</a><ol class="arabic"><li><a class="crosslink" href="#Methode-1-etc-rc-local">Methode 1: /etc/rc.local
</a></li><li><a class="crosslink" href="#Methode-2-etc-network-interfaces">Methode 2: /etc/network/interfaces
</a></li></ol></li></ol></li><li><a class="crosslink" href="#halt-Skript-anpassen">halt-Skript anpassen
</a></li><li><a class="crosslink" href="#WOL-nach-Standby-oder-Suspend">WOL nach Standby oder Suspend
</a></li><li><a class="crosslink" href="#Aufwecken">Aufwecken
</a><ol class="arabic"><li><a class="crosslink" href="#etherwake">etherwake
</a></li><li><a class="crosslink" href="#wakeonlan">wakeonlan
</a></li></ol></li><li><a class="crosslink" href="#Problemloesungen">Problemlösungen
</a><ol class="arabic"><li><a class="crosslink" href="#BCM5723-Chipsatz">BCM5723-Chipsatz
</a></li><li><a class="crosslink" href="#Nforce-4-Chipsaetze">Nforce-4 Chipsätze
</a></li><li><a class="crosslink" href="#3c905c-Chipsatz">3c905c Chipsatz
</a></li><li><a class="crosslink" href="#Marvell-Yukon-Modul-sky2">Marvell Yukon (Modul "sky2")
</a></li><li><a class="crosslink" href="#Kernel-Parameter">Kernel-Parameter
</a></li><li><a class="crosslink" href="#proc-acpi-wakeup">/proc/acpi/wakeup
</a></li><li><a class="crosslink" href="#NIC-Module-bei-SUSPEND-nicht-entladen">NIC-Module bei SUSPEND nicht entladen
</a></li><li><a class="crosslink" href="#Neustart-als-provisorische-Loesung">Neustart als provisorische Lösung
</a></li><li><a class="crosslink" href="#TLP-Einstellung">TLP-Einstellung
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Unter Wake-on-LAN (WOL) versteht man, einen Rechner per Netzwerk einzuschalten. Dies ist z.B. sehr praktisch, wenn man einen Linux-Router oder Server hat und diesen ferngesteuert aus- und einschalten kann. Das Einschalten erfolgt meistens durch ein sogenanntes <a class="external" href="http://de.wikipedia.org/wiki/Wake_On_LAN#Magic_Packet" rel="nofollow">Magic Packet</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> .</p><p>Zum Wecken braucht man einen zweiten Rechner mit einem Programm, das ein "Magic Packet" erzeugt und an die MAC-Adresse der Netzwerkkarte des aufzuweckenden Rechners schickt. Damit WOL funktioniert, muss der Rechner dafür vorbereitet werden. Sowohl im BIOS als auch im System müssen die richtigen Einstellungen vorgenommen werden.</p><div class="section_1"><h2 id="WOL-im-BIOS-aktivieren">WOL im BIOS aktivieren<a class="headerlink" href="#WOL-im-BIOS-aktivieren">¶</a></h2><p>
Im ersten Schritt sollte man im BIOS des Rechners überprüfen, ob Wake-On-LAN überhaupt aktiviert ist. Die in Rechnern verbauten BIOS-Arten sind zu vielfältig, um detaillierte Tipps geben zu können. Doch unter den Bezeichnungen "Wake on LAN" oder "Power on PCI/PCIE Devices" sollte man fündig werden.</p><p>Eventuell muss man auch einen Schraubendreher in die Hand nehmen. Ältere PCI-Netzwerkkarten wurden oft mit einem kleinen Kabel mit dem Mainboard verbunden. Fehlt dieses Kabel, so geht eventuell WOL gar nicht. Moderne PCI-Netzwerkkarten brauchen dieses Kabel nicht mehr. Auf dem Mainboard integrierte Netzwerkadapter benötigen das Kabel mit Sicherheit ebenfalls nicht.</p></div><div class="section_1"><h2 id="Ubuntu-fuer-WOL-vorbereiten">Ubuntu für WOL vorbereiten<a class="headerlink" href="#Ubuntu-fuer-WOL-vorbereiten">¶</a></h2><p>
Die meisten Kernelmodule für Netzwerkkarten aktivieren beim Hochfahren Wake-On-LAN nicht. Dieses muss extra nach oder während des Starts des Systems durchgeführt werden. Dies geschieht über das Programm <a class="internal" href="./ethtool.html">ethtool</a>, das erst über das Paket</p><ul><li><p><strong>ethtool </strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install ethtool  </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install ethtool  </pre></div></div><p>
</p></div></div><p>nachinstalliert <sup><a href="#source-1">[1]</a></sup> werden muss. Mit <strong>ethtool</strong> können die Parameter und Einstellungen von Netzwerkkarten ausgelesen und verändert werden. Im Laufe des Wikis wird nur das Gerät "<code class="notranslate">eth0</code>" behandelt. Sollte man ein anderes Netzwerkgerät zu Wake-On-LAN benutzen wollen, so müssen die Befehle natürlich entsprechend angepasst werden. Über den Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ethtool eth0 </pre></div></div><p>
</p><pre class="notranslate">  Settings for eth0:
       Supported ports: [ TP MII ]
       Supported link modes:   10baseT/Half 10baseT/Full
                               100baseT/Half 100baseT/Full
[...]
       Auto-negotiation: on
       Supports Wake-on: pumbg
       Wake-on: g
       Current message level: 0x00000001 (1)
       Link detected: yes</pre><p>im Terminal <sup><a href="#source-3">[3]</a></sup> bekommt man angezeigt, wie die Optionen derzeit gesetzt sind. Besonders die Zeilen "Supports Wake-on" und "Wake-on" sollte man hier im Auge behalten. Die Bedeutung der einzelnen Buchstaben findet man in der <a class="internal" href="./man.html">Man-Page</a> zu ethtool.</p><div class="bash"><div class="contents"><pre class="notranslate">man ethtool </pre></div></div><p>
</p><pre class="notranslate">[...]
      wol p|u|m|b|a|g|s|d...
             Set Wake-on-LAN options.  Not all  devices  support  this.   The
             argument  to  this  option  is a string of characters specifying
             which options to enable.
             p  Wake on phy activity
             u  Wake on unicast messages
             m  Wake on multicast messages
             b  Wake on broadcast messages
             a  Wake on ARP
             g  Wake on MagicPacket(tm)
             s  Enable SecureOn(tm) password for MagicPacket(tm)
             d  Disable (wake on nothing).  This option clears  all  previous
                options.
[...]</pre><p>Mittels des Befehls</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ethtool -s eth0 wol g </pre></div></div><p>aktiviert man nun das Wake-On-LAN beim Eintreffen eines "MagicPacket". Allerdings überdauert diese Einstellung einen Neustart des Rechners nicht. Sie muss bei jedem Start des Rechners neu gesetzt werden.</p><div class="section_2"><h3 id="WOL-dauerhaft-aktivieren">WOL dauerhaft aktivieren<a class="headerlink" href="#WOL-dauerhaft-aktivieren">¶</a></h3><p>
Um diese Einstellung bei jedem Start des Rechners zu setzen, bieten sich verschiedene Wege an. Am einfachsten und zuverlässigsten ist sicherlich die erstgenannte Methode.</p><div class="section_3"><h4 id="Methode-1-etc-rc-local">Methode 1: /etc/rc.local<a class="headerlink" href="#Methode-1-etc-rc-local">¶</a></h4><p>
Die Datei <strong>/etc/rc.local</strong> wird bei jedem Boot-Vorgang ausgeführt. Sie ist dafür gedacht, einfache Befehle beim Start auszuführen. Daher ist sie der ideale Platz, um Wake-On-LAN zu aktivieren. Man trägt mit einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> einfach nur den Befehl</p><pre class="notranslate">ethtool -s eth0 wol g</pre><p>zum Aktivieren von WOL ein. Weitere Informationen finden sich im entsprechenden Wiki Artikel zur <a class="internal" href="./rc.local.html">rc.local</a>.
Sollte nach einem Neustart dennoch das Argument nicht gesetzt sein, wird rc.local evtl. zu früh, also noch vor dem Anlegen der Netzwerkschnittstelle, ausgeführt. In diesem Falle bleibt ein</p><pre class="notranslate">sleep 5
ethtool -s eth0 wol g</pre><p>bzw. die nächste Methode.</p></div><div class="section_3"><h4 id="Methode-2-etc-network-interfaces">Methode 2: /etc/network/interfaces<a class="headerlink" href="#Methode-2-etc-network-interfaces">¶</a></h4><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Seit Ubuntu "Intrepid Ibex" 8.10 ist die <strong>/etc/network/interfaces</strong> üblicherweise bis auf das loopback-Device "lo" leer. Der <a class="internal" href="./network-manager.html">Network-Manager</a> übernimmt bei einer Desktop-Installation vollständig die Verwaltung der Netzwerke. Daher bietet sich hier besonders die erste Methode an, da es keine graphische Oberfläche mehr gibt, um die <a class="internal" href="./interfaces.html">interfaces</a> Datei zu bearbeiten.
</p></div></div><p>Hier ist ebenfalls mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> die Datei <strong>/etc/network/<a class="internal" href="./interfaces.html">interfaces</a></strong> zu bearbeiten. Für jedes Interface, auf dem Wake-On-Lan aktiviert werden soll, muss die Zeile <code class="notranslate">pre-down /usr/sbin/ethtool -s &lt;netzwerkdevice&gt; wol g</code> ergänzt werden. Ein so konfiguriertes Netzwerkgerät sieht dann beispielsweise so aus:</p><pre class="notranslate">auto eth0
iface eth0 inet static
    address 192.168.0.97
    netmask 255.255.255.0
    gateway 192.168.0.1
    pre-down /usr/sbin/ethtool -s eth0 wol g</pre><p>Dabei ist zu beachten, dass manuell über die /etc/network/interfaces konfigurierte Netzwerk-Geräte nicht mehr im <a class="internal" href="./network-manager.html">Network-Manager</a> erscheinen. Diese Konfiguration bietet sich daher im Endeffekt nur für Serversysteme an.</p></div></div></div><div class="section_1"><h2 id="halt-Skript-anpassen">halt-Skript anpassen<a class="headerlink" href="#halt-Skript-anpassen">¶</a></h2><p>
Unglücklicherweise reicht das noch nicht aus, damit der Rechner wieder aufwacht. Schuld daran ist das Skript <strong>/etc/init.d/halt</strong>, das beim Herunterfahren des Systems ausgeführt wird. Es schaltet von Haus aus alle Netzwerkschnittstellen aus und macht damit die bisherige Arbeit wieder zunichte.</p><p>Um das Deaktivieren der Netzwerkkarten beim Herunterfahren zu verhindern, öffnet man die Datei <strong>/etc/default/halt</strong> in einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> und fügt die Variable "NETDOWN" mit dem Wert "no" ein:</p><pre class="notranslate">NETDOWN=no</pre><p>Danach bleiben die Karten aktiviert. Änderungen des Init-Skriptes <strong>"/etc/init.d/halt"</strong> werden <strong> bei Ubuntu-Updates überschrieben!</strong></p></div><div class="section_1"><h2 id="WOL-nach-Standby-oder-Suspend">WOL nach Standby oder Suspend<a class="headerlink" href="#WOL-nach-Standby-oder-Suspend">¶</a></h2><p>
Wer seinen Rechner nicht richtig herunterfährt, sondern lediglich Standby oder den Ruhezustand benutzt, der stellt eventuell fest, dass WOL nach dem Tiefschlaf nicht funktioniert. Hier hilft es, WOL wie oben beschrieben einzurichten und anschließend in der Datei <strong>/etc/default/acpi-support</strong> die Option</p><pre class="notranslate"># Add services to this list to stop them before suspend and restart them in
# the resume process.
STOP_SERVICES=""</pre><p>um den Eintrag <strong>networking</strong> zu erweitern, so dass die Option danach so</p><pre class="notranslate"># Add services to this list to stop them before suspend and restart them in
# the resume process.
STOP_SERVICES="networking"</pre><p>aussieht. Eventuell stehen hier schon andere Einträge. Hier muss man "networking" mit einem Leerzeichen abgetrennt einfügen. Welche weiteren Einträge dort vorhanden sind, hängt von den auf dem System installierten Programmen ab - die Zeile sieht beispielsweise so <em>STOP_SERVICES="mysql lirc networking"</em> aus.</p></div><div class="section_1"><h2 id="Aufwecken">Aufwecken<a class="headerlink" href="#Aufwecken">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das Aufwecken eines Rechners ist <strong>nur</strong> innerhalb des eigenen lokalen Netzwerkes möglich, da die "Magic Packets" nicht routingfähig sind. Es ist daher nicht möglich, einen Rechner direkt über das Internet aufzuwecken. Möchte man dies tun, so benötigt man einen Router oder Rechner im LAN, den man vom Internet aus erreichen kann. Manche Hardware-Router bieten in ihren Web-Frontends sogar Wake-On-LAN-Funktionen an.
</p></div></div><p>Hat man dies alles gemacht, kann man den zu weckenden Rechner herunterfahren. Von einem zweiten Rechner im lokalen Netzwerk aus kann man versuchen, den Rechner aufzuwecken. Dazu benötigt man die <a class="external" href="http://de.wikipedia.org/wiki/MAC-Adresse" rel="nofollow">MAC-Adresse</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> des aufzuweckenden Rechners. Man findet sie beispielsweise auf der Netzwerkkarte oder eventuell auf der Rückseite des Rechners. Alternativ kann man sie über den Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">ifconfig eth0 | grep "Hardware Adresse" </pre></div></div><p>
</p><pre class="notranslate">eth0      Link encap:Ethernet  Hardware Adresse 00:0c:5e:17:23:7a</pre><p>herausfinden. Die MAC-Adresse wäre in diesem Fall die Zeichenfolge <em>"00:0c:5e:17:23:7a"</em>. Zum Aufwecken stehen verschiedene Programme zur Verfügung.</p><div class="section_2"><h3 id="etherwake">etherwake<a class="headerlink" href="#etherwake">¶</a></h3><p>
Für Ubuntu gibt es ein Programm im Paket</p><ul><li><p><strong>etherwake</strong> (<em>universe</em> )</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install etherwake </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install etherwake </pre></div></div><p>
</p></div></div><p>welches einfach über die Paketverwaltung installiert <sup><a href="#source-1">[1]</a></sup> werden kann. Der Aufruf erfolgt im Terminal <sup><a href="#source-3">[3]</a></sup> mit</p><div class="bash"><div class="contents"><pre class="notranslate"># Allgemein
sudo etherwake &lt;mac-adresse&gt;
#Beispiel
sudo etherwake 00:0c:5e:17:23:7a </pre></div></div></div><div class="section_2"><h3 id="wakeonlan">wakeonlan<a class="headerlink" href="#wakeonlan">¶</a></h3><p>
Mit diesem Befehl ist es komfortabler möglich, verschiedene Rechner per LAN aufzuwecken. Unter anderem lassen sich die Hardwareadressen in Dateien speichern. Das benötigte Paket <sup><a href="#source-1">[1]</a></sup> heißt</p><ul><li><p><strong>wakeonlan</strong> (<em>universe</em> )</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install wakeonlan </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install wakeonlan </pre></div></div><p>
</p></div></div></div></div><div class="section_1"><h2 id="Problemloesungen">Problemlösungen<a class="headerlink" href="#Problemloesungen">¶</a></h2><p>
Selbst wenn man all diese Einstellungen vorgenommen hat, kann man über eine Reihe von Problemen stolpern. Im Folgenden sind weitere Problemlösungen gesammelt. Man sollte diese nicht wahllos durchprobieren und "eingebaut" lassen, sondern die einzelnen Tipps nach und nach probieren. Einige der genannten Tipps haben Nachteile, wie z.B. das Deaktivieren des modernen Stromsparmechanismus ACPI zugunsten des veralteten APMs.</p><div class="section_2"><h3 id="BCM5723-Chipsatz">BCM5723-Chipsatz<a class="headerlink" href="#BCM5723-Chipsatz">¶</a></h3><p>
Bei einer Broadcom NetXtreme Netzwerkkarte mit dem BCM5723-Chipsatz, Treibermodul: tg3 Version 3.128 funktioniert folgender Weg lt <a class="crosslink user" href="https://ubuntuusers.de/user/fx-83/">fx-83</a>:
Eine Datei <strong>/etc/rc0.d/K99wol_poweroff</strong> erstellen und ausführbar machen. Folgender Inhalt:
</p><pre class="notranslate">#!/bin/bash
ifconfig eth0 down 
poweroff</pre></div><div class="section_2"><h3 id="Nforce-4-Chipsaetze">Nforce-4 Chipsätze<a class="headerlink" href="#Nforce-4-Chipsaetze">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die umgekehrte MAC-Adresse kommt nur vor, wenn man den Rechner "richtig" heruntergefahren hat. Fährt man den Rechner in den Standby- oder Ruhezustand, so kann er nur mit der MAC-Adresse in der richtigen Reihenfolge geweckt werden.
</p></div></div><p>Im Kernel gibt es <a class="external" href="https://bugs.launchpad.net/ubuntu/+source/linux/+bug/288053" rel="nofollow">einen</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <a class="external" href="http://bugzilla.kernel.org/show_bug.cgi?id=6604" rel="nofollow">Fehler</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> , der bewirkt, dass die MAC-Adresse beim Herunterfahren in der falschen Reihenfolge auf die Netzwerkkarte geschrieben wird. Mittels des Befehls</p><div class="bash"><div class="contents"><pre class="notranslate">lsmod | grep forcedeth </pre></div></div><p>
</p><pre class="notranslate">forcedeth              68112  0</pre><p>findet man heraus, ob die eigene Hardware diesen Treiber benutzt. Wer nun Hardware besitzt, die den <strong>forcedeth</strong>-Treiber verwendet, und das Aufwecken über die "richtige" MAC nicht klappt, kann man versuchen, seine MAC-Adresse verkehrt herum einzugeben. Also statt 01:02:03:04:05:06 dreht man die Folge um: 06:05:04:03:02:01.</p></div><div class="section_2"><h3 id="3c905c-Chipsatz">3c905c Chipsatz<a class="headerlink" href="#3c905c-Chipsatz">¶</a></h3><p>
Netzwerkkarten mit dem <a class="external" href="http://support.3com.com/infodeli/tools/nic/3c905c/family.htm" rel="nofollow">3C905C</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> Chipsatz von 3Com brauchen eine Option, die beim Laden des Kernelmoduls <em>"3c59x"</em> geladen werden muss. Dazu fügt man <sup><a href="#source-4">[4]</a></sup> in der Datei <strong>/etc/modprobe.d/options</strong> die Zeile</p><pre class="notranslate">options 3c59x enable_wol=1</pre><p>ein und startet den Rechner neu. Ob solch eine Netzwerkkarte im eigenen Rechner verbaut ist, kann man mittels</p><div class="bash"><div class="contents"><pre class="notranslate">lsmod | grep 3c59x </pre></div></div><p>
</p><pre class="notranslate">3c59x                  46248  0 
mii                     6400  1 3c59x</pre><p>überprüfen. Sollte die Ausgabe leer sein, so wurde das Kernelmodul nicht geladen. Daher wird auch keine Netzwerkkarte im Rechner verbaut sein, die solch einen Chipsatz benutzt.</p></div><div class="section_2"><h3 id="Marvell-Yukon-Modul-sky2">Marvell Yukon (Modul "sky2")<a class="headerlink" href="#Marvell-Yukon-Modul-sky2">¶</a></h3><p>
Bei diesem Ethernetadapter kann es <a class="external" href="http://lists.debian.org/debian-kernel/2012/05/msg00123.html" rel="nofollow">helfen</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>, den Modul-Parameter "legacy_pme" auf "1" zu setzen. Der Parameter wurde ist jedoch erst ab Kernel 3.2.14-1 vorhanden.
Dazu muss dem Kernel der Parameter</p><pre class="notranslate">sky2.legacy_pme=1</pre><p>übergeben werden. Alternativ ist auch ein Eintrag in modprobe.d möglich:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo sh -c 'echo "options sky2 legacy_pme=1" &gt;&gt; /etc/modprobe.d/sky2.conf'; sudo update-initramfs -u </pre></div></div></div><div class="section_2"><h3 id="Kernel-Parameter">Kernel-Parameter<a class="headerlink" href="#Kernel-Parameter">¶</a></h3><p>
Bei diversen Serversystemen hilft es, auf ACPI zu verzichten und APM zu benutzen (z.B.: HP Server tc2110). Dazu bearbeitet man die Datei <strong>/boot/grub/menu.lst</strong> mit einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup> und fügt in der Zeile mit den "defoptions" die Kernel-Parameter <em>"apm=on apm=power-off"</em> hinzu. Die Zeile</p><pre class="notranslate">[...]
# defoptions=quiet splash language=de_DE
[...]</pre><p>muss dann beispielsweise so</p><pre class="notranslate">[...]
# defoptions=quiet splash language=de_DE apm=on apm=power-off
[...]</pre><p>aussehen. Damit diese Optionen in die Kernelzeilen geschrieben werden, muss noch der Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>ausgeführt werden. Nun sollte man den Rechner neu starten und Wake-On-LAN testen. Weitere Informationen zum Laden von Kernel-Parametern beim Starten findet man im Wiki-Artikel <a class="internal" href="./menu.lst.html">menu.lst</a>.</p></div><div class="section_2"><h3 id="proc-acpi-wakeup">/proc/acpi/wakeup<a class="headerlink" href="#proc-acpi-wakeup">¶</a></h3><p>
Sollte WOL nach wie vor nicht funktionieren, so kann man sich den Inhalt der "virtuellen" Datei <strong>/proc/acpi/wakeup</strong> ansehen.</p><div class="bash"><div class="contents"><pre class="notranslate">cat /proc/acpi/wakeup </pre></div></div><p>
</p><pre class="notranslate">Device	S-state	  Status   Sysfs node
HUB0	  S5	 disabled  pci:0000:00:06.0
XVR0	  S5	 disabled  pci:0000:00:0f.0
[...]
AZAD	  S5	 disabled  pci:0000:00:06.1
MMAC	  S5	 disabled  pci:0000:<strong class="highlighted">00:08.0</strong></pre><p>Man erkennt, dass WOL für alle Geräte ("devices") deaktiviert ist! Ein Vergleich der Device-Nummern mit</p><div class="bash"><div class="contents"><pre class="notranslate">lspci </pre></div></div><p>
</p><pre class="notranslate">[...]
<strong class="highlighted">00:08.0</strong> Bridge: nVidia Corporation MCP55 Ethernet (rev a2)
[...]</pre><p>lässt hier die Zugehörigkeit von <strong>MMAC</strong> zum kabelgebundenen Netzwerkinterface erkennen. Zum Testen aktiviert man mittels des Befehls</p><div class="bash"><div class="contents"><pre class="notranslate">echo -n MMAC | sudo tee /proc/acpi/wakeup </pre></div></div><p>WOL für das gerade herausgefundene Gerät. Auf dem eigenen Rechner muss man die Angabe des "device" sicherlich anpassen. Den Erfolg kann man nun mittels</p><div class="bash"><div class="contents"><pre class="notranslate">cat /proc/acpi/wakeup </pre></div></div><p>
</p><pre class="notranslate">Device  S-state   Status   Sysfs node
[...]
MMAC	  S5	 enabled   pci:0000:00:08.0
[...]</pre><p>überprüfen. Sollte ein Wake-On-LAN nun funktionieren, so bietet es sich an, die Zeile</p><pre class="notranslate">echo -n MMAC | tee /proc/acpi/wakeup</pre><p>in die <a class="internal" href="./rc.local.html">rc.local</a> aufzunehmen, so dass sie bei jedem Neustart des Systems ausgeführt wird.</p></div><div class="section_2"><h3 id="NIC-Module-bei-SUSPEND-nicht-entladen">NIC-Module bei SUSPEND nicht entladen<a class="headerlink" href="#NIC-Module-bei-SUSPEND-nicht-entladen">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Dies gilt für Ubuntu 8.04 und eventuell auch spätere Versionen! Das ist ein Workaround, der überprüft werden muss.
</p></div></div><ul><li><p>Die Datei <strong>/usr/lib/pm-utils/sleep.d/50modules</strong>ins Verzeichnis <strong>/etc/pm/sleep.d/</strong> kopieren. Dadurch wird nicht mehr der <a class="internal" href="./pm-utils.html#pm-utils-Hooks">pm-utils-Hook</a> aus <strong>/usr/lib/pm-utils/sleep.d/</strong> sondern der angepasste aus dem Verzeichnis  <strong>/etc/pm/sleep.d/</strong>. Ausserdem wird dadurch das angepasste Skript nicht beim nächsten Update des Pakets <a class="internal" href="./pm-utils.html">pm-utils</a> durch die Standard-Version ersetzt.</p></li></ul><pre class="notranslate">sudo cp /usr/lib/pm-utils/sleep.d/50modules /etc/pm/sleep.d/
sudo chmod +x /etc/pm/sleep.d/50modules</pre><p>
</p><ul><li><p>Im Skript <strong>/etc/pm/sleep.d/50modules</strong> den Inhalt der Funktion <strong>unload_network()</strong> kommentieren. Das sollte so aussehen:</p></li></ul><pre class="notranslate">unload_network()
{
#       for x in /sys/class/net/*; do
#       if [ -e $x/device/driver ]; then
#               NETMODULES="$NETMODULES $(basename $(readlink $x/device/driver) | tr [:upper:\] [:lower:])"
#       fi
#       done
#       for x in $NETMODULES; do
#               modunload $x;
#       done
#       if [ -d /sys/module/ndiswrapper ]; then
#               modunload ndiswrapper;
#       fi
}</pre><p>
</p><ul><li><p>Anschließend sollte WOL funktionieren!</p></li></ul><p>
Für ältere Versionen von Ubuntu, müsste eine Datei 60-generate-modules-list.sh und 55-down-interfaces.sh unter <strong>/etc/acpi/sleep.d/</strong> sein, welche wahrscheinlich das gleiche tut. Konnte ich bis jetzt aber nicht testen!</p></div><div class="section_2"><h3 id="Neustart-als-provisorische-Loesung">Neustart als provisorische Lösung<a class="headerlink" href="#Neustart-als-provisorische-Loesung">¶</a></h3><p>
Möglicherweise lässt sich der Rechner trotz allem nicht aufwecken, wenn er aus Ubuntu/Linux heraus heruntergefahren wurde. In manchen Fällen befindet sich der Computer aber in einem aufweckbaren Zustand, wenn er aus einem anderen Betriebssystem oder aus dem Bootloader heraus heruntergefahren wurde. In diesem Fall hilft es nach jedem Linux-Herunterfahren einmal kurz neu zu starten und wieder aus zu schalten. Dies lässt sich bequem über die folgenden Befehle erledigen, die <a class="external" href="http://www.vdrportal.de/board/thread.php?postid=848345" rel="nofollow">diesem</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> Beitrag entnommen sind. Diese Anleitung bezieht sich auf <a class="internal" href="./grub_2.html">Grub 2</a>.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bei Änderungen am Bootloader sollte man immer mit Bedacht vorgehen und Sicherheitskopien anlegen.
</p></div></div><p>Zunächst muss ein neuer Boot-Eintrag erstellt werden. Dazu wird die Datei <strong>/etc/grub.d/40_custom</strong> wie folgt angepasst:
</p><pre class="notranslate">#!/bin/sh
exec tail -n +3 $0
# This file provides an easy way to add custom menu entries.  Simply type the
# menu entries you want to add after this comment.  Be careful not to change
# the 'exec tail' line above.
menuentry "PowerOff" {
saved_entry=0
save_env saved_entry
halt
}</pre><p>In der <strong>/etc/default/grub</strong> muss folgende Zeile angepasst werden:
</p><pre class="notranslate">GRUB_DEFAULT=saved</pre><p>Nach jeder Änderung an der Datei <strong>/etc/default/grub</strong> muss die Grubkonfiguration aktualisiert werden:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-grub </pre></div></div><p>Der Rechner sollte dann mit folgendem Befehl heruntergefahren werden:
</p><div class="bash"><div class="contents"><pre class="notranslate">grub-set-default PowerOff ; shutdown -r now </pre></div></div></div><div class="section_2"><h3 id="TLP-Einstellung">TLP-Einstellung<a class="headerlink" href="#TLP-Einstellung">¶</a></h3><p>
Unter Ubuntu 16.04 muss für WOL zusätzlich eine Einstellung des Power-Management-Tools TLP geändert werden. Dazu wird in der Datei <strong>/etc/default/tlp</strong> die Zeile
</p><pre class="notranslate">WOL_DISABLE=Y</pre><p>
zu
</p><pre class="notranslate">WOL_DISABLE=N</pre><p>
geändert. Ein Neustart ist nötig, um diese Änderung zu übernehmen.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.vdr-wiki.de/wiki/index.php/WAKE_ON_LAN" rel="nofollow">Ausführliches Wake-on-LAN Wiki</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </p></li><li><p><a class="external" href="http://stephan.mestrona.net/wol/" rel="nofollow">MagicPacket(TM) als Web-Formular</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./wake_on_lan/a/revision/940372.html">Diese Revision</a> wurde am 8. Mai 2017 12:16 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./wake_on_lan.html">Wake on LAN</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>