<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Alix/CF-Bootmedium_erstellen › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../alix/cf-bootmedium_erstellen.html">CF-Bootmedium erstellen</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Alix/CF-Bootmedium_erstellen">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../alix/cf-bootmedium_erstellen/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../alix/cf-bootmedium_erstellen/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../alix/cf-bootmedium_erstellen/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../alix/cf-bootmedium_erstellen/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../alix/cf-bootmedium_erstellen/a/backlinks.html">CF-Bootmedium erstellen</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="../trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../sudo.html">Root-Rechte erlangen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../sources.list.html">Paketquellen Einrichten</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../chroot.html">Der Befehl chroot</a></p></li><li><p><a class="crosslink anchor" href="#source-7" id="source-7"></a> <a class="internal" href="../fstab.html">Laufwerke in /etc/fstab statisch einbinden</a></p></li><li><p><a class="crosslink anchor" href="#source-8" id="source-8"></a> <a class="internal" href="../packprogramme.html">Archive entpacken</a></p></li><li><p><a class="crosslink anchor" href="#source-9" id="source-9"></a> <a class="internal" href="../partitionierung/grundlagen.html">Grundlagen der Partitionierung</a></p></li><li><p><a class="crosslink anchor" href="#source-10" id="source-10"></a> <a class="internal" href="../kernelmodule.html">Umgang mit Kernelmodulen (Treibern)</a></p></li><li><p><a class="crosslink anchor" href="#source-11" id="source-11"></a> <a class="internal" href="../grub_2.html">GRUB 2</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Voraussetzungen">Voraussetzungen
</a></li><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Partitionierung-und-Formatierung">Partitionierung und Formatierung
</a></li><li><a class="crosslink" href="#Installation-des-Basissystems">Installation des Basissystems
</a></li><li><a class="crosslink" href="#Konfiguration-des-Basissystems">Konfiguration des Basissystems
</a></li><li><a class="crosslink" href="#Erster-Start">Erster Start
</a></li></ol></li><li><a class="crosslink" href="#Finale-Konfiguration-und-Optimierung">Finale Konfiguration und Optimierung
</a><ol class="arabic"><li><a class="crosslink" href="#Aktualisierung-und-Softwareinstallation">Aktualisierung und Softwareinstallation
</a></li><li><a class="crosslink" href="#Ansteuerung-der-LEDs">Ansteuerung der LEDs
</a></li><li><a class="crosslink" href="#Fazit">Fazit
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Dieser Artikel erklärt detailliert, wie man eine Compact Flash Karte auf einem anderen Computer mit einem fertigen Betriebssystem für <a class="internal" href="../alix.html">Alix-Boards</a> vorbereitet. Die meisten Anleitungen, die sich im Internet finden lassen, erklären, wie eine Installation auf der Maschine selber funktioniert. Dies scheitert aber sehr oft daran, dass gerade, wo man es bräuchte, das Null-Modem Kabel verschwunden ist, das neue Notebook oder der Computer ja gar keine serielle Schnittstelle mehr hat und zu einer ungünstigen Uhrzeit ein solches auch nicht mal eben schnell aufzutreiben ist.</p><p>Die Herausforderung liegt also darin, die Installation vollkommen offline auf einer anderen Maschine vorzubereiten, die daraus resultierende CF-Karte ins Alix-Board einzulegen, den Strom und das Netzwerk anzuschließen und sich nach wenigen Sekunden per <a class="internal" href="../ssh.html">SSH</a> einloggen zu können.</p><div class="section_1"><h2 id="Voraussetzungen">Voraussetzungen<a class="headerlink" href="#Voraussetzungen">¶</a></h2><p>
Um mit der Installation zu beginnen, muss folgendes vorhanden sein:
</p><ul><li><p>Ein funktionierendes Netzwerk, welches Zugriff auf das Internet erlaubt.</p></li><li><p>Ein Rechner, auf dem ein Ubuntu läuft. Die Version ist prinzipiell egal, aber es ist ratsam, mindestens ein Ubuntu 8.04 zu verwenden, da ältere Versionen von <strong>debootstrap</strong> unter Umständen nicht mehr so funktionieren, wie es für eine korrekte Installation nötig wäre.</p></li><li><p>Ein funktionsfähiges Alix-Board. Mit Hilfe des Verfahrens, welches in dieser Anleitung beschrieben wird, wurden Systeme für verschiedene Alix-Boards der Serie 2D.. aufgesetzt. Prinzipiell sollte diese Anleitung für alle Alix-Boards mit nur einer serieller Schnittstelle geeignet sein (um funktionierende Betriebssystems-Images erzeugen zu können).</p></li><li><p>Eine möglichst schnelle Compact Flash Karte, die mindestens 1GB groß sein sollte. Die Gesamtkapazität ist allerdings vom späteren Verwendungszweck abhängig.</p></li><li><p>ein externer Kartenleser</p></li></ul><p>
Sind alle diese Voraussetzungen erfüllt, kann mit der Installation begonnen werden.</p></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Nahezu alle hier nachfolgend aufgeführten Befehle erfordern Root-Rechte <sup><a href="#source-1">[1]</a></sup>. Um nicht jedem dieser Befehle <strong>sudo</strong> voranstellen zu müssen, empfiehlt es sich, die Installation in einer Root-Shell auszuführen. Diese kann durch Eingabe des Befehls <strong>sudo su</strong> erreicht werden.
</p></div></div><p>Im Laufe dieses Artikels werden des öfteren Pakete mit <a class="internal" href="../apt-get.html">apt-get</a> installiert und deinstalliert. Dieser Befehl stellt nicht die einzige Möglichkeit dar, dies zu erreichen. Es ist zum Beispiel möglich, alternativ den Befehl <a class="internal" href="../aptitude.html">aptitude</a> zu verwenden, bei dem allerdings unter Umständen dann andere Parameter angegeben werden müssen.</p><div class="section_2"><h3 id="Partitionierung-und-Formatierung">Partitionierung und Formatierung<a class="headerlink" href="#Partitionierung-und-Formatierung">¶</a></h3><p>
Um die Compact Flash Karte benutzen zu können, muss diese zuerst partitioniert und formatiert werden. Nach dem Einlegen im Kartenleser muss zunächst der Gerätename, unter dem die Karte angesprochen werden kann, ermittelt werden. Dies erreicht man, in dem man die Ausgaben des System Log beobachtet. Folgender Befehl, vor dem Einlegen der Karte ausgeführt, zeigt die bisherigen Meldungen:</p><div class="bash"><div class="contents"><pre class="notranslate">tail -f /var/log/messages </pre></div></div><p>Nach dem Einlegen der CF-Karte sollten dann neue Meldungen wie diese hier erscheinen:</p><pre class="notranslate">Nov 25 06:36:10 transpoldo kernel: [58904.010195] sd 2:0:0:1: [sdc] 7847280 512-byte hardware sectors (4018 MB)
Nov 25 06:36:10 transpoldo kernel: [58904.016240] sd 2:0:0:1: [sdc] Write Protect is off
Nov 25 06:36:10 transpoldo kernel: [58904.026204] sd 2:0:0:1: [sdc] 7847280 512-byte hardware sectors (4018 MB)
Nov 25 06:36:10 transpoldo kernel: [58904.032226] sd 2:0:0:1: [sdc] Write Protect is off
Nov 25 06:36:10 transpoldo kernel: [58904.037168]  sdc: sdc1</pre><p>Hieran kann man erkennen, dass die CF-Karte den Gerätenamen <strong>/dev/sdc</strong> bekommen hat und sich darauf eine Partition mit dem Gerätenamen <strong>/dev/sdc1</strong> befindet. An diesem Punkt kann das Partitionierungsprogramm aufgerufen werden <sup><a href="#source-9">[9]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">fdisk /dev/sdc </pre></div></div><p>Im Partitionierungsprogramm sollten dann eventuell vorhandene Partitionen gelöscht werden, eine neue primäre Partition vom Typ 83 (Linux) die die ganze Karte umfasst erstellt werden und diese mit einem Boot-Flag versehen werden (Befehl 'a'). Das sieht bei einer 4 GB Karte ungefähr so aus:</p><pre class="notranslate">Disk /dev/sdc: 4017 MB, 4017807360 bytes
128 heads, 63 sectors/track, 973 cylinders
Units = cylinders of 8064 * 512 = 4128768 bytes
Disk identifier: 0x00000000

   Device Boot      Start         End      Blocks   Id  System
/dev/sdc1   *           1         973     3923104+  83  Linux</pre><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Ohne das Setzen des Boot-Flags (was man am Sternchen neben dem Gerätenamen der Partition erkennen kann), wird das System nicht von der Partition starten.
</p></div></div><p>Nun kann die Partitionierung beendet werden, um mit der Erstellung des Dateisystems fortzufahren:</p><div class="bash"><div class="contents"><pre class="notranslate">mke2fs -t ext2 -L root /dev/sdc1 </pre></div></div><p>Wie man hier sehen kann, wurde dem Volumen der Name <code class="notranslate">root</code> gegeben (was das Einhängen nach Namen erlaubt), und als Dateisystem wurde <strong>ext2</strong> gewählt, was aufgrund der geringeren Anzahl Schreibzugriffe wegen der fehlenden Implementation des "Journaling", das Flash-RAM der CF-Karte schont. Da heutzutage moderne Flash-Controller über die Fähigkeit verfügen, die Schreibzugriffe gleichmäßig auf die Speicherzellen zu verteilen, wird die Wirksamkeit dieser Maßnahme zur Zeit kontrovers diskutiert. Die Benutzung des Dateisystems <strong>ext3</strong> oder gar eines anderen Dateisystems ist durchaus auch möglich.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Mit Angabe des Parameters <code class="notranslate">-L root</code> wurde dem Volumen der Name <code class="notranslate">root</code> gegeben. Auf Systemen mit <a class="internal" href="../udev.html">udev</a> erlaubt dies, die Partition nicht nur durch ihren Gerätenamen <strong>/dev/sdc1</strong> sondern auch durch den Namen <strong>/dev/disk/by-label/root</strong> anzusprechen (bei gerade erst erstellten Volumen allerdings erst nach Eingabe des Befehls <strong>udevtrigger</strong>). Damit kann man das Problem mit ständig wechselnden Gerätenamen etwas entschärfen. Legt man z.B. ein USB Stick ein, kann es beim nächsten Neustart durchaus passieren, dass die Reihenfolge der Gerätenamen sich geändert hat. Das identifizieren nach Namen funktioniert allerdings nur, solange diese Namen auch eindeutig sind. Besser gelingt hier eine Identifizierung nach <a class="internal" href="../uuid.html">UUID</a>. Diese pseudo-eindeutige Identifikationsnummer wird bei Erstellen des Dateisystems erzeugt und die Partition kann dann über <strong>/dev/disk/by-id/&lt;UUID&gt;</strong> angesprochen werden. Allerdings ist auch hier die Eindeutigkeit nicht wirklich gewährleistet, da einige Formatierungsprogramme wie z.B. <strong>mkswap</strong> das Angeben einer UUID erlauben. Außerdem kann eine Partition auch geklont werden.
</p></div></div><p>Nach erfolgreicher Erzeugung des Dateisystems kann die neue formatierte CF-Karte ins Dateisystem eingebunden werden, um mit der Installation fortzufahren.</p><div class="bash"><div class="contents"><pre class="notranslate">mkdir /mnt/alix
mount /dev/sdc1 /mnt/alix </pre></div></div></div><div class="section_2"><h3 id="Installation-des-Basissystems">Installation des Basissystems<a class="headerlink" href="#Installation-des-Basissystems">¶</a></h3><p>
Zu Beginn wird auf der Karte ein minimales Basissystem installiert. Dafür wird das Paket
</p><ul><li><p><strong>debootstrap</strong></p></li></ul><p>verwendet. Ist dieses nicht bereits installiert, so muss man es zuerst installieren <sup><a href="#source-2">[2]</a></sup>.</p><p>Die Installation des Basissystems erfolgt mittels Eingabe des Befehls:</p><ul><li><p>Ubuntu 14.04: </p><div class="bash"><div class="contents"><pre class="notranslate">debootstrap --arch i386 trusty /mnt/alix http://de.archive.ubuntu.com/ubuntu </pre></div></div></li></ul><p>Dieser Vorgang dauert je nach Geschwindigkeit der Internetverbindung (falls noch Pakete heruntergeladen werden müssen) und je nach Schreibgeschwindigkeit der CF-Karte verschieden lange.</p><div class="section_3"><h4 id="Wechsel-in-das-Zielsystem">Wechsel in das Zielsystem<a class="headerlink" href="#Wechsel-in-das-Zielsystem">¶</a></h4><p>
Ist dieser Vorgang erfolgreich beendet, ist es Zeit, in das neue Dateisystem zu wechseln<sup><a href="#source-6">[6]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">mount -o bind /dev /mnt/alix/dev
mount -o bind /sys /mnt/alix/sys
mount -o bind /proc /mnt/alix/proc
chroot /mnt/alix /bin/bash </pre></div></div></div></div><div class="section_2"><h3 id="Konfiguration-des-Basissystems">Konfiguration des Basissystems<a class="headerlink" href="#Konfiguration-des-Basissystems">¶</a></h3><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Ab hier ist man per <a class="internal" href="../chroot.html">chroot</a> auf dem späteren Zielsystem unterwegs. Alle eingegebenen Befehle im momentanen Terminal wirken sich nur dort aus!
</p></div></div><div class="section_3"><h4 id="Namensaufloesung">Namensauflösung<a class="headerlink" href="#Namensaufloesung">¶</a></h4><p>
Jedes System braucht eigentlich keinen Namen, aber mit einem Namen lässt es sich besser leben:</p><div class="bash"><div class="contents"><pre class="notranslate">echo alix-router &gt; /etc/hostname </pre></div></div><p>Und damit die ganze Namensauflösung zumindest rudimentär funktioniert, sollte die Datei <strong>/etc/hosts</strong> folgenden Inhalt haben:</p><pre class="notranslate">127.0.0.1		localhost
127.0.1.1		alix-router.example.com alix-router

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts</pre><p>Es lohnt sich auch, einen kurzen Blick in die Datei <strong>/etc/resolv.conf</strong> zu werfen. debootstrap kopiert hier üblicherweise die Datei des erzeugenden Systems rein. Da das Alix-System zunächst im selben Netzwerk angeschlossen werden wird, stellt das kein Problem dar. Will man jedoch sicher stellen, dass auch nach einer Umkonfiguration die Namensauflösung höchstwahrscheinlich funktioniert, empfiehlt es sich hier, als Nameserver generell erreichbare wie z.B. die OpenDNS- und Google-Server einzutragen:</p><pre class="notranslate">nameserver 8.8.8.8
nameserver 208.67.222.222
nameserver 8.8.4.4
nameserver 208.67.220.220</pre></div><div class="section_3"><h4 id="Dateisystem">Dateisystem<a class="headerlink" href="#Dateisystem">¶</a></h4><p>
Folgende Dateisystem-Tabelle <a class="internal" href="../fstab.html">/etc/fstab</a> <sup><a href="#source-7">[7]</a></sup> stellt sicher, dass das System auch alle seine Dateisysteme korrekt einhängt:</p><pre class="notranslate"># /etc/fstab: static file system information.
#
# &lt;file system&gt;                 &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;                       &lt;dump&gt;  &lt;pass&gt;
proc                            /proc           proc    defaults                        0       0

# /dev/sda1
LABEL=root                      /               ext2    noatime,errors=remount-ro       0       0

tmpfs                           /tmp            tmpfs   defaults,noatime                0       0
tmpfs                           /var/tmp        tmpfs   defaults,noatime                0       0</pre><p>Die Option <code class="notranslate">noatime</code> beim Root-Dateisystem verhindert, dass jeder Dateizugriff (also auch lesende Zugriffe) das sogenannte <code class="notranslate">atime</code> Attribut (Zeitstempel des letzten Zugriffes) aktualisiert. Dies schont den Flash-Speicher der CF-Karte. Aus diesem Grunde werden hier auch die temporären Verzeichnisse als RAM-Disk ausgelegt. Um den Flash-Speicher noch weiter zu schonen, kann man die Zeit für zeitversetzte Schreibzugriffe verlängern. Dies erfolgt, indem man folgende Zeilen in die Datei <strong>/etc/sysctl.conf</strong> einfügt:</p><pre class="notranslate">vm.dirty_writeback_centisecs = 1500</pre><p>Der Standard-Wert liegt normalerweise bei <code class="notranslate">500</code> (5 Sekunden). Der neue Wert <code class="notranslate">1500</code> (15 Sekunden) dürfte die Anzahl der tatsächlich stattfindenden Schreibzugriffe im laufenden Betrieb relevant senken.</p></div><div class="section_3"><h4 id="Netzwerk">Netzwerk<a class="headerlink" href="#Netzwerk">¶</a></h4><p>
Innerhalb dieses Artikels wird angenommen, dass das vorhandene Netzwerk den Adressraum <code class="notranslate">192.168.97.0/24</code> besitzt und <code class="notranslate">192.168.97.1</code> das Standard-Gateway ist. Diese entsprechenden Werte müssen an die lokalen Gegebenheiten angepasst werden. Die Konfiguration der Netzwerkadressen der Adapter erfolgt statisch in der Datei <a class="internal" href="../interfaces.html">/etc/network/interfaces</a>. Diese wird hier nun mit folgendem Inhalt angelegt:</p><pre class="notranslate"># Used by ifup(8) and ifdown(8). See the interfaces(5) manpage or
# /usr/share/doc/ifupdown/examples for more information.


# The loopback network interface
auto lo
iface lo inet loopback


# The primary network interface
auto eth0
iface eth0 inet static
        address         192.168.97.100
        netmask         255.255.255.0
        gateway         192.168.97.1
        # emergency fallback addresses
        post-up         ip addr add 169.254.19.65/16 dev eth0
        pre-down        ip addr del 169.254.19.65/16 dev eth0</pre><p>Da das Alix-System blind (ohne Bildschirm) gestartet wird, ist es sehr sinnvoll, eine feste IP-Adresse zu vergeben, da es sonst eher schwierig sein dürfte, die der Netzwerkkarte zugewiesene Adresse zu ermitteln. Die Angabe des Default-Gateways ist zwingend, da später auf dem System noch zusätzliche Pakete installiert werden müssen. Es ist übrigens extrem ratsam, noch zusätzlich eine bekannte <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/APIPA">APIPA</a> Adresse zu vergeben (wie z.B.: <code class="notranslate">169.254.19.65</code>), da man so die Sicherheit hat, jederzeit mit dem Gerät Kontakt aufnehmen zu können, auch wenn die primäre Adresse vergessen wurde oder unbekannt ist. Die APIPA Adresse sollte auch in Form eines Etiketts am Gerät befestigt werden.</p></div><div class="section_3"><h4 id="Paketquellen-Eintragen">Paketquellen Eintragen<a class="headerlink" href="#Paketquellen-Eintragen">¶</a></h4><p>
Die Paketquellen werden - entsprechend der gewünschten Ubuntu-Version - in <a class="internal" href="../sources.list.html">sources.list</a> eingetragen<sup><a href="#source-5">[5]</a></sup>.</p><p>Für Ubuntu 14.04 (trusty):
</p><pre class="notranslate"># See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to
# newer versions of the distribution.

## Primary distribution source
deb http://de.archive.ubuntu.com/ubuntu/ trusty main universe
#deb-src http://de.archive.ubuntu.com/ubuntu/ trusty main universe

## Major bug fix updates produced after the final release of the
## distribution.
deb http://de.archive.ubuntu.com/ubuntu/ trusty-updates main universe
#deb-src http://de.archive.ubuntu.com/ubuntu/ trusty-updates main universe

## Security updates
deb http://security.ubuntu.com/ubuntu trusty-security main universe
#deb-src http://security.ubuntu.com/ubuntu trusty-security main universe</pre></div><div class="section_3"><h4 id="Paketabhaengigkeitsmodus-optimieren">Paketabhängigkeitsmodus optimieren<a class="headerlink" href="#Paketabhaengigkeitsmodus-optimieren">¶</a></h4><p>
Seit Ubuntu 8.10 ist auch der Paketmanager <strong>apt</strong> so konfiguriert, daß nicht nur Pakete mit direkter Abhängigkeit mitinstalliert werden, sondern auch Pakete, die sich in der Liste der empfohlenen Zusatzpakete (<em>Recommends</em>) befinden. Dieses Verhalten ist in diesem spezifischen Falle aus verschiedenen Gründen unerwünscht, da zum einen beabsichtigt wird, ein möglichst schlankes System zu erzeugen, zum anderen aber auch vermieden werden soll, daß einer der vorgeschlagenen Boot Manager (in diesem Fall GRUB 2) automatisch mitinstalliert wird, da dieser in einem derartigen System nicht nur überdimensioniert sondern sogar schädlich sein kann, was im entsprechenden Abschnitt dieses Artikel näher erläutert wird.</p><p>Um also den Paketmanager dazu zu bringen, nur die notwendigen Abhängigkeiten zu installieren, wird die Datei <strong>/etc/apt/apt.conf.d/00onlydepends</strong> mit folgenden Inhalt angelegt:</p><pre class="notranslate">APT::Install-Recommends "0";
APT::Install-Suggests "0";</pre><p>
Diese Änderung wirkt sich sowohl auf den Paketmanager <a class="internal" href="../apt.html">apt</a> als auch auf dem Paketmanager <a class="internal" href="../aptitude.html">aptitude</a> aus.</p></div><div class="section_3"><h4 id="Regionale-Einstellungen">Regionale Einstellungen<a class="headerlink" href="#Regionale-Einstellungen">¶</a></h4><p>
Regionale Einstellungen und das Konsolensystem installieren <sup><a href="#source-1">[1]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">echo en_US.UTF-8 UTF-8 &gt; /var/lib/locales/supported.d/local
locale-gen
apt-get update </pre></div></div></div><div class="section_3"><h4 id="Kernel-und-Bootloader">Kernel und Bootloader<a class="headerlink" href="#Kernel-und-Bootloader">¶</a></h4><p>
Nun kann ein geeigneter Kernel installiert werden.</p><p>Der Kernel für Ubuntu 14.04 benötigt die Unterstützung der CPU von PAE, welches der AMD Geode Prozessor nicht bietet. <a class="external" href="https://wiki.ubuntu.com/phillw/non-pae" rel="nofollow">Phill Whiteside</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> hat für 14.04 Kernel ohne PAE erstellt. Für Ubuntu 14.04 erfolgt die Installation des Non-PAE-Kernel mittels Eingabe der Befehle:
</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get -y install wget
wget http://phillw.net/isos/non-pae/14.04/alternate-14.04/linux-firmware-image-3.13.0-non-pae_124_i386.deb
wget http://phillw.net/isos/non-pae/14.04/alternate-14.04/linux-headers-3.13.0-non-pae_124_i386.deb
wget http://phillw.net/isos/non-pae/14.04/alternate-14.04/linux-image-3.13.0-non-pae_124_i386.deb
wget http://phillw.net/isos/non-pae/14.04/alternate-14.04/linux-libc-dev_124_i386.deb
dpkg -i *.deb
rm *non-pae*.deb </pre></div></div><p>Für Ubuntu 16.04:</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get -y install wget
wget http://phillw.net/isos/non-pae/16.04/linux-firmware-image-4.4.0-non-pae_4.4.0-non-pae-1_i386.deb
wget http://phillw.net/isos/non-pae/16.04/linux-headers-4.4.0-non-pae_4.4.0-non-pae-1_i386.deb
wget http://phillw.net/isos/non-pae/16.04/linux-image-4.4.0-non-pae_4.4.0-non-pae-1_i386.deb
wget http://phillw.net/isos/non-pae/16.04/linux-libc-dev_4.4.0-non-pae-1_i386.deb
dpkg -i *.deb
rm *non-pae*.deb </pre></div></div><p>Für Ubuntu 12.04 mittels Eingabe des Befehls:</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get -y install linux-image-generic </pre></div></div></div><div class="section_3"><h4 id="Bootmanager-installieren">Bootmanager installieren<a class="headerlink" href="#Bootmanager-installieren">¶</a></h4><p>
Damit das System starten kann, benötigt es noch einen Bootmanager. In üblichen Ubuntu Installationen wird der Boot Manager GRUB eingesetzt, der in diesem spezifischen Fall derart konfiguriert wird, daß er seine Ein- und Ausgaben über die serielle Schnittstelle erledigt. Bedauerlicherweise wurde aber auf verschiedenen Alix-Boards beobachtet, daß dies dazu führen kann, daß nach dem Einschalten des Systems, dieses nicht automatisch bootet, sondern im GRUB Menü verweilt. Dies ist vermutlich darauf zurückzuführen, daß anscheinend der Einschaltimpuls nach zufälligem Muster Zeichen im Seriellen Puffer erscheinen lässt, was die automatische Boot-Sequenz unterbricht.</p><p>Um den Benutzer die Wahl zwischen den verschiedenen Boot-Managern zu überlassen, folgen nun die Anleitungen für die Installationen sowohl von SYSLINUX als auch von GRUB.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bitte bei allen nachfolgenden Aktionen darauf achten, dass der angesprochene Gerätename auch tatsächlich der ist, unter dem die CF Karte im System angesprochen wird. Blindes Ausführen der Befehle kann ansonsten zu <em>unerwünschten</em> Resultaten führen! Der Benutzer <a class="crosslink user" href="https://ubuntuusers.de/user/girts/">girts</a> kann ein Lied davon singen: er hat sich nämlich damit den Bootsektor seines Rechners zerschossen:</p><p>Comment by girts, 2011-04-29: I changed the destination in MBR copy command to /dev/sdc . It was /dev/sda in the original version. However, I rewrote the MBR of my PC and lost a day trying to recover it. Therefore, I wanted to correct this bug to save a day of other hacker lives <img alt=":)" src="../_/3ce64ccd64bad0e73d738cbfcfba48160e1cd2a9.png"/> Sorry, was not able to write this comment in German, it would take too much time <img alt=":)" src="../_/3ce64ccd64bad0e73d738cbfcfba48160e1cd2a9.png"/>
</p></div></div><div class="section_4"><h5 id="Booten-mit-SYSLINUX">Booten mit SYSLINUX<a class="headerlink" href="#Booten-mit-SYSLINUX">¶</a></h5><p>
Das SYSLINUX-Projekt stellt kompakte Boot-Loader für das Starten von MS-DOS FAT Dateisysteme (SYSLINUX), für das Starten über das Netzwerk (PXELINUX), für das Starten von bootbaren "El Torito" CD-ROMs (ISOLINUX) und für das Starten von ext2/ext3 Dateisystemen (EXTLINUX) zur Verfügung.</p></div><div class="section_4"><h5 id="Installation-von-SYSLINUX-unter-Ubuntu-14-04-oder-12-04">Installation von SYSLINUX unter Ubuntu 14.04 oder 12.04<a class="headerlink" href="#Installation-von-SYSLINUX-unter-Ubuntu-14-04-oder-12-04">¶</a></h5><p>
Mit folgenden Befehlen wird SYSLINUX installiert und die CF-Karte bootbar gemacht:</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get -y install extlinux
mkdir -f /boot/extlinux
extlinux --install /boot/extlinux
dd if=/usr/lib/extlinux/mbr.bin of=/dev/sdc </pre></div></div><p>Als nächstes wird die Konfiguration des SYSLINUX Bootmanagers angepasst. Dafür muß die Datei <strong>/etc/default/extlinux</strong> editiert werden:</p><pre class="notranslate">EXTLINUX_UPDATE="true"
EXTLINUX_ALTERNATIVES="default recovery"
EXTLINUX_DEFAULT="l0"
EXTLINUX_ENTRIES="all"
EXTLINUX_MENU_LABEL="Ubuntu GNU/Linux, kernel"
EXTLINUX_PARAMETERS="ro reboot=bios console=ttyS0,38400n8"
EXTLINUX_ROOT="root=/dev/sda1"
EXTLINUX_THEME="none"
EXTLINUX_TIMEOUT="50"</pre><p>Zum Schluss noch ein mal
</p><div class="bash"><div class="contents"><pre class="notranslate">extlinux-update </pre></div></div><p>
aufrufen. Hiermit ist die Installation des Bootmanagers abgeschlossen.</p></div><div class="section_4"><h5 id="Booten-mit-GRUB-2">Booten mit GRUB 2<a class="headerlink" href="#Booten-mit-GRUB-2">¶</a></h5><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die Installation von GRUB wurde unter Ubuntu 12.04 nicht getestet!
</p></div></div><p>Ab Version 9.10 benutzt Ubuntu nicht mehr die Version 0.97 von <a class="internal" href="../grub.html">GRUB</a> (Grub Legacy), sondern den Nachfolger <a class="internal" href="../grub_2.html">GRUB 2</a>. Die Installation erfolgt mittels folgenden Befehls:</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get -y install grub-pc </pre></div></div><p>Während der Installation werden verschiedene Fragen gestellt, die alle mit der Eingabetaste bestätigt werden können. Wichtig ist hier lediglich, in der Liste der vorhandenen Geräte nur die CF-Karte (in unserem Fall <strong>/dev/sdc</strong>) auszuwählen. Weiteren Anpassungen erfolgen mittels Eingabe diverser Werte in einigen Konfigurationsdateien.</p><p>Als nächstes wird die Konfiguration des GRUB 2<sup><a href="#source-11">[11]</a></sup> angepasst. Dafür muß die Datei <strong>/etc/default/grub</strong> folgenden Inhalt vorweisen:</p><pre class="notranslate"># If you change this file, run 'update-grub' afterwards to update
# /boot/grub/grub.cfg.

GRUB_DEFAULT=0
GRUB_HIDDEN_TIMEOUT=0
GRUB_HIDDEN_TIMEOUT_QUIET=true

GRUB_TIMEOUT="3"
GRUB_DISTRIBUTOR=`lsb_release -i -s 2&gt; /dev/null || echo Debian`
GRUB_CMDLINE_LINUX_DEFAULT="verbose console=ttyS0,38400n8 reboot=bios"
GRUB_CMDLINE_LINUX=""

# Konfiguration der seriellen Schnittstelle der Alix-Boards:
GRUB_SERIAL_COMMAND="serial --unit=0 --speed=38400"
GRUB_TERMINAL=serial

# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console

# The resolution used on graphical terminal
# note that you can use only modes which your graphic card supports via VBE
# you can see them in real GRUB with the command `vbeinfo'
#GRUB_GFXMODE=640x480

# Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to Linux
#GRUB_DISABLE_LINUX_UUID=true

# Uncomment to disable generation of recovery mode menu entrys
#GRUB_DISABLE_LINUX_RECOVERY="true"</pre><p>Die eingebenen Änderungen bewirken, dass GRUB 2 seine Ein- und Ausgaben über die serielle Schnittstelle entgegen nimmt und ansonsten alle Pausen recht kurz ausfallen.</p><p>In nachfolgenden Schritt wird GRUB 2 nun in die CF-Karte installiert. Da diese sich allerdings noch nicht im Zielsystem befindet, gibt es einen Unterschied zwischen den Parametern, wie sie im Boot-Sektor eingetragen werden müssen (z.B. dass sich das Betriebsystem auf dem ersten Datenträger befindet), und der momentanen Realität (und zwar die, daß das künftige Boot-Medium sich als zusätzliches Laufwerk in einem anderen System befindet). Zu diesem Zwecke wird die Zuweisung zwischen dem internen Gerätenamen und dem effektiven Gerätenamen in der Namens-Abgleichstabelle <strong>/boot/grub/devices.map</strong> von GRUB 2 folgendenmaßen getätigt:</p><pre class="notranslate">(hd0)   /dev/sdc</pre><p>Hierbei ist es existentiell wichtig, dass der Gerätename der CF-Karte eingegeben wird. Dieser wird sich später im laufenden System verändern. Hier soll jetzt erst mal der Name aus Sicht des installierenden Systems stehen. An diesem Punkt kann GRUB2 anhand der neuen Werte auf die CF-Karte mit folgenden Befehlen installiert und konfiguriert werden:</p><div class="bash"><div class="contents"><pre class="notranslate">grub-install /dev/sdc
update-grub </pre></div></div><p>Nach der Installation kann nun die Namens-Abgleichstabelle <strong>/boot/grub/devices.map</strong> mit dem endgültigen Eintrag versehen werden:</p><pre class="notranslate">(hd0)   /dev/sda</pre><p>Damit auch bei künftigen Kernel-Aktualisierungen GRUB 2 seine Konfiguration anpassen kann, müssen noch folgende Zeilen der Datei <strong>/etc/kernel-img.conf</strong> hinzugefügt werden:</p><pre class="notranslate">postinst_hook = update-grub
postrm_hook   = update-grub</pre></div></div><div class="section_3"><h4 id="Root-Passwort">Root-Passwort<a class="headerlink" href="#Root-Passwort">¶</a></h4><p>
Damit ein Login über SSH funktioniert, muss noch das Password für den Benutzer <strong>root</strong> festgelegt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">passwd root </pre></div></div></div><div class="section_3"><h4 id="Serielle-Konsole">Serielle Konsole<a class="headerlink" href="#Serielle-Konsole">¶</a></h4><p>
Eine Standardinstallation konfiguriert eine Bildschirm-Konsolensystem mit sechs Konsolen. Diese werden nicht benötigt und daher entfernt. Dafür ist es lediglich erforderlich, die Event-Handler-Konfigurationsdateien der sechs Bildschirmkonsolen aus dem Event-Handler-Verzeichnis von <a class="internal" href="../upstart.html">Upstart</a> zu entfernen:</p><div class="bash"><div class="contents"><pre class="notranslate">rm /etc/init/tty?.conf </pre></div></div><p>Stattdessen wird nun eine Konfigurationsdatei benötigt, die dafür zuständig ist, eine serielle Konsole einzurichten. Dies erfolgt durch Erstellen der Datei <strong>/etc/init/ttyS0.conf</strong> mit folgendem Inhalt:</p><pre class="notranslate"># ttyS0 - getty
#
# This service maintains a getty on tty1 from the point the system is
# started until it is shut down again.

start on stopped rc RUNLEVEL=[2345]
stop on runlevel [!2345]

respawn
exec /sbin/getty -8 38400 -L ttyS0</pre></div><div class="section_3"><h4 id="Zeitzone">Zeitzone<a class="headerlink" href="#Zeitzone">¶</a></h4><p>
Die Zeitzone des Systems wird mit folgendem Befehl festgelegt:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg-reconfigure tzdata </pre></div></div></div><div class="section_3"><h4 id="Zugang-ueber-SSH">Zugang über SSH<a class="headerlink" href="#Zugang-ueber-SSH">¶</a></h4><p>
Um auf das laufende System zugreifen zu können, muss ein <a class="internal" href="../ssh.html">SSH</a>-Server installiert werden <sup><a href="#source-2">[2]</a></sup>:</p><ul><li><p><strong>openssh-server</strong></p></li></ul><p>
Ab hier ist das System über das Netz erreichbar.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Der SSH Server akzeptiert standardmäßig die Authentifiziereung mittels Passwort. Sobald das System in den Regelbetrieb gehen wird, wird empfohlen, diese Möglichkeit abzuschalten, da sie ein erhebliches Sicherheitsrisiko darstellt. Bei abgeschalteter Passwort-Authentifizierung ist es nur noch möglich, sich mittels privatem Schlüssel anzumelden. Zu diesem Zwecke ist dafür Sorge zu tragen, den eigenen öffentlichen Schlüssel in die Datei <strong>~/.ssh/authorized_keys</strong> des entsprechenden Benutzers einzutragen. Die Passwort-Authentifizierung kann bei OpenSSH abgeschaltet werden, indem man die Option <em>PasswordAuthentication</em> in der Datei <strong>/etc/ssh/sshd_config</strong> auf <em>no</em> setzt.
</p></div></div></div><div class="section_3"><h4 id="Zusaetzlich-geladene-Module">Zusätzlich geladene Module<a class="headerlink" href="#Zusaetzlich-geladene-Module">¶</a></h4><p>
Damit das System beim Start auch die <a class="internal" href="../kernelmodule.html">Kernelmodule</a> ("Treiber") für spezielle Hardware-Komponenten der Alix-Boards lädt, werden diese in der Datei <strong>/etc/modules</strong> eingetragen<sup><a href="#source-10">[10]</a></sup>:</p><pre class="notranslate"># /etc/modules: kernel modules to load at boot time.
#
# This file contains the names of kernel modules that should be loaded
# at boot time, one per line. Lines beginning with "#" are ignored.

# Alix Specific:
natsemi
lm90
scx200_acb base=0x810,0x820
leds-alix
ledtrig-default-on
ledtrig-heartbeat
ledtrig-gpio
ledtrig-timer</pre></div><div class="section_3"><h4 id="Installation-abschliessen-und-CF-Karte-aushaengen">Installation abschließen und CF-Karte aushängen<a class="headerlink" href="#Installation-abschliessen-und-CF-Karte-aushaengen">¶</a></h4><p>
An diesem Punkt ist die eigentliche Installation abgeschlossen. Vor dem Entfernen der CF-Karte aus dem Kartenleser müssen aber noch folgende Befehle ausgeführt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">exit
umount /mnt/alix/proc
umount /mnt/alix/sys
umount /mnt/alix/dev
umount /mnt/alix </pre></div></div><p>Sollte der letzte Befehl eine Fehlermeldung ausgeben, ist zu prüfen, ob noch ein Prozess auf das Verzeichnis <strong>/mnt/alix</strong> oder dessen Unterverzeichnisse zugreift. Erst wenn das Dateisystem ohne Fehlermeldung ausgehängt wurde, kann die Karte entnommen werden.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Nach der Eingabe des Befehls <em>exit</em> wird <a class="internal" href="../chroot.html">chroot</a> beendet und man ist nicht mehr auf dem späteren Zielsystem unterwegs. Alle eingebenen Befehle im momentanen Terminal wirken sich wieder auf das reale System aus!
</p></div></div></div></div><div class="section_2"><h3 id="Erster-Start">Erster Start<a class="headerlink" href="#Erster-Start">¶</a></h3><p>
Nach dem Einlegen der CF-Karte ins Alix-Board kann nun ein erster Start gewagt werden. Vor dem Einschalten muss das System aber noch ans Netzwerk angeschlossen werden. Bei Alix-Boards mit mehreren Netzwerkkarten ist die erste Netzwerkkarte erfahrungsgemäß jene, die sich direkt neben der Stromversorgungsbuchse befindet. Will man auf Nummer sicher gehen, so kann man alle Netzwerkstecker mit dem Netzwerk verbinden. An diesem Punkt kann das System eingeschaltet werden. Um festzustellen, wann das System hochgefahren ist und im Netzwerk erscheint, kann man vor dem Einschalten auf dem eigenen Rechner schon mal folgenden Befehl eingeben:</p><div class="bash"><div class="contents"><pre class="notranslate">ping 192.168.97.100 </pre></div></div><p>Nach ca. 10-15 Sekunden sollte sichtbare Aktivität auf beiden LEDs des aktiven Netzwerk-Anschlusses zu sehen sein. Der Erfolg ist dadurch zu erkennen, dass das Alix-System auf die Pings antwortet:</p><div class="bash"><div class="contents"><pre class="notranslate">ping 192.168.97.100 </pre></div></div><p>
</p><pre class="notranslate">PING 192.168.97.100 (192.168.97.100) 56(84) bytes of data.
From 192.168.97.249 icmp_seq=1 Destination Host Unreachable
[...]
From 192.168.97.249 icmp_seq=6 Destination Host Unreachable
64 bytes from 192.168.97.100: icmp_seq=7 ttl=64 time=2001 ms
64 bytes from 192.168.97.100: icmp_seq=8 ttl=64 time=992 ms

--- 192.168.97.100 ping statistics ---
11 packets transmitted, 5 received, +6 errors, 54% packet loss, time 10026ms
rtt min/avg/max/mdev = 0.389/599.057/2001.498/799.607 ms, pipe 3</pre><p>Tritt dieser Fall nicht ein, so ist davon auszugehen, daß das System nicht gestartet ist, die Netzwerk-Konfiguration nicht mit dem Netzwerk kompatibel ist oder bei der Ausführung der oben genannten Schritte etwas schiefgegangen ist. Eine genaue Analyse des Inhalts der CF-Karte erlaubt es in der Regel, den Fehler schnell zu finden. Allerdings sollte man auch in Erwägung ziehen, sich mit der passenden Hardware an die serielle Schnittstelle anzuschließen und den Startvorgang des Systems genau zu verfolgen.</p><p>Ist hingegen erwartungsgemäß alles gut gegangen, kann man sich nun mit dem System mittels SSH verbinden:</p><div class="bash"><div class="contents"><pre class="notranslate">ssh -l root 192.168.97.100 </pre></div></div><pre class="notranslate">The authenticity of host '192.168.97.100 (192.168.97.100)' can't be established.
RSA key fingerprint is ec:38:36:0b:42:9c:c2:ae:17:6d:8f:d5:27:24:9d:f0.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.97.100' (RSA) to the list of known hosts.
root@192.168.97.100's password:
Linux alix-router 2.6.31-15-386 #50-Ubuntu SMP Tue Nov 10 17:30:14 UTC 2009 i586

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/

root@alix-router:~#</pre><p>
Das System ist nun lauffähig und bereit für den letzten Feinschliff.</p></div></div><div class="section_1"><h2 id="Finale-Konfiguration-und-Optimierung">Finale Konfiguration und Optimierung<a class="headerlink" href="#Finale-Konfiguration-und-Optimierung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Aktualisierung-und-Softwareinstallation">Aktualisierung und Softwareinstallation<a class="headerlink" href="#Aktualisierung-und-Softwareinstallation">¶</a></h3><p>
Erst mal das ganze System aktualisieren und die Standard-Systemkomponenten installieren:</p><div class="bash"><div class="contents"><pre class="notranslate">apt-get update
apt-get upgrade
apt-get -y install ubuntu-standard screen </pre></div></div><p>Damit <a class="internal" href="../screen.html">screen</a> auch angenehm benutzbar wird, sollte die entsprechende Konfigurationsdatei <strong>/etc/screenrc</strong> noch etwas verbessert werden. Hier die vollständige geänderte Fassung mit Änderungsvermerken:</p><pre class="notranslate"># $Id: screenrc,v 1.15 2003/10/08 11:39:03 zal Exp $
#
# /etc/screenrc
#
#   This is the system wide screenrc.
#
#   You can use this file to change the default behavior of screen system wide
#   or copy it to ~/.screenrc and use it as a starting point for your own
#   settings.
#
#   Commands in this file are used to set options, bind screen functions to
#   keys, redefine terminal capabilities, and to automatically establish one or
#   more windows at the beginning of your screen session.
#
#   This is not a comprehensive list of options, look at the screen manual for
#   details on everything that you can put in this file.
#

# ------------------------------------------------------------------------------
# SCREEN SETTINGS
# ------------------------------------------------------------------------------

startup_message off
#nethack on

#defflow on # will force screen to process ^S/^Q
deflogin on
#autodetach off

# turn visual bell on
# vbell on
# vbell_msg "   Wuff  ----  Wuff!!  "

# define a bigger scrollback, default is 100 lines
defscrollback 10240

# ------------------------------------------------------------------------------
# SCREEN KEYBINDINGS
# ------------------------------------------------------------------------------
# Remove some stupid / dangerous key bindings
bind ^k
#bind L
bind ^\
# Make them better
bind \\ quit
bind K kill
bind I login on
bind O login off
bind } history

# An example of a "screen scraper" which will launch urlview on the current
# screen window
#
#bind ^B eval "hardcopy_append off" "hardcopy -h $HOME/.screen-urlview" "screen urlview $HOME/.screen-urlview"

# ------------------------------------------------------------------------------
# TERMINAL SETTINGS
# ------------------------------------------------------------------------------
# The vt100 description does not mention "dl". *sigh*
termcapinfo vt100 dl=5\E[M

# turn sending of screen messages to hardstatus off
hardstatus off
# Set the hardstatus prop on gui terms to set the titlebar/icon title
termcapinfo xterm*|rxvt*|kterm*|Eterm* hs:ts=\E]0;:fs=\007:ds=\E]0;\007
# use this for the hard status string
hardstatus string "%h%? users: %u%?"

# An alternative hardstatus to display a bar at the bottom listing the
# windownames and highlighting the current windowname in blue. (This is only
# enabled if there is no hardstatus setting for your terminal)
#
#hardstatus lastline "%-Lw%{= BW}%50&gt;%n%f* %t%{-}%+Lw%&lt;"

# set these terminals up to be 'optimal' instead of vt100
termcapinfo xterm*|linux*|rxvt*|Eterm* OP

# Change the xterm initialization string from is2=\E[!p\E[?3;4l\E[4l\E&gt;
# (This fixes the "Aborted because of window size change" konsole symptoms found
#  in bug #134198)
termcapinfo xterm 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'

# To get screen to add lines to xterm's scrollback buffer, uncomment the
# following termcapinfo line which tells xterm to use the normal screen buffer
# (which has scrollback), not the alternate screen buffer.
#
#termcapinfo xterm|xterms|xs|rxvt ti@:te@

# Enable non-blocking mode to better cope with flaky ssh connections.
defnonblock 5

# ------------------------------------------------------------------------------
# STARTUP SCREENS
# ------------------------------------------------------------------------------

# Example of automatically running some programs in windows on screen startup.
#
#   The following will open top in the first window, an ssh session to monkey
#   in the next window, and then open mutt and tail in windows 8 and 9
#   respectively.
#
# screen top
# screen -t monkey ssh monkey
# screen -t mail 8 mutt
# screen -t daemon 9 tail -f /var/log/daemon.log

hardstatus alwayslastline "%{kw} %{b}%H%{K}    &lt; %-w%{Wb} %n %t %{-}%+w &gt;"
# This lets work all functions keys in midnight commander
termcapinfo xterm 'k1=\E[11~:k2=\E[12~:k3=\E[13~:k4=\E[14~'</pre></div><div class="section_2"><h3 id="Ansteuerung-der-LEDs">Ansteuerung der LEDs<a class="headerlink" href="#Ansteuerung-der-LEDs">¶</a></h3><p>
Zur Ansteuerung der LEDs müß das entsprechende Modul kompiliert und geladen werden. Eine detaillierte Beschreibung dazu findet sich <a class="internal" href="../alix.html#LEDs-ansteuern">hier</a>.</p><p>Und nun damit die erste LED nicht einfach nur stur vor sich hin leuchtet, sondern ein wenig Rückmeldung über den Systemstatus und Run Level gibt, hier ein Event-Handler in Form der Datei <strong>/etc/init/watchdog-led.conf</strong>:</p><pre class="notranslate"># WatchDog LED Configuration for Alix-Boards
#
# This task configures the watchdog led to resemble the status
# of the system

description     "Configuration of the first alix led (Watchdog led)"
author          "Leo Moll &lt;leo@yeasoft.com&gt;"

start on runlevel [0123456]
stop on runlevel [!$RUNLEVEL]

export RUNLEVEL
export PREVLEVEL

task
script

case $RUNLEVEL in
1|6)     echo timer     &gt; /sys/class/leds/alix\:1/trigger
         echo 100       &gt; /sys/class/leds/alix\:1/delay_on
         echo 100       &gt; /sys/class/leds/alix\:1/delay_off
         ;;
0)       echo 0         &gt; /sys/class/leds/alix\:1/brightness
         echo none      &gt; /sys/class/leds/alix\:1/trigger
         ;;
2|3|4|5) echo heartbeat &gt; /sys/class/leds/alix\:1/trigger
         ;;
*)       echo timer     &gt; /sys/class/leds/alix\:1/trigger
         echo 100       &gt; /sys/class/leds/alix\:1/delay_on
         echo 300       &gt; /sys/class/leds/alix\:1/delay_off
         ;;
esac

end script</pre><p>Basierend auf dem entsprechenden Run Level verhält sich nun die erste LED folgendermaßen:</p><ul><li><p>Normaler Betrieb: Herzschlag (Heartbeat)</p></li><li><p>Reboot: Schnelles blinken</p></li><li><p>System heruntergefahren: LED aus</p></li><li><p>Beim Starten: LED an</p></li><li><p>System gestartet in Run Level 1: schnelles blinken</p></li><li><p>Anderer Runlevel: Kurzes blinken</p></li></ul><p>
</p></div><div class="section_2"><h3 id="Fazit">Fazit<a class="headerlink" href="#Fazit">¶</a></h3><p>
Das System befindet sich nun im Zustand eines gut funktionierenden Basissystems. Dies ist ein hervorragender Startpunkt, um beliebige Spezial-Applikationen wie z.B. Spezialrouter, kleine Netzwerkserver oder Telefonanlagen daraus zu fabrizieren.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Möchte man das System auf weitere CF-Karten klonen bzw. die CF-Karte in ein anderes Alix-System einsetzen, so darf nicht vergessen werden, die Datei <strong>/etc/udev/rules.d/70-persistent-net.rules</strong> zu löschen. Tut man dies nicht, werden die Netzwerkadapter neue Namen erhalten (z.B. <code class="notranslate">eth3</code>, <code class="notranslate">eth4</code> und <code class="notranslate">eth5</code>) und werden nicht initialisiert (da diese ja nicht in der <strong>/etc/network/interfaces</strong> stehen).
</p></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.networksoul.net/page/2/" rel="nofollow">Setting up a Linux home server based on a low cost and low power hardware (Pc Engines Alix) – Part1</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://lwn.net/Articles/169919/" rel="nofollow">LED Class, Triggers and Drivers</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="http://ichbinroot.de/alix/leds.html" rel="nofollow" title="http://ichbinroot.de/alix/leds.html">http://ichbinroot.de/alix/leds.html</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> LEDs</p></li><li><p><a class="external" href="http://syslinux.zytor.com" rel="nofollow" title="http://syslinux.zytor.com">http://syslinux.zytor.com</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> Homepage des SYSLINUX Projektes</p></li><li><p><a class="internal" href="../alix.html">Alix</a> - Hauptartikel</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../alix/cf-bootmedium_erstellen/a/revision/944845.html">Diese Revision</a> wurde am 10. November 2017 16:15 von <a href="https://ubuntuusers.de/user/aPollO2k/">aPollO2k</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../alix.html">Alix</a></li>
<li><a href="../alix/cf-bootmedium_erstellen.html">CF-Bootmedium erstellen</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>