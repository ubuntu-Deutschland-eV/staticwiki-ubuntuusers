<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Computer_nach_dem_Neustart_zurücksetzen › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./computer_nach_dem_neustart_zurücksetzen.html">Computer nach dem Neustart zurücksetzen</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Computer_nach_dem_Neustart_zurücksetzen">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./computer_nach_dem_neustart_zurücksetzen/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./computer_nach_dem_neustart_zurücksetzen/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./computer_nach_dem_neustart_zurücksetzen/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./computer_nach_dem_neustart_zurücksetzen/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./computer_nach_dem_neustart_zurücksetzen/a/backlinks.html">Computer nach dem Neustart zurücksetzen</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./sudo.html">Root-Rechte erlangen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Ausgangssituation">Ausgangssituation
</a></li><li><a class="crosslink" href="#Benutzer-einrichten">Benutzer einrichten
</a></li><li><a class="crosslink" href="#Ordner-anlegen">Ordner anlegen
</a></li><li><a class="crosslink" href="#Benutzerrechte-aendern">Benutzerrechte ändern
</a></li><li><a class="crosslink" href="#Einstellungen-sichern">Einstellungen sichern
</a></li><li><a class="crosslink" href="#Test">Test
</a></li><li><a class="crosslink" href="#Spaetere-nderungen">Spätere Änderungen
</a></li><li><a class="crosslink" href="#Grafische-Anmeldung-konfigurieren">Grafische Anmeldung konfigurieren
</a><ol class="arabic"><li><a class="crosslink" href="#LightDM">LightDM
</a></li><li><a class="crosslink" href="#GDM">GDM
</a></li></ol></li><li><a class="crosslink" href="#Weitere-Moeglichkeiten">Weitere Möglichkeiten
</a><ol class="arabic"><li><a class="crosslink" href="#Script-Loesung">Script-Lösung
</a></li><li><a class="crosslink" href="#Rechner-klonen">Rechner klonen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/help.png" class="image-left" src="./_/7962ceb28732c252b41d77857f84f4fb459d3447.png"/>
In diesem Artikel soll erläutert werden, wie ein Computer mit Ubuntu bei jedem Start immer wieder das gleiche Aussehen erhält. Diese Anleitung eignet sich z.B. für Schulcomputer oder andere Übungsräume. Schüler verändern oft und gerne das Erscheinungsbild des Computers. Beispiele sind das Verschieben oder Löschen der Programmstarter auf dem Desktop, der Leisten (Panels), das Ändern des Hintergrundbilds und vieles andere mehr.</p><p>Das ist an sich nicht tragisch, aber leider fehlt oft die Zeit, das Wissen oder die Lust, diese persönlichen Einstellungen wieder rückgängig zu machen. Der oft geäußerte Satz <em>"Verlasse Deinen Platz so, wie Du ihn vorgefunden hast."</em> bleibt damit reines Wunschdenken und nach kurzer Zeit ist man als Lehrer mehr damit beschäftigt, das Chaos auf den PCs zu reparieren als sich dem eigentlichen Unterricht widmen zu können. Im schlimmsten Fall resigniert das Lehrpersonal und nutzt den Raum – zu Lasten der Schüler – einfach nicht mehr.</p><p>Während es unter anderen Betriebssystemen entsprechende, aber nicht kostenlose Soft- oder Hardwarelösungen (<em>"Wächterkarten"</em>) gibt, basiert das nachfolgend beschriebene Vergehen einfach darauf, dass beim Systemstart automatisch sämtliche Benutzereinstellungen aus einer vordefinierten Sicherungskopie wiederhergestellt werden.</p><p>Eine Alternative kann das Programm <a class="interwiki interwiki-sourceforge" href="http://sourceforge.net/projects/dafturnofris-id">Ofris</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> sein, das ein ähnliches Verfahren (auf Basis von <a class="internal" href="./rsync.html">rsync</a>) verwendet. Weitere Informationen dazu gibt es in diesem Blogeintrag: <a class="external" href="http://linuxundich.de/de/ubuntu/virtuelle-wachterkarte-fur-linux-mit-ofris/" rel="nofollow">Virtuelle Wächterkarte für Linux</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/>.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Ab <a class="internal" href="./oneiric.html">Ubuntu 11.10</a> kann man auch die <a class="internal" href="./gastsitzung.html">Gastsitzung</a> des Displaymanagers <a class="internal" href="./lightdm.html">LightDM</a> verwenden, bei der alle Änderungen beim Abmelden automatisch verworfen werden. Diese kann auf Wunsch vorkonfiguriert werden, um bestimmte Einstellungen vorzugeben.
</p></div></div><div class="section_1"><h2 id="Ausgangssituation">Ausgangssituation<a class="headerlink" href="#Ausgangssituation">¶</a></h2><p>
Im folgenden Beispiel wird von einem Computer ausgegangen, auf dem bei der Installation nur ein Benutzer eingerichtet wurde. Dieser Benutzer hat unter Ubuntu traditionell alle Rechte <sup><a href="#source-1">[1]</a></sup>, um den Computer zu warten, zu pflegen, Programme zu installieren, Grafik und Bildschirmauflösung einzustellen und das Erscheinungsbild anzupassen.</p><p>Dieser Benutzer wird im weiteren Verlauf des Artikels als <em>"Hauptbenutzer"</em> bezeichnet. Er erstellt die Grundkonfiguration des Rechners und richtet weitere <a class="internal" href="./benutzer_und_gruppen.html">Benutzer</a> ein. Hierzu werden mit einem Linksklick <img alt="linke Maustaste" class="image-default" src="./_/9c03a73e06581c6d6932d30e0750812ed76e6022.png"/> im Menü</p><ul><li><p><em>"System -&gt; Systemverwaltung -&gt; Benutzer und Gruppen"</em></p></li></ul><p>
zwei neue Benutzer angelegt und auch ein Passwort vergeben. In weiteren Verlauf dieses Artikels sind das die Benutzer</p><ul><li><p><strong>kinder</strong> (dient später als "normaler" Benutzer)</p></li><li><p><strong>default</strong> (zur Sicherung bzw. Rücksicherung der Einstellungen)</p></li></ul><p>
Die Rechte der neuen Benutzer werden an dieser Stelle <span class="underline">noch nicht</span> einschränkt, sondern erst nach der kompletten Einrichtung des Systems. Jetzt abmelden und als neuer Benutzer <code class="notranslate">kinder</code> anmelden.</p></div><div class="section_1"><h2 id="Benutzer-einrichten">Benutzer einrichten<a class="headerlink" href="#Benutzer-einrichten">¶</a></h2><p>
Nach der Anmeldung erfolgt die Einrichtung des Benutzers <code class="notranslate">kinder</code>. Folgende Punkte wären z.B. interessant:</p><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="./kinder.png" class="image-default" src="./_/f445a8b3ec9c13dc25cc8d9b95b3fe5a306d4cb3.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 200px"> Desktop mit <a class="internal" href="./unity.html">Unity</a></td></tr></table><ul><li><p>Starter für ausgewählte Programme auf dem Desktop anlegen und an die gewünschte Stelle verschieben</p></li><li><p>Dateiablage einrichten (Ordner auf dem Desktop anlegen, siehe unten)</p></li><li><p>Browserkonfiguration (siehe Artikel <a class="internal" href="./kinder.html#Browser">Kinder</a>)</p></li><li><p>Lautstärke einstellen bzw. auf stumm schalten</p></li><li><p><a class="internal" href="./schriften.html#Windowsschriftarten">Schriftarten</a> und gewünschte Zusatzprogramme installieren</p></li><li><p>nicht benötigte Programme aus den Menüs entfernen</p></li><li><p>Update-Benachrichtigung abschalten usw.</p></li></ul><p>
Wenn alles soweit fertig eingerichtet ist, sollte das System neu gestartet werden. Wenn nach dem Neustart immer noch alles so ist, wie es sein sollte, wird diese Einstellung beibehalten. Spätere Änderungen sind ohne weiteres – durch den Hauptbenutzer – möglich.</p></div><div class="section_1"><h2 id="Ordner-anlegen">Ordner anlegen<a class="headerlink" href="#Ordner-anlegen">¶</a></h2><p>
</p><p>
</p><table style="float: right; clear: left; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="./Kinder1.png" class="image-default" src="./_/36f63bb73c71e26e54624d5c980c48e5e8be76eb.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 200px"> Desktop mit GNOME 2</td></tr></table><p>
Ein Speichern von Dateien auf dem Desktop oder unter Dokumente soll nicht möglich sein. Dateien werden immer – hier als Basisordner bezeichnet – unterhalb von <strong>/Dateien</strong> abgelegt. Dann sind die Dateien in diesem Ordner auch nach dem Neustart noch vorhanden.</p><p>Im Folgenden sind das beispielsweise die Ordner:</p><ul><li><p>Klasse 1</p></li><li><p>Klasse 2</p></li><li><p>Klasse 3</p></li><li><p>Klasse 4</p></li></ul><p>
Diese sollen auf dem Desktop zu sehen sein und nur in diesen Ordnern dürfen die Schüler Dateien abspeichern. Alle genannten Ordner werden mit Schreib- und Leserechten versehen. So können Dateien problemlos abgespeichert werden, wobei die Schüler allerdings selbst den richtigen Ordner auswählen müssen.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die späteren Benutzer sollten deutlich darauf hingewiesen werden, dass sämtliche Dateien, die außerhalb der vorgegebenen Ordner gespeichert werden, bei einem Neustart gelöscht werden und damit unwiderruflich verloren sind. Nicht betroffen sind externe Speichermedien wie beispielsweise USB-Sticks.
</p></div></div><p>Um den beschriebenen Vorschlag umzusetzen, wieder als Hauptbenutzer anmelden und ein Terminal-Fenster <sup><a href="#source-2">[2]</a></sup> öffnen. Es werden in zwei Schritten der oben erwähnte Basisordner und die Verknüpfungen auf dem Desktop des Benutzers <code class="notranslate">kinder</code> eingerichtet. Dazu die folgenden Befehle ausführen:</p><ol class="arabic"><li><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir -p /dateien/klasse1 /dateien/klasse2 /dateien/klasse3 /dateien/klasse4
sudo chown -R kinder:kinder /dateien </pre></div></div></li><li><div class="bash"><div class="contents"><pre class="notranslate">cd /home/kinder/Desktop/
sudo -s
ln -s /dateien/klasse1 Klasse1
ln -s /dateien/klasse2 Klasse2
ln -s /dateien/klasse3 Klasse3
ln -s /dateien/klasse4 Klasse4
exit </pre></div></div></li></ol><p>
Jetzt kann das Terminal-Fenster wieder geschlossen werden. Nach der Anmeldung als Benutzer <code class="notranslate">kinder</code> haben die Ordner auf dem Desktop ein kleines Pfeilsymbol als Zeichen für eine Verknüpfung.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Je nach Bedarf kann auch ein anderer Basisordner zur permanenten Speicherung genutzt werden. Die obigen Angaben sollen nur als Beispiel dienen.
</p></div></div></div><div class="section_1"><h2 id="Benutzerrechte-aendern">Benutzerrechte ändern<a class="headerlink" href="#Benutzerrechte-aendern">¶</a></h2><p>
Wie in der <a class="crosslink" href="#Ausgangssituation">Ausgangssituation</a> beschrieben, haben die Benutzer <code class="notranslate">kinder</code> und <code class="notranslate">default</code> immer noch Root- bzw. Administrator-Rechte. Dies diente bis hierhin vor allem der leichteren Konfiguration der Benutzer. Durch den Aufruf von</p><ul><li><p><em>"System -&gt; Systemverwaltung -&gt; Benutzer und Gruppen"</em></p></li></ul><p>
und die Auswahl von <em>"Desktop-Benutzer"</em> in den Eigenschaften der beiden Benutzer werden diese Rechte – durch den Hauptbenutzer – eingeschränkt. Änderungen wie z.B. die Installation von Programmen sind nun bei diesen Benutzern nicht mehr möglich.</p></div><div class="section_1"><h2 id="Einstellungen-sichern">Einstellungen sichern<a class="headerlink" href="#Einstellungen-sichern">¶</a></h2><p>
Da über den Benutzer <code class="notranslate">default</code> eine Speichermöglichkeit für alle Einstellungen vorhanden ist, kann das Rücksetzen der Benutzereinstellungen nach jedem Neustart eingerichtet werden. Dazu als Hauptbenutzer anmelden und und mit folgendem Befehl die kompletten Einstellungen sichern:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cp -a /home/kinder* /home/default </pre></div></div><p>Als nächstes wird die Datei <strong>/etc/<a class="internal" href="./rc.local.html">rc.local</a></strong> mit einem Editor <sup><a href="#source-3">[3]</a></sup> und Root-Rechten <sup><a href="#source-4">[4]</a></sup> bearbeitet und diese Befehle hinzugefügt, um die automatische Rücksicherung zu aktivieren:</p><div class="bash"><div class="contents"><pre class="notranslate">/bin/rm -rf /home/kinder/ 
/bin/cp -a /home/default/kinder /home
/bin/chown kinder:kinder -R /home/kinder  </pre></div></div><p><strong>Wichtig</strong>: die Zeile mit
</p><pre class="notranslate">exit 0</pre><p>
ist <span class="underline">immer</span> die letzte Zeile in <strong>/etc/rc.local</strong>!</p></div><div class="section_1"><h2 id="Test">Test<a class="headerlink" href="#Test">¶</a></h2><p>
Jetzt kann der Benutzer <code class="notranslate">kinder</code> angemeldet und ein Test durchgeführt werden. Einfach das Hintergrundbild wechseln, einen Starter löschen oder ein Panel ändern. Anschließend den Computer neu starten. Nach der Anmeldung sollte alles wieder wie vorher aussehen.</p></div><div class="section_1"><h2 id="Spaetere-nderungen">Spätere Änderungen<a class="headerlink" href="#Spaetere-nderungen">¶</a></h2><p>
Nach Übernahme der Einstellungen können immer noch Änderungen vorgenommen werden – soweit sie nicht durch die <a class="crosslink" href="#Benutzerrechte-aendern">Einschränkung der Benutzerrechte</a> blockiert sind. Als Benutzer <code class="notranslate">Kinder</code> anmelden, die Änderungen vornehmen und abmelden. Nun als Hauptbenutzer anmelden und die Einstellungen sichern:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo cp -a /home/kinder/* /home/default </pre></div></div></div><div class="section_1"><h2 id="Grafische-Anmeldung-konfigurieren">Grafische Anmeldung konfigurieren<a class="headerlink" href="#Grafische-Anmeldung-konfigurieren">¶</a></h2><p>
Das in diesem Artikel beschriebene Verfahren funktioniert bis jetzt nur, wenn der Computer nach der Benutzung heruntergefahren bzw. ausgeschaltet oder neu gestartet wird. Falls nur eine Abmeldung erfolgt, bleiben sämtliche Änderungen erhalten! Je nach Verwendungszweck kann dieses Verhalten unerwünscht sein.</p><div class="section_2"><h3 id="LightDM">LightDM<a class="headerlink" href="#LightDM">¶</a></h3><p>
Ab <a class="internal" href="./natty.html">Ubuntu 11.10</a> kommt statt GDM (siehe nächster Abschnitt) der Displaymanger <a class="internal" href="./lightdm.html">LightDM</a> zum Einsatz. Hier gibt es über die Optionen "<code class="notranslate">session-setup-script=...</code>" und "<code class="notranslate">session-cleanup-script=...</code>" in der Datei <strong>/etc/lightdm/lightdm.conf</strong> zwei Möglichkeiten, Befehle vor der Anmeldung bzw. nach der Abmeldung auszuführen.</p></div><div class="section_2"><h3 id="GDM">GDM<a class="headerlink" href="#GDM">¶</a></h3><p>
Als Lösung editiert man mit Root-Rechten <sup><a href="#source-3">[3]</a></sup> <sup><a href="#source-4">[4]</a></sup> die Datei <strong>/etc/gdm/PreSession/Default</strong> nach folgendem Muster:</p><pre class="notranslate">#!/bin/sh

if [ $LOGNAME = "kinder" ]; then
	rm -rf /home/kinder/*
	cp -a /home/default/* /home/kinder
	chown -R kinder:kinder /home/kinder
fi

exit 0</pre><p>
Da jetzt der Displaymanager <a class="internal" href="./gdm.html">GDM</a> zum Zurücksetzen der Einstellungen benutzt wird, ist der Eintrag in <strong>/etc/rc.local</strong> überflüssig. Diese Variante kann allerdings zu Problemen bei <a class="crosslink" href="#Spaetere-nderungen">späteren Änderungen</a> führen.</p></div></div><div class="section_1"><h2 id="Weitere-Moeglichkeiten">Weitere Möglichkeiten<a class="headerlink" href="#Weitere-Moeglichkeiten">¶</a></h2><p>
</p><div class="section_2"><h3 id="Script-Loesung">Script-Lösung<a class="headerlink" href="#Script-Loesung">¶</a></h3><p>
Man kann auch mit Hilfe eines Scripts das Homeverzeichnis eines Benutzers sichern und bei einem Neustart wieder zurückspielen. Im Homeverzeichnis sind alle Daten gespeichert, die direkten Einfluss auf das Aussehen und die Funktionen des Systems für den Benutzer haben. Zuerst das eigentliche Skript <strong>resethomedir</strong> zum Zurücksetzen:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1">### BEGIN INIT INFO</span>
<span class="c1"># Provides: Home-Dir-Resetter</span>
<span class="c1"># Required-Start: $syslog $remote_fs</span>
<span class="c1"># Required-Stop: $syslog $remote_fs</span>
<span class="c1"># Default-Start: 3 5</span>
<span class="c1"># Default-Stop:</span>
<span class="c1"># Description: Reset home direction of a user while booting written by Armin Jacob &amp; Anton Bracke</span>
<span class="c1"># License: This script is licensed under GNU GPL.</span>
<span class="c1">### END INIT INFO</span>
 
<span class="c1">### BEGIN INIT TODO ADJUST</span>
<span class="nv">USER</span><span class="o">=</span>BENUTZERNAME
<span class="nv">TMPDIR</span><span class="o">=</span>/home/.saves/
<span class="c1">### END INIT TODO ADJUST</span>
 
<span class="k">case</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> in
     start<span class="o">)</span>
         <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span> <span class="o">]</span>
         <span class="k">then</span>
         <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span>/Arbeitsfläche <span class="o">]</span>
         <span class="k">then</span>
                sudo rm -r -f /home/<span class="nv">$USER</span>
                sudo cp -a -r -f <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span> /home/
                sudo chown -R <span class="nv">$USER</span>:users /home/<span class="nv">$USER</span>
                sudo rm -r -f /tmp/*
                <span class="nb">echo</span> <span class="s2">"The homedir of </span><span class="nv">$USER</span><span class="s2"> is now resetted!"</span>
         <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$TMPDIR</span><span class="s2">/</span><span class="nv">$USER</span><span class="s2"> exists, but the others not! For safety reasons, the script has not been executed!"</span>
         <span class="k">fi</span>
         <span class="k">else</span> 
                <span class="nb">echo</span> <span class="s2">"The Backup-Directory doesn't exists!"</span>
         <span class="k">fi</span>
         <span class="p">;;</span>
     save<span class="o">)</span>
         <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span> <span class="o">]</span>
         <span class="k">then</span>
                sudo rm -r <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span>
         <span class="k">fi</span>
                sudo mkdir -p <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span>
                sudo cp -r -f /home/<span class="nv">$USER</span> /home/.saves
                <span class="nb">wait</span>
         <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$TMPDIR</span>/<span class="nv">$USER</span> <span class="o">]</span>
         <span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">"The home-dir of </span><span class="nv">$USER</span><span class="s2"> was successfully saved to: </span><span class="nv">$TMPDIR</span><span class="s2">/</span><span class="nv">$USER</span><span class="s2">"</span>
         <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">"Unfortunately, the backup operation was unsuccessful. Please repeat the command!"</span>
         <span class="k">fi</span>
         <span class="p">;;</span>
      *<span class="o">)</span>
         <span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> {start|save}"</span>
         <span class="nb">exit</span> <span class="m">1</span>
         <span class="p">;;</span>
<span class="k">esac</span>
<span class="nb">exit</span> <span class="m">0</span>
</pre></div>
</td></tr></table></div><p>Das obige Script lässt sich recht einfach mit folgendem Installationsscript <strong>config_resethomedir</strong> einrichten:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">read</span> -p <span class="s2">"Wessen Benutzerkonto soll abgesichert werden? Bitte achten sie auf die Rechtschreibung!</span>
<span class="s2">"</span> name
<span class="nb">read</span> -p <span class="s2">"Möchten sie einen abweichenden Pfad für die Sicherungen angeben? (Standard: /home/.saves/*) Falls Ja geben sie ihn bitte hier ein, ansonsten drücken sie bitte nur ENTER!</span>
<span class="s2">"</span> direction
<span class="nb">read</span> -p <span class="s2">"Bitte bestätigen sie, dass die Sicherung für folgenden Benutzer angelegt werden soll: </span><span class="nv">$name</span><span class="s2"> (Ja/Nein)</span>
<span class="s2">"</span> confirmation1
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$confirmation1</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"Ja"</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">"Script wird kopiert!"</span>
sudo cp resethomedir /etc/init.d/
chmod <span class="m">777</span> /etc/init.d/resethomedir
<span class="k">if</span> <span class="o">[</span> -w /etc/init.d/resethomedir <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">"Die Datei wurde erfolgreich kopiert, die Rechte gesetzt und es existiert Schreibzugriff."</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">"Die Datei wurde erfolgreich kopiert, aber es existiert kein Schreibzugriff! Der Vorgang wird jetzt wahrscheinlich mit vielen Fehlern beendet!"</span>
<span class="k">fi</span>
<span class="nb">echo</span> <span class="s2">"Das Script wird nun angepasst."</span>
sudo sed -i -e 13d /etc/init.d/resethomedir
<span class="nb">wait</span>
sudo sed -i <span class="s1">'12aUSER='</span><span class="nv">$name</span><span class="s1">''</span> /etc/init.d/resethomedir
<span class="nb">wait</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$direction</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">""</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">"Es wird das Standardverzeichnis verwendet."</span>
<span class="k">else</span>
sudo sed -i -e 13d /etc/init.d/resethomedir
<span class="nb">wait</span>
sudo sed -i <span class="s1">'13aTMPDIR='</span><span class="nv">$direction</span><span class="s1">''</span> /etc/init.d/resethomedir
<span class="k">fi</span>
<span class="nb">echo</span> <span class="s2">"Das Script wurde angepasst."</span>
sudo update-rc.d resethomedir defaults
<span class="nb">wait</span>
<span class="nb">echo</span> <span class="s2">"Das Script wurde im Autostart verankert."</span>
<span class="nb">read</span> -p <span class="s2">"Möchtest du jetzt eine erste Sicherung erstellen? (Ja/Nein)</span>
<span class="s2">"</span> confirmation2
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$confirmation2</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"Ja"</span> <span class="o">]</span>
<span class="k">then</span>
sudo /etc/init.d/resethomedir save
<span class="nb">wait</span>
<span class="nb">echo</span> <span class="s2">"Die Installation wurde inklusvie einer ersten Sicherung abgeschlossen."</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">"Die Installation wurde ohne erste Sicherung abgeschlossen! Bitte führen sie dies nun manuell durch."</span>
<span class="k">fi</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">"Vorgang wurde abgebrochen!"</span>
<span class="k">fi</span>
</pre></div>
</td></tr></table></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Die beiden Skripte müssen im selben Ordner vorhanden sein.
</p></div></div></div><div class="section_2"><h3 id="Rechner-klonen">Rechner klonen<a class="headerlink" href="#Rechner-klonen">¶</a></h3><p>
Um den Arbeitsaufwand bei mehreren Rechnern zu verringern, kann man einen derart eingerichteten Rechner mittels einer exakten Kopie der Festplatte auf andere übertragen. Während das <em>"Klonen"</em> eines Computers unter Windows durch den Hersteller des Betriebssystems bewusst erschwert wird, ist dieser Vorgang unter Linux normalerweise relativ problemlos möglich. Von einem fertig eingerichtetem PC bzw. der Festplatte erstellt man einfach ein <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Speicherabbild">Speicherabbild</a> ("Image") und überspielt dieses auf weitere Rechner. Für diesen Vorgang kann beispielsweise das Programm <a class="interwiki interwiki-sourceforge2" href="http://clonezilla.sourceforge.net">Clonezilla</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> in der <em>LiveCD</em>-Variante verwendet werden.</p><p>Clonezilla ist für die Datensicherung und das Klonen mehrerer Rechnersysteme konzipiert und unterstützt die Dateisysteme ext2, ext3, reiserfs, xfs, jfs, fat und ntfs. Dabei helfen die Programme <a class="internal" href="./partimage.html">partimage</a>, <a class="external" href="http://man.linux-ntfs.org/ntfsclone.8.html" rel="nofollow">ntfsclone</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> und <a class="internal" href="./shell/dd.html">dd</a> (DiskDump). Zum <a class="external" href="http://clonezilla.sourceforge.net/downloads.php" rel="nofollow">Download</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> des Clonezilla Live-CD ISO-Images.</p><p>So kann man in relativ kurzer Zeit viele Rechner mit Linux ausstatten - auch wenn die verwendete Hardware nicht ganz identisch ist. Unter Ubuntu problematisch sind dabei die <a class="internal" href="./uuid.html">UUIDs</a>, die nach dem Klonen angepasst werden müssen.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="./zugriff_auf_pc_einschränken.html">Zugriff auf PC einschränken</a> - weitere Möglichkeiten</p></li><li><p><a class="internal" href="./kinder.html">Kinder</a> - Computer kindgerecht einrichten</p></li><li><p><a class="internal" href="./edubuntu.html">Edubuntu</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/></p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./computer_nach_dem_neustart_zurücksetzen/a/revision/934713.html">Diese Revision</a> wurde am 8. Februar 2017 17:15 von <a href="https://ubuntuusers.de/user/Germrolf/">Germrolf</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./computer_nach_dem_neustart_zurücksetzen.html">Computer nach dem Neustart zurücksetzen</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>