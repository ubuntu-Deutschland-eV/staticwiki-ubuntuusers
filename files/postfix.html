<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Postfix › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./postfix.html">Postfix</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Postfix">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./postfix/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./postfix/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./postfix/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./postfix/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./postfix/a/backlinks.html">Postfix</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Falls Postfix im Internet agieren soll und nicht nur in der eigenen LAN-Spielwiese, so müssen Postfix und abhängige Programme (zum Beispiel <a class="internal" href="./dovecot_2.html">Dovecot</a>) sehr sorgfältig konfiguriert werden, damit kein <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Offenes_Mail-Relay">offenes Relay</a> entsteht!</p><p>Ein gutes Tutorial findet man unter <a class="external" href="http://workaround.org/ispmail/squeeze/postfix-smtp-auth" rel="nofollow">Authentifiziering Postfix via Dovecot</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Grundkonfiguration">Grundkonfiguration
</a></li><li><a class="crosslink" href="#Postfix-Server-steuern">Postfix Server steuern
</a></li><li><a class="crosslink" href="#Besondere-Konfigurationen">Besondere Konfigurationen
</a><ol class="arabic"><li><a class="crosslink" href="#Authentifizierung-am-Smarthost">Authentifizierung am Smarthost
</a></li><li><a class="crosslink" href="#Korrekten-Absender-setzen">Korrekten Absender setzen
</a></li><li><a class="crosslink" href="#Verschluesselung-aktivieren">Verschlüsselung aktivieren
</a></li><li><a class="crosslink" href="#Mehr-Konfigurationsmoeglichkeiten">Mehr Konfigurationsmöglichkeiten
</a></li></ol></li><li><a class="crosslink" href="#Funktionstest">Funktionstest
</a></li><li><a class="crosslink" href="#Anhang-Smarthost-Provider">Anhang: Smarthost-Provider
</a><ol class="arabic"><li><a class="crosslink" href="#AOL">AOL
</a></li><li><a class="crosslink" href="#Arcor">Arcor
</a></li><li><a class="crosslink" href="#GMX">GMX
</a></li><li><a class="crosslink" href="#OVH">OVH
</a></li><li><a class="crosslink" href="#WEB-DE">WEB.DE
</a></li><li><a class="crosslink" href="#Gmail">Gmail
</a></li><li><a class="crosslink" href="#1und1-de">1und1.de
</a></li><li><a class="crosslink" href="#Posteo">Posteo
</a></li></ol></li><li><a class="crosslink" href="#Fehlerbehandlung">Fehlerbehandlung
</a><ol class="arabic"><li><a class="crosslink" href="#fatal-open-database-etc-aliases-db-No-such-file-or-directory">fatal: open database /etc/aliases.db: No...</a></li><li><a class="crosslink" href="#GMX-SASL-authentication">GMX SASL authentication
</a></li><li><a class="crosslink" href="#Problem-mit-Smarthost">Problem mit Smarthost
</a></li><li><a class="crosslink" href="#Network-unreachable-Postfix-fatal-error">Network unreachable – Postfix fatal erro...</a></li><li><a class="crosslink" href="#Anhaenge-mit-mehr-als-10-MB">Anhänge mit mehr als 10 MB
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./postfix_logo.gif" class="image-left" src="./_/850a78367000ba5ccd8c926f8fd5e184d30c9df4.gif"/> 
Damit ein Linux-Rechner direkt E-Mails verschicken kann, muss ein MTA (<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Mail_Transfer_Agent">Mail Transfer Agent</a>) installiert und konfiguriert sein. Der Klassiker unter den MTA ist <code class="notranslate">sendmail</code>, dieser ist jedoch sehr umständlich zu konfigurieren, deshalb hat sich Postfix zum Standard entwickelt.</p><p>Im Prinzip könnte man den Postfix-Server aufsetzen und gleich E-Mails verschicken. Doch leider ist das im Zeitalter von Spam nicht mehr so einfach. Ein SMTP-Server ohne eine feste IP-Adresse und ohne ordentliche Zertifikate wäre eine ideale Spam-Schleuder. Deshalb akzeptiert eigentlich kein E-Mail-Server E-Mails von solchen Servern. Man muss daher die eigenen E-Mails über einen "ordentlichen" SMTP-Server (<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/SMTP-Relay-Server">Smarthost</a>), wie z.B. den von web.de und Co., leiten. Für ortsgebundene Rechner bietet sich der Server des eigenen Internet-Dienstanbieters an, da dieser meistens keine zusätzliche Authentifizierung erfordert.</p><p>Ein MTA ist aber auch dann erforderlich, wenn lokale Benutzer auf dem System untereinander E-Mails verschicken wollen. In diesem Fall findet kein Datenaustausch zu einem externen SMTP-Server statt. Lautet der Name des Rechners beispielsweise "ubuntu", so ist "root@ubuntu" eine gültige E-Mail-Adresse. Das Versenden von lokalen E-Mails wird unter anderem von Diensten wie <a class="internal" href="./cron.html">Cron</a> verwendet, um den Administrator über mögliche Probleme zu informieren. Die im Folgenden beschriebene Konfiguration ermöglicht sowohl das Versenden von E-Mails an externe als auch an interne Empfänger.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Folgende Pakete müssen installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>postfix</strong></p></li><li><p><strong>libsasl2-modules</strong> (wenn der Smarthost eine Authentifizierung benötigt)</p></li><li><p><strong>bsd-mailx</strong> (optional, um über die Konsole mit dem Befehl <code class="notranslate">mail</code> Mails verschicken zu können)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install postfix libsasl2-modules bsd-mailx </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install postfix libsasl2-modules bsd-mailx </pre></div></div><p>
</p></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Beim Einsatz von Monitoring-Programmen, die via E-Mail informieren sollen, wird <strong>mailx</strong> oft zwingend benötigt.</p><p>Alternativ kann in diesem Fall auch <a class="external" href="http://linuxundich.de/de/software/system-mails-ohne-einen-mail-server-mit-ssmtp-verschicken/#more-15889" rel="nofollow">ssmtp</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> eingesetzt werden, wodurch sich die Installation von <strong>postfix</strong> und <strong>mailx</strong> erübrigt.
</p></div></div></div><div class="section_1"><h2 id="Grundkonfiguration">Grundkonfiguration<a class="headerlink" href="#Grundkonfiguration">¶</a></h2><p>
Anschließend wird man gleich zur Grundkonfiguration von Postfix geleitet, die aus einer Serie von Fragen besteht. Bei Fragen, auf die hier nicht besonders eingegangen wird, sollte einfach der Standardwert bestätigt werden. Je nachdem, wie man die erste Frage beantwortet, tauchen bestimmte Fragen später vielleicht gar nicht auf.</p><div class="section_2"><div class="section_3"><h4 id="General-type-of-configuration">General type of configuration?<a class="headerlink" href="#General-type-of-configuration">¶</a></h4><p>
Als erstes wird nach dem allgemeinen Einsatzzweck des Servers gefragt. Zur Auswahl stehen folgende Möglichkeiten:</p><table><tr style="background-color: #F9EAAF"><td> <strong>Typ</strong></td><td><strong>Beschreibung</strong></td><td><strong>Einsatzszenarien</strong></td></tr><tr><td><em>"Internet Site"</em></td><td>Standard. Mail wird empfangen und verschickt.</td><td>Echter Mailserver mit fester IP-Adresse, z.B. Root-Server</td></tr><tr><td><em>"Internet mit Smarthost"</em></td><td>Wie Internet Site, aber Mail wird nicht direkt an den entfernten Server zugestellt, sondern über einen anderen Server (etwa beim ISP) geleitet.</td><td>Mailserver mit dynamischer IP-Adresse, die sonst sehr oft als potentielle Spam- oder Virenversender blockiert werden.</td></tr><tr><td><em>"Satellite System"</em></td><td>Keine Mail wird empfangen, alle ausgehende Mail über einen Smarthost (s.o.) verschickt.</td><td>Mail durch Admin-Skripte oder Webapplikationen verschicken lassen.</td></tr><tr><td><em>"Local only"</em></td><td>Mail wird lokal auf dem Rechner zugestellt, es wird keine Mail von außen empfangen bzw. nach außen geschickt.</td><td>Wie <em>"Satellite System"</em>, aber die Mail soll direkt auf demselben System gelesen werden.</td></tr></table></div><div class="section_3"><h4 id="Where-should-mail-for-root-go">Where should mail for root go?<a class="headerlink" href="#Where-should-mail-for-root-go">¶</a></h4><p>
Hier sollte man entweder den Benutzernamen des Admins eintragen oder seine gültige E-Mail-Adresse.</p></div><div class="section_3"><h4 id="Mailname">Mailname<a class="headerlink" href="#Mailname">¶</a></h4><p>
Dies ist der Name des Rechners, der jeder ausgehenden Mail als Absender-Domain hinzugefügt wird. In den meisten Fällen sollte man einfach den Hostnamen als Mailnamen akzeptieren, außer man ist im Besitz eines geeigneteren Domain-Namens.</p></div><div class="section_3"><h4 id="SMTP-relay-host">SMTP relay host?<a class="headerlink" href="#SMTP-relay-host">¶</a></h4><p>
Hier sollte man den Mailserver des Anbieters eintragen, über den man die Mail verschicken will, z.B. <em>smtp.mailanbieter.de</em>.</p></div><div class="section_3"><h4 id="Fuer-welche-weiteren-Rechner-moechten-Sie-Mails-akzeptieren">Für welche weiteren Rechner möchten Sie Mails akzeptieren?<a class="headerlink" href="#Fuer-welche-weiteren-Rechner-moechten-Sie-Mails-akzeptieren">¶</a></h4><p>
Wenn man den Mailserver für bestimmte Domains betreibt, die hier noch nicht aufgelistet werden, muss man diese ergänzen.</p></div><div class="section_3"><h4 id="Local-Networks">Local Networks<a class="headerlink" href="#Local-Networks">¶</a></h4><p>
Hier trägt man ein, welche Maschinen Mail über diesen Server verschicken dürfen. Es ist wichtig, dass man seinen Server hier nicht Unbekannten zur Verfügung stellt, die darüber dann Spam oder Viren verschicken können (<em>Open Relay</em>). Als Vorgabe steht dort <em>127.0.0.0/8</em>, was bedeutet, dass man nur vom lokalen Rechner aus Mails versenden darf. Wer seinen Mailserver aus dem ganzen LAN zum Versand nutzen will, sollte hier zusätzlich sein eigenes Netz eintragen:</p><pre class="notranslate">127.0.0.0/8, 192.168.1.0/24</pre><p>Wer seinen Server, bspw. einen Root-Server, über das Internet nutzen will, sollte hier auf keinen Fall weite Adressbereiche erlauben, sondern für den Versand stattdessen eine <a class="internal" href="./postfix/erweiterte_konfiguration.html">Authentifizierung</a> verlangen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Je nach Ubuntu-Version sehen diese Fragen etwas anders aus. Der wichtigste Punkt ist immer der SMTP-Server, wenn man <em>Smarthost</em> oder <em>Satellite</em> gewählt hat. Hat man sich in der Konfiguration vertan, kann man diese im Terminal <sup><a href="#source-2">[2]</a></sup> mit</p><p><code class="notranslate">sudo dpkg-reconfigure postfix</code></p><p>wiederholen, in welchem Fall noch viel mehr Fragen gestellt werden. Ebenso kann man diesen Befehl ausführen, wenn eine wichtige Einstellung, die man verändern wollte (z.B. <em>"Local Networks"</em>), bei der Installation übergangen wurde. 
</p></div></div><p>Danach ist die erste Konfiguration von Postfix abgeschlossen. Diese wird in der Datei <strong>/etc/postfix/main.cf</strong> hinterlegt.</p></div></div></div><div class="section_1"><h2 id="Postfix-Server-steuern">Postfix Server steuern<a class="headerlink" href="#Postfix-Server-steuern">¶</a></h2><p>
Wie alle anderen Dienste bringt auch Postfix Start/Stop-Skripte mit. Diese Skripte lassen sich natürlich auch zum Kontrollieren des Servers verwenden.</p><div class="bash"><div class="contents"><pre class="notranslate"># Allgemein
sudo /etc/init.d/postfix {start|stop|restart|reload|flush|check|abort|force-reload}
# Beispiel
sudo /etc/init.d/postfix restart </pre></div></div><ul><li><p><em>"start"</em> - Startet den Dienst </p></li><li><p><em>"stop"</em> - Stoppt den Dienst </p></li><li><p><em>"restart"</em> - Startet den Server neu, bestehende Verbindungen auf den Server werden gekappt </p></li><li><p><em>"reload"</em> - Lädt die Konfigurationsdateien neu, ohne dass Verbindungen getrennt werden </p></li><li><p><em>"flush"</em> - Es wird versucht, alle Mails, die in der Warteschlange liegen, zu senden </p></li><li><p><em>"abort"</em> - Stoppt Postfix sofort, alle laufenden Postfix Prozesse werden angehalten </p></li></ul><p>Mehr dazu im Wiki unter <a class="internal" href="./dienste.html">Dienste</a>.</p></div><div class="section_1"><h2 id="Besondere-Konfigurationen">Besondere Konfigurationen<a class="headerlink" href="#Besondere-Konfigurationen">¶</a></h2><p>
<a class="crosslink anchor" href="#smtp_auth" id="smtp_auth"></a>
</p><div class="section_2"><h3 id="Authentifizierung-am-Smarthost">Authentifizierung am Smarthost<a class="headerlink" href="#Authentifizierung-am-Smarthost">¶</a></h3><p>
Wenn der SMTP-Server auf dem Smarthost zum Versenden der Mail ein Passwort verlangt, muss die eben erstellte Konfiguration <strong>/etc/postfix/main.cf</strong> allerdings noch einmal editiert <sup><a href="#source-3">[3]</a></sup> und diese Zeilen eingefügt werden:</p><pre class="notranslate">smtp_sasl_auth_enable = yes
# noplaintext weglassen, wenn Passwörter im Klartext übertragen werden müssen:
# (nicht empfohlen, nur wenn's anders nicht funktioniert)
smtp_sasl_security_options = noplaintext noanonymous
smtp_sasl_password_maps = hash:/etc/postfix/sasl_password</pre><p>Wie in der Konfigurationsdatei ersichtlich, holt Postfix die Zugangsdaten aus der Datei <strong>/etc/postfix/sasl_password</strong> bzw. aus einer Datenbank, die aus der <strong>sasl_password</strong> generiert wird. Die Datei sollte man vorzugsweise mit folgendem Befehl erstellen, da sonst ein Umwandeln in eine Datenbank nicht immer möglich ist. Dazu muss man ein Terminalfenster öffnen <sup><a href="#source-2">[2]</a></sup> und den folgenden Befehl eingeben:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo touch /etc/postfix/sasl_password </pre></div></div><p>Nun schreibt man seine Daten nach folgendem Muster in die Datei</p><pre class="notranslate">smtp.mailanbieter.de username:ganzgeheimespasswort</pre><p>Damit nicht gleich jeder das Passwort lesen kann, sollte man noch die Berechtigungen der Datei einschränken (eventuell ist das für Sicherungskopien oder die nachfolgend erzeugte Datenbank zu wiederholen):</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod 600 /etc/postfix/sasl_password </pre></div></div><p>Jetzt muss noch die Datenbank erzeugt werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo postmap hash:/etc/postfix/sasl_password </pre></div></div><p>Danach muss man postfix neu starten:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/postfix restart </pre></div></div><p><a class="crosslink anchor" href="#sender_canonical" id="sender_canonical"></a>
</p></div><div class="section_2"><h3 id="Korrekten-Absender-setzen">Korrekten Absender setzen<a class="headerlink" href="#Korrekten-Absender-setzen">¶</a></h3><p>
Viele E-Mail-Anbieter erwarten inzwischen, dass man seine Post mit "richtigen" Absenderadressen verschickt - also nicht <em>ich@localhost</em> oder <em>user@meinrechner</em>. Einige, wie GMX, gehen sogar so weit, nur die eigene, korrekte Adresse zu akzeptieren. Deshalb muss man Postfix beibringen, die lokalen Adressen durch die gewünschte offizielle zu ersetzen.</p><p>Folgende Zeile muss man dafür in die Datei <strong>/etc/postfix/main.cf</strong> einfügen:</p><pre class="notranslate">sender_canonical_maps = hash:/etc/postfix/sender_canonical</pre><p>Dann erstellt man in einem Editor mit Root-Rechten <sup><a href="#source-3">[3]</a></sup> die Datei <strong>/etc/postfix/sender_canonical</strong> mit beliebig vielen Zuordnungen, z.B.:</p><pre class="notranslate">benutzer email.adresse@gmx.net
www-data beispiel@example.com
root email.adresse@gmx.net</pre><p>Zu guter Letzt erstellt man auch aus dieser Datei eine Postfix-Datenbank und lädt die Postfix-Konfiguration im Terminal <sup><a href="#source-2">[2]</a></sup> neu:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo postmap /etc/postfix/sender_canonical
sudo /etc/init.d/postfix restart   </pre></div></div></div><div class="section_2"><h3 id="Verschluesselung-aktivieren">Verschlüsselung aktivieren<a class="headerlink" href="#Verschluesselung-aktivieren">¶</a></h3><p>
Standardmäßig werden die Mails unverschlüsselt an den nächsten Server verschickt. Inzwischen wird dies aus Sicherheitsgründen von immer mehr Anbietern nicht mehr unterstützt (Web.de, GMX, T-Online, etc).</p><p>Durch Setzen des <code class="notranslate">smtp_tls_security_level</code> auf <code class="notranslate">encrypt</code>  werden nur noch verschlüsselte Verbindungen aufgebaut. Man sollte den Wert zumindest aber auf <code class="notranslate">may</code> setzen. In diesem Fall wird versucht, eine verschlüsselte Verbindung aufzubauen, wenn dies möglich ist.</p><p>In die <strong>/etc/postfix/main.cf</strong> hierzu folgendes hinzufügen:</p><pre class="notranslate">smtp_tls_security_level = may</pre><p>Ob die Mail verschlüsselt wurde, sieht man daran, dass in den Kopfzeilen ("header") der Mail bei der entsprechenden Verbindung ESMTPS(A) steht:</p><pre class="notranslate">Received: from Meinserver (meine-reverse-dns [Meine IP])
	by Derserver (Postfix) with ESMTPSA id 0E523340030E
	for &lt;me@example.com&gt;; Tue,  8 Apr 2014 10:21:11 +0200 (CEST)</pre></div><div class="section_2"><h3 id="Mehr-Konfigurationsmoeglichkeiten">Mehr Konfigurationsmöglichkeiten<a class="headerlink" href="#Mehr-Konfigurationsmoeglichkeiten">¶</a></h3><p>
Weitere Konfigurationsmöglichkeiten beschreibt der Artikel <a class="internal" href="./postfix/erweiterte_konfiguration.html">Postfix/Erweiterte Konfiguration</a>:</p><ul><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html">Aliase</a> - E-Mail-Umleitungen, z.B. für <em>root</em> oder <em>postmaster</em> </p></li><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html">TLS-Verschlüsselung</a> - Clients Verschlüsselung anbieten </p></li><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html">SASL-Authentifizierung</a> - Authentifizierung von Clients verlangen </p></li><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html#Sender-abhaengige-Authentifizierung">Sender-abhängige Authentifizierung</a> - Statt einem Smarthost E-Mails individuell über verschiedene SMTP-Server versenden</p></li><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html">Greylisting-Server</a> - Postgrey als Greylisting-Server einsetzen </p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Funktionstest">Funktionstest<a class="headerlink" href="#Funktionstest">¶</a></h2><p>
Jetzt kann man z.B. mit <code class="notranslate">mail</code> aus dem Paket <strong>mailx</strong> eine E-Mail verschicken. Der Befehl dazu sieht im Prinzip so aus:</p><div class="bash"><div class="contents"><pre class="notranslate">mail -s "testbetreff" email@addresse.de &lt; testmailtext.txt </pre></div></div><p>Danach sollte man die Datei <strong>/var/log/mail.log</strong> durchlesen und überprüfen ob alles geklappt hat. Hoffentlich steht nun am Ende der Datei etwas ähnliches wie das hier:</p><pre class="notranslate">  ...from=&lt;email@gmx.net&gt;...
   ...to=&lt;xyz@example.com&gt;,... status=sent... Message accepted</pre><p><a class="crosslink anchor" href="#Anhang" id="Anhang"></a>
</p></div><div class="section_1"><h2 id="Anhang-Smarthost-Provider">Anhang: Smarthost-Provider<a class="headerlink" href="#Anhang-Smarthost-Provider">¶</a></h2><p>
Die Anti-Spam-Maßnahmen mancher Mail-Anbieter können einem als Betreiber eines Heim- oder SOHO-Servers schon ein bisschen das Leben schwer machen. Hier werden ein paar davon beschrieben, und wie man über sie korrekt Mail verschicken kann.</p><div class="section_2"><h3 id="AOL">AOL<a class="headerlink" href="#AOL">¶</a></h3><p>
AOL erschwert die Konfiguration zusätzlich, weil unumgängliche Filterungsmaßnahmen durchgeführt werden. Nicht nur wird Mail mit anderen Absendern als der angemeldeten AOL-Kennung aggressiv gefiltert, sie leiten auch alle ausgehende Post auf dem regulären SMTP-Port 25 über einen Zwangs-Proxy weiter, der wiederum die gleiche Filterung durchführt. Der Einsatz der AOL-eigenen Mailserver als Smarthost ist deswegen nicht zu empfehlen. Um aber einen externen Anbieter als Smarthost benutzen zu können, muss man statt dem Standardport 25 den <em>Mail submission</em>-Port 587 verwenden, z.B. so:</p><pre class="notranslate">relayhost = [mail.gmx.net:587]</pre></div><div class="section_2"><h3 id="Arcor">Arcor<a class="headerlink" href="#Arcor">¶</a></h3><p>
Arcor-Internet-Kunden können über ihren eigenen Internetzugang ohne weitere Authentifizierung E-Mails mit beliebigem Absender versenden, sofern dieser eine gültige E-Mail-Adresse darstellt:</p><ul><li><p><a class="crosslink" href="#sender_canonical">Korrekten Absender setzen</a> </p></li></ul><p>Auch von unterwegs bzw. über Internet-Anbieter, die es versäumen, ihren Kunden einen eigenen Smarthost bereitzustellen (etwa im Kabelmodem-Bereich) kann man die Arcor-SMTP-Server auf diese Art nutzen, wenn man sich authentifiziert:</p><ul><li><p><a class="crosslink" href="#smtp_auth">Authentifizierung am Smarthost</a> </p></li></ul><p>Es funktioniert auch als Freemail-Kunde des sogenannten <a class="external" href="http://www.arcor.de/register/reg_01.jsp" rel="nofollow">PIA</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> -Systems, daher ist Arcor eine gute Wahl für einen Smarthost. Man braucht das entsprechende Postfach noch nicht einmal als Kontaktadresse zu nutzen, sondern benutzt es nur für den SMTP-Auth und verschickt darüber seine reguläre Mail mit beliebigen Absender-Domains, die allerdings auf Internet-weite Gültigkeit geprüft werden (nicht also von <em>user@localhost</em> o.ä. - weshalb der o.g. Schnelltest per <strong>mail</strong>-Befehl scheitern könnte). Zu beachten ist, dass Arcor die Adresse, mit der man sich authentifiziert hat, in einem Zusatz-Header in die Mail einträgt, den der Empfänger lesen kann. Darüber hinaus ist eine Freemail-Registrierung nur aus Deutschland möglich. Es sind folgende Einträge in <strong>/etc/postfix/main.cf</strong> erforderlich (wodurch die Anmelde-Informationen leider unverschlüsselt übertragen werden):</p><pre class="notranslate">relayhost = mail.arcor.de
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_password
smtp_sasl_security_options = noanonymous</pre><p>Der noch in zahlreichen Beispielen aufgeführte Server <em>postman.arcor-online.net</em> ist seit November 2005 außer Betrieb. 
</p></div><div class="section_2"><h3 id="GMX">GMX<a class="headerlink" href="#GMX">¶</a></h3><p>
<a class="crosslink anchor" href="#gmx" id="gmx"></a>
Um mit Postfix auch über GMX E-Mails versenden zu können, muss man folgende, weiter oben beschriebene Schritte ausführen:</p><ul><li><p><a class="crosslink" href="#smtp_auth">Authentifizierung am Smarthost</a> </p></li><li><p><a class="crosslink" href="#sender_canonical">Korrekten Absender setzen</a> </p></li></ul><p>Außerdem gilt es folgende Besonderheiten zu beachten:</p><ul><li><p>GMX akzeptiert nur Mail mit demselben Absender, als der man sich authentifiziert hat. Dieser Anbierter ist deswegen nur als Smarthost geeignet, wenn alle ausgehenden Mails denselben Absender tragen dürfen. Will man dies bei GMX umgehen, kann man sich auch mit der Kundennummer authentifizieren in der sasl_password , man trägt dann dort etwa mail.gmx.net 12345678:meinZugangspasswort    ein.</p></li><li><p>Die Benutzerkennung in der <strong>/etc/postfix/sasl_password</strong> besteht aus der vollständigen E-Mail-Adresse und nicht nur aus dem Benutzernamen, z.B.: </p></li></ul><p>
</p><pre class="notranslate">mail.gmx.net beispiel@gmx.de:geheim</pre><p>Eine minimale main.cf sieht dann so aus:
</p><pre class="notranslate">alias_database = hash:/etc/aliases
inet_interfaces = loopback-only
mailbox_size_limit = 0
relayhost = mail.gmx.net:587
sender_canonical_maps = hash:/etc/postfix/sender_canonical
smtp_generic_maps = hash:/etc/postfix/generic
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_password
smtp_sasl_security_options = noanonymous
smtp_tls_security_level = encrypt</pre></div><div class="section_2"><h3 id="OVH">OVH<a class="headerlink" href="#OVH">¶</a></h3><p>
Wer den SMTP-Server des Webhosters <a class="external" href="http://www.ovh.de" rel="nofollow">OVH</a> als Smarthost verwendet, muss ähnliche Änderungen vornehmen wie bei GMX. In der Datei <strong>/etc/postfix/main.cf</strong> muss folgender Eintrag geändert werden:
</p><pre class="notranslate">smtp_sasl_security_options = noanonymous</pre></div><div class="section_2"><h3 id="WEB-DE">WEB.DE<a class="headerlink" href="#WEB-DE">¶</a></h3><p>
</p><ul><li><p>Der Versand und Empfang über externe Programme muss unter <em>"Einstellungen -&gt; POP3/IMAP Abruf"</em> aktiviert werden.</p></li><li><p>Von einer WEB.DE-Absenderadresse lässt sich keine Mail an WEB.DE-Empfänger senden. In <strong>/var/log/mail.log</strong> wird in diesem Fall folgende Meldung ausgegeben: <em>"Authentification failed, or POP3 logon too old.  (in reply to MAIL FROM command)"</em></p></li></ul><p>
Seit der Sicherheitsaktualisierung vom 10.03.2009 muss die SMTP-Authentifizierung über TLS im Klartext erfolgen. Dazu wird in der Datei <strong>/etc/postfix/main.cf</strong> folgender Eintrag geändert <sup><a href="#source-3">[3]</a></sup>:</p><pre class="notranslate">smtp_sasl_security_options = noanonymous</pre></div><div class="section_2"><h3 id="Gmail">Gmail<a class="headerlink" href="#Gmail">¶</a></h3><p>
</p><ul><li><p>Wenn man unter gmail ([smtp.googlemail.com]:587) diese Fehler erhält:</p></li></ul><pre class="notranslate">"530 5.7.0 Must issue a STARTTLS command first."</pre><p>, hilft folgende Option:</p><pre class="notranslate">smtp_tls_security_level = may</pre><p>, natürlich in Zusammenhang mit:</p><pre class="notranslate">smtp_sasl_security_options = noanonymous</pre></div><div class="section_2"><h3 id="1und1-de">1und1.de<a class="headerlink" href="#1und1-de">¶</a></h3><p>
Bei 1&amp;1 ist zu beachten, dass der Parameter <em>noplaintext</em> entfernt werden muss, also:</p><pre class="notranslate">relayhost = smtp.1und1.de
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps =  hash:/etc/postfix/sasl_password
smtp_sasl_security_options = noanonymous</pre></div><div class="section_2"><h3 id="Posteo">Posteo<a class="headerlink" href="#Posteo">¶</a></h3><p>
Bei Posteo gelten prinzipiell dieselben Vorgaben wie bei 1&amp;1. Die Verbindung muss via STARTTLS (Port 587) erfolgen, Verbindungen über SSL (Port 465) werden zurückgewiesen. Zusätzlich muss man jedoch <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/MX_Resource_Record">MX</a>-Lookups deaktivieren. Das geschieht über die FQDN-Schreibweise in eckigen Klammern (ggfs. auch in der Datei <strong>/etc/postfix/tls_policy</strong> verwenden!):</p><pre class="notranslate">relayhost = [posteo.de]:587</pre><p>Versäumt man diese spezielle Notation, kommentiert Postfix das mit einer Fehlermeldung, die der folgenden ähnlich ist:</p><pre class="notranslate">connect to mx02.posteo.de[89.146.194.165]:587: Connection refused</pre><p>Im Kanal <a class="external" href="http://www.youtube.com/user/ctaasDE" rel="nofollow" title="http://www.youtube.com/user/ctaasDE">http://www.youtube.com/user/ctaasDE</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> ist ein Video zur Installation von Postfix unter Ubuntu 10.04.1 LTS veröffentlicht. Auch wird hier noch auf den HylaFAX-Server eingegangen.</p></div></div><div class="section_1"><h2 id="Fehlerbehandlung">Fehlerbehandlung<a class="headerlink" href="#Fehlerbehandlung">¶</a></h2><p>
</p><div class="section_2"><h3 id="fatal-open-database-etc-aliases-db-No-such-file-or-directory">fatal: open database /etc/aliases.db: No such file or directory"<a class="headerlink" href="#fatal-open-database-etc-aliases-db-No-such-file-or-directory">¶</a></h3><p>
Nach dem Versenden einer Mail wurde in der Log-Datei folgender Fehler festgehalten:</p><blockquote><p>" fatal: open database /etc/aliases.db: No such file or directory".</p></blockquote><p>Der Befehl
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo newaliases </pre></div></div><p>
schafft Abhilfe.</p></div><div class="section_2"><h3 id="GMX-SASL-authentication">GMX SASL authentication<a class="headerlink" href="#GMX-SASL-authentication">¶</a></h3><blockquote><p>"SASL authentication failed; cannot authenticate to server mail.gmx.net[213.165.64.21]: no mechanism available"</p></blockquote><p>Mit einer Sicherheitsaktualisierung vom 10.03.2009 hat GMX die SMTP-Authentifizierung geändert: diese muss jetzt TLS-verschlüsselt und im Klartext erfolgen. Die Konfiguration wird in <a class="crosslink" href="#gmx">GMX</a> beschrieben.</p></div><div class="section_2"><h3 id="Problem-mit-Smarthost">Problem mit Smarthost<a class="headerlink" href="#Problem-mit-Smarthost">¶</a></h3><p>
Trotz Einrichtens der Benutzerauthentifizierung am Smarthost und der Umwandlung der Absenderadresse kann postfix keine E-Mails über den Smarthost versenden. Manchmal kommt es hier zu Problemen mit der Namensauflösung des Smarthosts. Hier hilft es, wenn man nicht seinen eingenen Router als Nameserver, sondern die Nameserver des Internet-Anbieters direkt angibt. Die notwendigen Schritte sind unter
<a class="internal" href="./interfaces.html#DNS-Server-angeben">interfaces</a> und <a class="internal" href="./dns_problembehebung.html">DNS Problembehebung</a> erklärt.</p><p>Nochmals unterstrichen werden sollte auch, dass die Datei <strong>sasl_password</strong> unbedingt mit 'sudo touch sasl_password' angelegt werden sollte UND NICHT mit einem Editor wie nano etc., ansonsten wird kein richtiger Zeitstempel erzeugt, und die smtp-Authentifizierung arbeitet nicht. Außerdem müssen der smtp-smarthost, z.B. smtp.gmx.net, in der main.conf bei 'relayname=' unbedingt mit dem in der Datei <strong>sasl_password</strong> übereinstimmen. Die Verwendung verschiedener Namen, die aber evtl. zur gleichen IP-Adresse zeigen (z.B. <code class="notranslate">mail.gmx.net</code>), führt ebenfalls zu Problemen.</p></div><div class="section_2"><h3 id="Network-unreachable-Postfix-fatal-error">Network unreachable – Postfix fatal error<a class="headerlink" href="#Network-unreachable-Postfix-fatal-error">¶</a></h3><p>
In diesem <a class="external" href="http://disfunctions.de/tutorials/network-unreachable-postfix-fatal-error/" rel="nofollow">Blogbeitrag</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> (05/2011) wird genauer auf den Fehler <a class="interwiki interwiki-bug" href="https://launchpad.net/bugs/42947">42947</a> eingegangen und eine Lösung beschrieben.</p></div><div class="section_2"><h3 id="Anhaenge-mit-mehr-als-10-MB">Anhänge mit mehr als 10 MB<a class="headerlink" href="#Anhaenge-mit-mehr-als-10-MB">¶</a></h3><p>
Die Postfix-Voreinstellung für die maximale Größe einer E-Mail ist 10 MB. Der Versuch, größere E-Mails (E-Mail Body plus Attachments) zu Verschicken endet mit einer Fehlermeldung im E-Mail-Client. Die aktuelle Einstellung kann mit
</p><div class="bash"><div class="contents"><pre class="notranslate">postconf -n | egrep message_size_limit </pre></div></div><p>
angezeigt werden, wobei die Größe in Byte ausgegeben wird. Mit folgenden Befehlen kann die maximale Größe einer E-Mail auf 100 MB erhöht werden:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo postconf -e "message_size_limit = 104857600"
sudo service postfix restart </pre></div></div><p>Falls Postfix zusammen mit einem Smarthost eingesetzt wird, sollte <code class="notranslate">message_size_limit</code> natürlich an das Smarthost-System angeglichen werden und dessen Begrenzungseinstellung nicht überschreiten.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p>Homepage: <a class="external" href="http://www.postfix.org/" rel="nofollow">Postfix</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> und <a class="external" href="http://de.postfix.org/" rel="nofollow">Postfix</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p><ul><li><p><a class="internal" href="./postfix/erweiterte_konfiguration.html">Postfix/Erweiterte Konfiguration</a> </p></li></ul></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Postfix_(Mail_Transfer_Agent)">Postfix</a></p></li><li><p><a class="external" href="https://kofler.info/postfix-tls-optionen/" rel="nofollow">Postfix-TLS-Optionen</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Blogbeitrag, 11/2016</p></li><li><p><a class="interwiki interwiki-wikibooks" href="https://de.wikibooks.org/wiki/Postfix">Postfix 1.x bei Wikibooks</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </p></li><li><p><a class="external" href="http://www.my-it-brain.de/wordpress/postfix-mit-gmail-als-smarthost/" rel="nofollow">Postfix mit Gmail als Smarthost</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Blogbeitrag, 11/2013</p></li><li><p><a class="crosslink post" href="https://forum.ubuntuusers.de/post/2582672/">Umleitung von Mails an root zum eigenen Postfach (Evolution)</a> - Beispiel im Forum </p></li><li><p><a class="internal" href="./thunderbird/einrichtung.html#Lokaler-Mailspool-var-mail">Lokale Mails in Thunderbird lesen</a></p></li><li><p><a class="external" href="https://bitbucket.org/wolfmanx/ws-vacation/" rel="nofollow">Automatische E-Mail-Weiterleitung und -Beantwortung bei Abwesenheit mit Postfix</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://ctaas.de/software-raid.htm#mdadm_postfix_E-Mail_config" rel="nofollow">Postfix als Satellitensystem</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Weiterleitung von beliebigen System-E-Mails an eine externe E-Mailadresse. Mit SoftwareRAID-Beispiel: Laufwerksprobleme werden autom. per E-Mail gemeldet. Auch für durch crontab, rsync u. ä. generierte Mails geeignet.</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./postfix/a/revision/944263.html">Diese Revision</a> wurde am 16. Oktober 2017 16:26 von <a href="https://ubuntuusers.de/user/BillMaier/">BillMaier</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./postfix.html">Postfix</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>