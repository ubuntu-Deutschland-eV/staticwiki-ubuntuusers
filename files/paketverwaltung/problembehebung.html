<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Paketverwaltung/Problembehebung › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../paketverwaltung/problembehebung.html">Problembehebung</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Paketverwaltung/Problembehebung">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../paketverwaltung/problembehebung/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../paketverwaltung/problembehebung/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../paketverwaltung/problembehebung/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../paketverwaltung/problembehebung/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../paketverwaltung/problembehebung/a/backlinks.html">Problembehebung</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Abhaengigkeiten-verhindern-die-Installation-eines-Pakets">Abhängigkeiten verhindern die Installation...</a></li><li><a class="crosslink" href="#Zuruecksetzen-der-Konfigurationsdateien">Zurücksetzen der Konfigurationsdateien
</a></li><li><a class="crosslink" href="#Zuruecksetzen-von-proposed-Aktualisierungen">Zurücksetzen von proposed-Aktualisierungen...</a></li><li><a class="crosslink" href="#Es-werden-kaputte-Pakete-gemeldet">Es werden "kaputte" Pakete gemeldet
</a></li><li><a class="crosslink" href="#Die-Installation-von-Paketen-wurde-unterbrochen">Die Installation von Paketen wurde unterbr...</a></li><li><a class="crosslink" href="#Die-Installation-Deinstallation-von-Paketen-endet-mit-Fehlermeldungen">Die Installation/Deinstallation von Pakete...</a></li><li><a class="crosslink" href="#Probleme-beim-Aktualisieren-der-Paketquellen">Probleme beim Aktualisieren der Paketquell...</a></li><li><a class="crosslink" href="#Fehler-beim-Reaktivieren-geloeschter-PPAs">Fehler beim Reaktivieren gelöschter PPAs
</a></li><li><a class="crosslink" href="#Fehler-beim-Setzen-des-Eigentuemers">Fehler beim Setzen des Eigentümers
</a></li><li><a class="crosslink" href="#Probleme-mit-Lockdateien">Probleme mit Lockdateien
</a></li><li><a class="crosslink" href="#Proxyserver-in-Unternehmen">Proxyserver in Unternehmen
</a></li><li><a class="crosslink" href="#Archivverzeichnis-fehlt">Archivverzeichnis fehlt
</a></li><li><a class="crosslink" href="#Fehler-in-var-lib-dpkg-available">Fehler in /var/lib/dpkg/available
</a></li><li><a class="crosslink" href="#Apt-steckt-bei-100-Reading-package-lists">Apt steckt bei [100%] Reading package list...</a></li><li><a class="crosslink" href="#Zu-Hostnamen-gehoert-keine-Adresse">Zu Hostnamen gehört keine Adresse
</a></li><li><a class="crosslink" href="#Paketverwaltung-unbrauchbar-Segfault">Paketverwaltung unbrauchbar (Segfault)
</a></li><li><a class="crosslink" href="#Dateilisten-Datei-beschaedigt">Dateilisten-Datei beschädigt
</a></li><li><a class="crosslink" href="#Saemtliche-Pakete-neu-installieren">Sämtliche Pakete neu installieren
</a></li><li><a class="crosslink" href="#status-Datei-geloescht-oder-kaputt">status-Datei gelöscht oder kaputt
</a></li><li><a class="crosslink" href="#Kein-Speicherplatz-mehr-frei">Kein Speicherplatz mehr frei
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Durch fehlerhafte oder unpassende Paketquellen, durch die Installation mangelhaft erstellter Pakete oder durch Abstürze bei aktiver Verwendung kann es zu Problemen mit der Paketverwaltung <a class="internal" href="../apt.html">APT</a> kommen. Folgendes Schaubild verdeutlicht, dass die Fehler an unterschiedlichen Stellen und in verschiedenen Programmen auftreten können.</p><p><img alt="Paketverwaltung/dpkg_apt_usw.png" class="image-default" src="../_/271aba293ff54dc57cb06dd38015323cd5bf08fe.png"/></p><p>In diesem Artikel soll versucht werden, Probleme mit der Paketverwaltung und ihre Lösung zu schildern.</p><div class="section_1"><h2 id="Abhaengigkeiten-verhindern-die-Installation-eines-Pakets">Abhängigkeiten verhindern die Installation eines Pakets<a class="headerlink" href="#Abhaengigkeiten-verhindern-die-Installation-eines-Pakets">¶</a></h2><p>
</p><pre class="notranslate">Die folgenden Pakete besitzen unerfüllte Abhängigkeiten:
kdelibs3-devel: Hängt ab von: libxslt-devel aber es wird nicht installiert werden
Hängt ab von: libxml2-devel aber es wird nicht installiert werden</pre><p>
Gefährlicher ist es, wenn die Installation zwar möglich ist, aber nur um den Preis der Deinstallation zahlreicher anderer Komponenten, die man möglicherweise benötigt. Wenn gewarnt wird, dass Pakete deinstalliert werden, ohne dass man damit gerechnet hat, sollte man die Aktion im Zweifelsfall abbrechen.</p><p>Dieses Problem tritt vor allem dann auf, wenn man Paketquellen verwendet, die nicht für Ubuntu geeignet sind.</p><div class="section_2"><h3 id="Loesung">Lösung<a class="headerlink" href="#Loesung">¶</a></h3><p>
Nur speziell für Ubuntu ausgewiesene Paketquellen verwenden (siehe auch <a class="internal" href="../fremdquellen.html#Risiken">Fremdquellen</a>).</p></div></div><div class="section_1"><h2 id="Zuruecksetzen-der-Konfigurationsdateien">Zurücksetzen der Konfigurationsdateien<a class="headerlink" href="#Zuruecksetzen-der-Konfigurationsdateien">¶</a></h2><p>
Wurde an den systemweiten Konfigurationsdateien Änderungen vorgenommen, die zu Fehlern führen, ist aber eine funktionierende Form nicht mehr rekonstruierbar, so kann mit folgendem Befehl das Paket reinstalliert werden, sodass alle Paketdateien inkl. der Konfigurationsdateien durch den Standard ersetzt werden:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get -o dpkg::options::="--force-confnew" -o dpkg::options::="--force-confmiss" --reinstall install PAKET </pre></div></div></div><div class="section_1"><h2 id="Zuruecksetzen-von-proposed-Aktualisierungen">Zurücksetzen von proposed-Aktualisierungen<a class="headerlink" href="#Zuruecksetzen-von-proposed-Aktualisierungen">¶</a></h2><p>
Wurden versehentlicherweise Pakete aus den <em>proposed</em>-Quellen installiert, können nach dem unter <a class="internal" href="../apt-pinning.html#Von-proposed-Quellen-downgraden">Apt-Pinning</a> beschriebenen Verfahren die Pakete wieder auf eine stabile Version gedowngradet (herabgesetzt) werden.</p></div><div class="section_1"><h2 id="Es-werden-kaputte-Pakete-gemeldet">Es werden "kaputte" Pakete gemeldet<a class="headerlink" href="#Es-werden-kaputte-Pakete-gemeldet">¶</a></h2><p>
</p><pre class="notranslate">Die folgenden Pakete besitzen unerfüllte Abhängigkeiten:
  z600cups: Hängt ab von: cups (&gt;= 1:1.1.15-10) aber 1.1.20-103 ist installiert
E: Unerfüllte Abhängigkeiten. Versuche -f zu benutzen.</pre><p>Dieses Problem tritt dann auf, wenn man ein Paket "von Hand" installiert hat, ohne dessen Abhängigkeiten zu erfüllen.</p><div class="section_2"><h3 id="Loesung-2">Lösung<a class="headerlink" href="#Loesung-2">¶</a></h3><p>
Im Terminal ist der vorgeschlagene Konsolenbefehl einzugeben <sup><a href="#source-1">[1]</a></sup>:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get -f install </pre></div></div></div></div><div class="section_1"><h2 id="Die-Installation-von-Paketen-wurde-unterbrochen">Die Installation von Paketen wurde unterbrochen<a class="headerlink" href="#Die-Installation-von-Paketen-wurde-unterbrochen">¶</a></h2><p>
</p><pre class="notranslate">E: dpkg was interrupted, you must manually run 'dpkg --configure -a' to correct the problem.</pre><p>Wenn während der Installation von Paketen die Stromzufuhr des Rechners unterbrochen wird, kann das auch für die Paketverwaltung Folgen haben. Fand der Ausfall während des Downloads und somit vor der eigentlichen Installation statt, kann der Installationsvorgang wiederholt werden, sodass dieser automatisch an passender Stelle fortgesetzt wird. Wenn aber bereits Dateien eines Pakets installiert wurden, ohne dass die Installation oder Konfiguration zu Ende geführt wurde, gibt es eine entsprechende Fehlermeldung.</p><div class="section_2"><h3 id="Loesung-3">Lösung<a class="headerlink" href="#Loesung-3">¶</a></h3><p>
Wie in der Meldung angegeben ist im Terminal <sup><a href="#source-1">[1]</a></sup> der entsprechende Befehl auszuführen:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo dpkg --configure -a </pre></div></div></div></div><div class="section_1"><h2 id="Die-Installation-Deinstallation-von-Paketen-endet-mit-Fehlermeldungen">Die Installation/Deinstallation von Paketen endet mit Fehlermeldungen<a class="headerlink" href="#Die-Installation-Deinstallation-von-Paketen-endet-mit-Fehlermeldungen">¶</a></h2><p>
</p><pre class="notranslate">dpkg: Fehler beim Bearbeiten von gettext (--configure):
 Unterprozess post-installation script gab den Fehlerwert 1 zurück</pre><p>
</p><pre class="notranslate">dpkg: Fehler beim Bearbeiten von magicolor2530dl (--remove):
 Unterprozess post-removal script gab den Fehlerwert 2 zurück</pre><p>Bei der Abarbeitung von <strong>postinst</strong>/<strong>preinst</strong>- bzw.  <strong>postrm</strong>/<strong>prerm</strong>-<a class="external" href="http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html" rel="nofollow">Maintainer Skripten</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> kommt es zu Fehlern.</p><div class="section_2"><h3 id="Loesung-4">Lösung<a class="headerlink" href="#Loesung-4">¶</a></h3><p>
Eine nicht ganz saubere Lösung ist es, diese entsprechenden Skripte umzubenennen. Diese Scripte befinden sich in <strong>/var/lib/dpkg/info/</strong>.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Nur die zum entsprechenden Paket gehörigen Skripte umbenennen.
</p></div></div><p>
Besser (aber schwieriger) ist es, beim entsprechende Skript zu überprüfen, welche Bedingung nicht stimmt und es deswegen zu der Fehlermeldung kommt.</p></div></div><div class="section_1"><h2 id="Probleme-beim-Aktualisieren-der-Paketquellen">Probleme beim Aktualisieren der Paketquellen<a class="headerlink" href="#Probleme-beim-Aktualisieren-der-Paketquellen">¶</a></h2><p>
</p><div class="section_2"><h3 id="Ungueltige-Signatur-von-Paketquellen">Ungültige Signatur von Paketquellen<a class="headerlink" href="#Ungueltige-Signatur-von-Paketquellen">¶</a></h3><p>
</p><pre class="notranslate">W: GPG-Fehler: http://de.archive.ubuntu.com maverick Release: 
Die folgenden Signaturen waren ungültig: BADSIG 40976EAF237D05B5 Ubuntu Archive Automatic Signing Key &lt;ftpmaster@ubuntu.com&gt;
W: Fehlschlag beim Holen von http://extras.ubuntu.com/ubuntu/dists/maverick/Release  </pre></div><div class="section_2"><h3 id="Mehrere-Pakete-der-Groesse-0kB-Loesung-2">Mehrere Pakete der Größe: 0kB (Lösung 2)<a class="headerlink" href="#Mehrere-Pakete-der-Groesse-0kB-Loesung-2">¶</a></h3><p>
</p><pre class="notranslate">E: Die Paketindexdateien sind beschädigt: Kein Filename:-Feld für Paket ubuntu-keyring.</pre><p>Dieses Problem kann nach einer Systemaktualisierung auftreten.</p><div class="section_3"><h4 id="Loesung-1">Lösung 1<a class="headerlink" href="#Loesung-1">¶</a></h4><p>
Mittels No-Cache und BrokenProxy ein neuladen erzwingen.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude -o Acquire::http::No-Cache=True -o Acquire::BrokenProxy=true update </pre></div></div></div><div class="section_3"><h4 id="Loesung-2-2">Lösung 2<a class="headerlink" href="#Loesung-2-2">¶</a></h4><p>
Den Speicherbereich für Statusinformationen jeder in der <a class="internal" href="../sources.list.html">sources.list</a> angegebenen Paketquelle zurücksetzen und neu laden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rm -rf /var/lib/apt/lists/*
sudo mkdir /var/lib/apt/lists/partial  # Für Versionen bis Ubuntu 10.04 Lucid Lynx
sudo apt-get update </pre></div></div></div></div><div class="section_2"><h3 id="Fehler-beim-Einlesen-der-Paketliste">Fehler beim Einlesen der Paketliste<a class="headerlink" href="#Fehler-beim-Einlesen-der-Paketliste">¶</a></h3><p>
</p><pre class="notranslate">E: Encountered a section with no Package: header
E: Problem with MergeList /var/lib/apt/lists/archive.canonical.com_ubuntu_dists_natty_partner_i18n_Translation-de
E: Die Paketliste oder die Statusdatei konnte nicht eingelesen oder geöffnet werden.</pre><pre class="notranslate">Failed to exec method /usr/lib/apt/methods/
E: Method  has died unexpectedly!
E: Unterprozess  hat Fehlercode zurückgegeben (100)
E: Methode /usr/lib/apt/methods/ ist nicht korrekt gestartet</pre><p>Diese Probleme können nach einer Systemaktualisierung auftreten.</p><div class="section_3"><h4 id="Loesung-5">Lösung<a class="headerlink" href="#Loesung-5">¶</a></h4><p>
Es ist der selbe Lösungsansatz wie bei <a class="crosslink" href="#Ungueltige-Signatur-von-Paketquellen">Ungültige Signatur von Paketquellen</a> anzuwenden.</p></div></div><div class="section_2"><h3 id="ffentlicher-Schluessel-von-extras-ubuntu-com-fehlt">Öffentlicher Schlüssel von extras.ubuntu.com fehlt<a class="headerlink" href="#ffentlicher-Schluessel-von-extras-ubuntu-com-fehlt">¶</a></h3><p>
</p><pre class="notranslate">W: GPG-Fehler: http://extras.ubuntu.com oneiric Release: Die folgenden Signaturen konnten nicht überprüft werden, weil ihr öffentlicher Schlüssel nicht verfügbar ist: NO_PUBKEY 16126D3A3E5C1192</pre><p>Dieses Problem kann nach einer Systemaktualisierung auftreten.</p><div class="section_3"><h4 id="Loesung-6">Lösung<a class="headerlink" href="#Loesung-6">¶</a></h4><p>
Kann der Schlüssel nicht mit <a class="internal" href="../apt/apt-key.html">apt/apt-key</a> importiert werden, hilft eine Neuinstallation des Pakets <strong>ubuntu-extras-keyring</strong>:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get --reinstall install ubuntu-extras-keyring </pre></div></div></div></div><div class="section_2"><h3 id="Aktualisieren-schlaegt-mit-GPG-Fehler-fehl">Aktualisieren schlägt mit GPG-Fehler fehl<a class="headerlink" href="#Aktualisieren-schlaegt-mit-GPG-Fehler-fehl">¶</a></h3><p>
</p><pre class="notranslate">W: GPG error: http://ppa.launchpad.net jaunty Release: The following signatures couldn't be 
verified because the public key is not available: NO_PUBKEY 632D16BB0C7135A6</pre><p>Ggf. funktioniert das Aktualisieren eines aufgenommenen PPAs nicht reibungslos, weil der Schlüssel trotz ordnungsgemäßen Vorgehens nicht installiert wurde (insbesondere unter <a class="internal" href="../oneiric.html">Ubuntu 11.10</a> vermehrt beobachtet).</p><div class="section_3"><h4 id="Loesung-7">Lösung<a class="headerlink" href="#Loesung-7">¶</a></h4><p>
Diese Meldung besagt, dass der Authentifizierungsschlüssel nicht importiert wurde. Gelöst werden kann das Problem in diesem Beispiel mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 632D16BB0C715DA6 </pre></div></div><p>Die Schlüsselnummer muss natürlich entsprechend der Fehlermeldung angepasst werden, siehe ggf. auch auf <a class="external" href="https://help.launchpad.net/Packaging/PPA/InstallingSoftware" rel="nofollow">launchpad.net</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p></div></div></div><div class="section_1"><h2 id="Fehler-beim-Reaktivieren-geloeschter-PPAs">Fehler beim Reaktivieren gelöschter PPAs<a class="headerlink" href="#Fehler-beim-Reaktivieren-geloeschter-PPAs">¶</a></h2><p>
Falls beim Wiederaktivieren eines zuvor deaktivierten oder gelöschten <a class="internal" href="../paketquellen_freischalten/ppa.html">PPAs</a> Probleme beim Importieren des Signierungsschlüssels auftreten, muss dieser zuerst komplett aus den APT-Schlüsseldatenbanken entfernt werden.</p><p>Um den Name (ID) des richtigen Schlüssels zu erfahren, kann man direkt in der Datenbank nachschauen:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-key list --keyring /etc/apt/trusted.gpg
sudo apt-key list --keyring /etc/apt/trusted.gpg~  </pre></div></div><p>Ein Ausschnitt könnte folgendermaßen aussehen:
</p><pre class="notranslate">[...]

pub   1024R/<strong class="highlighted">12DE56F8</strong> 2011-01-01
uid                  Launchpad PPA for Ubuntu User

pub   1024R/5753AA42 2010-11-23
uid                  Launchpad PPA for Edubuntu Developers

[...]</pre><p>Soll nun der Schlüssel des PPAs von "Ubuntu User" entfernt werden, werden die folgenden zwei Befehle ausgeführt:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-key --keyring /etc/apt/trusted.gpg del 12DE56F8
sudo apt-key --keyring /etc/apt/trusted.gpg~ del 12DE56F8  </pre></div></div><p>Abschließend muss noch der Speicherbereich für Statusinformationen nach <a class="internal" href="../paketverwaltung/problembehebung.html#Ungueltige-Signatur-von-Paketquellen">Paketverwaltung/Problembehebung</a> zurückgesetzt werden.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das Entferen eines PPAs mit <a class="internal" href="../paketquellen_freischalten/ppa.html#PPA-Purge">ppa-purge</a> reicht nicht aus, da die Schlüssel nicht entfernt werden, sondern lediglich die Quelle deaktiviert wird (und das Paket auf die nächstniedrigere Version zurückgesetzt wird).
</p></div></div></div><div class="section_1"><h2 id="Fehler-beim-Setzen-des-Eigentuemers">Fehler beim Setzen des Eigentümers<a class="headerlink" href="#Fehler-beim-Setzen-des-Eigentuemers">¶</a></h2><p>
</p><pre class="notranslate">dpkg: Fehler beim Bearbeiten von /var/cache/apt/archives/linux-image-3.0.0-12-generic_3.0.0-12.20_i386.deb (--unpack):
 Fehler beim Setzen des Eigentümers von »./boot/vmlinuz-3.0.0-12-generic«: Die Operation ist nicht erlaubt
dpkg-deb: Fehler: Unterprozess einfügen wurde durch Signal (Datenübergabe unterbrochen (broken pipe)) getötet
Examining /etc/kernel/postrm.d .
run-parts: executing /etc/kernel/postrm.d/initramfs-tools 3.0.0-12-generic /boot/vmlinuz-3.0.0-12-generic
run-parts: executing /etc/kernel/postrm.d/zz-update-grub 3.0.0-12-generic /boot/vmlinuz-3.0.0-12-generic
Fehler traten auf beim Bearbeiten von:
 /var/cache/apt/archives/linux-image-3.0.0-12-generic_3.0.0-12.20_i386.deb
E: Sub-process /usr/bin/dpkg returned an error code (1) </pre><p>Dieser Fehler tritt auf, wenn Systemverzeichnisse sich nicht auf einem Linux-Dateisystem befinden.</p><div class="section_2"><h3 id="Loesung-8">Lösung<a class="headerlink" href="#Loesung-8">¶</a></h3><p>
Systemordner über <a class="internal" href="../fstab.html">fstab</a> in <a class="internal" href="../dateisystem.html">Dateisystem</a> mit ausreichender Rechteverwaltung einbinden. U.U. muss eine entsprechende Partition erst angelegt werden: <a class="internal" href="../manuelle_partitionierung.html">Manuelle Partitionierung</a></p></div></div><div class="section_1"><h2 id="Probleme-mit-Lockdateien">Probleme mit Lockdateien<a class="headerlink" href="#Probleme-mit-Lockdateien">¶</a></h2><p>
</p><div class="section_2"><h3 id="Datei-oder-Verzeichnis-nicht-gefunden">Datei oder Verzeichnis nicht gefunden<a class="headerlink" href="#Datei-oder-Verzeichnis-nicht-gefunden">¶</a></h3><p>
</p><pre class="notranslate">E: Lockdatei /var/lib/apt/lists/lock konnte nicht geöffnet werden - open (2: Datei oder Verzeichnis nicht gefunden)
E: Das Listenverzeichnis kann nicht gesperrt werden</pre><p>
</p><pre class="notranslate">E: Lockdatei /var/cache/apt/archives/lock konnte nicht geöffnet werden - open (2: No such file or directory)
E: Das Downloadverzeichnis konnte nicht gesperrt werden.</pre><div class="section_3"><h4 id="Loesung-9">Lösung<a class="headerlink" href="#Loesung-9">¶</a></h4><p>
Die Lockdatei und das zugrunde liegende Verzeichnis manuell anlegen. Für das erste Beispiel also:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir -p /var/cache/apt/archives
sudo touch /var/cache/apt/archives/lock </pre></div></div></div></div></div><div class="section_1"><h2 id="Proxyserver-in-Unternehmen">Proxyserver in Unternehmen<a class="headerlink" href="#Proxyserver-in-Unternehmen">¶</a></h2><p>
</p><div class="section_2"><h3 id="PPA-Repository-Key-laesst-sich-nicht-ueber-Proxy-hinzufuegen">PPA Repository Key lässt sich nicht über Proxy hinzufügen<a class="headerlink" href="#PPA-Repository-Key-laesst-sich-nicht-ueber-Proxy-hinzufuegen">¶</a></h3><p>
</p><pre class="notranslate">E: HTTP fetch error 6
E: Could not resolve host: keyserver.ubuntu.com</pre><p>
</p><pre class="notranslate">E: Die folgenden Signaturen konnten nicht überprüft werden, weil ihr öffentlicher Schlüssel nicht verfügbar ist</pre><div class="section_3"><h4 id="Loesung-10">Lösung<a class="headerlink" href="#Loesung-10">¶</a></h4><p>
Die Environment-Einstellungen müssen dem Root-Benutzer im sudo übergeben werden mit der Option "-E"
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo -E apt-key adv --keyserver http://keyserver.ubuntu.com:80 ... </pre></div></div></div></div><div class="section_2"><h3 id="Ressource-ist-zur-Zeit-nicht-verfuegbar">Ressource ist zur Zeit nicht verfügbar<a class="headerlink" href="#Ressource-ist-zur-Zeit-nicht-verfuegbar">¶</a></h3><p>
</p><pre class="notranslate">E: Konnte Sperre /var/cache/apt/archives/lock nicht bekommen - open (11: Die Ressource ist zur Zeit nicht verfügbar)
E: Das Verzeichnis /var/cache/apt/archives/ kann nicht gesperrt werden</pre><p>
oder
</p><pre class="notranslate">E: Konnte Sperre /var/lib/dpkg/lock nicht bekommen - open (11: Die Ressource ist zur Zeit nicht verfügbar)
E: Das Verzeichnis /var/lib/dpkg/ kann nicht gesperrt werden</pre><div class="section_3"><h4 id="Loesung-11">Lösung<a class="headerlink" href="#Loesung-11">¶</a></h4><p>
Arbeitet bereits ein anderes Programm zur Paketverwaltung im Hintergrund? Dies kontrolliert man zuerst mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lsof /var/cache/apt/archives/lock </pre></div></div><p>
um dann gegebenenfalls mit <a class="internal" href="../shell/ps.html">ps</a> herauszufinden, welcher Prozess die Paketverwaltung blockiert. Warten auf das Terminieren des Prozesses löst das Problem meist. Sollte der Prozess hängen, kann er mit <a class="internal" href="../shell/kill.html">kill</a> zum Beenden gezwungen werden. Sollte der Lock danach immer noch nicht freigegeben sein, kann man als letzte Möglichkeit den Lock mit <a class="internal" href="../sudo.html">Rootrechten</a> löschen. Nach dem Löschen muss die Lockdatei erneut angelegt werden, zum Beispiel mit</p><div class="bash"><div class="contents"><pre class="notranslate">sudo touch /var/cache/apt/archives/lock </pre></div></div></div></div><div class="section_2"><h3 id="Keine-Berechtigung">Keine Berechtigung<a class="headerlink" href="#Keine-Berechtigung">¶</a></h3><p>
</p><pre class="notranslate">E: Lockdatei /var/lib/apt/lists/lock konnte nicht geöffnet werden - open (13: Keine Berechtigung)</pre><div class="section_3"><h4 id="Loesung-12">Lösung<a class="headerlink" href="#Loesung-12">¶</a></h4><p>
Man sollte das eingegebene Kommando nochmal mit <a class="internal" href="../sudo.html">Rootrechten</a> ausführen.</p></div></div></div><div class="section_1"><h2 id="Archivverzeichnis-fehlt">Archivverzeichnis fehlt<a class="headerlink" href="#Archivverzeichnis-fehlt">¶</a></h2><p>
</p><pre class="notranslate">E: Archivverzeichnis /var/cache/apt/archives/partial fehlt.</pre><div class="section_2"><h3 id="Loesung-13">Lösung<a class="headerlink" href="#Loesung-13">¶</a></h3><p>
Bis <a class="internal" href="../lucid_lynx.html">Ubuntu 10.04</a> wird ein fehlendes Verzeichnis für Statusinformationen während der Aktualisierung der Paketindexdateien nicht automatisch angelegt. Durch Neuanlegen des Verzeichnisses wird das Problem behoben:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir -p /var/lib/apt/lists/partial </pre></div></div></div></div><div class="section_1"><h2 id="Fehler-in-var-lib-dpkg-available">Fehler in /var/lib/dpkg/available<a class="headerlink" href="#Fehler-in-var-lib-dpkg-available">¶</a></h2><p>
</p><pre class="notranslate">Vorkonfiguration der Pakete ...
dpkg: Fehler: Parsen der Datei »/var/lib/dpkg/available«, nahe Zeile 0:
 nach Feldname »../../../../share/pyshared/UpdateManager/check-meta-release.py« muss ein Doppelpunkt folgen
E: Sub-process /usr/bin/dpkg returned an error code (2)</pre><p>Durch Verletzen der Policy von Versionsbezeichnung von Maintainern, kann es zu Meldungen bezüglich fehlender oder nicht erlaubter Zeichen kommen.</p><div class="section_2"><h3 id="Loesung-14">Lösung<a class="headerlink" href="#Loesung-14">¶</a></h3><p>
Durch Entfernen der Datei <strong>/var/lib/dpkg/available</strong> wird das Problem behoben:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo dpkg --clear-avail </pre></div></div></div></div><div class="section_1"><h2 id="Apt-steckt-bei-100-Reading-package-lists">Apt steckt bei <strong>[100%] Reading package lists</strong><a class="headerlink" href="#Apt-steckt-bei-100-Reading-package-lists">¶</a></h2><p>
</p><pre class="notranslate">$ sudo apt-get install
[100%] Reading package lists</pre><p>Durch eine fehlerhafte /var/lib/dpkg/available Datei kann es sein, dass apt-get für etwa 20 Minuten hängenbleibt.</p><div class="section_2"><h3 id="Loesung-15">Lösung<a class="headerlink" href="#Loesung-15">¶</a></h3><p>
Durch Entfernen der Datei <strong>/var/lib/dpkg/available</strong> wird das Problem behoben:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install dctrl-tools # Hier einmal die 20Minuten abwarten
sudo dpkg --clear-avail
sudo sync-available </pre></div></div></div></div><div class="section_1"><h2 id="Zu-Hostnamen-gehoert-keine-Adresse">Zu Hostnamen gehört keine Adresse<a class="headerlink" href="#Zu-Hostnamen-gehoert-keine-Adresse">¶</a></h2><p>
</p><pre class="notranslate">W: Fehlschlag beim Holen von http://archieve.ubuntu.com/dists/oneiric-security/restricted/i18n/Translation-de Beim Auflösen von »archieve.ubuntu.com:http« ist etwas Schlimmes passiert (-5 - Zu diesem Hostnamen gehört keine Adresse)</pre><p>Bei fehlerhaft eingetragenen oder nicht mehr vorhandenen Paketquellen bzw. fehlerhaften Netzwerkeinstellungen kann es zu dieser Fehlermeldung kommen.</p><div class="section_2"><h3 id="Loesung-16">Lösung<a class="headerlink" href="#Loesung-16">¶</a></h3><p>
Manuell die Paketquellen in der Datei <a class="internal" href="../sources.list.html">/etc/apt/sources.list</a> korrigieren. Dabei auf Rechtschreibfehler und nicht mehr vorhandene Paketquellen achten. Sollten diese Angaben korrekt sein, muss der Netzwerkzugang auf statische bzw. dynamische IP-Zuweisung untersucht werden.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Bei neueren Ubuntu-Versionen sollten auch Einträge im Ordner <strong>/etc/apt/sources.list.d/</strong> überprüft werden.
</p></div></div></div></div><div class="section_1"><h2 id="Paketverwaltung-unbrauchbar-Segfault">Paketverwaltung unbrauchbar (Segfault)<a class="headerlink" href="#Paketverwaltung-unbrauchbar-Segfault">¶</a></h2><p>
Es kann vorkommen, dass die Paketverwaltung aufgrund einer Beschädigung des Zwischenspeichers zum Speichern von "verfügbaren" Informationen nicht mehr funktioniert und z.B. ein 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get check </pre></div></div><p>mit folgender Fehlermeldung abbricht:
</p><pre class="notranslate">Segmentation faulty Tree</pre><div class="section_2"><h3 id="Loesung-17">Lösung<a class="headerlink" href="#Loesung-17">¶</a></h3><p>
Dieser Missstand kann durch das Löschen der beiden Zwischenspeicherdateien <strong>/var/cache/apt/pkgcache.bin</strong> und <strong>/var/cache/apt/srcpkgcache.bin</strong> mit Root-Rechten <sup><a href="#source-2">[2]</a></sup> behoben werden.</p></div></div><div class="section_1"><h2 id="Dateilisten-Datei-beschaedigt">Dateilisten-Datei beschädigt<a class="headerlink" href="#Dateilisten-Datei-beschaedigt">¶</a></h2><p>
</p><pre class="notranslate">Extrahiere Vorlagen aus Paketen: 100%
Vorkonfiguration der Pakete ...
(Lese Datenbank ... 55%dpkg: nicht behebbarer fataler Fehler, Abbruch:
 Abschließender Zeilenvorschub fehlt in Dateilisten-Datei des Paketes »pulseaudio-module-bluetooth«
E: Sub-process /usr/bin/dpkg returned an error code (2)</pre><p>Nach einem Festplatten- oder Speicherfehler, bzw. wenn der Paket-Entpackprozess unterbrochen wurde, kann die entsprechende Datei unter <strong>/var/lib/dpkg/info/PAKET.list</strong> beschädigt sein.</p><div class="section_2"><h3 id="Loesung-18">Lösung<a class="headerlink" href="#Loesung-18">¶</a></h3><p>
Mit folgendem Vorgehen wird die entsprechend beschädigte Datei unter <strong>/var/lib/dpkg/info/PAKET.list</strong> neu generiert. Dazu wird zuerst das entsprechende Paket heruntergeladen (sollte sich das Paket noch im Cache unter <strong>/var/cache/apt/archives/</strong> befinden, kann dieser Schritt übersprungen werden):
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get --download-only --reinstall install PAKET </pre></div></div><p>Abschließend wird die Dateilisten-Datei generiert und am entsprechenden Ort mit dem an 4 Stellen anzupassenden Befehl gespeichert (anzupassen sind <span class="underline">zweimal</span> <code class="notranslate">PAKET</code> und einmal jeweils <code class="notranslate">VERSION</code> und <code class="notranslate">ARCHITEKTUR</code>):</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg -c /var/cache/apt/archives/PAKET_VERSION_ARCHITEKTUR.deb | awk '{if ($6 == "./") { print "/."; } else if (substr($6, length($6), 1) == "/") {print substr($6, 2, length($6) - 2); } else { print substr($6, 2, length($6) - 1);}}' | sudo tee /var/lib/dpkg/info/PAKET.list </pre></div></div><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die <a class="internal" href="../shell/umleitungen.html">Umleitung</a> in die Datei <strong>/var/lib/dpkg/info/PAKET.list</strong> muss korrekt angepasst werden, da bei falscher Bezeichnung die Paketverwaltung weiter beschädigt werden könnte, indem andere Dateilistendateien überschrieben werden.
</p></div></div></div></div><div class="section_1"><h2 id="Saemtliche-Pakete-neu-installieren">Sämtliche Pakete neu installieren<a class="headerlink" href="#Saemtliche-Pakete-neu-installieren">¶</a></h2><p>
Sind sehr viele Pakete in schlechtem Zustand, lohnt es sich eventuell, alle installierten Programme neu aus den Quellen herunterzuladen und zu installieren:</p><div class="bash"><div class="contents"><pre class="notranslate">dpkg --get-selections | grep "\binstall" | awk '{print $1}' &gt; /tmp/dpkg.log </pre></div></div><p>
sucht alle installierten Pakete und speichert diese in der Datei <strong>/tmp/dpkg.log</strong>.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo xargs -n1 apt-get --reinstall install -y &lt; /tmp/dpkg.log </pre></div></div><p>
nimmt einen Eintrag aus <strong>/tmp/dpkg.log</strong> und installiert diese Pakete erneut.</p></div><div class="section_1"><h2 id="status-Datei-geloescht-oder-kaputt">status-Datei gelöscht oder kaputt<a class="headerlink" href="#status-Datei-geloescht-oder-kaputt">¶</a></h2><p>
In der Datei <strong>/var/lib/dpkg/status</strong> werden alle wichtigen Informationen für dpkg gespeichert. Ist diese Datei beschädigt, ist die Paketverwaltung unbrauchbar. Helfen auch die Sicherungskopien im  selben Verzeichnis <strong>/var/lib/dpkg/</strong> nicht weiter, kann die Datei mithilfe von Informationen aus <strong>/var/lib/dpkg/available</strong> und Infodateien aus <strong>/var/lib/dpkg/info/</strong> rekonstruiert werden. Die Qualität der Rekonstruktion hängt entscheidend von der Aktualität von <strong>/var/lib/dpkg/available</strong> ab. Diese Datei sollte zuerst (mit <a class="internal" href="../apt/apt-get.html#apt-get-update">apt-get</a>) erneuert werden. Anschließend kann folgendes  <a class="internal" href="../perl.html">Perl</a>-Skript z.B. als <strong>dpkg-rebuild</strong> gespeichert werden:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/usr/bin/perl -w</span>

<span class="c1"># Rebuild the Debian '/var/lib/dpkg/status' file from information in</span>
<span class="c1"># '/var/lib/dpkg/available' and '/var/lib/dpkg/info/*.(list|conffiles)'.</span>
<span class="c1"># This is useful if your 'status' file got corrupted if the system crashed</span>
<span class="c1"># during package maintenance, for example.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2002 by Patrick Reynolds (reynolds .at. cs duke edu)</span>
<span class="c1">#           2012 by Dominique Lasserre (lasserre.d at gmail com)</span>
<span class="c1"># Distributed under the terms of the GNU General Public License (GPL).</span>
<span class="c1">#</span>
<span class="c1"># Usage:</span>
<span class="c1">#   dpkg-rebuild</span>
<span class="c1"># It takes no arguments and generates output in /tmp/status.</span>
<span class="c1"># Move /tmp/status to /var/lib/dpkg if it looks acceptable.</span>
<span class="c1"># With multiarch support!</span>
<span class="c1">#</span>
<span class="c1"># Limitations:</span>
<span class="c1">#   1) Packages that are no longer available will not show up in the</span>
<span class="c1">#   rebuilt 'status' file.  This means installed-but-obsolete packages</span>
<span class="c1">#   can't be managed after a rebuild.</span>
<span class="c1">#   Only packages listed in /var/lib/dpkg/available are processed. So update</span>
<span class="c1">#   it before dpkg-rebuild operation.</span>
<span class="c1">#</span>
<span class="c1">#   2) The 'Conffiles:' keys in the 'status' file doesn't have checksums.</span>
<span class="c1">#   It is not possible to detect if config file was modified or not, so do</span>
<span class="c1">#   not generate checksums at all.</span>
<span class="c1">#   If a package has config files but not listed in .conffiles they aren't</span>
<span class="c1">#   tracked (and probably package state is guessed false).</span>
<span class="c1">#   'Config-Version' will not created because it is impossible to detect from</span>
<span class="c1">#   which version config files are from.</span>
<span class="c1">#   Configuration files may not be completely removed when you purge</span>
<span class="c1">#   packages, and package upgrades may clobber existing configuration</span>
<span class="c1">#   files without asking.</span>
<span class="c1">#</span>
<span class="c1">#   3) Packages in transitional or error states will be misreported.</span>

<span class="k">use</span> <span class="nn">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">warnings</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$available</span> <span class="o">=</span> <span class="s">"/var/lib/dpkg/available"</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$status</span> <span class="o">=</span> <span class="s">"/tmp/status"</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$info_dir</span> <span class="o">=</span> <span class="s">"/var/lib/dpkg/info"</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%installed</span><span class="p">;</span>

<span class="c1"># Multiarch supported architectures.</span>
<span class="k">my</span> <span class="nv">@archs</span><span class="p">;</span>
<span class="nb">open</span><span class="p">(</span><span class="n">ARCHS</span><span class="p">,</span> <span class="s">"dpkg --print-architecture |"</span><span class="p">)</span> <span class="o">||</span> <span class="nb">die</span> <span class="s">"no native architecture\n"</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="sr">&lt;ARCHS&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">chomp</span><span class="p">;</span>
  <span class="nb">push</span><span class="p">(</span><span class="nv">@archs</span><span class="p">,</span> <span class="nv">$_</span><span class="p">);</span>
<span class="p">}</span>
<span class="nb">close</span><span class="p">(</span><span class="n">ARCHS</span><span class="p">);</span>
<span class="nb">open</span><span class="p">(</span><span class="n">ARCHS</span><span class="p">,</span> <span class="s">"dpkg --print-foreign-architectures |"</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="sr">&lt;ARCHS&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">chomp</span><span class="p">;</span>
  <span class="nb">push</span><span class="p">(</span><span class="nv">@archs</span><span class="p">,</span> <span class="nv">$_</span><span class="p">);</span>
<span class="p">}</span>
<span class="nb">close</span><span class="p">(</span><span class="n">ARCHS</span><span class="p">);</span>

<span class="c1"># Fill %installed with status information of installed packages.</span>
<span class="c1"># installed{package} =&gt; {</span>
<span class="c1">#      "status" =&gt; 1,  (installed with files -&gt; installed)</span>
<span class="c1">#      "status" =&gt; 2,  (installed without files -&gt; deinstalled)</span>
<span class="c1">#    ## not implemented:</span>
<span class="c1">#    ##  "status" =&gt; 3,  (installed with files but no md5sums file -&gt; purged)</span>
<span class="c1">#      "conffiles" =&gt; array of conffiles</span>
<span class="c1"># }</span>
<span class="k">foreach</span> <span class="p">(</span><span class="sr">&lt;$info_dir/*.list&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">my</span> <span class="nv">$package</span> <span class="o">=</span> <span class="nv">$_</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="c1">#.*/([^/]+)\.list$#$1#);</span>
  <span class="k">my</span> <span class="nv">$pkgfile_st</span> <span class="o">=</span> <span class="s">"$info_dir/$package"</span><span class="p">;</span>
  <span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"status"</span><span class="p">}</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nb">open</span><span class="p">(</span><span class="n">LISTFILE</span><span class="p">,</span> <span class="s">"&lt;$pkgfile_st.list"</span><span class="p">)</span> <span class="o">||</span> <span class="nb">die</span> <span class="s">"no $pkgfile_st.list\n"</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="sr">&lt;LISTFILE&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">chomp</span><span class="p">;</span>
    <span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"status"</span><span class="p">}</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">last</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">e</span> <span class="s">"$pkgfile_st.conffiles"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">CONFFILE</span><span class="p">,</span> <span class="s">"&lt;$pkgfile_st.conffiles"</span><span class="p">)</span> <span class="o">||</span> <span class="nb">die</span> <span class="s">"no $pkgfile_st.conffiles\n"</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">@files</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="sr">&lt;CONFFILE&gt;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">chomp</span><span class="p">;</span>
      <span class="nb">push</span><span class="p">(</span><span class="nv">@files</span><span class="p">,</span> <span class="nv">$_</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="n">conffiles</span><span class="p">}</span> <span class="o">=</span> <span class="o">\</span><span class="nv">@files</span> <span class="k">if</span> <span class="nv">@files</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># 0=between, 1=essential-searching 2=copying-installed, 3=copying-not-installed</span>
<span class="k">my</span> <span class="nv">$state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$package</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@conffiles</span> <span class="o">=</span> <span class="nb">undef</span><span class="p">;</span>
<span class="nb">open</span><span class="p">(</span><span class="n">AVAILABLE</span><span class="p">,</span> <span class="s">"&lt;$available"</span><span class="p">)</span> <span class="o">||</span> <span class="nb">die</span> <span class="s">"no $available\n"</span><span class="p">;</span>
<span class="nb">open</span><span class="p">(</span><span class="n">STATUS</span><span class="p">,</span> <span class="s">"&gt;$status"</span><span class="p">)</span> <span class="o">||</span> <span class="nb">die</span> <span class="s">"no $status\n"</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="sr">&lt;AVAILABLE&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">chomp</span><span class="p">;</span>
  <span class="k">my</span> <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$_</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">/^Package: (\S+)$/</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$package</span> <span class="o">=</span> <span class="nv">$1</span><span class="p">;</span>
      <span class="k">unless</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$1</span><span class="p">})</span> <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">@archs</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$package</span> <span class="o">=</span> <span class="s">"$1:$_"</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="s">"$1:$_"</span><span class="p">});</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">})</span> <span class="p">{</span>
        <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"$line\n"</span><span class="p">;</span>
        <span class="nv">$state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nb">die</span> <span class="s">"Expected 'Package:' at $.\n"</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">elsif</span> <span class="p">(</span><span class="nv">$state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$ess_pkg</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=~</span> <span class="sr">m/^Essential: /</span><span class="p">);</span>
    <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"$_\n"</span> <span class="k">if</span> <span class="nv">$ess</span><span class="p">;</span>
    <span class="nv">$state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"status"</span><span class="p">}</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"Status: install ok installed\n"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"status"</span><span class="p">}</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"Status: deinstall ok config-files\n"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"status"</span><span class="p">}</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"Status: purge ok config-files\n"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"conffiles"</span><span class="p">})</span> <span class="p">{</span>
      <span class="nv">@conffiles</span> <span class="o">=</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">}{</span><span class="s">"conffiles"</span><span class="p">}};</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">@conffiles</span> <span class="o">=</span> <span class="nb">undef</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">delete</span> <span class="nv">$installed</span><span class="p">{</span><span class="nv">$package</span><span class="p">};</span>
    <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"$_\n"</span> <span class="k">unless</span> <span class="nv">$ess_pkg</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elsif</span> <span class="p">(</span><span class="nv">$state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="ow">eq</span> <span class="s">""</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"\n"</span><span class="p">;</span>
      <span class="nv">$state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span><span class="sr">/^Description: /</span> <span class="o">&amp;&amp;</span> <span class="nv">$conffiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"Conffiles:\n"</span><span class="p">;</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">" $_\n"</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">@conffiles</span><span class="p">);</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"$line\n"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span><span class="o">!</span><span class="sr">/^Filename: /</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="sr">/^Size: /</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="sr">/^MD5sum: /</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">print</span> <span class="n">STATUS</span> <span class="s">"$line\n"</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">elsif</span> <span class="p">(</span><span class="nv">$state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">){</span>
    <span class="nv">$state</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span> <span class="ow">eq</span> <span class="s">""</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">printf</span> <span class="s">"Installed packages not found in $available:\n"</span><span class="p">;</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nb">sort</span> <span class="nb">keys</span> <span class="nv">%installed</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">print</span> <span class="s">"  $_\n"</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div><p>
Nun wird das Skript ausgeführt:
</p><div class="bash"><div class="contents"><pre class="notranslate">perl dpkg-rebuild </pre></div></div><p>Anschließend wurde bei Erfolg in <strong>/tmp/status</strong> eine Rekonstruktion erstellt. Diese sollte mit den Backupdateien abgeglichen werden und kann anschließend verwendet werden. Je nach Aktualität der <strong>available</strong>-Datei wurde eine mehr oder weniger gute Rekonstruktion erstellt. Diese kann allerdings niemals ein externes Backup ersetzen.</p></div><div class="section_1"><h2 id="Kein-Speicherplatz-mehr-frei">Kein Speicherplatz mehr frei<a class="headerlink" href="#Kein-Speicherplatz-mehr-frei">¶</a></h2><p>
Wenn man Software oder Aktualisierungen installieren möchte, aber kein freier Speicherplatz mehr zur Verfügung steht, erhält man eine Fehlermeldung:</p><pre class="notranslate">gzip: stdout: No space left on device</pre><p>
Eine Lösung speziell für eine separate Boot-Partition wird im Artikel <a class="internal" href="../kernel.html#Kein-Speicherplatz-mehr-frei">Kernel</a> beschrieben. Ansonsten muss versucht werden, Platz durch manuelles Löschen zu gewinnen.</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="../paketverwaltung.html">Paketverwaltung</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Informationen rund um die Paketverwaltung</p></li><li><p><a class="internal" href="../dpkg.html">dpkg</a> - Debian Paketmanager</p></li><li><p><a class="interwiki interwiki-ubuntu" href="https://wiki.ubuntu.com/DebuggingInstallationIssues">DebuggingInstallationIssues</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Sammlung von Problembehebungen mit der Paketverwaltung</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../paketverwaltung/problembehebung/a/revision/937247.html">Diese Revision</a> wurde am 4. März 2017 13:27 von <a href="https://ubuntuusers.de/user/gerhardbeck/">gerhardbeck</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../paketverwaltung.html">Paketverwaltung</a></li>
<li><a href="../paketverwaltung/problembehebung.html">Problembehebung</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>