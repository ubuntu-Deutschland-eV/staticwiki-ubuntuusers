<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>WireGuard › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./wireguard.html">WireGuard</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/WireGuard">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./wireguard/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./wireguard/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./wireguard/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./wireguard/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./wireguard/a/backlinks.html">WireGuard</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./paketquellen_freischalten.html">Paketquellen freischalten</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-7" id="source-7"></a> <a class="internal" href="./iptables2.html">Iptables Regeln erstellen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Vorbereitung">Vorbereitung
</a></li><li><a class="crosslink" href="#Einmalige-Konfiguration">Einmalige Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Client-1">Client 1
</a></li><li><a class="crosslink" href="#Client-2">Client 2
</a></li></ol></li><li><a class="crosslink" href="#Statische-Konfiguration">Statische Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Client-1-2">Client 1
</a></li><li><a class="crosslink" href="#Client-2-2">Client 2
</a></li><li><a class="crosslink" href="#Client-3-und-mehr">Client 3 und mehr
</a></li></ol></li><li><a class="crosslink" href="#LAN-miteinbeziehen">LAN miteinbeziehen
</a><ol class="arabic"><li><a class="crosslink" href="#Client-1-3">Client 1
</a></li><li><a class="crosslink" href="#Client-2-3">Client 2
</a></li></ol></li></ol></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a><ol class="arabic"><li><a class="crosslink" href="#Kein-Verbindung-moeglich">Kein Verbindung möglich
</a></li><li><a class="crosslink" href="#Probleme-mit-der-dynamischen-IP">Probleme mit der dynamischen IP
</a></li><li><a class="crosslink" href="#Fehler-Netzwerkschnittstelle-nocht-konfiguriert-beim-Befehl-ifdown-wg0">Fehler "Netzwerkschnittstelle nocht konf...</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>
<img alt="logo.png" class="image-left" src="./_/5c210a5dfe4a366ae7aadb99429eef1a64f5c3f9.png"/>
<a class="external" href="https://www.wireguard.com/" rel="nofollow">WireGuard</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist eine <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Virtual_Private_Network">Virtual-Private-Network-Software</a>, welche als Alternative zu bekannten VPN-Lösungen wie <a class="internal" href="./openvpn.html">OpenVPN</a> und IPsec entwickelt wird. Es soll im Vergleich zu OpenVPN und IPsec einfacher zu konfigurieren sein sowie schneller und effizienter. WireGuard ist für unterschiedlichste Plattformen verfügbar. Im Gegensatz zu den anderen Lösungen basiert es nicht auf der Client-Server-Architektur, sondern auf der Peer-to-Peer-Architektur.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Da es sich hierbei noch um ein sehr junges Projekt handelt, sind die Pakete leider noch nicht in den offiziellen Paketquellen enthalten und müssen als Fremdquelle hinzugefügt werden. Dies sollte sich aber mit der nächsten LTS-Version von Ubuntu ändern.</p><p>Adresszeile zum <a class="internal" href="./paketquellen_freischalten/ppa.html#PPA-hinzufuegen">Hinzufügen</a> des PPAs:
</p><ul><li><p><strong>ppa:wireguard/wireguard</strong> </p></li></ul><div class="box warning"><h3 class="box warning">Hinweis!</h3><div class="contents"><p>
Zusätzliche <a class="internal" href="./fremdquellen.html">Fremdquellen</a> können das System gefährden. 
</p><hr/><p>Ein PPA unterstützt nicht zwangsläufig alle Ubuntu-Versionen. Weitere Informationen sind der <img alt="Wiki/Vorlagen/PPA/ppa.png" class="image-default" src="./_/237f3a0f00c3091056c1a912d81e924e8391ed6b.png"/> <a class="external" href="https://launchpad.net/~wireguard/+archive/wireguard" rel="nofollow">PPA-Beschreibung</a> des Eigentümers/Teams <a class="interwiki interwiki-lpuser" href="https://launchpad.net/~wireguard">wireguard</a> zu entnehmen.
</p></div></div><p>
Damit Pakete aus dem PPA genutzt werden können, müssen die Paketquellen <a class="internal" href="./paketquellen_freischalten.html">neu eingelesen</a> werden.</p><p>Nach dem Aktualisieren der Paketquellen kann folgendes Paket installiert werden <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>wireguard-dkms</strong> (<em>ppa</em> <sup><a href="#source-2">[2]</a></sup>)</p></li><li><p><strong>wireguard-tools</strong> (<em>ppa</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install wireguard-dkms wireguard-tools </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install wireguard-dkms wireguard-tools </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
<img alt="Netzwerkübersicht-WireGuard.png" class="image-default" src="./_/47c6ef9a7d162a187df7a8e46589feeb1f3eba6b.png"/></p><div class="section_2"><h3 id="Vorbereitung">Vorbereitung<a class="headerlink" href="#Vorbereitung">¶</a></h3><p>
Wenn keiner der beiden Clients eine feste globale IP Adresse hat, sollte man diese zuerst konfigurieren. Hierbei hilft das erstellen einer Domain, welche mit der neuesten dynamischen Adresse verbunden ist. Erklärt wird dies in diesem Artikel <a class="internal" href="./ddns-clients.html">DDNS-Clients</a></p></div><div class="section_2"><h3 id="Einmalige-Konfiguration">Einmalige Konfiguration<a class="headerlink" href="#Einmalige-Konfiguration">¶</a></h3><p>
</p><div class="section_3"><h4 id="Client-1">Client 1<a class="headerlink" href="#Client-1">¶</a></h4><p>
Als erstes sollte man die erforderlichen Schlüssel im Verzeichnis <strong>/etc/wireguard</strong> generieren. <sup><a href="#source-3">[3]</a></sup><sup><a href="#source-6">[6]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">cd /etc/wireguard
sudo wg genkey &gt; private.key
sudo wg pubkey &gt; public.key &lt; private.key
sudo wg genpsk &gt; psk.key </pre></div></div><p>Nun erstellt man die Schnittstelle mit einer Adresse, einem Namen und weist ihr einen Private Key zu.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ip link add wg0 type wireguard
sudo ip addr add 192.168.3.1/24 dev wg0
sudo wg set wg0 private-key ./private </pre></div></div><p>Dann kann man die Schittstelle starten.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ip link set wg0 up </pre></div></div><p>Zur Überprüfung sollte man nun dieses Kommando ausführen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo wg </pre></div></div><p>Hierbei sollte jetzt eine Ausgabe erscheinen, in der man sich den "Listen Port" merken sollte. Als letztes muss man dann noch Client 2 dem Client 1 bekannt machen. Sodass er sich mit diesem verbinden <strong>könnte</strong>.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo wg set wg0 peer "Public Key von Client 2" preshared-key "Preshared Key von Client 1 und 2" allowed-ips 192.168.3.2/32 endpoint beispiel2.domain.de:port </pre></div></div></div><div class="section_3"><h4 id="Client-2">Client 2<a class="headerlink" href="#Client-2">¶</a></h4><p>
Das gleiche sollte man nun auch bei Client 2 tun. Der "Preshared Key" muss nicht mehr neu erstellt werden, da er auf beiden Clients identisch sein <strong>muss</strong>. Deswegen sollte man ihn übertragen.</p><div class="bash"><div class="contents"><pre class="notranslate">cd /etc/wireguard
sudo wg genkey &gt; private.key
sudo wg pubkey &gt; public.key &lt; private.key </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ip link add wg0 type wireguard
sudo ip addr add 192.168.3.2/24 dev wg0
sudo wg set wg0 private-key ./private
sudo ip link set wg0 up </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo wg </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo wg set wg0 peer "Public Key von Client 1" preshared-key "Preshared Key von Client 1 und 2" allowed-ips 192.168.3.1/32 endpoint beispiel1.domain.de:port </pre></div></div></div></div><div class="section_2"><h3 id="Statische-Konfiguration">Statische Konfiguration<a class="headerlink" href="#Statische-Konfiguration">¶</a></h3><p>
Damit es nicht nur bei einer einmaligen Konfiguration, welche beim Neustart verloren geht, bleibt. Müssen bei jedem Client die Datei <strong>/etc/wireguard/wg0</strong> erstellt werden und die Datei <strong>/etc/network/interfaces</strong> editiert werden.</p><div class="section_3"><h4 id="Client-1-2">Client 1<a class="headerlink" href="#Client-1-2">¶</a></h4><p>
Dies muss in die Datei <strong>/etc/network/interfaces</strong> hinzugefügt werden. <sup><a href="#source-4">[4]</a></sup>
</p><pre class="notranslate">auto wg0
iface wg0 inet manual
        pre-up ip link add wg0 type wireguard
        pre-up ip addr add 192.168.3.1/24 dev wg0
        pre-up wg setconf wg0 /etc/wireguard/wg0.conf
        up ip link set wg0 up
        down ip link delete wg0</pre><p>Nun muss diese Datei <strong>/etc/wireguard/wg0.conf</strong> erstellt werden.
</p><pre class="notranslate">[Interface]
PrivateKey = Privat Key von Client 1 
ListenPort = 50002

[Peer]
PublicKey = Public Key von Client 2
PresharedKey = Preshared Key von Client 1 und 2
Endpoint = beispiel2.domain.de:50002
AllowedIPs = 192.168.3.2/32</pre><p>Weil in dieser Datei <code class="notranslate">sicherheitskritische Schlüssel</code> enthalten sind, sollte man auf jeden Fall die Rechte für die Datei einschränken. <sup><a href="#source-5">[5]</a></sup></p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod 0600 /etc/wireguard/wg0 </pre></div></div></div><div class="section_3"><h4 id="Client-2-2">Client 2<a class="headerlink" href="#Client-2-2">¶</a></h4><p>
Auch hier müssen diese Zeilen in die Datei <strong>/etc/network/interfaces</strong> hinzugefügt werden.</p><pre class="notranslate">auto wg0
iface wg0 inet manual
        pre-up ip link add wg0 type wireguard
        pre-up ip addr add 192.168.3.2/24 dev wg0
        pre-up wg setconf wg0 /etc/wireguard/wg0.conf
        up ip link set wg0 up
        down ip link delete wg0</pre><p>Und diese Datei <strong>/etc/wireguard/wg0.conf</strong> mit diesen Zeilen erstellt werden.</p><pre class="notranslate">[Interface]
PrivateKey = Privat Key von Client 2 
ListenPort = 50002

[Peer]
PublicKey = Public Key von Client 1
PresharedKey = Preshared Key von Client 1 und 2
Endpoint = beispiel1.domain.de:50002
AllowedIPs = 192.168.3.1/32, 192.168.1.0/24</pre><p>Auch die Rechte für diese Datei sollte man auf jeden Fall einschränken.</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod 0600 /etc/wireguard/wg0 </pre></div></div></div><div class="section_3"><h4 id="Client-3-und-mehr">Client 3 und mehr<a class="headerlink" href="#Client-3-und-mehr">¶</a></h4><p>
Um noch mehr Clients hinzuzufügen muss die Grundkonfiguration wie zuvor erklärt, eingefügt und abgeändert werden.</p><p>Und bei dem Clienten (1 oder 2), mit dem man sich verbinden will, muss man in der <strong>/etc/wireguard/wg0</strong> nur den Abschnitt <code class="notranslate">[Peer]</code> vervielfältigen.</p></div></div><div class="section_2"><h3 id="LAN-miteinbeziehen">LAN miteinbeziehen<a class="headerlink" href="#LAN-miteinbeziehen">¶</a></h3><p>
Damit der Client auch mit dem Netzwerk hinter dem anderen Client kommunizieren können, muss man bei allen Clients in der Datei <strong>/etc/network/interfaces</strong> Routen erstellt werden und bei allen Clients in der Datei <strong>/etc/wireguard/wg0.conf</strong> den Adressbereich des anderen Netzes hinzufügen.</p><div class="section_3"><h4 id="Client-1-3">Client 1<a class="headerlink" href="#Client-1-3">¶</a></h4><p>
In der Datei <strong>/etc/network/interfaces</strong> muss nur eine einzige Zeile hinzugefügt werden. <sup><a href="#source-7">[7]</a></sup>
</p><pre class="notranslate">auto wg0
iface wg0 inet manual
        pre-up ip link add wg0 type wireguard
        pre-up ip addr add 192.168.3.1/24 dev wg0
        pre-up wg setconf wg0 /etc/wireguard/wg0.conf
        up ip link set wg0 up
        post-up ip route add 192.168.2.0/24 via 192.168.3.1 dev wg0 #Diese Zeile muss hinzugefügt werden
        down ip link delete wg0</pre><p>Und auch in dieser Datei <strong>/etc/wireguard/wg0.conf</strong> muss nur eine Zeile eingefügt werden.</p><pre class="notranslate">[Interface]
PrivateKey = Privat Key von Client 1 
ListenPort = 50002

[Peer]
PublicKey = Public Key von Client 2
PresharedKey = Preshared Key von Client 1 und 2
Endpoint = beispiel2.domain.de:50002
AllowedIPs = 192.168.3.2/32, 192.168.2.0/24 #Hier muss der Adressbereich des anderen Netzes hinzugefügt werden</pre></div><div class="section_3"><h4 id="Client-2-3">Client 2<a class="headerlink" href="#Client-2-3">¶</a></h4><p>
Das selbe auch beim zweiten Client. In der Datei <strong>/etc/network/interfaces</strong> fügt man wieder dies ein:
</p><pre class="notranslate">auto wg0
iface wg0 inet manual
        pre-up ip link add wg0 type wireguard
        pre-up ip addr add 192.168.3.2/24 dev wg0
        pre-up wg setconf wg0 /etc/wireguard/wg0.conf
        up ip link set wg0 up
        post-up ip route add 192.168.1.0/24 via 192.168.3.2 dev wg0 #Diese Zeile muss auch hier hinzugefügt werden
        down ip link delete wg0</pre><p>Und in diese Datei <strong>/etc/wireguard/wg0.conf</strong> das:
</p><pre class="notranslate">[Interface]
PrivateKey = Privat Key von Client 2 
ListenPort = 50002

[Peer]
PublicKey = Public Key von Client 1
PresharedKey = Preshared Key von Client 1 und 2
Endpoint = beispiel1.domain.de:50002
AllowedIPs = 192.168.3.1/32, 192.168.1.0/24 #Hier muss wieder der Adressbereich des anderen Netzes hinzugefügt werden</pre><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Es darf kein Adressbereich in der Datei <strong>/etc/wireguard/wg0</strong> zweimal vorhanden sein, ansonsten wird bloß das erste Vorkommen beachtet und alle anderen nicht.
</p></div></div></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Kein-Verbindung-moeglich">Kein Verbindung möglich<a class="headerlink" href="#Kein-Verbindung-moeglich">¶</a></h3><p>
Wenn keine Verbindung zwischen beiden Clients zustande kommt, sollte man sowohl die Firewall als auch die Portweiterleitung überprüfen.</p></div><div class="section_2"><h3 id="Probleme-mit-der-dynamischen-IP">Probleme mit der dynamischen IP<a class="headerlink" href="#Probleme-mit-der-dynamischen-IP">¶</a></h3><p>
auch wenn die Domainauflösung dynamischer IP Adressen unterstützt wird, passiert dies nur beim Start der Schnittstelle. Wenn sich in der Laufzeit die IP eines Clienten ändert, hilft nur ein Neustart der Schnittstelle:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ifdown wg0 &amp;&amp; sudo ifup wg0 </pre></div></div><p>Um dieses Problem dauerhaft zu umgehen, hilft im Moment nur ein <a class="internal" href="./cron.html">Cronjob</a> in kombination mit einem Skript für <strong>jeden</strong> Client, welcher sich mit diesem Client verbinden soll.</p><p>Um zu vermeiden, dass die Schnittstelle unnötig oft neu gestartet wird, erstellt man eine Datei mit diesem Inhalt, welches die Domain auflöst und überprüft, ob sich diese geändert hat. Hier sinnbildlich für <strong>Client 1</strong>.</p><pre class="notranslate">#!/bin/bash
file="/tmp/digIP.txt"

digIP=$(dig +short beispiel2.domain.de) # Diese IP muss natürlich angepasst werden
#echo "$digIP"

if [ -e "$file" ]
then
        fileTXT=$(cat "$file")
                if [ "$digIP" != "$fileTXT" ]
                then
                        #echo "Daten sind gleich"
                        /sbin/ifdown wg0
                        /sbin/ifup wg0
                        echo "$digIP" &gt; "$file"
                fi
else
        echo "$digIP" &gt; "$file"
fi</pre><p>Danach sollte man die Datei ausführbar machen:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo chmod +x "Pfad zum Skript" </pre></div></div><p>und in die Crontabelle trägt man zum Beispiel folgendes ein:</p><pre class="notranslate">#sudo crontab -e # Aufruf der Crontabelle für Befehle mit root-Zugriff
*/10 * * * * "Pfad zum Skript" # Führt das Skript alle 10 Minuten aus</pre></div><div class="section_2"><h3 id="Fehler-Netzwerkschnittstelle-nocht-konfiguriert-beim-Befehl-ifdown-wg0">Fehler "Netzwerkschnittstelle nocht konfiguriert" beim Befehl ifdown wg0<a class="headerlink" href="#Fehler-Netzwerkschnittstelle-nocht-konfiguriert-beim-Befehl-ifdown-wg0">¶</a></h3><p>
Wenn dieser Fehler auftritt, hilft das manuelle Löschen der Schnittstelle:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ip link delete wg0 </pre></div></div><p><img alt="wireguard-banner.jpg" class="image-right" src="./_/f7d836192959ff209a2fe4f22bb68576186eed10.png"/>
</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="https://www.wireguard.com/" rel="nofollow">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-youtube" href="https://www.youtube.com/watch?v=eYztYCbV_8U">WireGuard: Next Generation Abuse-Resistant Kernel Network Tunnelby Jason Donenfeld</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-youtube" href="https://www.youtube.com/watch?v=9Rk4doELmwM">Kernel Recipes 2015 - WireGuard: A Kernelspace VPN - by J. A. Donenfeld</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://technofaq.org/posts/2017/10/how-to-setup-wireguard-vpn-on-your-debian-gnulinux-server-with-ipv6-support/" rel="nofollow">Anleitung für WireGuard mit IPv6</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://www.digitalocean.com/community/tutorials/how-to-create-a-point-to-point-vpn-with-wireguard-on-ubuntu-16-04" rel="nofollow">Weitere Anleitung für WireGuard</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./wireguard/a/revision/945247.html">Diese Revision</a> wurde am 4. Dezember 2017 16:43 von <a href="https://ubuntuusers.de/user/march/">march</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./wireguard.html">WireGuard</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>