<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Archiv/Kernel_Socks_Bouncer › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../archiv/kernel_socks_bouncer.html">Kernel Socks Bouncer</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Archiv/Kernel_Socks_Bouncer">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../archiv/kernel_socks_bouncer/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../archiv/kernel_socks_bouncer/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../archiv/kernel_socks_bouncer/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../archiv/kernel_socks_bouncer/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../archiv/kernel_socks_bouncer/a/backlinks.html">Kernel Socks Bouncer</a></h1>
<div id="page"><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><p> </p><div class="box improvable"><h3 class="box improvable">Archivierte Anleitung</h3><div class="contents"><p>
Dieser Artikel wurde archiviert, da er - oder Teile daraus -
nur noch unter einer älteren Ubuntu-Version nutzbar ist. Diese
Anleitung wird vom Wiki-Team weder auf Richtigkeit überprüft
noch anderweitig gepflegt. Zusätzlich wurde der Artikel für
weitere Änderungen gesperrt.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../packprogramme.html">Archive entpacken</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../kernelmodule.html">Umgang mit Kernelmodulen (Treibern)</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Patchen">Patchen
</a></li><li><a class="crosslink" href="#Kompilieren">Kompilieren
</a></li></ol></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Socks-Proxys">Socks-Proxys
</a></li><li><a class="crosslink" href="#Hosts">Hosts
</a></li></ol></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a></li><li><a class="crosslink" href="#Deinstallation">Deinstallation
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Ein <a class="external" href="http://ksb.sourceforge.net/" rel="nofollow">Kernel Socks Bouncer</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist ein simples Kernelmodul, welches alle ausgehenden Internetverbindungen durch einen Socks(4/5)-Proxy oder eine ganze Proxykette umleitet.</p><p>Dabei überschreibt das Modul die <code class="notranslate">unix_stream_connect</code>-Funktion des Kernels mit seiner eigenen und alle Anwendungen die sich normal mit dem Internet verbinden werden erfasst.</p><p>Es gibt theoretische Wege um diesen Kernel Socks Bouncer herum, mit Hilfe von raw-sockets. Doch werden diese von normalen Anwendungen in der Regel nicht verwendet. Wenn man auf Nummer sicher gehen möchte, kann man zusätzlich mit <a class="internal" href="../iptables2.html">iptables2</a> alle Verbindungen die nicht über einen Proxy gehen verbieten.</p><p>Wie jedes Kernel-Modul muss auch ein Kernel-Socks-Bouncer für jede neue Kernel-Version neu kompiliert werden. Dieser Artikel behandelt ausschliesslich ksb26, also einen Kernel Socks Bouncer für Kernel mit einer Version 2.6.X.X.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Da ksb26 nicht in den Paketquellen vorhanden ist, muss man ihn selbst kompilieren. Zuerst muss man jedoch noch diese Pakete installieren <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>linux-source</strong> </p></li><li><p><strong>build-essential</strong> </p></li><li><p><strong>linux-headers-generic</strong> (<code class="notranslate">generic</code> ggf. der Architektur entsprechend ersetzen <sup><a href="#source-5">[5]</a></sup>) </p></li></ul><p>Dann lädt man ksb26 von seiner <a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=129588" rel="nofollow">Sourceforge-Seite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> herunter und entpackt <sup><a href="#source-2">[2]</a></sup> ihn. 
</p><div class="section_2"><h3 id="Patchen">Patchen<a class="headerlink" href="#Patchen">¶</a></h3><p>
</p><div class="section_3"><h4 id="Patch-1">Patch 1<a class="headerlink" href="#Patch-1">¶</a></h4><p>
Da ksb26 für eine ältere Kernel-Version geschrieben wurde als sich in Hardy befindet, muss man den Quellcode zuerst etwas anpassen. Dazu öffnet man die Datei <strong>ksb26.c</strong> im Unterordner <strong>kernel</strong> mit einem Editor <sup><a href="#source-3">[3]</a></sup> und verändert die Zeilen 124/125: 
</p><pre class="notranslate">if(unregister_chrdev(ksb26_major, KSB26_DEV_NAME) &lt; 0)
       printk("[%s] Cannot unregister device %s.\n", MODNAME, KSB26_DEV_NAME);</pre><p>
indem man sie einfach entfernt und an deren Stelle diese Zeile einfügt: 
</p><pre class="notranslate">unregister_chrdev(ksb26_major, KSB26_DEV_NAME);</pre><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>
Grund für diesen Patch ist, dass in neueren Kerneln die in <strong>linux/fs.h</strong> befindliche Funktion <em>unregister_chrdev</em> vom Typ <em>void</em> ist, also keinen Rückgabewert mehr liefert, welcher in einer if-Abfrage abgefragt werden kann.</p></div></div></div><div class="section_3"><h4 id="Patch-2">Patch 2<a class="headerlink" href="#Patch-2">¶</a></h4><p>
Nun muss man noch im Stammverzeichnis des entpackten Archives die Datei <strong>install.sh</strong> mit einem Editor <sup><a href="#source-3">[3]</a></sup> öffnen und ersetzt die Zeile 90: 
</p><pre class="notranslate">cp ksb26.8.gz /usr/man/man8/</pre><p>
durch diese Zeilen: 
</p><pre class="notranslate">mkdir -p /usr/local/share/man/man8/
cp ksb26.8.gz /usr/local/share/man/man8/</pre></div></div><div class="section_2"><h3 id="Kompilieren">Kompilieren<a class="headerlink" href="#Kompilieren">¶</a></h3><p>
Nun kann man im entpackten Verzeichnis durch Ausführen des Installations-Skriptes das Kernelmodul und den Userland-Manager kompilieren und installieren. Um das Skript auszuführen muss man im Terminal <sup><a href="#source-4">[4]</a></sup> einfach nur den Befehl: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ./install.sh </pre></div></div><p>
eingeben. 
</p></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
Bevor man ksb26 benutzen kann, muss man es erstmal konfigurieren. Dazu muss man zunächst die beiden Dateien <strong>/etc/ksb26/socks</strong> und <strong>/etc/ksb26/thosts</strong> erstellen. Dies geht im Terminal <sup><a href="#source-4">[4]</a></sup> mit diesem Befehl: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo touch /etc/ksb26/socks /etc/ksb26/thosts </pre></div></div><div class="section_2"><h3 id="Socks-Proxys">Socks-Proxys<a class="headerlink" href="#Socks-Proxys">¶</a></h3><p>
In der Datei <strong>/etc/ksb26/socks</strong> legt man nun die Socks-Proxys fest, welche man benutzen möchte. Pro Proxy benutzt man dazu eine extra Zeile, deren Syntax allgemein so aussieht: 
</p><pre class="notranslate">#Ssocks_IP:socks_port;socks_version|</pre><p>
<code class="notranslate">socks_IP</code> und <code class="notranslate">socks_port</code> dürften selbst erklärend sein. <code class="notranslate">socks_version</code> ist entweder <code class="notranslate">4</code> oder <code class="notranslate">5</code>. Will man zum Beispiel nur einen Socks-Proxy auf dem Server 198.0.13.1 und Port 9050 als einzigen Proxy benutzen sieht die Datei so aus: 
</p><pre class="notranslate">#S198.0.13.1:9050;5|</pre><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Wenn man einen Proxy auf dem Localhost benutzt, kann es zu einer Endlosschleife kommen.</p><p>Das passiert, wenn man einstellt, dass sämtlicher Traffik zu allen Zielhosts durch den Proxy gebounced werden sollen. Dann wird auch der Traffik, der durch den Proxy versendet wird, wieder zurück zum Proxy geschickt und dann nochmal und nochmal und ...</p><p>Es empfiehlt sich also den Proxy nicht auf dem selben Rechner laufen zu lassen, auf dem man den Kernel-Socks-Bouncer verwendet. Ausser man weiss, dass die Daten die den Proxy verlassen nicht zu einem Zielhost führen, welcher vom KSB erfasst wird.</p></div></div></div><div class="section_2"><h3 id="Hosts">Hosts<a class="headerlink" href="#Hosts">¶</a></h3><p>
In der Datei <strong>/etc/ksb26/socks</strong> legt man nun fest, welche Verbindungen zu welcher IP und zu welchem Port letztendlich durch den Kernel Socks Bouncer umgebogen werden sollen. Die Syntax einer Zeile in dieser Datei sieht allgemein so aus: 
</p><pre class="notranslate">#Hhost_ip:host_port;|</pre><p>
<code class="notranslate">host_ip</code> und <code class="notranslate">host_port</code> dürften wieder selbst erklärend sein. Als Hinweis sei noch erwähnt, dass als <code class="notranslate">host_ip</code> ein Stern <code class="notranslate">*</code> als Wildcard verwendet werden kann und jede IP erfasst und als <code class="notranslate">host_port</code> eine Null <code class="notranslate">0</code> als Wildcard verwendet werden kann und jeden Port erfasst.</p><p>Will man also, dass sämtliche Verbindungen zu allen Servern und auf allen Ports durch den Kernel Socks Bouncer umgebogen werden sollen, sieht die Datei so aus: 
</p><pre class="notranslate">#H*:0;|</pre></div></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
Letztendlich kann man den Kernel Socks Bouncer nun durch den Befehl: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo ksb26manager </pre></div></div><p>
aktivieren.</p><p>Um ihn wieder zu deaktivieren muss man das Kernelmodul <sup><a href="#source-5">[5]</a></sup> wieder entladen. Dies geht im Terminal <sup><a href="#source-4">[4]</a></sup> mit dem Befehl: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe -r ksb26 </pre></div></div></div><div class="section_1"><h2 id="Deinstallation">Deinstallation<a class="headerlink" href="#Deinstallation">¶</a></h2><p>
Der Kernel Socks Bouncer besitzt leider keine Deinstallationsroutine, weswegen man die einzelnen Bestandteile von Hand deinstallieren muss. Dies geht im Terminal <sup><a href="#source-4">[4]</a></sup> mit den folgenden Befehlen: 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo rm -r /etc/ksb26
sudo rm /usr/bin/ksb26manager
sudo rm /usr/man/man8/ksb26.8.gz
sudo rm /lib/modules/`uname -r`/extra/ksb26.ko </pre></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://ksb.sourceforge.net/" rel="nofollow">offizielle Webseite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> </p></li><li><p><a class="crosslink" href="http://wiki.ubuntuusers.de/Sicherheit#Anonymitaet">Artikel über Anonymität im Ubuntuusers-Wiki</a> </p></li><li><p><a class="external" href="http://de.wikipedia.org/wiki/Proxy_%28Rechnernetz%29" rel="nofollow">Proxy bei Wikipedia</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> </p></li></ul><p></p></div></div>
<p class="meta">
<a href="../archiv/kernel_socks_bouncer/a/revision/662822.html">Diese Revision</a> wurde am 2. Dezember 2013 16:59 von <a href="https://ubuntuusers.de/user/frustschieber/">frustschieber</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../archiv.html">Archiv</a></li>
<li><a href="../archiv/kernel_socks_bouncer.html">Kernel Socks Bouncer</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>