<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Archiv/Accelerometer › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../archiv/accelerometer.html">Accelerometer</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Archiv/Accelerometer">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../archiv/accelerometer/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../archiv/accelerometer/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../archiv/accelerometer/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../archiv/accelerometer/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../archiv/accelerometer/a/backlinks.html">Accelerometer</a></h1>
<div id="page"><div class="box improvable"><h3 class="box improvable">Archivierte Anleitung</h3><div class="contents"><p>
Dieser Artikel wurde archiviert, da er - oder Teile daraus -
nur noch unter einer älteren Ubuntu-Version nutzbar ist. Diese
Anleitung wird vom Wiki-Team weder auf Richtigkeit überprüft
noch anderweitig gepflegt. Zusätzlich wurde der Artikel für
weitere Änderungen gesperrt.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Paketen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../terminal.html">Einen Terminal öffnen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Apples-Beschleunigungssensor">Apples Beschleunigungssensor
</a><ol class="arabic"><li><a class="crosslink" href="#Beschleunigungssensor-abfragen">Beschleunigungssensor abfragen
</a></li><li><a class="crosslink" href="#Einsatz-als-Wasserwaage-oder-Murmelspiel">Einsatz als Wasserwaage oder Murmelspiel...</a></li><li><a class="crosslink" href="#Ausblick">Ausblick
</a></li></ol></li></ol></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li></ol></div></div><div class="section_1"><h2 id="Apples-Beschleunigungssensor">Apples Beschleunigungssensor<a class="headerlink" href="#Apples-Beschleunigungssensor">¶</a></h2><p>
Viele moderne Notebooks enthalten Beschleunigungssensoren. Sie registrieren sowohl die Richtung der Gravitationskraft, also die Lage des Rechners, als auch abrupte Bewegungen. Allerdings registrieren sie nicht die Geschwindigkeit einer gleichförmigen Bewegung. Bei Apple heißen sie <strong>Sudden Motion Sensor</strong>, bei IBM/Lenovo <a class="internal" href="../festplattenschutz.html">HDAPS</a>.</p><div class="section_2"><h3 id="Beschleunigungssensor-abfragen">Beschleunigungssensor abfragen<a class="headerlink" href="#Beschleunigungssensor-abfragen">¶</a></h3><p>
Das Accelerometer von Apple MacBooks lässt sich unter dem Pfad <strong>/sys/devices/platform/applesmc.768/position</strong> abfragen. Getestet wurde dies mit einem MacBook Pro 4.1 unter <a class="internal" href="../natty.html">Ubuntu 11.04</a>.</p><div class="bash"><div class="contents"><pre class="notranslate">cat /sys/devices/platform/applesmc.768/position </pre></div></div><p>Ergebnis z.B.</p><pre class="notranslate">(2,-1,268)</pre><p>Die drei Sensoren mit den Bezeichnungen X,Y,Z liefern ganze Zahlen im Bereich von etwa +/- 1000.</p><table><tr class="titel"><td colspan="4"> Funktion der einzelnen Sensoren </td></tr><tr class="kopf"><td> </td><td> X </td><td> Y </td><td> Z </td></tr><tr><td> bei waagerecht stehendem Rechner </td><td> 0 </td><td> 0 </td><td> 255 </td></tr><tr><td> Neigung zum User (Scharnier hoch) </td><td> </td><td> größer </td><td> kleiner </td></tr><tr><td> Neigung vom User weg (Touchpad hoch) </td><td> </td><td> kleiner </td><td> kleiner </td></tr><tr><td> Neigung links hoch </td><td> kleiner </td><td> </td><td> kleiner </td></tr><tr><td> Neigung rechts hoch </td><td> größer </td><td> </td><td> kleiner </td></tr><tr><td> Beschleunigung rauf </td><td> </td><td> </td><td> größer </td></tr><tr><td> Beschleunigung runter </td><td> </td><td> </td><td> kleiner </td></tr><tr><td> Beschleunigung nach links </td><td> kleiner </td><td> </td><td> </td></tr><tr><td> Beschleunigung nach rechts </td><td> größer </td><td> </td><td> </td></tr><tr><td> Beschleunigung nach hinten </td><td> </td><td> größer </td><td> </td></tr><tr><td> Beschleunigung nach vorne (zum User) </td><td> </td><td> kleiner </td><td> </td></tr><tr><td> Drehung um senkrechte Achse </td><td> </td><td> </td><td> </td></tr></table><p>
Der X-Sensor misst die Beschleunigung zu den Seiten. Steht das Notebook senkrecht auf der linken Seite, ist X=255, auf der rechten gilt X=-255. Dieser Sensor registriert seitliche Schläge und ist der richtige für die Simulation eines Lenkrades.</p><p>Der Y-Sensor verläuft von vorne nach hinten. Mit Displayscharnier oben gilt Y=255, mit Touchpad oben ist Y=-255.</p><p>Der Z-Sensor misst die Beschleunigung zum Boden des Notebooks. Die reine Gravitation bringt einen Wert von 255. Steht das Notebook senkrecht, egal auf welcher Seite, ist Z=0. Mit Tastatur nach unten ist Z=255.</p><p>Der Öffnungswinkel des Displays spielt bei diesen Sensoren gar keine Rolle und lässt sich auch nicht anderweitig durch Software ermitteln.</p></div><div class="section_2"><h3 id="Einsatz-als-Wasserwaage-oder-Murmelspiel">Einsatz als Wasserwaage oder Murmelspiel<a class="headerlink" href="#Einsatz-als-Wasserwaage-oder-Murmelspiel">¶</a></h3><p>
In einer beispielhaften Anwendung soll der Sensor als eine hochsensible elektronische Wasserwaage verwendet werden.</p><p>Dazu wird als extrem schlanker Webserver NetCat aus dem Paket <strong>netcat-traditional</strong> benötigt.</p><ul><li><p><strong>netcat-traditional</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install netcat-traditional </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install netcat-traditional </pre></div></div><p>
</p></div></div><p>Danach wird er im Terminal<sup><a href="#source-2">[2]</a></sup> gestartet:</p><div class="bash"><div class="contents"><pre class="notranslate">while true; do ( echo "HTTP/1.0 200 Ok"; echo; sed  's/(/X([/g;s/)/])/g' /sys/devices/platform/applesmc.768/position; ) | nc.traditional -q 0 -l -p 8090 &gt; /dev/null ; done </pre></div></div><p>Netcat lauscht auf Port 8090. Jede Anfrage auf der Adresse <code class="notranslate">http://localhost:8090/</code> beantwortet er mit einem HTTP-Dokument mit den aktuellen Koordinaten. Dafür schickt netcat erst den HTTP-Header und dann die Daten des Sensors im Format <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/JavaScript_Object_Notation#JSONP_.28JSON_mit_Padding.29">JsonP</a>. Es handelt sich um ein JavaScript-Dokument mit einem Objekt <em>X</em>, das von einem Browser per SCRIPT-Element eingebunden werden kann. Die Endlosschleife <code class="notranslate">while-do-done</code> startet den Server nach jeder Anfrage neu. Das Ergebnis lässt sich im Browser betrachten:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="nx">X</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">259</span><span class="p">])</span>
</pre></div>
</td></tr></table></div><p>Die Webseite mit dem unten angegebenen Quellcode fragt über netcat regelmäßig den Sensor ab. Die JavaScript-Bibliothek JQuery wird automatisch von Googles Servern nachgeladen. Wer möchte, kann sich die Datei auch lokal herunterladen und die Referenz im SCRIPT-Element anpassen. Der Code in JQuery sorgt für die ständig aktualisierte Anzeige der Daten im Browser. Das DIV-Element bewegt sich nicht wie die Luftblase einer Wasserwaage, sondern wie eine Murmel auf einem Brett. Sie wandert also bei schräger Lage immer weiter und macht auch minimale Neigungen sichtbar.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="cp">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"&gt;</span>

<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="c">&lt;!-- Include JQuery --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
	<span class="kd">function</span> <span class="nx">iteration</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Daten anzeigen</span>
		<span class="c1">// Hole Sensordaten. Die Zufallszahl verhindert Caching.</span>
		<span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s1">'http://localhost:8090/?id='</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">+</span><span class="s1">'json=?'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// Zahlen einblenden:</span>
			<span class="nx">$</span><span class="p">(</span><span class="s1">'p#sensorx'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">'X: '</span><span class="o">+</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
			<span class="nx">$</span><span class="p">(</span><span class="s1">'p#sensory'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Y: '</span><span class="o">+</span><span class="nx">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
			<span class="nx">$</span><span class="p">(</span><span class="s1">'p#sensorz'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Z: '</span><span class="o">+</span><span class="nx">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

			<span class="c1">// Murmel positionieren:</span>
			<span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'left'</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">position</span><span class="p">().</span><span class="nx">left</span><span class="o">-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">'px'</span><span class="p">);</span>
			<span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'top'</span><span class="p">,</span><span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">position</span><span class="p">().</span><span class="nx">top</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">'px'</span><span class="p">);</span>
		<span class="p">});</span>
	<span class="p">}</span>
	<span class="nx">$</span><span class="p">().</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="c1">// Callbackmethode auf "X" setzen, weil netcat diese liefert:</span>
		<span class="nx">$</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span> <span class="nx">jsonpCallback</span><span class="o">:</span> <span class="s1">'X'</span> <span class="p">});</span>
		<span class="c1">// 20x pro Sekunde Anzeige aktualisieren:</span>
		<span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="s2">"iteration()"</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
	<span class="c">&lt;!-- Sensordaten --&gt;</span>
	<span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"sensorx"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"sensory"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"sensorz"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
	<span class="c">&lt;!-- Murmel: --&gt;</span>
	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">"position:absolute; left:50%; top:50%; width:10px; height:10px; background-color:black; -moz-border-radius: 5px; border-radius: 5px;"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div><p>
<img alt="accelerometer.png" class="image-right" src="../_/15da384c18745f1c3cbd3cdc70e251c0fcaf6f69.png"/>
Nun ist ersichtlich, ob der Tisch gerade steht. Oben links stehen die Beschleunigungen, die das Accelerometer gemessen hat. X und Y geben die Neigung des Notebooks wieder. Z ist die Beschleunigung nach unten, 255 entspricht der Gravitationskraft. Das Notebook steht also flach auf dem Tisch. Der Punkt wandert nur langsam.</p></div><div class="section_2"><h3 id="Ausblick">Ausblick<a class="headerlink" href="#Ausblick">¶</a></h3><p>
Der Sensor lässt sich auch von anderen Rechnern abfragen. Dann muss die IP-Adresse anstelle von <code class="notranslate">localhost</code> in die URL zum netcat.</p><p>Weiteren Experimenten in JQuery für ein Murmelspiel oder Rennen steht nichts mehr im Wege.</p><p></p></div></div></div>
<p class="meta">
<a href="../archiv/accelerometer/a/revision/641362.html">Diese Revision</a> wurde am 22. September 2013 12:33 von <a href="https://ubuntuusers.de/user/frustschieber/">frustschieber</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../archiv.html">Archiv</a></li>
<li><a href="../archiv/accelerometer.html">Accelerometer</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>