<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Archiv/LDAP_Client_Authentifizierung › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../archiv/ldap_client_authentifizierung.html">LDAP Client Authentifizierung</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Archiv/LDAP_Client_Authentifizierung">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../archiv/ldap_client_authentifizierung/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../archiv/ldap_client_authentifizierung/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../archiv/ldap_client_authentifizierung/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../archiv/ldap_client_authentifizierung/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../archiv/ldap_client_authentifizierung/a/backlinks.html">LDAP Client Authentifizierung</a></h1>
<div id="page"><div class="box improvable"><h3 class="box improvable">Archivierte Anleitung</h3><div class="contents"><p>
Dieser Artikel wurde archiviert, da er - oder Teile daraus -
nur noch unter einer älteren Ubuntu-Version nutzbar ist. Diese
Anleitung wird vom Wiki-Team weder auf Richtigkeit überprüft
noch anderweitig gepflegt. Zusätzlich wurde der Artikel für
weitere Änderungen gesperrt.
</p></div></div><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../editor.html">Einen Editor öffnen</a> </p></li></ol></div></div><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Benutzung-Konfiguration">Benutzung/Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Vorueberlegungen">Vorüberlegungen
</a></li><li><a class="crosslink" href="#Unterschied-zwischen-PAM-LDAP-Modul-und-NSS-Modul">Unterschied zwischen PAM LDAP-Modul und ...</a></li><li><a class="crosslink" href="#PAM-Modul-Konfiguration">PAM - Modul - Konfiguration
</a></li><li><a class="crosslink" href="#NSS-Modul-Konfiguration">NSS - Modul - Konfiguration
</a></li></ol></li><li><a class="crosslink" href="#Dienste-neu-laden">Dienste neu laden
</a></li><li><a class="crosslink" href="#Testen">Testen
</a></li></ol></div><p>In manchen Netzen gibt es einen LDAP-Server, der für die Authentifizierung zuständig ist. LDAP (<em>Lightweight Directory Access Protocol</em>) ist ein Protokoll für einen Verzeichnisdienst (eine Art Adressbuch). Es wird jedoch auch immer beliebter, LDAP für die Benutzerauthentifizierung oder für Konfigurationen von Diensten wie DHCP oder DNS zu benutzen. Wenn ein LDAP-Server im Netz bereits für die Authentifizierung läuft, soll diese Anleitung helfen, eine bestehende Ubuntu-Installation so zu konfigurieren, dass sich am LDAP-Server angemeldet werden kann.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Folgende Pakete müssen installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>libnss-ldap</strong></p></li><li><p><strong>libpam-ldap</strong></p></li><li><p><strong>nscd</strong> (<em>universe</em>)</p></li><li><p><strong>portmap</strong></p></li></ul><p>Die Pakete <strong>nscd</strong> und <strong>portmap</strong> sind Abhängigkeiten, welche unerlässlich sind, um sich an einem LDAP Server zu authentifizieren. Sie benötigen keine weitere Konfiguration.</p></div><div class="section_1"><h2 id="Benutzung-Konfiguration">Benutzung/Konfiguration<a class="headerlink" href="#Benutzung-Konfiguration">¶</a></h2><p>
Bei der Installation der Pakete werden einige Daten wie cn des Administrators der LDAP-Datenbank abgefragt, ebenso wie Hostname/IP des LDAP-Servers. Diese können auch jederzeit nach der Installation verändert werden. Daher ist es am einfachsten, während der Installation die Abfragen einfach mit 
<span class="key">⏎</span>  zu bestätigen.</p><div class="section_2"><h3 id="Vorueberlegungen">Vorüberlegungen<a class="headerlink" href="#Vorueberlegungen">¶</a></h3><p>
Bevor man sich an die Konfiguration macht, sollte man einige Informationen bereits wissen oder in Erfahrung gebracht haben:</p><table><tr><td style="background-color: #DDDDDD"><strong>Ausdruck</strong></td><td style="background-color: #DDDDDD"><strong>Beispielwert</strong></td><td style="background-color: #DDDDDD"><strong>Kommentar</strong></td></tr><tr><td>Host</td><td>ldap.ubuntuusers.de</td><td>Die Host-Adresse vom LDAP Server, die IP (hier 10.0.0.2) statt des Hostnamens beschleunigt die Authentifizierung geringfügig.</td></tr><tr><td>BASEDN</td><td>dc=ubuntuusers,dc=de</td><td>Suchbasis auf dem Server (engl. Base Distinguished Name)</td></tr><tr><td>ROOTBINDDN</td><td>cn=Administrator,dc=ubuntuusers,dc=de</td><td>Der LDAP Server Administrator Account Name</td></tr><tr><td>ldap_version</td><td>3</td><td>Heute meist Version 3, allerdings ist Version 2 des LDAP Protokolls noch vertreten.</td></tr><tr><td>secret</td><td>geheimesPW</td><td>das LDAP - Passwort des LDAP-Administrator-Benutzerkontos (ROOTBINDDN)</td></tr></table><p>
</p></div><div class="section_2"><h3 id="Unterschied-zwischen-PAM-LDAP-Modul-und-NSS-Modul">Unterschied zwischen PAM LDAP-Modul und NSS-Modul<a class="headerlink" href="#Unterschied-zwischen-PAM-LDAP-Modul-und-NSS-Modul">¶</a></h3><p>
Es gibt grundsätzlich zwei Möglichkeiten, über die PAM das LDAP zu benutzen. Als erste Möglichkeit kann man das "pam_ldap"-Modul aus dem "libpam-ldap"-Paket nutzen. Bei dieser Methode versucht sich der Client bei der Passwort-Überprüfung auf dem LDAP-Server anzumelden. Bei der zweiten Möglichkeit werden die Passwort-"Hashes" vom LDAP-Server zum Client mit Hilfe von NSS exportiert. Bei dieser Methode wird dann das traditionelle "pam_unix"-Modul zur Authentifikation genutzt. Beide Methoden haben Vor- und Nachteile, "pam_ldap" würde beispielsweise das Ändern des Passworts vom Client aus ermöglichen.</p></div><div class="section_2"><h3 id="PAM-Modul-Konfiguration">PAM - Modul - Konfiguration<a class="headerlink" href="#PAM-Modul-Konfiguration">¶</a></h3><p>
<strong>PAM</strong> (<em>Pluggable Authentication Modules [for Linux]</em>) ist eine praktische Sammlung von Modulen, die die Authentifizierung für Benutzer, aber auch Maschinen oder Dienste übernehmen. Folgend werden einige Module dahingehend verändert, damit eine erfolgreiche Benutzerauthentifizierung mittels LDAP möglich und effizient wird. Wenn ein Verzeichnis (<strong>/etc/pam.d/</strong>) existiert, ist in der Regel <strong>/etc/pam.conf</strong> leer, da alles modular konfiguriert wird, um individuell auf Wünsche der Authentifizierung eingehen zu können. Damit die Authentifizierung funktioniert, müssen die bestehenden Einträge in <strong>/etc/pam.d/common-*</strong> auskommentiert und folgende hinzugefügt werden:</p><div class="section_3"><h4 id="etc-pam-d-common-auth">/etc/pam.d/common-auth<a class="headerlink" href="#etc-pam-d-common-auth">¶</a></h4><p>
</p><pre class="notranslate">auth    sufficient      pam_ldap.so
auth    required        pam_unix.so use_first_pass nullok_secure</pre><p>
<strong>auth</strong> ist für die Sicherheit zuständig, d.h. ob der Benutzer, der er vorgibt zu sein, auch wirklich dieser ist und somit ein Passwort verlangt.</p></div><div class="section_3"><h4 id="etc-pam-d-common-account">/etc/pam.d/common-account<a class="headerlink" href="#etc-pam-d-common-account">¶</a></h4><p>
</p><pre class="notranslate">account sufficient      pam_ldap.so
account required        pam_unix.so use_first_pass
# account [default=bad success=ok user_unknown=ignore] pam_ldap.so | Diese Eintrag sollte genommen werden falls man in der /etc/ldap.conf mit den Optionen pam_groupdn und pam_member_attribute arbeitet, da sonst diese Optionen nicht greifen.</pre><p>
<strong>account</strong> prüft die Berechtigung, ob ein Benutzer den Dienst verwenden darf oder ob vielleicht sein Passwort abgelaufen ist.</p></div><div class="section_3"><h4 id="etc-pam-d-common-password">/etc/pam.d/common-password<a class="headerlink" href="#etc-pam-d-common-password">¶</a></h4><p>
</p><pre class="notranslate">password   sufficient pam_ldap.so
password   required   pam_unix.so use_first_pass nullok obscure min=4 max=8 md5</pre><p>
<strong>password</strong> spezifiziert, wie ein Passwort gewechselt wird und wie dieses zusammengesetzt werden muss.</p></div><div class="section_3"><h4 id="etc-pam-d-common-session">/etc/pam.d/common-session<a class="headerlink" href="#etc-pam-d-common-session">¶</a></h4><p>
</p><pre class="notranslate">session required        pam_unix.so
session optional        pam_foreground.so</pre><p>
<strong>session</strong> übernimmt alle wichtigen Prioritätsaufgaben und regelt die Prozesse wie das Zur-Verfügung-Stellen des Heimatverzeichnisses ("home").</p></div><div class="section_3"><h4 id="etc-ldap-ldap-conf">/etc/ldap/ldap.conf<a class="headerlink" href="#etc-ldap-ldap-conf">¶</a></h4><p>
</p><pre class="notranslate">HOST    10.0.0.2 # IP des LDAP Servers
BASE    dc=ubuntuusers,dc=de # BASE DN</pre><p>
In der <strong>ldap.conf</strong> sind die wichtigsten LDAP-Angaben untergebracht, die weit ins Detail verfeinert werden können. Zunächst reicht es jedoch wenn, dort die Adresse des LDAP-Servers und die Suchbasis, in der man sich authentifizieren will, angegeben wird. Durch das Konfigurationsscript wird die URI des LDAP-Servers verlangt. Die Vorgabe in dieser Zeile lautet <strong>ldapi:///</strong>, anschließend wird die IP-Adresse (IP:Port) des LDAP-Servers verlangt, dabei muss <strong>ldapi:///</strong> auf <strong>ldap://</strong> geändert werden.</p><div class="section_4"><h5 id="Ubuntu-8-04">Ubuntu 8.04<a class="headerlink" href="#Ubuntu-8-04">¶</a></h5><p>
Hier werden die Angaben, die bei der Installation gemacht werden, in die Datei <strong>/etc/ldap.conf</strong> geschrieben. Diese Datei kann auch problemlos weiter genutzt werden, sie bietet im Gegensatz zur <strong>/etc/ldap/ldap.conf</strong> mehr voreingestellte Optionen, die bei Bedarf einfach einkommentiert werden können. Die <strong>/etc/ldap/ldap.conf</strong> kann somit unberührt bleiben. Vor einem Neustart des Systems sollte aber auch hier die <strong>bind_policy</strong> auf <strong>soft</strong> gesetzt werden, da das System sonst nicht weiter bootet, wenn es den LDAP-Server nicht finden kann.</p></div></div><div class="section_3"><h4 id="etc-pam-ldap-conf">/etc/pam_ldap.conf<a class="headerlink" href="#etc-pam-ldap-conf">¶</a></h4><p>
</p><pre class="notranslate">host 10.0.0.2
base dc=ubuntuusers,dc=de
rootbinddn cn=Administrator,dc=ubuntuusers,dc=de # der Adminaccountname des LDAP Servers</pre><p>
Damit auch das LDAP-PAM-Modul weiß, wo es sich verbinden muss, werden hier ebenfalls Host, Suchbasis und Administratorkonto angegeben.</p></div><div class="section_3"><h4 id="etc-pam-ldap-secret">/etc/pam_ldap.secret<a class="headerlink" href="#etc-pam-ldap-secret">¶</a></h4><p>
</p><pre class="notranslate">geheimesPW</pre><p>
Das Passwort des in <strong>rootbinddn</strong> angegebenen Administrators. Diese Datei sollte nicht für jeden lesbar sein!</p></div></div><div class="section_2"><h3 id="NSS-Modul-Konfiguration">NSS - Modul - Konfiguration<a class="headerlink" href="#NSS-Modul-Konfiguration">¶</a></h3><p>
<strong>NSS</strong> (<em>System Databases and Name Service Switch configuration</em>) gibt im System an, wo sich welche Datenbanken (Aliase, Benutzer, Gruppen, Netzwerke...etc.) befinden und in welcher Reihenfolge sie abgefragt oder genutzt werden sollen. So kann man für <em>jede</em> Datenbank <em>individuell</em> angeben, wie der <em>LookUp</em>-Prozess funktionieren soll. (<strong>/etc/nsswitch.conf</strong>)</p><div class="section_3"><h4 id="etc-libnss-ldap-conf">/etc/libnss-ldap.conf<a class="headerlink" href="#etc-libnss-ldap-conf">¶</a></h4><p>
</p><pre class="notranslate">host 10.0.0.2
base dc=ubuntuusers,dc=de
ldap_version 3</pre><p>
Auch hier werden die Suchbasis und der Host angegeben.</p></div><div class="section_3"><h4 id="etc-libnss-ldap-secret">/etc/libnss-ldap.secret<a class="headerlink" href="#etc-libnss-ldap-secret">¶</a></h4><p>
</p><pre class="notranslate">geheimesPW</pre><p>
Das Passwort sollte auch hier in einer Datei gespeichert sein, die vor fremden Zugriffen geschützt ist!</p></div><div class="section_3"><h4 id="etc-nsswitch-conf">/etc/nsswitch.conf<a class="headerlink" href="#etc-nsswitch-conf">¶</a></h4><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>
Nachdem man die <strong>nsswitch.conf</strong> editiert hat, könnte kein sudo mehr erfolgreich sein, wenn man sich vertan hat oder etwas anderes nicht stimmt, denn dann möchte Ubuntu bereits auf den LDAP-Server zugreifen. Sorgfalt ist also geboten. Wenn man sich trotz aller Vorsicht ausgesperrt, hilft nur noch ein Start im Rettungsmodus oder von einer Live-CD, um den Fehler zu korrigieren oder die alte <strong>nsswitch.conf</strong> wiederherzustellen. Im Artikel <a class="internal" href="../recovery_modus.html">Recovery Modus</a> ist auch ein weiterer Hinweis, wie man an das Root-Filesystem gelangt, um Fehler zu korrigieren oder Einträge rückgängig zu machen.</p></div></div><pre class="notranslate">passwd:         files ldap
group:          files ldap
shadow:         files ldap
hosts:          files dns
networks:       files</pre></div></div></div><div class="section_1"><h2 id="Dienste-neu-laden">Dienste neu laden<a class="headerlink" href="#Dienste-neu-laden">¶</a></h2><p>
Damit der LDAP-Server von den Clients auch benutzt wird, müssen nach den Konfigurationsanpassungen einige Dienste neu gestartet werden:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span>~# /etc/init.d/nscd restart
~# /etc/init.d/portmap restart
~# /etc/init.d/libnss-ldap restart
</pre></div>
</td></tr></table></div><p>
Anschließend wird der LDAP-Server zur Authentifizierung herangezogen.</p></div><div class="section_1"><h2 id="Testen">Testen<a class="headerlink" href="#Testen">¶</a></h2><p>
Jetzt ist es an der Zeit, die Konfiguration zu testen.
</p><div class="bash"><div class="contents"><pre class="notranslate">getent passwd </pre></div></div><p>
Es sollten die Benutzerkonten vom LDAP-Repository angezeigt werden.</p><p>Funktionierts? 
</p><div class="bash"><div class="contents"><pre class="notranslate">su &lt;benutzerID des LDAP-Servers&gt; </pre></div></div><p></p></div></div>
<p class="meta">
<a href="../archiv/ldap_client_authentifizierung/a/revision/655722.html">Diese Revision</a> wurde am 12. November 2013 18:08 von <a href="https://ubuntuusers.de/user/frustschieber/">frustschieber</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../archiv.html">Archiv</a></li>
<li><a href="../archiv/ldap_client_authentifizierung.html">LDAP Client Authentifizierung</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>