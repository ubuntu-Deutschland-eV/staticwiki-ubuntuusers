<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Archiv/CapiSuite › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../archiv/capisuite.html">CapiSuite</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Archiv/CapiSuite">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../archiv/capisuite/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../archiv/capisuite/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../archiv/capisuite/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../archiv/capisuite/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../archiv/capisuite/a/backlinks.html">CapiSuite</a></h1>
<div id="page"><div class="box improvable"><h3 class="box improvable">Archivierte Anleitung</h3><div class="contents"><p>
Dieser Artikel wurde archiviert, da er - oder Teile daraus -
nur noch unter einer älteren Ubuntu-Version nutzbar ist. Diese
Anleitung wird vom Wiki-Team weder auf Richtigkeit überprüft
noch anderweitig gepflegt. Zusätzlich wurde der Artikel für
weitere Änderungen gesperrt.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../pakete_installieren.html">Installation von Programmen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../paketquellen_freischalten.html">Paketquellen freischalten</a> </p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="../isdn-karten.html">ISDN-Karten einrichten</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="../postfix.html">lokalen Mailserver einrichten</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="../editor.html">Eine Textdatei verändern</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Mailserver">Mailserver
</a></li><li><a class="crosslink" href="#CapiSuite">CapiSuite
</a></li></ol></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Anrufbeantworter">Anrufbeantworter
</a></li><li><a class="crosslink" href="#Faxgeraet">Faxgerät
</a></li><li><a class="crosslink" href="#Capisuite-als-Daemon">Capisuite als Daemon
</a></li></ol></li><li><a class="crosslink" href="#Benutzung">Benutzung
</a><ol class="arabic"><li><a class="crosslink" href="#Anrufbeantworter-2">Anrufbeantworter
</a></li><li><a class="crosslink" href="#Faxgeraet-2">Faxgerät
</a></li></ol></li><li><a class="crosslink" href="#Probleme-und-Loesungen">Probleme und Lösungen
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p>Das Programm <a class="external" href="http://www.capisuite.org/" rel="nofollow">CapiSuite</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> bietet eine relativ einfache Methode, einen Linux-Rechner mit einer CAPI-fähigen ISDN-Karte in einen Anrufbeantworter (AB) und/oder ein Faxgerät zu verwandeln. Eingehende Anrufe und Faxe werden gespeichert und als Sound- (<strong>.wav</strong>) bzw. PDF-Dateien per (interner) E-Mail zugestellt. Auch eine Fernabfrage des ABs mit persönlichem PIN-Code ist möglich.</p><p>Für fortgeschrittene Benutzer, die sich in der Programmiersprache <a class="internal" href="../python.html">Python</a> auskennen, bieten die Skripting-Fähigkeiten der CapiSuite noch ganz andere Möglichkeiten: beispielsweise automatische Anrufe bei bestimmten Systemereignissen oder automatisierte Call-In-Systeme. Optional kann noch ein Skript zum sofortigen Ausdrucken eingehender Faxe eingebunden werden.</p><p>Das Programm wird seit mehreren Jahren nicht mehr weiterentwickelt, funktioniert aber weiterhin tadellos. Die entscheidende Hürde ist die Inbetriebnahme der benötigten <a class="internal" href="../isdn-karten.html">ISDN-Karte</a> unter Linux.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Als Allererstes braucht man ein funktionierendes <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Common_ISDN_Application_Programming_Interface">CAPI</a>-System auf dem Rechner. Dafür wird entweder eine aktive ISDN-Karte, die von Haus eine integrierte CAPI besitzt, oder eine passive wie eine FRITZ!Card von AVM benötigt, wobei hier der Kartentreiber für die CAPI-Unterstützung sorgt.</p><p>Wie letztere installiert wird, beschreibt der Artikel <a class="internal missing" href="../isdn-karten/avm_fritz!card_pci.html">AVM_FRITZ!Card_PCI</a> (bis einschließlich <a class="internal" href="../natty.html">Ubuntu 11.04</a>). Das Paket <strong>pppdcapiplugin</strong> braucht man nicht, wenn man nur Fax- und/oder Sprachdienste nutzen will und den <a class="internal" href="../internetzugang.html">Internetzugang</a> über einen Router realisiert hat.</p><div class="section_2"><h3 id="Mailserver">Mailserver<a class="headerlink" href="#Mailserver">¶</a></h3><p>
Dann benötigt man noch einen funktionierenden Mailserver. <a class="internal" href="../postfix.html">Postfix</a> funktioniert z.B. wunderbar. Zum Testen kann man sich anschließend das Paket</p><ul><li><p><strong>mailutils</strong></p></li></ul><p>
installieren <sup><a href="#source-1">[1]</a></sup> und ausprobieren, ob man sich mit</p><div class="bash"><div class="contents"><pre class="notranslate">mail -s Test Email-Adresse </pre></div></div><p>
erfolgreich Mail an die eigene interne Adresse (Benutzername@Rechnername) schicken kann. Der lokale Mail-Server muss unverschlüsselte Verbindungen akzeptieren, deshalb sollte in der Datei <strong>/etc/postfix/main.cf</strong> folgende Zeile enthalten sein:</p><pre class="notranslate">smtpd_tls_security_level = may</pre><p>Falls an eine externe Mailadresse versendet werden sollen, muss die Adresse des Absenders (username@example.com) mit einer gültigen Domain versehen sein. Andernfalls ist eine Fehlermeldung des Providers vorprogrammiert und die Mail kann nicht verschickt werden. Dies kann sowohl in den globalen als auch in den benutzerspezifischen Abschnitten erfolgen (siehe <a class="crosslink" href="#Anrufbeantworter">Anrufbeantworter</a> und <a class="crosslink" href="#Faxgeraet">Faxgerät</a>).</p></div><div class="section_2"><h3 id="CapiSuite">CapiSuite<a class="headerlink" href="#CapiSuite">¶</a></h3><p>
Zum Schluss braucht man natürlich noch das Paket <sup><a href="#source-1">[1]</a></sup></p><ul><li><p><strong>capisuite</strong> (<em>universe</em>, bis <a class="internal" href="../natty.html">Ubuntu 11.04</a>)</p></li><li><p><strong>libsox-fmt-all</strong> (<em>universe</em>, Audio-Codecs)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="../_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="../apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install capisuite libsox-fmt-all </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install capisuite libsox-fmt-all </pre></div></div><p>
</p></div></div><div class="section_3"><h4 id="Ubuntu-13-10-und-14-04">Ubuntu 13.10 und 14.04<a class="headerlink" href="#Ubuntu-13-10-und-14-04">¶</a></h4><p>
Capisuite ist nicht mehr in den offiziellen Paketquellen enthalten. Man muss sich deshalb den Quellcode herunterladen und diesen an Ubuntu 13.10 anpassen. Eine Anleitung findet sich im <a class="crosslink post" href="https://forum.ubuntuusers.de/post/6078567/">Forum</a>.</p><p>Unter Ubuntu 14.04 scheinen die Pythonscripte nicht mehr zu funktionieren. Als Alternative zum Faxversand bietet sich Hylafax/Capi4hylafax an.</p></div></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
</p><div class="section_2"><h3 id="Anrufbeantworter">Anrufbeantworter<a class="headerlink" href="#Anrufbeantworter">¶</a></h3><p>
Alles was man machen muss, um den Anrufbeantworter zu aktivieren, ist die Datei <strong>/etc/capisuite/answering_machine.conf</strong> entsprechend zu bearbeiten. Im Gegensatz zu anderen <a class="internal" href="../serverdienste.html">Diensten</a> muss CapiSuite anschließend nicht neu gestartet werden, da Änderungen in der Konfiguration automatisch berücksichtigt werden.</p><p>Man beginnt mit der Sektion für die globalen Einstellungen, genannt <em>[GLOBAL]</em>, die man weitgehend so lassen kann, wie sie ist. Wenn man möchte, kann man in der Zeile mit <code class="notranslate">voice_email_from=</code> anstatt <em>root</em> eine richtige E-Mailadresse eintragen, die dann in den Mails als Absender erscheint.</p><p>Wichtig sind die folgenden Sektionen, die nach den jeweiligen Benutzern benannt sind und die persönlichen Einstellungen beinhalten. Dabei muss auf dem System ein gleichlautender Benutzer existieren. Hier ein Beispiel:</p><pre class="notranslate">[Benutzername]
# Telefonnummer (MSN), auf die das Gerät reagieren soll. Verschiedene Benutzer brauchen einen 
# eigenen Abschnitt: [anderer Benutzername] mit entsprechend unterschiedlicher Nummer.
voice_numbers="123456"
# mehrere Nummern sind auch möglich:
# voice_numbers="123456,123457,123458"
# was mit dem Anruf passiert: MailAndSave, SaveOnly oder None (nur Ansage)
voice_action="MailAndSave"
# Aufnahmelänge:
record_length="60"
# (interne) E-Mail Adresse des Empfängers:
voice_email="Benutzername@Rechnername"
# PIN für Fernabfrage:
pin="00000"</pre><p>
Falls die Aufzeichnung an eine externe Mailadresse versendet werden soll:</p><pre class="notranslate">voice_email_from="CapiSuite AB &lt;username@example.com&gt;"</pre><p>
Dabei bitte beachten, dass <strong>.wav</strong>-Dateien nicht komprimiert sind und relativ viel Platz belegen!</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Die Sprachaufzeichnungen sind leider normalerweise ziemlich leise. Wem das nicht gefällt, der muss die entsprechenden Python-Skripte ändern. Und zwar muss die Zeile 230 in der Datei <strong>/usr/lib/python2.5/site-packages/cs_helpers.py</strong> wie folgt geändert werden, und danach der vorkompilierte Bytecode in Gestalt der Dateien <strong>cs_helpers.py<em>c</em></strong> und <strong>cs_helpers.py<em>o</em></strong> gelöscht werden:</p><p><code class="notranslate">ret = os.spawnlp(os.P_WAIT,"sox","sox",'''"-v","3",attachment,"-w",'''basename+"wav")</code></p><p>Alternativ kann man dem Rauschen beim Abspielen der <strong>.wav</strong>-Datei diese Datei wie folgt begegnen:</p><p><code class="notranslate">ret = os.spawnlp(os.P_WAIT,"sox","sox",'''"-X","-v","3",'''attachment,"-w",basename+"wav")</code></p><p>Das "-X" beseitigt das Rauschen (getestet auf Ubuntu 8.04.2 64-Bit).
</p></div></div><p>Die vom Anrufbeantworter erstellten <strong>.la</strong>-Dateien (a-Law ISDN Audioformat) können mit folgendem Befehl abgespielt:</p><div class="bash"><div class="contents"><pre class="notranslate">play &lt;Pfad&gt;&lt;Beispiel.la&gt; </pre></div></div><p>
und mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sox &lt;Pfad&gt;&lt;Beispiel.la&gt; &lt;Pfad&gt;&lt;Beispiel.wav&gt; </pre></div></div><p>
in eine <strong>.wav</strong>-Datei umgewandelt werden. Bei der Zustellung per E-Mail geschieht dies automatisch.</p></div><div class="section_2"><h3 id="Faxgeraet">Faxgerät<a class="headerlink" href="#Faxgeraet">¶</a></h3><p>
Auch die Faxfunktion hat ihre eigene Konfigurationsdatei - <strong>/etc/capisuite/fax.conf</strong> - die der des Anrufbeantworters sehr ähnlich ist. Da CapiSuite eine integrierte Faxweiche besitzt, kann man Anrufbeantworter und Faxgerät ohne weiteres die gleiche Rufnummer (MSN) zuweisen. Die [GLOBAL]-Sektion besitzt ebenfalls vernünftige Voreinstellungen, daher an dieser Stelle gleich eine kommentierte Benutzer-Sektion:</p><pre class="notranslate">[Benutzername]
fax_numbers="123456"
# Fax-Nummer für den Empfänger; mit Länderkennung und OHNE führende Null bei der Vorwahl:
fax_stationID="+49 40 123456"
# Fax-Meldung (beliebiger Text):
fax_headline="Faxen machen - sent by CapiSuite"
# (interne) E-Mail Adresse des Empfängers:
fax_email="Benutzername@Rechnername"
# 'None' macht hier keinen Sinn:
fax_action="MailAndSave"</pre><p>
Falls die Faxe an eine externe Mailadresse versendet werden sollen:</p><pre class="notranslate">fax_email_from="Fax von CapiSuite &lt;username@example.com&gt;"</pre><div class="section_3"><h4 id="Fehlerbehebung-Faxempfang">Fehlerbehebung Faxempfang<a class="headerlink" href="#Fehlerbehebung-Faxempfang">¶</a></h4><p>
Ohne folgenden Bugfix funktioniert der Faxempfang nicht. Das Problem liegt an einem Umlaut (<strong>ü</strong>) in einem Kommentar des Skripts <strong>/usr/lib/capisuite/incoming.py</strong>, der entfernt bzw. in "ue" umbenannt werden muss <sup><a href="#source-6">[6]</a></sup>. Hier die korrigierte Zeile:</p><pre class="notranslate">problems on Redhat, thx to Herbert Huebner for reporting</pre><p>
Danach sollte der Faxempfang funktionieren.</p></div><div class="section_3"><h4 id="OpenOffice-org">OpenOffice.org<a class="headerlink" href="#OpenOffice-org">¶</a></h4><p>
Um aus <a class="internal" href="../openoffice.org.html">OpenOffice.org</a> heraus faxen zu können, muss man mit Hilfe des Programms <strong>/usr/lib/openoffice/program/spadmin</strong> einen neuen Fax-Drucker konfigurieren (das Programm <code class="notranslate">spadmin</code> ist auch Bestandteil von <a class="internal" href="../libreoffice.html">LibreOffice</a>). Im spadmin-Fenster <em>"Neuer Drucker"</em> auswählen, dann <em>"eine Faxlösung anbinden"</em>, <em>"der Standardtreiber"</em> und dann folgendes als Kommandozeile angeben:</p><pre class="notranslate">/usr/bin/capisuitefax -q -d "(PHONE)" "(TMP)"</pre><p>
Dann noch einen Namen für den Drucker vergeben und <em>"Fertig stellen"</em>.</p></div><div class="section_3"><h4 id="Scanner-einbinden">Scanner einbinden<a class="headerlink" href="#Scanner-einbinden">¶</a></h4><p>
Das Programm <strong>xsane</strong> bietet die Möglichkeit, neben der eigentlichen Scanfunktion eine eingescannte Vorlage direkt zu faxen. Hierzu müssen lediglich die Einstellungen angepasst werden. Diese befinden sich in <a class="internal" href="../xsane.html">xsane</a> unter den Menüpunkten <em>"Einstellungen -&gt; Konfiguration"</em> in der Registerkarte Fax:</p><table><tr><td> Befehl: </td><td> <strong>/usr/bin/capisuitefax</strong> </td></tr><tr><td> Option für Empfängernummer: </td><td> <strong>-d</strong> </td></tr><tr><td> Option für Postscriptdatei: </td><td> bleibt leer </td></tr><tr><td> Option für Normalmodus: </td><td> entfernen </td></tr><tr><td> Option für Feinmodus: </td><td> entfernen </td></tr></table><p>
</p></div><div class="section_3"><h4 id="Faxe-unmittelbar-ausdrucken">Faxe unmittelbar ausdrucken<a class="headerlink" href="#Faxe-unmittelbar-ausdrucken">¶</a></h4><p>
Um Faxe nach dem Empfang direkt auszudrucken, kann folgendes Python-Skript verwendet werden. Die erste Funktion <strong>printfax</strong> dient zum sofortigen Ausdruck, die zweite Funktion <strong>name</strong> wird weiter unten erläutert. Das Skript muss unter <strong>/usr/lib64/python2.5/site-packages/faxen_machen.py</strong> gespeichert werden <sup><a href="#source-6">[6]</a></sup>.</p><p>Damit wird aus dem Fax (Endung <strong>.sff</strong>) eine <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Tagged_Image_File_Format">TIFF</a>-Datei erzeugt, diese in Postscript umgewandelt und an den Drucker umgeleitet. Anschließend wird die TIFF-Datei wieder gelöscht. Bei ausgeschaltetem Drucker verbleiben die Druckaufträge solange in der Warteschlange, bis der Drucker angeschaltet wird.</p><pre class="notranslate"># hilfsroutinen fuer capisuite
# m.goerres 14.01.2007
# /usr/lib64/python2.5/site-packages/faxen_machen.py
#
# printfax = fax direkt ausdrucken
#

def printfax(filename):
  import cs_helpers
  # fuer die funktion sfftotiff
  # fuer string-funktionen
  import os
  # fuer die systemfunktionen
  namen = filename.split(".")
  suffix = namen[1]
  dateiname = namen[0]
  if suffix=="sff":
     ret=cs_helpers.sfftotiff(filename,dateiname+".tif")
     command="tiff2ps -a -h11 -w8.5 "+dateiname+".tif"+" | lp"
     os.system(command)
     os.unlink(dateiname+".tif")
  else:
     raise "color fax kann nicht ausgedruckt werden!"
# ende

#
# name = rueckgabe eines eindeutigen namens aus faxnummer + datum + zeit + endung
#
def name(directory,call_from,suffix):
  import time
  faxtime = time.strftime("%Y-%m-%d_%H-%M-%S")

  if call_from=="-":
     faxnumber = "unknown"
  else:
     faxnumber = call_from
  faxname = directory+"fax_"+faxnumber+"_"+faxtime+"."+suffix
  return faxname</pre><p>
Das Python-Skript muss nun noch am Ende der Funktion <strong>faxIncoming</strong> in der Datei <strong>/usr/lib/capisuite/incoming.py</strong> durch folgende Programmzeile aufgerufen werden <sup><a href="#source-6">[6]</a></sup>:</p><pre class="notranslate">faxen_machen.printfax(filename)</pre><p>
Das Skript muss am Anfang der Datei <strong>/usr/lib/capisuite/incoming.py</strong> unmittelbar hinter den anderen Importzeilen importiert werden. Damit der Import funktioniert muss außerdem davor noch Python das Verzeichnis des Moduls bekannt gemacht werden. 
</p><pre class="notranslate">import sys
sys.path.append(r'/usr/lib64/python2.5/site-packages/')
import faxen_machen</pre></div><div class="section_3"><h4 id="Dateinamen-der-Faxe-anpassen">Dateinamen der Faxe anpassen<a class="headerlink" href="#Dateinamen-der-Faxe-anpassen">¶</a></h4><p>
CapiSuite nummeriert die Faxe prinzipiell aufsteigend. Zur eindeutigen Erkennung und Zuordnung ist dies nur begrenzt hilfreich, die eingehende Faxnummer ist eindeutiger und hilfreicher.</p><p>Hierzu dient die Funktion <strong>name</strong> aus dem oben beschriebenen Python-Skript <strong>/usr/lib64/python2.5/site-packages/faxen_machen.py</strong>.  Der Name des Faxes setzt sich zusammen aus der eingehenden Nummer und Empfangsdatum und -zeit, z.B. fax_012345678_2007-01-14_11-24-16.pdf. Hierzu wird die formatierte Zeitausgabe, eine Standardfunktion von Python, verwendet. Bei Bedarf kann diese natürlich beliebig angepasst werden.</p><p>Das Skript muss wie oben beschrieben am Anfang der Datei <strong>/usr/lib/capisuite/incoming.py</strong> unmittelbar hinter den anderen Importzeilen importiert werden.</p><p>Der Funktionsaufruf in der Datei <strong>/usr/lib/capisuite/incoming.py</strong> muss noch entsprechend angepasst werden:</p><pre class="notranslate"># alter Befehl (auskommentiert):
#filename=cs_helpers.uniqueName(udir+"received/","fax",faxFormat)
# neuer Befehl:
filename=faxen_machen.name(udir+"received/",call_from,faxFormat)</pre></div></div><div class="section_2"><h3 id="Capisuite-als-Daemon">Capisuite als Daemon<a class="headerlink" href="#Capisuite-als-Daemon">¶</a></h3><p>
Um CapiSuite als Dienst direkt zu starten, muss die Datei <strong>/etc/default/capisuite</strong> angepasst werden:</p><pre class="notranslate">run_capisuite_daemon=y</pre><p>
Jetzt die CapiSuite mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">sudo /etc/init.d/capisuite restart </pre></div></div><p>
neustarten. Anrufbeantworter und Faxgerät sollten funktionieren. Ansonsten finden sich Fehlermeldungen in der Datei <strong>/var/log/capisuite.error</strong>.</p></div></div><div class="section_1"><h2 id="Benutzung">Benutzung<a class="headerlink" href="#Benutzung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Anrufbeantworter-2">Anrufbeantworter<a class="headerlink" href="#Anrufbeantworter-2">¶</a></h3><p>
Anrufe sollten jetzt automatisch aufgezeichnet und als <strong>.wav</strong>-Datei per E-Mail verschickt werden, so dass die Nachrichten aus dem E-Mail Programm heraus abgehört werden können. Dafür bietet sich z.B. das Programm <strong>aplay</strong> an.</p><p>Wenn man sich selbst von woanders anruft und mit dem Tonwahl-Verfahren die PIN-Nummer eingibt, gelangt man in das Fernabfragemenü, wo man u.a. auch einen neuen Text aufsprechen kann. Alternativ kann man auch eine Ansage als Nachricht hinterlassen und später die entsprechende <strong>.la</strong>-Datei umkopieren.</p><p>Zusätzlich kann man auch eine beliebige andere Audiodatei mit Hilfe des Programms <strong>sox</strong> in eine <strong>.la</strong>-Datei umwandeln und der CapiSuite über die Konfigurationsdirektiven <em>voice_user_dir</em> und <em>announcement</em> in der Datei <strong>/etc/capisuite/answering-machine.conf</strong> zugänglich machen.</p></div><div class="section_2"><h3 id="Faxgeraet-2">Faxgerät<a class="headerlink" href="#Faxgeraet-2">¶</a></h3><p>
Eingehende Faxe werden wie Sprachnachrichten per E-Mail versandt. Selbst Faxe versenden kann man mit dem Befehl</p><div class="bash"><div class="contents"><pre class="notranslate">capisuitefax -d Faxnummer Datei(en) </pre></div></div><p>
Die Dateien müssen dafür im PDF- oder im Postscriptformat vorliegen. Mit den <code class="notranslate">capisuitefax</code>-Optionen <strong>-l</strong> und <strong>-a <em>ID</em> </strong> kann man sich die Sendeschlange anzeigen lassen bzw. den Auftrag mit der Nummer <em>ID</em> abbrechen.</p><div class="section_3"><h4 id="OpenOffice-org-2">OpenOffice.org<a class="headerlink" href="#OpenOffice-org-2">¶</a></h4><p>
Um Dokumente mit <a class="internal" href="../openoffice.org.html">OpenOffice.org</a> zu faxen, einfach den eingerichteten Faxdrucker im Druckdialog auswählen und die Faxnummer im folgenden Dialogfeld eingeben.</p></div><div class="section_3"><h4 id="xsane">xsane<a class="headerlink" href="#xsane">¶</a></h4><p>
Im Hauptdialog von <strong>xsane</strong> statt Betrachter einfach Fax auswählen, in dem erscheinenden Dialog ein Faxprojekt erstellen und die gewünschte Faxnummer eingeben. Nach Scannen der Vorlage die entsprechende Datei auswählen und auf Projekt senden drücken. Nach Umwandlung wird die Datei an CapiSuite übergeben und als Fax verschickt.</p></div></div></div><div class="section_1"><h2 id="Probleme-und-Loesungen">Probleme und Lösungen<a class="headerlink" href="#Probleme-und-Loesungen">¶</a></h2><p>
</p><table><tr class="titel"><td colspan="2"> mögliche Fehlermeldungen </td></tr><tr class="kopf"><td> Problem </td><td> Lösung </td></tr><tr><td> <em>"Sorry, you're no valid user for CapiSuite"</em> </td><td> Fehlermeldung bei Nutzung von <strong>capisuitefax</strong> - aktueller Benutzername stimmt nicht mit dem konfigurierten Nutzer in <strong>/etc/capisuite/fax.conf</strong> überein </td></tr><tr><td> <em>"capisuite can't write to queue dir"</em> oder <em>"Druckerfehler"</em> beim Faxen aus OpenOffice </td><td> Das Verzeichnis <strong>/var/spool/capisuite/users/&lt;username&gt;/sendq</strong> existiert nicht,  möglicherweise wurde Capisuite als Dienst noch nicht aktiviert (siehe oben); Capisuite als Dienst starten ist Voraussetzung für das Absenden von Faxen. </td></tr><tr><td> <em>"ERROR occured while converting file: Error while calling sox. Not installed? Please talk to your friendly administrator."</em> </td><td> Leider installiert <strong>sox</strong> nicht alle benötigten Codecs mit, deshalb einfach das Paket <strong>libsox-dev</strong> installieren (getestet unter 8.04.2 64-Bit) </td></tr><tr><td> <em>"...CapiSuite 0x7fff93c4f4c0: Error while trying to send mail: (530, '5.7.0 Must issue a STARTTLS command first', ..."</em> </td><td> Wenn diese Fehlermeldung in <strong>/var/log/capisuite.error</strong> auftaucht, dann kann die Mail nicht an den Mailserver übergeben werden, weil dieser keine unverschlüsselte Verbindung akzeptiert. Unter <a class="crosslink" href="#Installation">Installation</a> ist eine Lösung beschrieben. </td></tr></table><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.capisuite.org/" rel="nofollow">Projektseite</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p><a class="external" href="http://www.capisuite.org/de-manual/" rel="nofollow">Dokumentation</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="interwiki interwiki-github" href="https://github.com/larsimmisch/capisuite">Quellcode</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li></ul></li><li><p><a class="external" href="http://www.neobiker.de/wiki/index.php?title=Capisuite" rel="nofollow">CapiSuite Erweiterungen</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="external" href="http://linux.eusterholz.dyndns.org/modem-isdn/capisuite.htm" rel="nofollow">Linux als SOHO-Server - CapiSuite</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/></p></li><li><p><a class="external" href="http://www.easylinux.de/Artikel/ausgabe/2007/02/040-isdn-fax/" rel="nofollow">Faxen machen - ISDN-Karte als Faxgerät und Anrufbeantworter nutzen</a> <img alt="{de}" src="../_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - EasyLinux 02/2007</p></li><li><p><a class="internal" href="../archiv/fritzbox/ffgtk.html">Fritz Fun GTK</a> - Faxen mit der Fritz!Box (oder T-Com Speedport) und <strong>capifax</strong></p></li><li><p><a class="interwiki interwiki-packages" href="http://packages.ubuntu.com/capi4hylafax">capi4hylafax</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - alternativer Faxserver auf Basis von <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/HylaFAX">HylaFAX</a> (ohne Anrufbeantworter)</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../archiv/capisuite/a/revision/940914.html">Diese Revision</a> wurde am 9. Mai 2017 08:07 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../archiv.html">Archiv</a></li>
<li><a href="../archiv/capisuite.html">CapiSuite</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>