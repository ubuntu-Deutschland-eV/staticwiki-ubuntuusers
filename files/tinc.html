<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Tinc › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./tinc.html">Tinc</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Tinc">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./tinc/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./tinc/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./tinc/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./tinc/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./tinc/a/backlinks.html">Tinc</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./programme_kompilieren.html">Programme kompilieren</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./chmod.html">Dateien ausführbar machen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-1"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a></li><li><a class="crosslink" href="#Beispiele">Beispiele
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="tinclogo.png" class="image-left" src="./_/098a82d440afbe262d057822df8fd0fd37ea0b41.png"/>
<a class="external" href="http://tinc-vpn.org/" rel="nofollow">Tinc</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ist eine dezentrale <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Virtual_Private_Network">Virtual-Private-Network</a>- oder kurz VPN-Software. Sie  zeichnet sich durch eine sehr schlanke und einfache Konfiguration, plattformübergreifende Unterstützung (Linux, BSD, Solaris, Mac OS X und Windows), vollständige <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Asymmetrisches%20Kryptosystem">asymmetrische Verschlüsselung</a> und dezentrales <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Vermaschtes_Netz">Mesh Routing</a> aus.</p><p>Bei letzterem verbinden sich alle Teilnehmer (Knoten) miteinander, um jeweils die beste Verbindung zu erreichen. Gleichzeitig können aber beliebig viele Knoten ausfallen, ohne dass die Verbindung zwischen zwei Knoten beeinträchtigt wird, solange noch eine einzige indirekte Verbindung verbleibt. Das virtuelle Netzwerk wird dabei standardmäßig auf Layer 3 (IP) im OSI-Modell erstellt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Um diesem Artikel folgen zu können, werden grundlegende Netzwerkkenntnisse vorausgesetzt. Als Beispiel wird das Subnet <code class="notranslate">10.8.0.0/16</code> verwendet, welches alle IP-Adressen von <code class="notranslate">10.8.0.1</code> bis <code class="notranslate">10.8.255.254</code> beinhaltet.
</p></div></div><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Vor Version 1.1 unterstützt Tinc das sogenannte <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Hole%20Punching">Hole Punching</a> nicht, wie etwa die VPN-Software <a class="external" href="http://www.ntop.org/products/n2n/" rel="nofollow">n2n</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>. D.h. bei mindestens einem Knoten muss der von Tinc verwendete Port <code class="notranslate">655</code> weitergeleitet werden, und über diesen Knoten fließt dann der komplette Netzwerkverkehr.
</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Tinc kann direkt aus den den offiziellen Paketquellen installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>tinc</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install tinc </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install tinc </pre></div></div><p>
</p></div></div><p>
Allerdings ist die enthaltene Version nicht immer die aktuellste. Für die neueste Ausgabe der Produktiv- oder Entwicklungsversion empfiehlt sich daher die Kompilierung von Hand.</p><div class="section_2"><h3 id="Manuell">Manuell<a class="headerlink" href="#Manuell">¶</a></h3><p>
Den Quellcode findet man auf der <a class="external" href="http://tinc-vpn.org/download/" rel="nofollow">Homepage</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> des Projekts, die Kompilierung erfolgt wie in <sup><a href="#source-2">[2]</a></sup> beschrieben. Zu beachten gilt dabei, dass bei einer manuellen Kompilierung per Standard alles in das Verzeichnis <strong>/usr/local/</strong> (siehe <a class="internal" href="./verzeichnisstruktur.html#usr">Verzeichnisstruktur</a>) verschoben wird. Dieses Verhalten kann wie in <a class="internal" href="./programme_kompilieren.html#Weitere-Optionen">Programme kompilieren</a> beschrieben geändert werden. Meist müssen neben den von über <sup><a href="#source-3">[3]</a></sup><sup><a href="#source-4">[4]</a></sup>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get build-dep tinc </pre></div></div><p>
gefundenen Bibliotheken noch die Pakete <strong>libreadline6-dev</strong> und <strong>libncurses5-dev</strong> nachinstalliert werden.</p><p>Tinc 1.1 unterscheidet sich von Version 1.0 u.a. durch eine vereinfachte Konfiguration und Unterstützung von <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Elliptic%20Curve%20Cryptography">Elliptic Curve Cryptography</a>. Allerdings ist diese Version noch nicht als stabil gekennzeichnet und sollte somit nur zum Testen benutzt werden.</p></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
</p><div class="section_2"><h3 id="Konfigurationsdateien">Konfigurationsdateien<a class="headerlink" href="#Konfigurationsdateien">¶</a></h3><p>
Die Konfigurationsdateien finden sich im Verzeichnis <strong>/etc/tinc/</strong>. Werden mehrere Netzwerke verwendet, so legt man für jedes ein Unterverzeichnis an, die später mit dem Parameter <code class="notranslate">-n Netzwerkname</code> ausgewählt werden. Es wird empfohlen, auch für ein einzelnes Netzwerk ein Unterverzeichnis anzulegen.</p><p>Allgemeine Einstellungen werden in der Datei <strong>/etc/tinc/NETZWERK/tinc.conf</strong> festgelegt. Für jeden Knoten gibt es dann nochmals eine eigene Datei im Unterverzeichnis <strong>hosts</strong>. Das hosts-Verzeichnis ist dabei bei allen Knoten identisch. Diese Syntax in den Dateien folgt dem Schema <code class="notranslate">Variablenname = Variablenwert</code>. Zudem gibt es die Skripte <strong>tinc-up</strong> und <strong>tinc-down</strong>, welche beim Starten bzw. Beenden von Tinc ausgeführt werden.</p><p>Beispielsweise existiert folgende Konfiguration:
</p><pre class="notranslate">/etc/tinc/NETZWERK/tinc.conf
/etc/tinc/NETZWERK/hosts/ersterknoten
/etc/tinc/NETZWERK/hosts/zweiterknoten
/etc/tinc/NETZWERK/tinc-up
/etc/tinc/NETZWERK/tinc-down</pre><div class="section_3"><h4 id="tinc-conf">tinc.conf<a class="headerlink" href="#tinc-conf">¶</a></h4><p>
Zuerst wird der Name des eigenen Knotens definiert <sup><a href="#source-5">[5]</a></sup>:</p><pre class="notranslate">Name = ersterknoten</pre><p>
Danach der Ort des TUN-Adapters (unter Linux <strong>/dev/net/tun</strong>):</p><pre class="notranslate">Device = /dev/net/tun</pre><p>
Zuletzt die Angabe, zu welchen anderen Knoten verbunden werden soll (ohne diese Angabe wartet der Knoten nur auf eingehende Verbindungen):</p><pre class="notranslate">ConnectTo = zweiterknoten</pre><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Ab Tinc 1.1 lässt sich dieser Schritt komfortabel mit</p><div class="bash"><div class="contents"><pre class="notranslate">tinc -n NETZWERK init ersterknoten </pre></div></div><p>
und
</p><div class="bash"><div class="contents"><pre class="notranslate">tinc -n NETZWERK add connectto zweiterknoten </pre></div></div><p>
ausführen.
</p></div></div></div><div class="section_3"><h4 id="hosts">hosts<a class="headerlink" href="#hosts">¶</a></h4><p>
Man legt eine neue Datei mit dem Namen <strong>/etc/tinc/NETZWERK/hosts/ersterknoten</strong>, der in tinc.conf angegeben wurde, an. Zuerst wird die öffentliche IP-Adresse (oder eine darauf verweisende Domain) des Knotens angegeben.</p><pre class="notranslate">Address = oeffentliche.ip.adresse.des.servers.org</pre><p>
Anschließend das Subnet des eigenen Knotens (angenommen, der Knoten besteht nur aus einem Rechner, hat das Subnet die Maske <code class="notranslate">/32</code>):
</p><pre class="notranslate">Subnet = 10.8.0.1/32</pre><p>
Ebenso möglich wäre aber auch, jedem Knoten 255 Adressen zuzuweisen (z.B. von <code class="notranslate">10.8.1.0</code> bis <code class="notranslate">10.8.1.255</code>):</p><pre class="notranslate">Subnet = 10.8.1.0/24</pre></div><div class="section_3"><h4 id="Schluessel-generieren">Schlüssel generieren<a class="headerlink" href="#Schluessel-generieren">¶</a></h4><p>
Dazu wird der folgende Befehl ausgeführt:</p><div class="bash"><div class="contents"><pre class="notranslate">tincd -n NETZWERK -K </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Dieser Schritt entfällt ab Version 1.1
</p></div></div></div><div class="section_3"><h4 id="tinc-up">tinc-up<a class="headerlink" href="#tinc-up">¶</a></h4><p>
Zuletzt wird noch das ausführbare <sup><a href="#source-6">[6]</a></sup> Skript <strong>tinc-up</strong> angelegt.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
ifconfig <span class="nv">$INTERFACE</span> <span class="m">10</span>.8.0.1 netmask <span class="m">255</span>.255.0.0
</pre></div>
</td></tr></table></div><p>Die IP-Adresse gibt diejenige Adresse aus dem Knoten-Subnet an, unter der man später erreichbar sein wird. Die Netzmaske entspricht hierbei der des "kompletten" Tinc-Netzwerkes.</p></div></div><div class="section_2"><h3 id="Weitere-Knoten">Weitere Knoten<a class="headerlink" href="#Weitere-Knoten">¶</a></h3><p>
Diese Schritte werden für jeden Knoten ausgeführt, jeweils mit einem eigenen Subnet / eigener IP-Adresse. Als letztes werden die Dateien im host-Verzeichnis an jeden anderen Knoten weitergegeben.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Tinc 1.1 unterstützt hierbei die komfortablen Optionen <code class="notranslate">import</code>, <code class="notranslate">export</code> und <code class="notranslate">exchange</code>. So kann man die Konfiguration via SSH mit dem Server <code class="notranslate">foobar.example.org</code> synchronisieren:</p><div class="bash"><div class="contents"><pre class="notranslate">tinc -n netname export | ssh foobar.example.org tinc -n netname exchange | tinc -n netname import </pre></div></div><p>
</p></div></div><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Es gibt noch einige weitere Konfigurationsmöglichkeiten, u.a. kann Tinc auch ein auf Layer-2-basiertes Netzwerk erstellen oder IPv6 und <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/ECDSA">ECDSA</a> nutzen. Hier sei auf die umfangreichen <a class="internal" href="./man.html">Manpages</a> von Tinc verwiesen.
</p></div></div></div><div class="section_2"><h3 id="Tinc-starten">Tinc starten<a class="headerlink" href="#Tinc-starten">¶</a></h3><p>
Tinc wird mit dem Kommando <code class="notranslate">tincd</code> bedient. Zum Starten dient die Option <code class="notranslate">start</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">tincd -n NETZWERK start </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Ab Tinc 1.1 werden alle Kommandos mit dem Befehl <code class="notranslate">tinc</code> (statt <code class="notranslate">tincd</code>) durchgeführt. Außerdem gibt es eine Übersicht über das Netzwerk mit dem Parameter <code class="notranslate">top</code>.
</p></div></div></div><div class="section_2"><h3 id="Optional-Symbolische-Namen">Optional: Symbolische Namen<a class="headerlink" href="#Optional-Symbolische-Namen">¶</a></h3><p>
Man kann das eigene virtuelle Netzwerk in die Datei <strong>/etc/networks</strong> eintragen. Als Beispiel:
</p><pre class="notranslate">NETZWERK 10.0.0.0 # Netzwerkname und Subnet</pre><p>Außerdem kann man in der Datei <strong>/etc/services</strong> dem Tinc-Service eine Port-Nummer (Standard: <code class="notranslate">655</code>) zuweisen, dadurch zeigen manche Programme statt der Portnummer den Namen des Services an:</p><pre class="notranslate">tinc            655/tcp    TINC
tinc            655/udp    TINC</pre></div></div><div class="section_1"><h2 id="Beispiele">Beispiele<a class="headerlink" href="#Beispiele">¶</a></h2><p>
</p><div class="section_2"><h3 id="Tinc-als-Default-Gateway">Tinc als Default-Gateway<a class="headerlink" href="#Tinc-als-Default-Gateway">¶</a></h3><p>
Wenn man Tinc als Default-Gateway nutzt, so bestimmt man einen Knoten, über den dann der komplette eigene Internetverkehr geroutet wird - mit Ausnahme der Verbindung zu diesem Knoten. Dann benutzt man dieses Knoten als VPN, um z.B. Zensur zu umgehen oder Man-in-the-middle-Attacken in öffentlichen WLANs vorzubeugen. Bei OpenVPN ist dies als <code class="notranslate">redirect-gateway</code> bekannt. Im Folgenden wird der Knoten, der das VPN bereitstellt, <em>"Server"</em> genannt, die Knoten, welche ihre Verbindung über den Server leiten, <em>"Client"</em>.</p><div class="section_3"><h4 id="Server">Server<a class="headerlink" href="#Server">¶</a></h4><p>
Allgemein muss dazu in der Datei <strong>/etc/sysctl.conf</strong> die IP-Weiterleitung aktiviert sein. Dazu entfernt man das Kommentarzeichen vor der entsprechenden Zeile:</p><pre class="notranslate">net.ipv4.ip_forward=1           # für IPv4
net.ipv6.conf.all.forwarding=1  # für IPv6</pre><p>
und übernimmt die Einstellungen mit:</p><div class="bash"><div class="contents"><pre class="notranslate">sysctl -p </pre></div></div><p>Dann ändert man in <strong>/hosts/server</strong> das Subnet auf <code class="notranslate">Subnet = 0.0.0.0/0</code> (IPv4) bzw. <code class="notranslate">::/0</code> (IPv6). Zudem fügt man der Datei <a class="internal" href="./rc.local.html">/etc/rc.local</a> folgendes hinzu (<code class="notranslate">eth0</code> muss durch den Netzwerkadapter mit der öffentlichen IP des Servers ersetzt werden, <code class="notranslate">tun0</code> durch den Netzwerkadapters mit der VPN-internen IP, <code class="notranslate">10.8.0.0/16</code> gibt das Tinc-Subnet an):</p><pre class="notranslate">iptables -A FORWARD -o eth0 -i tun0 -s 10.8.0.0/16 -m conntrack --ctstate NEW -j ACCEPT
iptables -A FORWARD -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
iptables -t nat -A POSTROUTING -o eth0 -s 10.8.0.0/16 -j MASQUERADE</pre><p>Sollte dies nicht funktionieren, kann man teilweise auch Source-NAT verwenden, siehe <a class="crosslink" href="#Virtualisierte-Systeme">Problembehebung</a>.</p></div><div class="section_3"><h4 id="Client">Client<a class="headerlink" href="#Client">¶</a></h4><p>
Auf den Clients werden nun die host-up und host-down Dateien angepasst.</p><ul><li><p><strong>/etc/tinc/NETZWERK/hosts/server-up</strong> (INTERNE_SERVER_IP wird durch die VPN-interne Netzwerkadresse des Servers ersetzt): </p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nv">VPN_GATEWAY</span><span class="o">=</span>INTERNE_SERVER_IP
<span class="nv">ORIGINAL_GATEWAY</span><span class="o">=</span><span class="sb">`</span>ip route show <span class="p">|</span> grep ^default <span class="p">|</span> cut -d <span class="s1">' '</span> -f <span class="m">2</span>-5<span class="sb">`</span>

ip route add <span class="nv">$REMOTEADDRESS</span> <span class="nv">$ORIGINAL_GATEWAY</span>
ip route add <span class="nv">$VPN_GATEWAY</span> dev <span class="nv">$INTERFACE</span>
ip route add <span class="m">0</span>.0.0.0/1 via <span class="nv">$VPN_GATEWAY</span> dev <span class="nv">$INTERFACE</span>
ip route add <span class="m">128</span>.0.0.0/1 via <span class="nv">$VPN_GATEWAY</span> dev <span class="nv">$INTERFACE</span>
</pre></div>
</td></tr></table></div></li><li><p><strong>/etc/tinc/NETZWERK/hosts/server-down</strong>: </p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nv">ORIGINAL_GATEWAY</span><span class="o">=</span><span class="sb">`</span>ip route show <span class="p">|</span> grep ^default <span class="p">|</span> cut -d <span class="s1">' '</span> -f <span class="m">2</span>-5<span class="sb">`</span>

ip route del <span class="nv">$REMOTEADDRESS</span> <span class="nv">$ORIGINAL_GATEWAY</span>
ip route del <span class="nv">$VPN_GATEWAY</span> dev <span class="nv">$INTERFACE</span>
ip route del <span class="m">0</span>.0.0.0/1 dev <span class="nv">$INTERFACE</span>
ip route del <span class="m">128</span>.0.0.0/1 dev <span class="nv">$INTERFACE</span>
</pre></div>
</td></tr></table></div></li></ul><p>
</p></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
Sollte etwas nicht wie gewünscht funktionieren, so lässt sich Tinc mit den Parametern <code class="notranslate">-D -d5</code> im Debug-Modus starten. Wird dadurch sehr viel ausgegeben, so kann man auch eine geringere Zahl als Parameter angeben.</p><div class="section_2"><h3 id="Firewall">Firewall<a class="headerlink" href="#Firewall">¶</a></h3><p>
</p><div class="section_3"><h4 id="UDP-Pakete-werden-blockiert">UDP Pakete werden blockiert<a class="headerlink" href="#UDP-Pakete-werden-blockiert">¶</a></h4><p>
Tinc lässt sich auch über eine TCP-Verbindung tunneln, was bei einigen Firewalls notwendig ist, allerdings die Geschwindigkeit beeinflussen kann. In der entsprechenden <strong>host-Datei</strong> wird folgendes eingefügt:</p><pre class="notranslate">TCPonly = yes</pre></div><div class="section_3"><h4 id="Port-wird-blockiert">Port wird blockiert<a class="headerlink" href="#Port-wird-blockiert">¶</a></h4><p>
Um den Port, über den ein Knoten erreichbar ist, zu ändern, müssen dessen <strong>tinc.conf</strong> und <strong>host-Datei</strong> angepasst werden:</p><ul><li><p><strong>tinc.conf</strong>: </p><pre class="notranslate">BindToAddress = *:1234</pre><p> Anstelle des Sternchens lässt sich auch eine spezielle Netzwerkadresse angeben.</p></li><li><p><strong>hosts/knoten</strong>: </p><pre class="notranslate">Port = 12345</pre></li></ul></div></div><div class="section_2"><h3 id="Virtualisierte-Systeme">Virtualisierte Systeme<a class="headerlink" href="#Virtualisierte-Systeme">¶</a></h3><p>
</p><div class="section_3"><h4 id="TUN-TAP">TUN/TAP<a class="headerlink" href="#TUN-TAP">¶</a></h4><p>
Auf vielen virtuellen Servern teilt sich das virtualisierte Betriebssystem den Kernel mit dem Host, sodass einige benötigte Module nicht verfügbar sein können. Ob das TUN/TAP-Modul geladen wurde, erkennt man mit dem Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">lsmod | grep tun </pre></div></div><p>
Sollte dies nicht der Fall sein (der Befehl gibt nichts zurück), so muss man das Gerät selbst erstellen:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkdir -p /dev/net
sudo mknod /dev/net/tun c 10 200
sudo chmod 600 /dev/net/tun </pre></div></div></div><div class="section_3"><h4 id="iptables-masquerading">iptables masquerading<a class="headerlink" href="#iptables-masquerading">¶</a></h4><p>
Sollte das Masquerading-Modul von <a class="internal" href="./iptables.html">iptables</a> nicht verfügbar sein, so kann man auch Source-NAT benutzen. Dazu ersetzt man in <strong>/etc/rc.local</strong>:</p><pre class="notranslate">iptables -t nat -A POSTROUTING -o eth0 -s 10.8.0.0/16 -j MASQUERADE # das geht nur, wenn das Interface nicht venet0:0 (also keine Map) ist</pre><p>
durch</p><pre class="notranslate">iptables -t nat -A POSTROUTING -s 10.8.0.0/16 -j SNAT --to-source EXT_IP  </pre><p>
wobei <code class="notranslate">EXT_IP</code> durch die öffentliche IP des Servers ersetzt wird.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Oftmals reicht eine Anfrage an die Administratoren des Servers, um die benötigten Module zu laden.
</p></div></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://tinc-vpn.org/" rel="nofollow">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p><ul><li><p><a class="external" href="http://tinc-vpn.org/docs/" rel="nofollow">Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> </p></li></ul></li><li><p><a class="interwiki interwiki-heise" href="https://www.heise.de/-785436">Dezentrales VPN mit Tinc - Tinc vermascht Rechner sicher übers Internet</a> - heise Netze, 09/2009</p></li><li><p><a class="external" href="http://www.admin-magazin.de/Das-Heft/2009/02/Virtual-Private-Networks-mit-Tinc" rel="nofollow">Tunnelbau - Virtual Private Networks mit Tinc</a> - Artikel ADMIN Magazin, 02/2009</p></li><li><p><a class="internal" href="./serverdienste.html#VPN">VPN</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Programmübersicht</p></li><li><p><a class="interwiki interwiki-youtube" href="https://www.youtube.com/watch?v=V-fhXawtQXQ?t=38m50s">Tunneling 101 – von überall ins Netz (SSH, Tinc, Socks, Krypto)</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Vortrag, Ubucon Berlin 2015</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./tinc/a/revision/942179.html">Diese Revision</a> wurde am 24. Juni 2017 10:45 von <a href="https://ubuntuusers.de/user/Into_the_Pit/">Into_the_Pit</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./tinc.html">Tinc</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>