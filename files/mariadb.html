<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>MariaDB › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./mariadb.html">MariaDB</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/MariaDB">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./mariadb/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./mariadb/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./mariadb/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./mariadb/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./mariadb/a/backlinks.html">MariaDB</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./xenial_xerus.html">Ubuntu 16.04</a> Xenial Xerus</p></li></ul></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./programme_starten.html">Starten von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./dienste.html">Dienste steuern</a></p></li><li><p><a class="crosslink anchor" href="#source-6" id="source-6"></a> <a class="internal" href="./logdateien.html">Logdateien lesen</a></p></li><li><p><a class="crosslink anchor" href="#source-7" id="source-7"></a> <a class="internal" href="./editor.html">einen Editor öffnen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a><ol class="arabic"><li><a class="crosslink" href="#Einzelinstallation">Einzelinstallation
</a></li><li><a class="crosslink" href="#Fremdquelle">Fremdquelle
</a></li><li><a class="crosslink" href="#Galera-Cluster">Galera Cluster
</a></li><li><a class="crosslink" href="#Wechsel-von-MySQL-nach-MariaDB">Wechsel von MySQL nach MariaDB
</a></li></ol></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a><ol class="arabic"><li><a class="crosslink" href="#Passwortloses-Arbeiten">Passwortloses Arbeiten
</a></li><li><a class="crosslink" href="#ndern-des-Datenbank-Verzeichnisses">Ändern des Datenbank-Verzeichnisses
</a></li><li><a class="crosslink" href="#Galera-Cluster-2">Galera Cluster
</a></li></ol></li><li><a class="crosslink" href="#Nutzung">Nutzung
</a></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a><ol class="arabic"><li><a class="crosslink" href="#Galera-Cluster-Debian-Sys-User-inkonsistent">Galera Cluster Debian-Sys-User inkonsist...</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="./MariaDB_Logo.png" class="image-left" src="./_/742ba2db0ca39d334b80e670831f82dc8210aa63.png"/>
<a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/MariaDB">MariaDB</a> ist eine Abspaltung (Fork) von <a class="internal" href="./mysql.html">MySQL</a>. Diese wurde entwickelt, nachdem <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Oracle">Oracle</a> <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Sun%20Microsystems">Sun Microsystems</a> im Jahre 2010 übernommen hatte. MariaDB ist größtenteils kompatibel mit MySQL und kann MySQL meist ohne Probleme ersetzen (API-kompatibel). Es werden die Prozessorarchitekturen <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/x86">x86</a> und <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/AMD64">AMD64</a> unterstützt.</p><p>Unterschiede zwischen MySQL und MariaDB:
</p><ul><li><p>MariaDB verwendet die "Storage-Engine" XtraDB als Ersatz für InnoDB.</p></li><li><p>Es gibt weitere "Storage-Engines": OQGRAPH, SphinxSE, IBMDB2I, Cassandra und Aria (Ersatz für MyISAM).</p></li><li><p>Alphanumerische Felder in Heap-Tabellen können eine Größe von 256 Zeichen übersteigen.</p></li><li><p>Unterstützung von <a class="external" href="https://kb.askmonty.org/en/pool-of-threads/" rel="nofollow">Pool of Threads</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>, um auch mit 200000+ Verbindungen noch hohe Geschwindigkeit zu garantieren</p></li><li><p>"sub queries" sind nun benutzbar.</p></li><li><p>Es gibt nun <a class="external" href="https://kb.askmonty.org/en/group-commit-for-the-binary-log/" rel="nofollow">Group commits</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p></li></ul><p>
</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Man kann nicht gleichzeitig MariaDB und <a class="internal" href="./mysql.html">MySQL</a> installiert haben, es sei denn, man installiert die Datenbank manuell. Wer es ausprobieren möchte, sollte sich <a class="external" href="https://kb.askmonty.org/en/mariadb-coexist-with-mysql/" rel="nofollow">MariaDB coexist with MySQL</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> ansehen. Es ist allerdings anzumerken, dass es nicht zu empfehlen ist, diese Konstellation produktiv einzusetzen, da sie ungetestet ist.
</p></div></div><p>
MariaDB ist in der Standard-Version (ohne Galera-Cluster) seit <a class="internal" href="./trusty.html">Ubuntu 14.04</a> in den offiziellen Paketquellen enthalten.</p><div class="section_2"><h3 id="Einzelinstallation">Einzelinstallation<a class="headerlink" href="#Einzelinstallation">¶</a></h3><p>
Installation ohne Interaktionen mit anderen MariaDB-Installationen:</p><ul><li><p><strong>mariadb-server</strong> (ab <a class="internal" href="./trusty.html">Ubuntu 14.04</a> in <em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mariadb-server </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install mariadb-server </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Fremdquelle">Fremdquelle<a class="headerlink" href="#Fremdquelle">¶</a></h3><p>
Vor Ubuntu 14.04 war MariaDB nicht in den offiziellen Paketquellen enthalten, daher muss eine zusätzliche Fremdquelle hinzugefügt werden: Um aus der <a class="internal" href="./fremdquellen.html">Fremdquelle</a> zu installieren, muss man eine <a class="internal" href="./paketquellen_freischalten.html">Paketquelle freischalten</a>, deren Syntax man auf der <a class="external" href="https://downloads.mariadb.org/mariadb/repositories/" rel="nofollow">Webseite zum Herunterladen</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> von MariaDB erzeugen kann.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Zusätzliche Fremdquellen können das System gefährden. 
</p></div></div><p>
Es muss noch ein Schlüssel zur Authentifizierung der Quelle hinzugefügt werden. Wie das geht, ist im Artikel <a class="internal" href="./apt/apt-key.html">apt-key</a> beschrieben. Nach dem Hinzufügen und Aktualisieren der Paketquellen kann MariaDB installiert werden.</p><p>Anschließend kann MariaDB mit folgendem Paket installiert werden:
</p><ul><li><p><strong>mariadb-server</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mariadb-server </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install mariadb-server </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Galera-Cluster">Galera Cluster<a class="headerlink" href="#Galera-Cluster">¶</a></h3><p>
Ein Galera-Cluster aus mehreren Servern bietet den Vorteil, dass Les- und Schreibzugriffe auf alle beteiligten Servern erfolgen können und dabei die Datenbanken redundant gehalten werden. Es können alle bis auf einen Server ausfallen, bevor Daten verlorengehen oder der Zugriff nicht mehr möglich ist.</p><ul><li><p><strong>mariadb-galera-server</strong></p></li><li><p><strong>galera</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mariadb-galera-server galera </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install mariadb-galera-server galera </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Wechsel-von-MySQL-nach-MariaDB">Wechsel von MySQL nach MariaDB<a class="headerlink" href="#Wechsel-von-MySQL-nach-MariaDB">¶</a></h3><p>
Vorbereitungen: Datenbanksicherung und bisheriges mysql-root-Passwort bereithalten. Man kann natürlich auch ein neues sql-root-Passwort für MariaDB vergeben.</p><p>MySQL Deinstallieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get purge mysql-server mysql-common mysql*
## Aufräumen:
sudo apt-get autoclean; sudo apt-get clean; sudo apt-get autoremove; 
## Prüfen auf sql Reste:
dpkg -l | grep -i -e "sql\|maria" </pre></div></div><p>
MariaDB Installieren:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install mariadb-server </pre></div></div><p>Bei einem Test unter Ubuntu 13.04 war in diesem Szenario die bisherige SQL-Datenbank sofort wieder einsatzfähig. Bis auf das ggf. geänderte sql-root-Passwort waren alle SQL-Datenbank-Tabellen und SQL-Nutzerkonten vorhanden. Auch eine Anbindung zum Webserver über das Paket <strong>php5-mysql</strong> lief wieder problemlos. Eine Einspielung einer Datenbanksicherung oder Änderungen in der Konfiguration war nicht notwendig. MySQL ist derzeit vollständig binärkompatibel zu MariaDB, d.h. alle Aufrufe auf der Kommandozeile oder in Schnittstellen zu anderen Programmen funktionieren wie bei MySQL.</p></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
</p><div class="section_2"><h3 id="Passwortloses-Arbeiten">Passwortloses Arbeiten<a class="headerlink" href="#Passwortloses-Arbeiten">¶</a></h3><p>
Um SQL-Befehle auszuführen, ohne sich jedes Mal bei MariaDB anmelden zu müssen, kann man im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> die Datei <strong>/home/BENUTZERNAME/.my.cnf</strong> mit folgenden Inhalt anlegen.</p><pre class="notranslate">[client]
host     = localhost
user     = BENUTZERNAME
password = PASSWORT
socket   = /var/run/mysqld/mysqld.sock
[mysql_upgrade]
host     = localhost
user     = BENUTZERNAME
password = PASSWORT
socket   = /var/run/mysqld/mysqld.sock
basedir  = /usr</pre><p>
Danach sollte man noch die Zugriffsrechte auf den Benutzer beschränken:</p><div class="bash"><div class="contents"><pre class="notranslate">chmod 600 /root/.my.cnf </pre></div></div></div><div class="section_2"><h3 id="ndern-des-Datenbank-Verzeichnisses">Ändern des Datenbank-Verzeichnisses<a class="headerlink" href="#ndern-des-Datenbank-Verzeichnisses">¶</a></h3><p>
Das Standardverzeichnis für Datenbanken ist <strong>/var/lib/mysql</strong>. Möchte man dies Änderung wollen, sind die folgenden Schritte notwendig.</p><p>Zuerst muss die Datei <strong>/etc/mysql/my.cnf</strong> mit einem Editor mit Root-Rechten <sup><a href="#source-4">[4]</a></sup><sup><a href="#source-7">[7]</a></sup> geöffnet werden. Dort Suche man die Zeile <code class="notranslate">datadir</code> und ändert hier den Wert auf das neue Verzeichnis, in dem MariaDB die Datenbank-Dateien ablegen soll.</p><p>Anschließend müssen die Systemdatenbanken, welche bei der Installation immer automatisch angelegt werden, vom Verzeichnis <strong>/var/lib/mysql</strong> ins neue Datenbankverzeichnis kopiert werden. Dabei ist zu beachten, dass Eigentümer und Gruppe der Dateien nicht verändert werden.</p><p>Beim Wechsel von MySQL ist zusätzlich die  Anpassung von <strong>/etc/apparmor.d/usr.sbin.mysqld</strong> erforderlich, da AppArmor den Zugriff auf andere Verzeichnisse unterbindet. Siehe hierfür den Artikel von <a class="internal" href="./mysql.html#Datenpfad">MySQL</a> im Wiki.</p></div><div class="section_2"><h3 id="Galera-Cluster-2">Galera Cluster<a class="headerlink" href="#Galera-Cluster-2">¶</a></h3><p>
Es ist empfehlenswert die Verbindung abzusichern. Hierzu muss man einen Benutzer mit Passwort anlegen. Die weitere Konfiguration erfolgt weiter unten.</p><div class="bash"><div class="contents"><pre class="notranslate">mysql -u root -p -e "SET wsrep_on=OFF; GRANT ALL ON *.* TO BENUTZERNAME@'%' IDENTIFIED BY 'PASSWORT';" </pre></div></div><p>
Um Fehler zu vermeiden, sollte man alle leeren Benutzer löschen:</p><div class="bash"><div class="contents"><pre class="notranslate">mysql -u root -p -e "SET wsrep_on=OFF; DELETE FROM mysql.user WHERE user='';" </pre></div></div><p>Es gibt einige Optionen, die für den Betrieb von Galera notwendig sind. Diese sind hier aufgeführt. In der Datei <strong>/etc/mysql/my.cnf</strong> müssen folgende Einstellungen vorgenommen werden. Bereits in der Datei hinterlegte Einstellungen sollten erhalten bleiben und gegebenenfalls angepasst werden:</p><pre class="notranslate">[mysqld]
# Wenn bind-address auskommentiert ist, "bind-address = 0.0.0.0" oder
# "bind-address = " gesetzt ist, ist die Datenbank an allen Netzwerkschnittstellen im Netzwerk erreichbar.
# MariaDB kann auch nur an dem Netzwerk verfügbar sein, das über die Netzwerkschnittstelle erreichbar ist:
# bind-address = IP-ADRESSE_EINES_INTERFACES
# Jedenfalls müssen sich die Knoten über das Netzwerk erreichen können.

binlog_format = ROW
innodb_locks_unsafe_for_binlog=1
innodb_autoinc_lock_mode=2
default_storage_engine=InnoDB
query_cache_size=0
query_cache_type=0

[mysqldump]
max_allowed_packet = 16M
quick
quote-names

[mysql]

[isamchk]
!includedir /etc/mysql/conf.d/</pre><p>In einer Datei unter <strong>/etc/mysql/conf.d/</strong> z.B. <strong>/etc/mysql/conf.d/mariadb.cnf</strong> kann man dann getrennt die spezifischen Galera-Optionen festlegen. Man kann natürlich auch alle Einstellungen in einer Datei sammeln. Es wird aber empfohlen, diese der Übersichtlichkeit halber zu trennen. Man muss sich auch noch überlegen, welche Replikationsmethode verwendet werden soll:</p><p>
</p><table><tr class="titel"><td colspan="2"> State Snapshot Transfer method (wsrep_sst_method) </td></tr><tr class="kopf"><td> Methode </td><td> Eigenschaften </td></tr><tr><td> mysqldump </td><td> Es wird bei jeder Synchronisation die gesamte Tabelle übertragen, daher langsam </td></tr><tr><td> rsync </td><td> Es wird festgestellt, wo Änderungen stattgefunden haben. Dann werden nur diese übertragen. </td></tr><tr><td> xtrabackup </td><td> Momentan noch experimentell. </td></tr><tr><td> eigene Skripte </td><td> Diese Möglichkeit ist die optimale Lösung, wenn man diese implementieren kann. Dann man kann eine Lösung auf die eigene Datenbank maßschneidern. </td></tr></table><p>Es wird empfohlen, <code class="notranslate">rsync</code> zu verwenden, da diese Methode ziemlich schnell, stabil und bandbreitenschonend ist. Man kann natürlich auch eine eigene Lösung implementieren. Dies ist aber im Vergleich zum Nutzen meist zu viel Arbeit.</p><p>Es muss im Folgenden die Option <code class="notranslate">wsrep_cluster_address</code> noch besonders beachtet werden. Hier wird eingestellt, wo der nächste Knoten zu finden ist. Der erste Knoten erhält vorübergehend keine Adresse zum Verbinden. Alle weiteren Knoten bekommen eine Adresse eingetragen, die zu einem Knoten gehört, der bereits an dem Cluster beteiligt ist. Zum Schluss wird auch dem ersten Knoten eine Adresse eingetragen, damit auch dieser sich wieder automatisch mit dem Cluster verbinden kann, wenn dieser Knoten einmal ausfällt.</p><pre class="notranslate">[client]
# Standard ist Latin1. Es wird für einen Galera-Cluster aber UTF-8 benötigt. (auch in der Serversektion)
default-character-set = utf8

[mysqld]
# Standard ist Latin1. Es wird für einen Galera-Cluster aber UTF-8 benötigt.
character_set_server   = utf8
collation_server       = utf8_general_ci

# "gcom://"" setzen um einen Knoten zu reinitialisieren (resetten)
wsrep_cluster_address = 'gcomm://'
# "gcom://10.10.10.10"" oder "gcom://HOSTNAME"" setzen, um einen Knoten mit bestehenden Cluster-Knoten zu verbinden
#wsrep_cluster_address = 'gcomm://KNOTENADRESSE'

wsrep_provider = /usr/lib/galera/libgalera_smm.so

# Wie oft soll versucht werden, festgefahrene "autocommits" per "commit" abzuschließen
wsrep_retry_autocommit=1

# Übertragungsmethode (mysqldump, rsync, xtrabackup oder eigene Skripte)
wsrep_sst_method=rsync


## Optionale Einstellungen ##

# Authentifizierung (empfohlen)
wsrep_sst_auth=BENUTZERNAME:PASSWORT

# Name des Clusters
wsrep_cluster_name=CLUSTERNAME

# Log-Level auf DEBUG stellen, damit man mehr Infos bekommt. 
# Diese Einstellung ist bei der Einrichtung sehr zu empfehlen, um Fehler zu finden. 
wsrep_debug=1

# Für MyISAM Unterstützung erforderlich
wsrep_replicate_myisam=1

# Konvertiere locking sessions in Transaktionen.
# Transaktionen sorgen dafür, daß bei parallelen Zugriff auf Daten
# diese für einen Zugreifenden gesperrt werden, damit nicht
# der Zufall entscheidet, was am Ende gespeichert wird.
wsrep_convert_LOCK_to_trx=1

# Generate fake primary keys for non-PK tables (required for multi-master and parallel applying operation)
wsrep_certify_nonPK=1</pre><p>Nun kann man MariaDB neustarten und den Status des Clusters überprüfen:</p><div class="bash"><div class="contents"><pre class="notranslate">mysql -e "SHOW STATUS LIKE 'wsrep_%';" </pre></div></div><p>Die Ausgabe sollte ungefähr so aussehen. Wenn die Node-Anzahl wsrep_cluster_size stimmt, kann man davon ausgehen, dass alles geklappt hat.</p><pre class="notranslate">+----------------------------+--------------------------------------+
| Variable_name              | Value                                |
+----------------------------+--------------------------------------+
| wsrep_local_state_uuid     | d50ca7c2-8f17-11e2-0800-ca06845fffe9 |
| wsrep_protocol_version     | 4                                    |
| wsrep_last_committed       | 320                                  |
| wsrep_replicated           | 0                                    |
| wsrep_replicated_bytes     | 0                                    |
| wsrep_received             | 3                                    |
| wsrep_received_bytes       | 267                                  |
| wsrep_local_commits        | 0                                    |
| wsrep_local_cert_failures  | 0                                    |
| wsrep_local_bf_aborts      | 0                                    |
| wsrep_local_replays        | 0                                    |
| wsrep_local_send_queue     | 0                                    |
| wsrep_local_send_queue_avg | 0.000000                             |
| wsrep_local_recv_queue     | 0                                    |
| wsrep_local_recv_queue_avg | 0.000000                             |
| wsrep_flow_control_paused  | 0.000000                             |
| wsrep_flow_control_sent    | 0                                    |
| wsrep_flow_control_recv    | 0                                    |
| wsrep_cert_deps_distance   | 0.000000                             |
| wsrep_apply_oooe           | 0.000000                             |
| wsrep_apply_oool           | 0.000000                             |
| wsrep_apply_window         | 0.000000                             |
| wsrep_commit_oooe          | 0.000000                             |
| wsrep_commit_oool          | 0.000000                             |
| wsrep_commit_window        | 0.000000                             |
| wsrep_local_state          | 4                                    |
| wsrep_local_state_comment  | Synced                               |
| wsrep_cert_index_size      | 0                                    |
| wsrep_causal_reads         | 0                                    |
| wsrep_incoming_addresses   | ,                                    |
| wsrep_cluster_conf_id      | 2                                    |
| wsrep_cluster_size         | 2                                    |
| wsrep_cluster_state_uuid   | d50ca7c2-8f17-11e2-0800-ca06845fffe9 |
| wsrep_cluster_status       | Primary                              |
| wsrep_connected            | ON                                   |
| wsrep_local_index          | 1                                    |
| wsrep_provider_name        | Galera                               |
| wsrep_provider_vendor      | Codership Oy &lt;info@codership.com&gt;    |
| wsrep_provider_version     | 23.2.2(r137)                         |
| wsrep_ready                | ON                                   |
+----------------------------+--------------------------------------+</pre></div></div><div class="section_1"><h2 id="Nutzung">Nutzung<a class="headerlink" href="#Nutzung">¶</a></h2><p>
MariaDB kann man für die verschiedensten Dinge gebrauchen.
</p><ul><li><p>Als Backend für diverse Webanwendungen</p></li><li><p>Um Benutzerdatenbanken zu verwalten</p></li><li><p>Abgleich von Datenmengen</p></li></ul><p>Einen Zugriff auf die Datenbanken kann man mit fast jeder Programmiersprache realisieren. Oftmals gibt es schon vorgefertigte Lösungen.
Dank <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/SQL">SQL</a> ist das Hantieren mit den Daten leicht und bequem.</p></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Galera-Cluster-Debian-Sys-User-inkonsistent">Galera Cluster Debian-Sys-User inkonsistent<a class="headerlink" href="#Galera-Cluster-Debian-Sys-User-inkonsistent">¶</a></h3><p>
Man erhält beim Starten von MariaDB folgende Fehlermeldung oder findet in den Protokollen ("log files") folgende Fehlermeldung:
</p><blockquote><p>"ERROR 1045 (28000): Access denied for user 'debian-sys-maint'@'localhost' (using password: YES)"</p></blockquote><p>
Falls man einen Galera-Cluster betreibt, liegt das Problem vor, daß auf den Knoten unterschiedliche Passwörter in den Dateien <strong>/etc/mysql/debian.cnf</strong> vorhanden sind. Am einfachsten ist es, die Datei von einem Knoten auf den/die anderen zu kopieren. Bei einer Einzelinstallation kann es bei einer Aktualisierung eines Paketes zu einer Veränderung des Passwortes gekommen ist. Man führt einfach folgende SQL-Befehle aus:</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="k">grant</span> <span class="k">all</span> <span class="n">privileges</span> <span class="k">on</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">to</span> <span class="s1">'debian-sys-maint'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">'newpassword'</span> <span class="k">with</span> <span class="k">grant</span> <span class="k">option</span><span class="p">;</span>
<span class="k">flush</span> <span class="n">privileges</span><span class="p">;</span>
<span class="n">quit</span><span class="p">;</span>
</pre></div>
</td></tr></table></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.mariadb.org" rel="nofollow">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="external" href="https://kb.askmonty.org/en/" rel="nofollow">Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/MariaDB">MariaDB</a> - Wikipedia</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./mariadb/a/revision/940697.html">Diese Revision</a> wurde am 9. Mai 2017 00:20 von <a href="https://ubuntuusers.de/user/ubot/">ubot</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./mariadb.html">MariaDB</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>