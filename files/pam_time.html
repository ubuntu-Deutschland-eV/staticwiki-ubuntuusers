<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>pam_time › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./pam_time.html">pam time</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/pam_time">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./pam_time/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./pam_time/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./pam_time/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./pam_time/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./pam_time/a/backlinks.html">pam time</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./editor.html">Bearbeiten von Textdateien</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Anwendung">Anwendung
</a><ol class="arabic"><li><a class="crosslink" href="#Aktivierung-der-Zeitsteuerung-in-der-Datei-common-auth">Aktivierung der Zeitsteuerung in der Dat...</a></li><li><a class="crosslink" href="#Konfiguration-der-time-conf">Konfiguration der time.conf
</a><ol class="arabic"><li><a class="crosslink" href="#Aufbau">Aufbau
</a></li><li><a class="crosslink" href="#Ausfuellhilfe">Ausfüllhilfe
</a></li><li><a class="crosslink" href="#Parameter-Spalte-1-4">Parameter (Spalte 1-4)
</a></li><li><a class="crosslink" href="#Moegliche-Operatoren">Mögliche Operatoren
</a></li></ol></li></ol></li><li><a class="crosslink" href="#Beispiele">Beispiele
</a><ol class="arabic"><li><a class="crosslink" href="#Kurze-Beispiele-zum-Verstaendnis">Kurze Beispiele zum Verständnis
</a></li><li><a class="crosslink" href="#Nutzungszeit-des-Computers-einschraenken-vollstaendiges-Anwendungsbeispiel">Nutzungszeit des Computers einschränken ...</a><ol class="arabic"><li><a class="crosslink" href="#pam-time-aktivieren-und-konfigurieren">pam_time aktivieren und konfigurieren
</a></li><li><a class="crosslink" href="#Cron-konfigurieren">Cron konfigurieren
</a></li></ol></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><strong>pam_time</strong> ist ein Bestandteil von <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Pluggable_Authentication_Modules">PAM</a>, den Pluggable Authentication Modules. Sie sind eine Softwarebibliothek, welche für Authentifizierungsdienste zur Verfügung steht. Damit kann man bestimmten Benutzern die Nutzung bestimmter <a class="internal" href="./dienste.html">Dienste</a>, Programme oder generell die Anmeldung am Computer zu bestimmten Uhrzeiten an bestimmten Tagen erlauben oder verbieten. Dieser Artikel erklärt jedoch nur die Einschränkung der Nutzungszeit des ganzen Linuxsystems durch eine Loginsperre.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Die benötigte Software ist bereits ein integraler Bestandteil von Ubuntu und gehört aufgrund Abhängigkeiten des Basissystems zum zwingend vorinstallierten Paket <strong>libpam-modules</strong><sup><a href="#source-1">[1]</a></sup> dazu.</p></div><div class="section_1"><h2 id="Anwendung">Anwendung<a class="headerlink" href="#Anwendung">¶</a></h2><p>
Grundsätzlich ist die Anwendung recht einfach aufgebaut:</p><ol class="arabic"><li><p>Als Erstes wird das Zeitmodul <strong>pam_time.so</strong> durch einen Eintrag in der Konfigurationsdatei <strong>common-auth</strong> im Verzeichnis <strong>/etc/pam.d</strong> aktiviert.</p></li><li><p>Im zweiten Schritt werden gewünschte Zeiten in der Konfigurationsdatei <strong>time.conf</strong> im Verzeichnis <strong>/etc/security</strong> eingerichtet.</p></li></ol><p>
Diese beiden Schritte werden in den Abschnitten "Aktivierung der Zeitsteuerung in der Datei common-auth" sowie "Konfiguration der time.conf" ausführlich erklärt. Abschließende <a class="crosslink" href="#Beispiele">Beispiele</a> verdeutlichen die Anwendung und decken typische Nutzungsmöglichkeiten ab.</p><div class="section_2"><h3 id="Aktivierung-der-Zeitsteuerung-in-der-Datei-common-auth">Aktivierung der Zeitsteuerung in der Datei common-auth<a class="headerlink" href="#Aktivierung-der-Zeitsteuerung-in-der-Datei-common-auth">¶</a></h3><p>
Damit die Zeitsteuerung überhaupt aktiviert wird, muss sie für den Service <strong>common-auth</strong> in der gleichnamigen Konfigurationsdatei <strong>common-auth</strong> im Verzeichnis <strong>/etc/pam.d</strong> eingetragen werden.</p><p>Aktivierung: Mit Root-Rechten<sup><a href="#source-2">[2]</a></sup> in einem Texteditor folgenden Eintrag am Ende der Konfigurationsdatei <strong>/etc/pam.d/common-auth</strong> einfügen<sup><a href="#source-3">[3]</a></sup>:
</p><pre class="notranslate">account required pam_time.so</pre><p>
Es erscheint dann bei der Anmeldung am <a class="internal" href="./displaymanager.html">Displaymanager</a> der Hinweis "<code class="notranslate">Passwort ungültig, bitte wiederholen</code>" (Ubuntu), "<code class="notranslate">Falsches Passwort, bitte wiederholen</code>" (Derivate von Ubuntu) oder ein ähnlicher Hinweis.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Es ist kein Eintrag in der Service-Konfigurationsdatei eines <a class="internal" href="./displaymanager.html">Displaymanagers</a> wie <a class="internal" href="./lightdm.html">Lightdm</a> (<strong>/etc/pam.d/lightdm</strong>) nötig. Die Aktivierung der Zeitsteuerung ist auch in der <a class="internal" href="./terminal.html#Virtuelle-Konsole">virtuelle Konsole</a> wirksam.
</p></div></div></div><div class="section_2"><h3 id="Konfiguration-der-time-conf">Konfiguration der time.conf<a class="headerlink" href="#Konfiguration-der-time-conf">¶</a></h3><p>
Nach der Aktivierung im vorherigen Schritt kann die gewünschte Zeitsteuerung, was wann verboten oder erlaubt werden soll, wie folgt mit einem Texteditor<sup><a href="#source-3">[3]</a></sup> mit Root-Rechten<sup><a href="#source-2">[2]</a></sup> in der Datei <strong>/etc/security/time.conf</strong> konfiguriert werden.</p><div class="section_3"><h4 id="Aufbau">Aufbau<a class="headerlink" href="#Aufbau">¶</a></h4><p>
Eine Konfiguration besteht aus mindestens einer Zeile, welche grundsätzlich so aufgebaut ist:
</p><pre class="notranslate">login ; ttys ; users ; times</pre><p>
Jede Zeile besteht aus vier Spalten, welche durch ein Semikolon "<code class="notranslate">;</code>" voneinander getrennt werden. Spalten zwischen den Semikolons können anstatt durch ein Leerzeichen durch den <a class="crosslink" href="#Moegliche-Operatoren">Platzhalter</a> <code class="notranslate">*</code> freigehalten werden. Das bedeutet, dass beispielsweise ein <code class="notranslate">*</code> in der Spalte <code class="notranslate">users</code> keine Einschränkungen der Benutzer macht: Diese Regel in dieser Zeile gilt dann also für alle Benutzer.</p></div><div class="section_3"><h4 id="Ausfuellhilfe">Ausfüllhilfe<a class="headerlink" href="#Ausfuellhilfe">¶</a></h4><p>
</p><ul><li><p>Die erste Spalte muss grundsätzlich nicht verändert werden, da im Artikel nur Logins konfiguriert werden sollen.</p></li><li><p><code class="notranslate">ttys</code> setzt man am besten auf <code class="notranslate">*</code>, um wirklich alle alle möglichen Orte von Loginversuchen grundsätzlich auszuschließen.</p></li><li><p>Für <code class="notranslate">users</code> wird der Benutzer eingetragen, welcher mit dieser Zeile zeitlich beschränkt werden soll.</p></li><li><p>Bei <code class="notranslate">times</code> werden die erlaubten Zeiten für den Benutzer eingetragen.</p></li></ul><p>
Eine Umkehrung durch Operatoren wie <code class="notranslate">!</code> (Logisches "Nicht") ist möglich:
</p><pre class="notranslate">login ; * ; users ; !times</pre><p>
Dann darf sich der Benutzer, welcher für <code class="notranslate">users</code> einzusetzen ist, nicht in den Zeiten, die für <code class="notranslate">times</code> einzusetzen sind, einloggen.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p><code class="notranslate">login</code> ist der Service, auf den sich der Artikel mit seinen Erklärungen und Beispielen bezieht. Experten haben hier erweiterte Konfigurationsmöglichkeiten, die der Artikel aufgrund ihrer Komplexität nicht abdecken kann. Mit <code class="notranslate">login</code> sind bereits häufige Nutzungsmöglichkeiten sehr gut abgedeckt.
</p></div></div><p>Die vollständigen Möglichkeiten werden in den folgenden Tabellen beschrieben und anschließend in <a class="crosslink" href="#Beispiele">Beispielen</a> konkret mit eingesetzten Benutzern und Zeiten angewendet.</p></div><div class="section_3"><h4 id="Parameter-Spalte-1-4">Parameter (Spalte 1-4)<a class="headerlink" href="#Parameter-Spalte-1-4">¶</a></h4><p>
Folgende Parameter sind zwingender Bestandteil der <strong>time.conf</strong>:
</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2"> Konfiguration </td></tr><tr class="kopf"><td> Parameter </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">services</code> </td><td> Eine logische Liste der PAM Service Namen, für die die Regel gilt. Für Logins wird immer einfach <code class="notranslate">login</code> eingetragen. </td></tr><tr><td> <code class="notranslate">ttys</code> </td><td> Eine logische Liste der Terminal Namen, für die diese Regel gilt. Empfehlung: <code class="notranslate">*</code> für alle Terminals (und virtuelle Konsolen) </td></tr><tr><td> <code class="notranslate">users</code> </td><td> Eine logische Liste von Benutzernamen. Sie werden so voneinander getrennt: Benutzer01|Benutzer02 </td></tr><tr><td> <code class="notranslate">times</code> </td><td> Eine logische Liste von Tagen und Zeitspannen. Beispiele in den folgenden Tabellen. </td></tr><tr><td> <code class="notranslate">#</code> </td><td> Leitet eine Kommentarzeile oder einen Kommentar am Ende einer Zeile ein. Kommentare werden von <strong>pam_time</strong> nicht ausgewertet. Damit kann man eigene Anpassungen dokumentieren oder deaktivieren.  </td></tr></table><div class="section_4"><h5 id="Tagesbezeichnungen">Tagesbezeichnungen<a class="headerlink" href="#Tagesbezeichnungen">¶</a></h5><p>
</p><p>
</p><table style="width: 57%"><tr class="titel"><td colspan="2"> Mögliche Bezeichnungen für Tage im Abschnitt <code class="notranslate">times</code> </td></tr><tr class="kopf"><td> Bezeichnung </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">Mo</code> </td><td> montags </td></tr><tr><td> <code class="notranslate">Tu</code> </td><td> dienstags </td></tr><tr><td> <code class="notranslate">We</code> </td><td> mittwochs </td></tr><tr><td> <code class="notranslate">Th</code> </td><td> donnerstags </td></tr><tr><td> <code class="notranslate">Fr</code> </td><td> freitags </td></tr><tr><td> <code class="notranslate">Sa</code> </td><td> sonnabends </td></tr><tr><td> <code class="notranslate">Su</code> </td><td> sonntags </td></tr><tr><td> <code class="notranslate">Wk</code> </td><td> wochentags </td></tr><tr><td> <code class="notranslate">Wd</code> </td><td> an Wochenenden </td></tr><tr><td> <code class="notranslate">Al</code> </td><td> an allen Tagen </td></tr></table><p>Die Tage bestehen also jeweils aus zwei Zeichen. Sie können miteinander kombiniert werden. Dabei gibt es jedoch einige Besonderheiten zu beachten.</p></div><div class="section_4"><h5 id="Besonderheiten-bei-Tagen">Besonderheiten bei Tagen<a class="headerlink" href="#Besonderheiten-bei-Tagen">¶</a></h5><p>
</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2"> Besonderheiten bei der Kombination von Tagen </td></tr><tr class="kopf"><td> Kombination </td><td> Erklärung </td></tr><tr><td> <code class="notranslate">MoMo</code> </td><td> Wiederholte Tage werden wie ungenannte Tage behandelt, also deaktiviert. <code class="notranslate">MoMo</code> hebt also den Montag auf, was dazu führt, dass in diesem Beispiel gar kein Tag aktiviert ist. </td></tr><tr><td> <code class="notranslate">MoWk</code> </td><td> Verschiedene Tage werden wie Ausnahmen kombiniert, also die Teilmenge von der Gesamtmenge ausgeschlossen. Alle Wochentage außer Montage. </td></tr><tr><td> <code class="notranslate">AlFr</code> </td><td> Alle Tage außer Freitag.  </td></tr></table></div><div class="section_4"><h5 id="Uhrzeitformat">Uhrzeitformat<a class="headerlink" href="#Uhrzeitformat">¶</a></h5><p>
</p><p>
</p><table style="width: 57%"><tr class="titel"><td colspan="2"> Format der Uhrzeit-Angaben </td></tr><tr class="kopf"><td> Format </td><td> Erklärung </td></tr><tr><td> <code class="notranslate">HHMM</code> </td><td> Stunde und Minute im 24-Stunden-Format </td></tr><tr><td> <code class="notranslate">HHMM-HHMM</code> </td><td> Start- und Endzeit der Regel </td></tr></table></div></div><div class="section_3"><h4 id="Moegliche-Operatoren">Mögliche Operatoren<a class="headerlink" href="#Moegliche-Operatoren">¶</a></h4><p>
</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2"> Mögliche Operatoren für alle vier Parameter </td></tr><tr class="kopf"><td> Verfügbare Operatoren </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">!</code> </td><td> Logisches "Nicht". Alles außer der folgende Parameter. </td></tr><tr><td> <code class="notranslate">&amp;</code> </td><td> Logisches "Und". Als Kombination zweier Parameter zwischen diesen platziert. Gilt für beide Elemente. </td></tr><tr><td> <code class="notranslate">|</code> </td><td> Logisches "Oder". Als Oder zweier Parameter zwischen diesen platziert. Gilt für eins Elemente, welches zutreffen muss. </td></tr><tr><td> <code class="notranslate">*</code> </td><td> Platzhalter für alle möglichen Elemente eines Parameters. Kann allein stehen oder ein Teilelement erweitern. </td></tr></table><p>Diese Konfigurationen sind sofort und ohne Neustart des Computers wirksam.</p></div></div></div><div class="section_1"><h2 id="Beispiele">Beispiele<a class="headerlink" href="#Beispiele">¶</a></h2><p>
</p><div class="section_2"><h3 id="Kurze-Beispiele-zum-Verstaendnis">Kurze Beispiele zum Verständnis<a class="headerlink" href="#Kurze-Beispiele-zum-Verstaendnis">¶</a></h3><p>
</p><p>
</p><table style="width: 97%"><tr class="titel"><td colspan="2"> Beispiele für die <strong>time.conf</strong> </td></tr><tr class="kopf"><td style="width: 40%"> Beispiel </td><td> Erklärung </td></tr><tr><td> <code class="notranslate">* ; * ; alice ; !SuMoTuWeTh2200-0700</code> </td><td> Für alle PAM Services aus dem Verzeichnis <strong>/etc/pam.d</strong> auf allen virtuellen Konsolen und Terminals gilt für Benutzer <strong>alice</strong> ein Nutzungsverbot von 22.00 Uhr bis 07.00 Uhr an allen Tagen, außer Freitag und Sonnabend. Hinweis: Für Logins ist <code class="notranslate">login</code> in erster Spalte empfohlen. </td></tr><tr><td> <code class="notranslate">login;tty* &amp; !pts*;du|ich;!Al0000-2400</code> </td><td> Der Benutzer <strong>du</strong> oder <strong>ich</strong> darf sich ganztags an allen Tagen auf allen <a class="internal" href="./terminal.html#Virtuelle-Konsole">virtuellen Konsolen</a> (<code class="notranslate">tty*</code>) nicht einloggen (<code class="notranslate">login</code>). An Terminals (<code class="notranslate">pty*</code>) gilt die Sperre nicht. Hinweis: Empfehlung ist eine generelle Sperre durch <code class="notranslate">*</code> anstatt <code class="notranslate">tty* &amp; !pts*</code> </td></tr><tr><td> <code class="notranslate">login ; * ; !tom ; WdMo0300-0400</code> </td><td> Benutzer <strong>tom</strong> darf sich am Wochenende und an Montagen in der Zeit von 03.00 Uhr bis 04.00 Uhr an keiner (<code class="notranslate">*</code>) der virtuellen Konsolen oder Terminals anmelden (<code class="notranslate">login</code>). Der Nutzer <strong>tom</strong> sollte sich damit aber nicht wirklich selbst aussperren, falls er der einzige <a class="internal" href="./sudo.html">Root</a>-Nutzer ist. Hinweis: <code class="notranslate">!tom</code> ist hier logisch gleichwertig mit <code class="notranslate">!WdMo0300-0400</code>: Die Aussage, dass <strong>tom</strong> nirgends in den angegebenen Zeiten einloggen darf, bleibt diesselbe - das <code class="notranslate">!</code> ist also sowohl direkt vor dem Benutzer als auch vor der Zeit möglich möglich. </td></tr></table></div><div class="section_2"><h3 id="Nutzungszeit-des-Computers-einschraenken-vollstaendiges-Anwendungsbeispiel">Nutzungszeit des Computers einschränken (vollständiges Anwendungsbeispiel)<a class="headerlink" href="#Nutzungszeit-des-Computers-einschraenken-vollstaendiges-Anwendungsbeispiel">¶</a></h3><p>
Ziel ist eine leicht umsetzbare Lösung für eine Kindersicherung durch Beschränkung der Nutzungszeit, welche den Login außer am Wochenende (So-Do) 22 bis 7 Uhr verhindert. Sollte man zu der Zeit noch eingeloggt sein, bekommt man 20 min vor Schluss ein Hinweisfenster und danach fährt der Computer um 22 Uhr herunter. Ein erneuter Login soll durch eine Anmeldesperre bis 7 Uhr morgens nicht mehr möglich sein. Danach kann man den Computer wieder betreiben, bis er spätestens 22 Uhr wieder herunterfährt.</p><div class="section_3"><h4 id="pam-time-aktivieren-und-konfigurieren">pam_time aktivieren und konfigurieren<a class="headerlink" href="#pam-time-aktivieren-und-konfigurieren">¶</a></h4><p>
Zunächst wird die Zeitsteuerung aktiviert, danach konfiguriert, wie im Abschnitt <a class="crosslink" href="#Anwendung">Anwendung</a> beschrieben. Die benötigten zwei Einträge am Ende der beiden Dateien kann man mit zwei <a class="internal" href="./echo.html">echo</a>-Befehlen in Verbindung mit <a class="internal" href="./shell/umleitungen.html#tee-Ausgabe-verdoppeln">tee</a> automatisch vornehmen lassen, wenn man die gewünschten Werte einträgt:
</p><div class="bash"><div class="contents"><pre class="notranslate">echo 'account required pam_time.so' | sudo tee -a /etc/pam.d/common-auth
echo '* ; * ; username ; !SuMoTuWeTh2200-0700' | sudo tee -a /etc/security/time.conf </pre></div></div><p>
Man muss die Dateien also nicht manuell bearbeiten, sondern passt die Werte in diesen echo-Befehlen an und führt die Befehle aus. Das verhindert, dass man versehentlich in einem Editor wichtige vorhandene Systemeinstellungen in den Dateien zerstört und lässt sich bequem ohne besonderes Vorwissen ins Terminal kopieren.</p><p>Für <code class="notranslate">username</code> trägt man den Nutzernamen des Kindes (in Kleinbuchstaben) ein. <code class="notranslate">!SuMoTuWeTh2200-0700</code> ist die Uhrzeit der Anmeldungssperre im Format <code class="notranslate">HHMM-HHMM</code> (<code class="notranslate">HH</code>=Stunde, <code class="notranslate">MM</code>=Minute), wobei zurerst die Start- und dann die Endzeit eingetragen wird. Das "<code class="notranslate">!</code>" bedeutet, dass zu der Zeit der Zugang gesperrt wird. <code class="notranslate">SuMoTuWeTh</code> bedeutet gültig am "Sonntag Montag Dienstag Mittwoch Donnerstag" zu der eingetragenen Uhrzeit. Die Sperre ist also am Freitag (<code class="notranslate">Fr</code>) und Samstag (<code class="notranslate">Sa</code>) aufgehoben.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Auf exakte Schreibweise des Formates achten! Keine Leerzeichen zwischen den Tagen!
</p></div></div></div><div class="section_3"><h4 id="Cron-konfigurieren">Cron konfigurieren<a class="headerlink" href="#Cron-konfigurieren">¶</a></h4><p>
Eine wirksame Loginsperre kann leicht dadurch umgangen werden, indem sich der Benutzer zur gewünschten Sperrzeit einfach nicht ausloggt. Mit der Zeitsteuerung <a class="internal" href="./cron.html#Die-systemweite-Cron-Tabelle-etc-crontab">Cron</a> kann man dieses Ausloggen in Sperrzeiten erzwingen. Daher ist dieser zusätzliche Schritt für eine wirksame zeitliche Zugangsbeschränkung im Sinne etwa einer Kindersicherung streng empfohlen bzw. nötig.</p><p>
</p><table style="float: left; clear: right; margin-top: 0px; border: none"><tr class="titel"><td> <img alt="pam_time-cron-zenity.png" class="image-default" src="./_/e07dc87b6e9cdbd55c5d6bbd24840f423e8a5c4d.png"/></td></tr><tr class="normal"><td style="text-align: center; width: 300px"> Ankündigung</td></tr></table><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Falls man <a class="internal" href="./kubuntu.html">Kubuntu</a> benutzt, sollte man noch <a class="internal" href="./zenity.html#Installation">Zenity</a> nachinstallieren, damit das Kind ein Hinweisfenster vor dem Herunterfahren bekommt.
</p></div></div><p>Dazu werden mit Root-Rechten<sup><a href="#source-2">[2]</a></sup> vier Zeilen ganz am Ende der Datei <a class="internal" href="./cron.html#Die-systemweite-Cron-Tabelle-etc-crontab">/etc/crontab</a> eingetragen, welche für die Zeitsteuerung des Herunterfahrens verantwortlich ist. Auch in diesem Beispiel erfolgen die Eintragungen über echo-Befehle im Terminal.</p><div class="bash"><div class="contents"><pre class="notranslate">echo '### kidstime' | sudo tee -a /etc/crontab
echo '00   22   * * 1-4     root   shutdown -h now' | sudo tee -a /etc/crontab
echo '40   21   * * 1-4     username   DISPLAY=:0 LANG=de_DE.UTF-8 zenity --info --text "Hallo liebes Kind. Bitte beende deine Aktivitäten. Für heute ist Schluss. In 20 min wird der Computer automatisch ausgeschalten..."' | sudo tee -a /etc/crontab
echo '# Ende (als letzte Zeile der Crontab unbedingt benötigt!)' | sudo tee -a /etc/crontab </pre></div></div><p>
Zeilen 1 und 4 sind lediglich erläuternde Kommentare, welche in die Konfigurationsdatei <strong>/etc/crontab</strong> eingetragen werden sollten. Die letzte Zeile muss sogar eingetragen werden, da die letzte Zeile immer eine Kommentarzeile (oder eine eingefügte unsichtbare Leerzeile) sein muss.</p><p>Zeile 2: <code class="notranslate">00   22</code> ist die Uhrzeit, zu der der Computer herunterfahren soll. Sie wird im Format <code class="notranslate">MM   HH</code> eingetragen. Im Beispiel fährt der Computer um 22.00 Uhr herunter und zwar am Wochentag <code class="notranslate">1-4</code>, von Sonntag zu zählen beginnend: <code class="notranslate">1</code>=Sonntag, <code class="notranslate">4</code>=Donnerstag.</p><p>Zeile 3: Um 21.40 Uhr, gekennzeichnet als <code class="notranslate">40   21</code> in Zeile 3, erfolgt ein Hinweisfenster beim zuerst (bzw. allein) eingeloggten Benutzer. <code class="notranslate">1-4</code> in dieser dritten Zeile ist nochmals die Festlegung der Wochentage. Als <code class="notranslate">username</code> ist wieder der gewünschte Benutzer einzusetzen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Zum Löschen oder Verändern der bearbeiteten Konfigurationsdateien öffnet man sie mit Root-Rechten<sup><a href="#source-2">[2]</a></sup> mit einem Texteditor<sup><a href="#source-3">[3]</a></sup>. Ein vorangestelltes "<code class="notranslate">#</code>" vor einer Zeile deaktiviert diese vorübergehend.
</p></div></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="external" href="http://www.linux-pam.org/" rel="nofollow">PAM-Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-man" href="http://manpages.ubuntu.com/cgi-bin/search.py?lr=lang_en&amp;q=pam_time">pam_time</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Manpage</p></li><li><p><a class="external" href="http://tldp.org/HOWTO/User-Authentication-HOWTO/x115.html" rel="nofollow" title="http://tldp.org/HOWTO/User-Authentication-HOWTO/x115.html">http://tldp.org/HOWTO/User-Authentication-HOWTO/x115.html</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - mehr Hintergrundinformationen zu <strong>PAM</strong></p></li><li><p><a class="external" href="http://linuxwiki.de/PAM" rel="nofollow" title="http://linuxwiki.de/PAM">http://linuxwiki.de/PAM</a> - Linuxwiki: Was man mit PAM noch alles machen kann</p></li><li><p><a class="interwiki interwiki-askubuntu" href="http://askubuntu.com/questions/68918/how-do-i-restrict-my-kids-computing-time">How do I restrict my kids computing time?</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-askubuntu" href="http://askubuntu.com/questions/183530/how-to-lock-yourself-out-of-the-primary-account-temporarily">How to lock yourself out of the primary account temporarily?</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - pam_time in <a class="internal" href="./lightdm.html">LightDM</a> einbinden</p></li><li><p><a class="interwiki interwiki-ubuntu_fr" href="http://doc.ubuntu-fr.org/tutoriel/restrictions_horaires">Les restrictions horaires sous Linux</a> <img alt="{fr}" src="./_/a4d7caed6af30e5c7549b4de45c71ed5f7036425.png"/> im franz. Ubuntu-Wiki</p></li><li><p><a class="interwiki interwiki-github" href="https://github.com/grover66/kidtimer">kidtimer</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Shell-Skript zur Einschränkung der Benutzerzeit</p></li><li><p><a class="crosslink topic" href="https://forum.ubuntuusers.de/topic/timekpr-und-nanny-ersatz-fuer-xubuntu/">timekpr- und nanny-Ersatz</a> - weitere Skript-Lösung</p></li><li><p><a class="internal" href="./kinder.html">Kinder</a> <img alt="{Übersicht}" src="./_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Zugang von Kindern zum Rechner, zum Internet oder zu Programmen beschränken</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./pam_time/a/revision/942304.html">Diese Revision</a> wurde am 30. Juni 2017 11:16 von <a href="https://ubuntuusers.de/user/Numblesix/">Numblesix</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./pam_time.html">pam time</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>