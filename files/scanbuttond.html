<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>scanbuttond › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./scanbuttond.html">scanbuttond</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/scanbuttond">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./scanbuttond/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./scanbuttond/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./scanbuttond/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./scanbuttond/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./scanbuttond/a/backlinks.html">scanbuttond</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p>
</p><ul><li><p><a class="internal" href="./trusty_tahr.html">Ubuntu 14.04</a> Trusty Tahr</p></li></ul></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./pakete_installieren.html">Installation von Programmen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./sudo.html">Root-Rechte</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./rechte.html">Rechte für Dateien und Ordner ändern</a></p></li><li><p><a class="crosslink anchor" href="#source-4" id="source-4"></a> <a class="internal" href="./editor.html">Einen Editor öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-5" id="source-5"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Konfiguration">Konfiguration
</a></li><li><a class="crosslink" href="#Skript-Beispiele">Skript-Beispiele
</a><ol class="arabic"><li><a class="crosslink" href="#PDF-mit-Textlayer">PDF mit Textlayer
</a></li></ol></li><li><a class="crosslink" href="#Mehrfachbelegung-von-Tasten">Mehrfachbelegung von Tasten
</a></li><li><a class="crosslink" href="#Tipps">Tipps
</a></li><li><a class="crosslink" href="#Alternativen">Alternativen
</a></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/scanner.png" class="image-left" src="./_/ee4a3591249f62064820c5a1575aad439751f4f0.png"/>
Viele Scanner haben Tasten, mit denen sich Vorlagen direkt kopieren, faxen oder mailen lassen. Leider ist Software, die diese Tasten überwacht und nutzbar macht, in vielen Fällen nur für proprietäre Betriebssysteme verfügbar. <a class="interwiki interwiki-sourceforge2" href="http://scanbuttond.sourceforge.net">scanbuttond</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> hilft, diese Tasten auch unter Linux zu nutzen. Momentan werden Scanner von <a class="internal" href="./scanner/epson.html">Epson</a>, <a class="internal" href="./scanner/canon.html">Canon</a>, <a class="internal" href="./scanner/agfa_snapscan.html">Agfa</a> und <a class="internal" href="./hplip.html">HP</a> unterstützt. Eine genaue Liste der jeweiligen Modelle findet man auf der <a class="external" href="http://scanbuttond.sourceforge.net/index.php?page=/Supported_Scanners.php" rel="nofollow">Hardwareseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> der Projektseite. Für Brother-Geräte und die KDE-Oberfläche gibt es auch <a class="internal" href="./scanbuttond.html#Alternativen">Alternativen</a> zu Scanbuttond.</p><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Zuerst muss das folgende Paket installiert <sup><a href="#source-1">[1]</a></sup> werden:</p><ul><li><p><strong>scanbuttond</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install scanbuttond </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install scanbuttond </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Konfiguration">Konfiguration<a class="headerlink" href="#Konfiguration">¶</a></h2><p>
Die benötigten Dateien <strong>initscanner.sh</strong> und <strong>buttonpressed.sh</strong> existieren zunächst nur als Beispieldateien (angehängtes ".example") im Verzeichnis <strong>/etc/scanbuttond</strong>. Um diese Dateien umzubenennen und zu bearbeiten, benötigt man Root-Rechte <sup><a href="#source-2">[2]</a></sup>. Nachdem man die beiden Konfigurationsdateien erstellt bzw. umbenannt hat, müssen diese noch ausführbar gemacht werden <sup><a href="#source-3">[3]</a></sup>.</p><p>Damit der Scanner auch gefunden wird, muss in der neu erzeugten Datei <strong>/etc/scanbuttond/initscanner.sh</strong> der Befehl</p><pre class="notranslate">sane-find-scanner</pre><p>aktiviert werden <sup><a href="#source-4">[4]</a></sup>.</p><p>Nun startet man im Terminal <sup><a href="#source-5">[5]</a></sup> scanbuttond per</p><div class="bash"><div class="contents"><pre class="notranslate">scanbuttond -f </pre></div></div><p>im Vordergrund. Wenn man jetzt die Tasten am Scanner drückt, sollte das Terminal eine Meldung ausgeben, die jeder gedrückten Taste eine eindeutige Nummer zuordnet. In etwa so:</p><pre class="notranslate">button 1 has been pressed on plustek:libusb:002:005
button 2 has been pressed on plustek:libusb:002:005
button 3 has been pressed on plustek:libusb:002:005</pre><p>Diese Zuordnung sollte man sich merken, sie wird später bei der Einrichtung der Aktionen noch gebraucht.</p><p>scanbuttond arbeitet mit Bash-Skripts, d.h. beim Drücken einer Scanner-Taste wird die Nummer der Taste an das Skript <strong>buttonpressed.sh</strong> im Verzeichnis <strong>/etc/scanbuttond/</strong> übergeben. Das Skript startet dann abhängig von der Taste eine Aktion. Im Skript sieht das dann ungefähr so aus:</p><pre class="notranslate">#!/bin/sh

# This script[...]like scanimage.

TMPFILE="/tmp/scan.tiff"
LOCKFILE="/tmp/copy.lock"

case $1 in
        1)
                echo "button 1 has been pressed on $2"
                ;;
        2)
                echo "button 2 has been pressed on $2"
                ;;
        3)
                echo "button 3 has been pressed on $2"
                ;;
        4)
                echo "button 4 has been pressed on $2"
                ;;
esac</pre><p>Momentan gibt das Skript nur aus, welche Taste gedrückt wurde; dieses Verhalten gilt es nun zu ändern. Dazu öffnet man die Skript-Datei mit einem Texteditor <sup><a href="#source-3">[3]</a></sup> und trägt die gewünschten Kommandos an den entsprechenden Stellen anstatt des echo-Befehls ein, z.B. „scanimage &gt; bild.pnm“, um ein Dokument unter Verwendung der Standardeinstellungen einzuscannen und als <strong>bild.pnm</strong> zu speichern. Wenn nun die entsprechende Taste gedrückt wird, startet sofort die festgelegte Aktion, in diesem Fall das Speichern des Scans im eigenen Ordner.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Sollte ein Scanner mehr als 4 Tasten besitzen, so kann man das Skript einfach erweitern, indem man weitere nummerierte Zeilen unter '4)' einfügt. 
</p></div></div><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Anstatt die Kommandos direkt in <strong>buttonpressed.sh</strong> einzutragen, könnte man weitere Skripte aufrufen. Siehe dazu auch die weiterführende <a class="external" href="http://gentoo-wiki.info/TIP_Scanner_buttons_and_one-touch_scanning" rel="nofollow">Anleitung im Gentoo-Wiki</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>
</p></div></div><p>Hat man die gewünschten Änderungen getätigt, speichert man die Datei. Nun kann man noch unter <em>"System -&gt; Einstellungen -&gt; Startprogramme"</em> den Eintrag <code class="notranslate">scanbuttond -f</code> hinzufügen und zukünftig nach jeder Anmeldung die programmierten Scannertasten sofort nutzen.</p></div><div class="section_1"><h2 id="Skript-Beispiele">Skript-Beispiele<a class="headerlink" href="#Skript-Beispiele">¶</a></h2><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Um diese Skripte nutzen zu können, müssen die Pakete
</p><ul><li><p><strong>netpbm</strong></p></li><li><p><strong>libtiff-tools</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install netpbm libtiff-tools </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install netpbm libtiff-tools </pre></div></div><p>
</p></div></div><p>installiert <sup><a href="#source-1">[1]</a></sup> sein.</p><p>Außerdem müssen die Skripte ausführbar<sup><a href="#source-3">[3]</a></sup> gemacht werden.</p><p>Ggf. sind nicht alle in den Skripten verwendeten Option für alle Scanner verwendbar - Auskunft darüber erhält man mit dem Aufruf von <code class="notranslate">scanimage --help</code>.
</p></div></div><p>Hier das für Skripte angepasste <strong>buttonpressed.sh</strong> sowie einige Beispiel-Skripte für Scannen, Kopieren und Mailen.</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nv">TMPDIR</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/Desktop"</span>                              <span class="c1">#hier wird ein Verzeichnis für die Datei festgelegt; durch die Verwendung der Umgebungsvariable $HOME wird jedesmal der Desktop des aktuellen Benutzers verwendet</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$TMPDIR</span><span class="s2">/scan`date +%Y%m%d`-`date +%H%M%S`"</span> <span class="c1">#wir generieren uns hier den Dateinamen für das spätere Ergebnis; der Name besteht aus dem Präfix scan und wird jedesmal um Datum und Uhrzeit ergänzt</span>
                                                    <span class="c1">#Dateinamenerweiterungen werden später hinzugefügt</span>
<span class="nv">LOCKFILE</span><span class="o">=</span><span class="s2">"/tmp/copy.lock"</span>                           <span class="c1">#Variable für das Lockfile, das kennzeichnet, ob der Scanner schon in Benutzung ist; wird hier nicht verwendet</span>

<span class="k">case</span> <span class="nv">$1</span> in
        <span class="m">1</span><span class="o">)</span>      <span class="nb">echo</span> <span class="s2">"Button 1 pressed"</span>                        <span class="c1">#wird Button 1 gedrückt so wird eine Meldung ausgegeben (nur sichtbar, wenn scanbuttond im Vordergrund läuft - zum Debuggen)</span>
                <span class="nv">$HOME</span>/.scanscripts/scan.sh <span class="nv">$TMPFILE</span> <span class="nv">$DEVICE</span>    <span class="c1">#und das Skript scan.sh im versteckten Ordner .scanscripts im Homeverzeichnis gestartet; zusätzlich werden noch Name und Ort des Tempfiles,</span>
                <span class="p">;;</span>                                             <span class="c1">#sowie die Adresse des Scanners übergeben, sinnvoll bei mehr als einem Scanner</span>

        <span class="m">2</span><span class="o">)</span>      <span class="nb">echo</span> <span class="s2">"Button 2 pressed"</span>                        <span class="c1">#wird Button 2 gedrückt, so wird eine Meldung ausgegeben (siehe oben)</span>
                <span class="nv">$HOME</span>/.scanscripts/copy.sh <span class="nv">$TMPFILE</span> <span class="nv">$DEVICE</span>    <span class="c1">#und das Skript copy.sh im versteckten Ordner .scanscripts im Homeverzeichnis gestartet; zu übergebenen Attributen siehe oben</span>
                <span class="p">;;</span>
        <span class="m">3</span><span class="o">)</span>      <span class="nb">echo</span> <span class="s2">"Button 3 pressed"</span>                        <span class="c1">#wird Button 3 gedrückt, so wird eine Meldung ausgegeben (siehe oben)</span>
                <span class="nv">$HOME</span>/.scanscripts/mail.sh <span class="nv">$TMPFILE</span> <span class="nv">$DEVICE</span>    <span class="c1">#und das Skript mail.sh im versteckten Ordner .scanscripts im Homeverzeichnis gestartet; zu übergebenen Attributen siehe oben</span>
                <span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</td></tr></table></div><p>Hier das Skript zum einfachen Scannen (<strong>scan.sh</strong>)</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span> <span class="c1">#Enthält zukünftigen Speicherort und Dateiname des Scans</span>

scanimage --format pnm --mode Color --depth <span class="m">8</span> --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 215mm -y 280mm --lampoff-time <span class="m">300</span> &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="c1">#scanimage scannt die Vorlage und speichert sie als Dateiname.pnm,</span>
                                                                                                                               <span class="c1">#die einzelnen Optionen sind von Scanner zu Scanner unterschiedlich (hier Farbscan</span>
                                                                                                                               <span class="c1">#in einer Auflösung von 300dpi)</span>

pnmtojpeg -quality <span class="m">85</span> -optimize -comment <span class="s2">"was immer man als Kommentar haben will"</span> <span class="nv">$TMPFILE</span>.pnm &gt; <span class="nv">$TMPFILE</span>.jpeg <span class="c1"># die .temp-Datei wird mittels pnmtojpeg in eine jpeg-Datei umgewandelt und dabei komprimiert</span>

rm -f <span class="nv">$TMPFILE</span>.pnm  <span class="c1">#jetzt muss nur noch die temporäre Datei gelöscht werden</span>
</pre></div>
</td></tr></table></div><p>Und hier zum Kopieren (<strong>copy.sh</strong>)</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>  <span class="c1">#siehe Skript zum Scannen</span>
scanimage --format tiff --mode Gray --resolution <span class="m">300</span> --brightness -3 -l <span class="m">0</span> -t <span class="m">0</span> -x 215mm -y 297mm &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.tiff  <span class="c1">#scannt das Bild ein und speichert es als tiff (hier in Graustufen und Auflösung 300dpi)</span>

tiff2ps -z -w <span class="m">8</span>.27 -h <span class="m">11</span>.69 <span class="nv">$TMPFILE</span>.tiff <span class="p">|</span> lpr   <span class="c1"># eingescanntes Bild wird in Postscript umgewandelt und an den Standarddrucker gesendet</span>

rm -f <span class="nv">$TMPFILE</span>.tiff  <span class="c1">#temporäre Datei wird gelöscht</span>
</pre></div>
</td></tr></table></div><p>Zum Schluss noch eines zum Versenden per Mail (<strong>mail.sh</strong>):</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>  <span class="c1">#siehe Skript zum Scannen</span>
scanimage --format pnm --mode Color --depth <span class="m">8</span> --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 215mm -y 280mm --lampoff-time <span class="m">300</span> &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm  <span class="c1">#scannt das Bild ein und speichert es als pnm</span>

pnmtojpeg -quality <span class="m">85</span> -optimize -comment <span class="s2">"was immer man als Kommentar haben will"</span> <span class="nv">$TMPFILE</span>.pnm &gt; <span class="nv">$TMPFILE</span>.jpeg    <span class="c1">#wandelt das Bild von pnm zu jpeg um</span>

rm -f <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="c1">#temporäre Datei wird gelöscht</span>

<span class="c1">#hier wird Evolution zum Versenden eingesetzt</span>
evolution --display<span class="o">=</span>:0.0 <span class="s2">"mailto:?attach=</span><span class="nv">$TMPFILE</span><span class="s2">.jpeg"</span> <span class="c1">#öffnet Evolutions Maileditor und fügt das Bild als Anhang hinzu</span>
</pre></div>
</td></tr></table></div><p>Falls scanbuttond nicht über einen Eintrag in die <strong>rc.local</strong> gestartet wurde, sondern der Dienst über die <strong>/etc/default/scanbuttond</strong>-Datei aktiviert wurde, kann es beim mail-Skript zu folgender Fehlermeldung kommen:</p><pre class="notranslate">Cannot start Evolution. Another Evolution instance may be unresponsive. System Error: Cannot autolaunch D-Bus without X11 $DISPLAY</pre><p>Abhilfe schafft es ggf., in der letzte Zeile Evolution mit folgendem Befehl aufzurufen:</p><pre class="notranslate">$(DISPLAY=:0 evolution "mailto:?attach=$TMPFILE.jpeg")</pre><div class="section_2"><h3 id="PDF-mit-Textlayer">PDF mit Textlayer<a class="headerlink" href="#PDF-mit-Textlayer">¶</a></h3><p>
Um eine PDF-Datei mit Textlayer zu erstellen (verwendet wird <a class="internal" href="./ocrmypdf.html">OCRmyPDF</a>) kann folgendes Skript (z.B. als <strong>pdf.sh</strong>) verwendet werden, was man zweckmäßigerweise mit dem PDF-Knopf am Scanner aufruft (dazu das <strong>buttonpressed.sh</strong> entsprechend erweitern):
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>  <span class="c1">#siehe Skript zum Scannen</span>
scanimage --format tiff --mode Gray --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 210mm -y 297mm &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.tiff  <span class="c1">#scannt das Bild ein und speichert es als tiff (hier in Graustufen und Auflösung 300dpi)</span>

tiff2pdf -o <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pdf <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.tiff  <span class="c1"># eingescanntes Bild wird in Pdf umgewandelt und an ocrmypdf übergeben</span>
ocrmypdf -l deu -C no_ligature <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pdf <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.OCR.pdf

rm -f <span class="nv">$TMPFILE</span>.tiff  <span class="c1">#temporäre Datei wird gelöscht</span>
rm -f <span class="nv">$TMPFILE</span>.pdf   <span class="c1">#temporäre PDF-Datei wird gelöscht</span>
</pre></div>
</td></tr></table></div></div></div><div class="section_1"><h2 id="Mehrfachbelegung-von-Tasten">Mehrfachbelegung von Tasten<a class="headerlink" href="#Mehrfachbelegung-von-Tasten">¶</a></h2><p>
Mit etwas Puzzlearbeit ist es möglich, die Tasten des Scanners mit mehreren Funktionen zu belegen. Im folgenden Beispiel wird die Copy-Taste mit den Funktionen S/W-Kopie (ein Tastendruck), Graustufen-Kopie (zwei Tastendrücke) und Farb-Kopie (drei Tastendrücke) belegt. Bei mehr als drei Tastendrücken innerhalb einer Zeitraumes von 5 Sekunden (anpassbar in Zeile 3) wird eine Fehlermeldung ausgegeben. Das hier vorgestellte Beispiel arbeitet mit <a class="internal" href="./yad.html">yad</a> und <a class="internal" href="./usbreset.html">usbreset</a>, um ggf. Fehler bei der Scannerfreigabe zu kompensieren. Das Skript sollte statt über einen Autostart-Eintrag in <strong>rc.local</strong> über die Datei <strong>/etc/default/scanbuttond</strong> gestartet werden, in der neben <code class="notranslate">RUN=yes</code> auch <code class="notranslate">RUN_AS_USER=BENUTZER</code> eingetragen werden sollte. In <strong>/etc/init.d/scanbuttond</strong> ebenfalls den Benutzer ändern, außerdem in Zeile <code class="notranslate">DAEMON_OPTS=</code> den Wert <code class="notranslate">"-p 10000"</code> eintragen (damit wird das Zeitintervall angegeben, wie oft scanbuttond überprüft, ob neue Tastendrücke erfolgt sind).</p><p>Zur Verwendung wird in <strong>/etc/scanbuttond/buttonprresed.sh</strong> folgender Eintrag für die entsprechende Taste abgespeichert:</p><pre class="notranslate">                echo "Button 1 pressed - copy" &gt;&gt; /tmp/scanbutton.log 2&lt;&amp;1                       #wird Button 1 gedrückt so wird eine Meldung ausgegeben (nur sichtbar, wenn scanbuttond im Vordergrund läuft - zum Debuggen, hier wird in die Log-Datei geschrieben)
		PID_FILE=/tmp/scanbutton.pid
		if [ -e $PID_FILE ]; then
    		kill -SIGUSR1 $(&lt;"$PID_FILE") 2&gt;&amp;1 |: #&gt;&gt; /tmp/scanbutton.log
		else
    		rm -f /tmp/scanbutton.log
   		nohup /PFAD/ZUM/.scanscripts/copy_counter.sh $TMPFILE $DEVICE &gt;&gt; /tmp/scanbutton.log 2&lt;&amp;1 &lt; /dev/null &amp;
		fi</pre><p>
Das Skript muss ggf. als bash-Skript gespeichert werden, dazu die <a class="internal" href="./shebang.html">Shebang</a> auf <code class="notranslate">#!/bin/bash</code> ändern. Den Pfad zum <strong>copy_counter.sh</strong>-Skript entsprechend anpassen.</p><p>Das Skript selbst in einen Editor kopieren und als <strong>copy_counter.sh</strong> abspeichern und ausführbar machen:
</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">TIMEOUT</span><span class="o">=</span><span class="m">5</span> <span class="c1"># count button presses after n seconds and take appropriate actions</span>
<span class="nv">PID_FILE</span><span class="o">=</span>/tmp/scanbutton.pid
<span class="nb">echo</span> <span class="nv">$$</span> &gt; <span class="nv">$PID_FILE</span>  <span class="c1"># create a file with our pid</span>

<span class="nb">declare</span> -a BTN_PRESSED
<span class="nv">BTN_PRESSED</span><span class="o">+=(</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="o">)</span>

<span class="k">function</span> cleanup <span class="o">{</span>
    rm -f <span class="s2">"</span><span class="nv">$PID_FILE</span><span class="s2">"</span>
<span class="o">}</span>

<span class="k">function</span> check_runtime <span class="o">{</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">BTN_PRESSED</span><span class="p">[0]</span><span class="si">}</span> -lt <span class="k">$(</span>date +%s -d <span class="s2">"</span><span class="nv">$TIMEOUT</span><span class="s2"> seconds ago"</span><span class="k">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="k">return</span> <span class="m">1</span>  <span class="c1"># the oldest timestamp is older than $TIMEOUT</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="m">0</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># reset usb-connection</span>
<span class="k">function</span> usbrestart <span class="o">{</span>
	usbreset /dev/bus/usb/002/004 <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;&gt; /tmp/scanbutton.log
<span class="o">}</span>

<span class="c1">#scan image</span>
<span class="k">function</span> scan_color <span class="o">{</span>
	<span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$SCANCOLOR</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"BW"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
	scanimage --format pnm --mode Lineart --custom-gamma<span class="o">=</span>yes --gamma-table <span class="m">30000</span> --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 210mm -y 297mm &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="m">2</span>&gt; /tmp/scanimage.txt
	<span class="k">elif</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$SCANCOLOR</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"GR"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
	scanimage --format pnm --mode Gray --swcrop<span class="o">=</span>yes --swdeskew<span class="o">=</span>no --custom-gamma<span class="o">=</span>yes --gamma-table <span class="m">30000</span> --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 210mm -y 297mm &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="m">2</span>&gt; /tmp/scanimage.txt
	<span class="k">elif</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$SCANCOLOR</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"CL"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
	scanimage --format pnm --mode Color --swcrop<span class="o">=</span>no --resolution <span class="m">300</span> -l <span class="m">0</span> -t <span class="m">0</span> -x 210mm -y 297mm &gt; <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="m">2</span>&gt; /tmp/scanimage.txt
	<span class="k">fi</span>
<span class="o">}</span>
<span class="c1">#print image</span>
<span class="k">function</span> print_tiff <span class="o">{</span>
	lpr <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm
	<span class="nb">echo</span> <span class="s2">"Scan sent to printer, ~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
	rm -f <span class="si">${</span><span class="nv">TMPFILE</span><span class="si">}</span>.pnm <span class="c1">#2&gt;&amp;1 &gt; /dev/null |: #temporäre Datei wird gelöscht</span>
<span class="o">}</span>
<span class="c1"># check if SANE-decive is usable, if not reset usb-device and restart the whole process</span>
<span class="k">function</span> check_device <span class="o">{</span>
	<span class="nv">CHECK</span><span class="o">=</span><span class="sb">`</span>cat <span class="s2">"/tmp/scanimage.txt"</span><span class="sb">`</span>
 	<span class="k">if</span> <span class="o">[[</span> <span class="nv">$CHECK</span> !<span class="o">=</span> <span class="s2">""</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
		<span class="k">$(</span><span class="nv">DISPLAY</span><span class="o">=</span>:0 yad --on-top --center --timeout<span class="o">=</span><span class="m">5</span> --title<span class="o">=</span><span class="s2">"Device problem..."</span> --text<span class="o">=</span><span class="s2">"Ooops - problems with the scanner! \nScript trys to reset usb connection!"</span><span class="k">)</span>
		<span class="nb">echo</span> <span class="s2">"device problem `date +%Y%m%d`-`date +%H%M%S`"</span>
		<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$CHECK</span><span class="s2">"</span>
		usbrestart
		scan_color
		<span class="nb">echo</span> <span class="s2">"Scan completed, ~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
		print_tiff
		rm -f /tmp/scanimage.txt
		<span class="nb">exit</span> <span class="m">0</span>
	<span class="k">fi</span> 
<span class="o">}</span>

<span class="nb">trap</span> <span class="s1">'cleanup; exit 0'</span> SIGTERM SIGINT
<span class="nb">trap</span> cleanup EXIT
<span class="nb">trap</span> <span class="s2">"BTN_PRESSED+=(</span><span class="k">$(</span>date +%s<span class="k">)</span><span class="s2">);"</span> SIGUSR1


<span class="k">while</span> check_runtime<span class="p">;</span> <span class="k">do</span>
    sleep <span class="m">0</span>.11  <span class="c1"># if the button presses have a shorter delta t, then reduce this value</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">"~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
<span class="nb">echo</span> <span class="s2">"Button has been pressed at </span><span class="si">${</span><span class="nv">BTN_PRESSED</span><span class="p">[@]</span><span class="si">}</span><span class="s2">"</span>

<span class="k">case</span> <span class="si">${#</span><span class="nv">BTN_PRESSED</span><span class="p">[@]</span><span class="si">}</span> in
<span class="m">1</span><span class="o">)</span> <span class="nb">echo</span> <span class="s2">"action #1, b/w-copy A4"</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">SCANCOLOR</span><span class="o">=</span>BW
scan_color
check_device
<span class="nb">echo</span> <span class="s2">"Scan completed, ~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
print_tiff
 <span class="p">;;</span>
<span class="m">2</span><span class="o">)</span> <span class="nb">echo</span> <span class="s2">"action #2 Grayscale-copy A4"</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">SCANCOLOR</span><span class="o">=</span>GR
scan_color
check_device
<span class="nb">echo</span> <span class="s2">"Scan completed, ~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
print_tiff
 <span class="p">;;</span>
<span class="m">3</span><span class="o">)</span> <span class="nb">echo</span> <span class="s2">"action #3, Color-copy A4"</span>
<span class="nv">TMPFILE</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">SCANCOLOR</span><span class="o">=</span>CL
scan_color
check_device
<span class="nb">echo</span> <span class="s2">"Scan completed, ~~~`date +%Y%m%d`-`date +%H%M%S`"</span>
print_tiff
 <span class="p">;;</span>
*<span class="o">)</span> <span class="nb">echo</span> <span class="s2">"too many button presses"</span>
<span class="k">esac</span>


rm -f /tmp/scanimage.txt
</pre></div>
</td></tr></table></div><p>Jetzt sollte bei entsprechenden Tastendrücken direkte Kopien im Din-A4-Format entstehen. Das Skript ist für einen CanoScan LiDE 60 ausgelegt, der in <a class="internal" href="./trusty.html">Ubuntu 14.04 Trusty Tahr</a> unter <a class="internal" href="./sane.html">SANE</a>-1.0.25 läuft, ggf. müssten einige Optionen an die Gegebenheiten des eigenen Scanners angepasst werden. Fehlermeldungen werden in der <strong>.log</strong>-Datei <strong>/tmp/scanbutton.log</strong> aufgeführt. Falls der Scanner nicht erkannt wird, versucht das Skript, den USB-Anschluss via usbreset neu zu starten und den Auftrag zu wiederholen - yad öffnet dazu ein Hinweisfenster.</p><p>Besonderer Dank geht an <a class="crosslink user" href="https://ubuntuusers.de/user/seahawk1986/">seahawk1986</a>, der maßgeblich an der Entwicklung beteiligt war, siehe dazu auch diesen <a class="crosslink topic" href="https://forum.ubuntuusers.de/topic/scanner-tastendruecke-in-einem-bestimmten-zeit/">Thread</a> im Forum.</p></div><div class="section_1"><h2 id="Tipps">Tipps<a class="headerlink" href="#Tipps">¶</a></h2><p>
</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Erweiterter Hardware Support für älterer Ubuntu-Versionen (unter anderem auch für die HP 39xx Serie) ist in der Version scanbuttond_0.2.3.cvs20090713-1 vorhanden. Ab <a class="internal" href="./14.04.html">Ubuntu 14.04</a> ist schon eine aktuellere Version von scanbuttond in den offiziellen Quellen.</p><ul><li><p>Repository-Link: <a class="external" href="http://sg.archive.ubuntu.com/ubuntu/pool/universe/s/scanbuttond/" rel="nofollow">Paketquelle</a> <img alt="{dl}" src="./_/8e630211d0f5f5cb7c6424055f9c9aa15a420fab.png"/> </p></li><li><p>In der <a class="external" href="http://scanbuttond.sourcearchive.com/documentation/0.2.3.cvs20090713/dir_396f776e290837d97107bcdc857cf4bf.html" rel="nofollow">Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> die Quellen der enthaltenen Treiber.</p></li></ul><p>
Sollten beim Einsatz der scanbuttond_0.2.3.cvs20090713-1 Version folgende Fehlermeldungen im syslog auftauchen:</p><pre class="notranslate">scanbuttond: libusbi: could not claim interface for device 003:004. (code=-1)
scanbuttond: scanbtnd_open failed, error code: -19</pre><p>muss in der Datei <strong>/etc/default/scanbuttond</strong> der Eintrag <code class="notranslate">RUN_AS_USER=saned</code> zu <code class="notranslate">RUN_AS_USER=root</code> geändert werden.
</p></div></div></div><div class="section_1"><h2 id="Alternativen">Alternativen<a class="headerlink" href="#Alternativen">¶</a></h2><p>
</p><ul><li><p>Für Brother-Scanner kann das Programm <a class="internal" href="./scanner/brother/scankey-tool.html">Scankey-Tool</a> verwendet werden</p></li><li><p><a class="external" href="http://jice.free.fr/KScannerButtons/" rel="nofollow">KScannerButtons</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Eine Alternative für KDE</p></li></ul><p>
</p></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="interwiki interwiki-sourceforge2" href="http://scanbuttond.sourceforge.net">Projektseite</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li><li><p><a class="interwiki interwiki-sourceforge2" href="http://scanbd.sourceforge.net">scanbd</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - jüngere Alternative zu scanbuttond</p></li><li><p><a class="external" href="https://0x0a14.de/scanbuttond-and-canoscan-lide-110210/" rel="nofollow">scanbuttond and CanoScan LiDE 110/120</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> Erklärung, wie scanbuttond um neue Scanner ergänzt werden kann.</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./scanbuttond/a/revision/939514.html">Diese Revision</a> wurde am 5. Mai 2017 12:26 von <a href="https://ubuntuusers.de/user/Heinrich_Schwietering/">Heinrich_Schwietering</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./scanbuttond.html">scanbuttond</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>