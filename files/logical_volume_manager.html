<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Logical_Volume_Manager › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./logical_volume_manager.html">Logical Volume Manager</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Logical_Volume_Manager">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./logical_volume_manager/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./logical_volume_manager/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./logical_volume_manager/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./logical_volume_manager/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./logical_volume_manager/a/backlinks.html">Logical Volume Manager</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><p>
</p><div class="box advanced"><h3 class="box advanced">Artikel für fortgeschrittene Anwender</h3><div class="contents"><p>
Dieser Artikel erfordert mehr Erfahrung im Umgang mit
Linux und ist daher nur für fortgeschrittene Benutzer
gedacht.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./partitionierung.html">Eine Festplatte partitionieren</a></p></li><li><p><a class="crosslink anchor" href="#source-3" id="source-3"></a> <a class="internal" href="./dateisystem.html">Dateisystem anlegen</a></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Grundlagen">Grundlagen
</a><ol class="arabic"><li><a class="crosslink" href="#Physical-Extent">Physical Extent
</a></li><li><a class="crosslink" href="#Physical-Volume">Physical Volume
</a></li><li><a class="crosslink" href="#Volume-Group">Volume Group
</a></li><li><a class="crosslink" href="#Logical-Volume">Logical Volume
</a></li><li><a class="crosslink" href="#Skalierbarkeit">Skalierbarkeit
</a></li><li><a class="crosslink" href="#Mindestanforderungen">Mindestanforderungen
</a></li></ol></li><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Einrichten-eines-LVM">Einrichten eines LVM
</a><ol class="arabic"><li><a class="crosslink" href="#GNOME">GNOME
</a></li><li><a class="crosslink" href="#KDE">KDE
</a></li><li><a class="crosslink" href="#Manuell">Manuell
</a></li></ol></li><li><a class="crosslink" href="#Administration-eines-LVM">Administration eines LVM
</a><ol class="arabic"><li><a class="crosslink" href="#Informationen-abfragen">Informationen abfragen
</a></li><li><a class="crosslink" href="#Verwaltung-von-Physical-Volumes">Verwaltung von Physical Volumes
</a></li><li><a class="crosslink" href="#Verwaltung-von-Volume-Groups">Verwaltung von Volume Groups
</a></li><li><a class="crosslink" href="#Verwaltung-von-Logical-Volumes">Verwaltung von Logical Volumes
</a></li></ol></li><li><a class="crosslink" href="#Problembehebung">Problembehebung
</a><ol class="arabic"><li><a class="crosslink" href="#Logical-Volume-Management-manuell-starten">Logical Volume Management manuell starte...</a></li><li><a class="crosslink" href="#LVs-anzulegen-oder-zu-vergroessern-bricht-wegen-zu-weniger-Extents-ab">LVs anzulegen oder zu vergrößern bricht ...</a></li><li><a class="crosslink" href="#Verschieben-einer-PV-mit-pvmove-funktioniert-nicht">Verschieben einer PV mit pvmove funktion...</a></li><li><a class="crosslink" href="#Snapshot-laesst-sich-nicht-anlegen">Snapshot lässt sich nicht anlegen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a><ol class="arabic"><li><a class="crosslink" href="#intern">intern
</a></li><li><a class="crosslink" href="#extern">extern
</a></li></ol></li></ol></div><p><a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Logical_Volume_Manager">LVM</a> steht für <strong>L</strong>ogical <strong>V</strong>olume <strong>M</strong>anager und ist ein Verfahren, um Speicherplatz über mehrere Festplatten dynamisch zu verwalten. Es wird sozusagen eine zusätzliche logische Schicht zwischen Partitionen und Dateisystemen eingefügt.</p><p>LVM bietet die Möglichkeit, mehrere Partitionen logisch zusammenzufassen (Volume Group) und in diesem logischen Verbund neue "logische Partitionen" (Logical Volume) anzulegen. Der Volume Group können dynamisch weitere Geräte hinzugefügt werden, wodurch sich der verfügbare Speicherplatz erhöht. Freier Speicherplatz kann ebenfalls dynamisch den Logical Volumes zugewiesen werden. Dadurch erreicht man eine höhere Flexibilität als beim klassischen Partitionierungsansatz. Dies ist vor allem für Server interessant, bei denen dynamisch auf das Wachsen der Datenbestände reagiert werden muss.</p><p>Vorteile:
</p><ul><li><p>Volumes können im laufenden Betrieb vergrößert, angelegt und verkleinert werden</p></li><li><p>Probleme durch falsche Partitionierung können vermieden werden</p></li><li><p>Höhere Flexibilität</p></li><li><p>Die Kapazität mehrerer Festplatten kann zu einem Volume zusammengefasst werden</p></li><li><p>Verschiedene Versionen von Daten sind durch sogenannte "Snapshots" möglich</p></li><li><p>Die Datensicherung ("backup") wird durch diese "Snapshots" vereinfacht</p></li><li><p>LVM hat einen hohen Datendurchsatz ("performance") und beeinträchtigt das System nur unwesentlich</p></li></ul><p>
Nachteile:
</p><ul><li><p>Liegen die Logical Volumes auf mehreren Festplatten, so wird das Risiko des "Single-Point-of-Failure" größer, da beim Ausfall einer Platte alle Daten verloren sind, ähnlich wie bei RAID0</p></li><li><p>Zugriff auf LVM-Partitionen ist nur mit Linux möglich</p></li><li><p>Um auf Logical Volumes zugreifen zu können, benötigen sog. Rescue CDs auch LVM-Unterstützung</p></li><li><p>Es ist eine zusätzliche <strong>/boot</strong>-Partition außerhalb des LVM-Verbunds erforderlich (gilt für <a class="internal" href="./grub.html">GRUB</a>, nicht für <a class="internal" href="./grub_2.html">GRUB 2</a>!)</p></li></ul><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Wegen der höheren Fehleranfälligkeit sollte das LVM in einem <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/RAID">RAID</a>-Verbund installiert werden, der Datensicherheit bietet (mindestens RAID-Level 1). Weiterhin sollten die Volumes über <a class="internal" href="./sicherheit.html">Backups</a> regelmäßig gesichert werden, um so Datenverlust durch den Ausfall einer Platte vorzubeugen!
</p></div></div><div class="section_1"><h2 id="Grundlagen">Grundlagen<a class="headerlink" href="#Grundlagen">¶</a></h2><p>
Vier Begriffe sind beim LVM essentiell und sollen zunächst erklärt werden:
</p><ul><li><p>Physical Extent</p></li><li><p>Physical Volume</p></li><li><p>Volume Group und</p></li><li><p>Logical Volume</p></li></ul><p>
</p><div class="section_2"><h3 id="Physical-Extent">Physical Extent<a class="headerlink" href="#Physical-Extent">¶</a></h3><p>
Das sog. <strong>Physical Extent</strong> (PE) ist die kleinste mögliche Speichergröße in einem LVM. Das PE ist vergleichbar mit den Sektoren von normalen Festplatten bzw. Partitionen. Es ist nicht möglich, die Größe der PEs nachträglich zu verändern. Dies ist aber auch nicht nötig, da die Anzahl der PEs seit LVM2 unbegrenzt ist, die Standardgröße beträgt 4 MByte.</p></div><div class="section_2"><h3 id="Physical-Volume">Physical Volume<a class="headerlink" href="#Physical-Volume">¶</a></h3><p>
Ein <strong>Physical Volume</strong> (PV) ist der eigentliche Datenspeicher eines LVMs. Ein PV kann eine Partition oder ein ganzes Laufwerk sein. Es ist auch möglich, sogenannte "Loop-Dateien" zu verwenden.</p></div><div class="section_2"><h3 id="Volume-Group">Volume Group<a class="headerlink" href="#Volume-Group">¶</a></h3><p>
Eine <strong>Volume Group</strong> (VG) ist eine Art Container für mindestens ein PV.</p></div><div class="section_2"><h3 id="Logical-Volume">Logical Volume<a class="headerlink" href="#Logical-Volume">¶</a></h3><p>
Ein <strong>Logical Volume</strong> (LV oder auch Volume) ist im LVM Kontext für den Anwender eine Art Partition innerhalb einer Volume Group. Es ist nicht möglich Logical Volumes außerhalb einer VG zu erstellen. Das LV kann wie eine normale Partition verwendet werden, d.h. es können Dateisysteme darauf angelegt werden und es kann gemounted werden.</p></div><div class="section_2"><h3 id="Skalierbarkeit">Skalierbarkeit<a class="headerlink" href="#Skalierbarkeit">¶</a></h3><p>
Im LVM können alle Elemente (PV, VG, LV), außer der PE, im laufenden Betrieb vergrößert und verkleinert werden. Doch die Erweiterbarkeit des LVM allein hilft noch nicht weiter, auch das darin liegende Dateisystem muss verändert werden, um es tatsächlich an die neue Größe anpassen zu können. Nicht jedes Dateisystem beherrscht das Vergrößern oder Verkleinern. Weitere Informationen sind unter <a class="internal" href="./dateisystemgröße_ändern.html">Dateisystemgrößen verändern</a> verfügbar.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p><a class="internal" href="./gparted.html">GParted</a> kann erst ab Version 0.14 und neuer - d.h. auf Ubuntu bezogen ab Ubuntu 14.04 Trusty - mit LVM Partitionen umgehen. Andere Programme wie z.B. Partition Magic können mit LVM Partitionen nichts anfangen, mit diesem Programm ist also ein Vergrößern oder Verkleinern der LVM-Partition nicht möglich.
</p></div></div></div><div class="section_2"><h3 id="Mindestanforderungen">Mindestanforderungen<a class="headerlink" href="#Mindestanforderungen">¶</a></h3><p>
Zusammengefasst lässt sich also sagen, dass zum Aufbau eines minimalen LVMs mindestens ein Physical Volume erforderlich ist, aus dem eine Volume Group erstellt wird. In dieser Volume Group können jetzt die einzelnen Logical Volumes angelegt werden. Es ist jedoch nicht erforderlich und sinnvoll, mit diesen Logical Volumes den gesamten Platz einer Volume Group auszunutzen, da man so leichter auf spätere Veränderungen reagieren kann. Als Faustregel kann man den aktuellen bzw. geplanten Platzbedarf + 25% nehmen.</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Um LVM unter Ubuntu verwenden zu können, müssen folgende Pakete installiert sein <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>lvm2</strong></p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install lvm2 </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install lvm2 </pre></div></div><p>
</p></div></div></div><div class="section_1"><h2 id="Einrichten-eines-LVM">Einrichten eines LVM<a class="headerlink" href="#Einrichten-eines-LVM">¶</a></h2><p>
Neben der Möglichkeit, ein LVM im Terminal einzurichten, gibt es auch grafische Lösungen für KDE und GNOME.</p><div class="section_2"><h3 id="GNOME">GNOME<a class="headerlink" href="#GNOME">¶</a></h3><p>
Für GNOME ist das "Verwaltung für logische Medien", das durch folgendes Paket installiert werden kann <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>system-config-lvm</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install system-config-lvm </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install system-config-lvm </pre></div></div><p>
</p></div></div><p>Für das Programm gibt es eine <a class="external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/s1-system-config-lvm.html" rel="nofollow">Dokumentation</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/>.</p></div><div class="section_2"><h3 id="KDE">KDE<a class="headerlink" href="#KDE">¶</a></h3><p>
Für KDE ist das "KVPM - KDE-Manager für Laufwerkspartitionen", das durch folgendes Paket installiert werden kann <sup><a href="#source-1">[1]</a></sup>:</p><ul><li><p><strong>kvpm</strong> (<em>universe</em>)</p></li></ul><p><img alt="Wiki/Vorlagen/Installbutton/button.png" class="image-default" src="./_/fd60ccb86c4d96df2f4518df2936cc7d038467aa.png"/>
mit <a class="internal" href="./apturl.html">apturl</a>
</p><div class="package-list"><div class="contents"><p>
Paketliste zum Kopieren:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo apt-get install kvpm </pre></div></div><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo aptitude install kvpm </pre></div></div><p>
</p></div></div></div><div class="section_2"><h3 id="Manuell">Manuell<a class="headerlink" href="#Manuell">¶</a></h3><p>
Im folgenden wird die Einrichtung eines LVM im Terminal erläutert. Um ein LVM einzurichten, muss zuerst jede zu verwendende Partition mittels <strong>pvcreate</strong> als <em>Physical Volume</em> initialisiert werden. Alle <em>Physical Volumes</em> müssen nun mittels <strong>vgcreate</strong> zu einer <em>Volume Group</em> zusammengefasst werden. In dieser Gruppe können nun mittels <strong>lvcreate</strong> die <em>Logical Volumes</em> erzeugt werden. Folgende Befehle zeigen das Vorgehen zum Einrichten eines LVM:</p><div class="bash"><div class="contents"><pre class="notranslate">pvcreate /dev/&lt;Partition&gt; /dev/&lt;Partition2&gt; # &lt;Partition&gt; und &lt;Partition2&gt; als Physical Volume initialisieren
vgcreate &lt;group&gt; /dev/&lt;Partition&gt; /dev/&lt;Partition2&gt; # Erstellt Volume Group &lt;group&gt;, bestehend aus /dev/&lt;Partition&gt; und /dev/&lt;Partition2&gt;
lvcreate -L 2G -n &lt;vol&gt; &lt;group&gt; # Erzeugt ein 2 GB großes Logical Volume mit dem Namen &lt;vol&gt; in der Volume Group &lt;group&gt; </pre></div></div><p>Für jedes Logical Volume wird eine Datei der Art <strong>/dev/&lt;group&gt;/&lt;vol&gt;</strong> angelegt. Das Logical Volume kann verwendet werden wie jedes andere Block-Device. So kann ein Dateisystem darauf erzeugt werden, und das Dateisystem kann eingebunden werden.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Eine mit pvcreate initialisierte Partition sollte vom Typ 0x8e bzw. <em>Linux LVM</em> sein, da es sonst zu Problemen mit der Erkennung der PVs kommt. Wenn das LVM auf einem RAID liegt, ist dies natürlich nicht nötig, genauso als ob das LVM direkt auf eine Festplatte ohne Partitionstabelle aufgesetzt wird.</p><p>Dies kann man z.B. via parted mit "set x lvm on" erreichen, wobei x die Partitionsnummer ist.
</p></div></div></div></div><div class="section_1"><h2 id="Administration-eines-LVM">Administration eines LVM<a class="headerlink" href="#Administration-eines-LVM">¶</a></h2><p>
</p><div class="section_2"><h3 id="Informationen-abfragen">Informationen abfragen<a class="headerlink" href="#Informationen-abfragen">¶</a></h3><p>
</p><div class="section_3"><h4 id="Informationen-ueber-Physical-Volumes-abfragen">Informationen über Physical Volumes abfragen<a class="headerlink" href="#Informationen-ueber-Physical-Volumes-abfragen">¶</a></h4><p>
Um Informationen über vorhandene Physical Volumes abzufragen, gibt es den Befehl <code class="notranslate">pvs</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo pvs </pre></div></div><p>
Die Ausgabe sieht dann ungefähr so aus:</p><pre class="notranslate">PV         VG   Fmt  Attr PSize   PFree
/dev/sda2  main lvm2 a-   465,57G 311,57G</pre><p>
Für jedes Physical Volume gibt es eine Zeile. Wenn das Physical Volume einer Volume Group zugeordnet ist, wird diese unter VG angezeigt. Die aktuelle Größe eines Physical Volumes steht unter PSize, der freie Platz innerhalb des Physical Volumes steht unter PFree.</p><p>Alternativ gibt es auch den Befehl <code class="notranslate">pvdisplay</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo pvdisplay </pre></div></div><p>
Dieser liefert Informationen in folgendem Format:</p><pre class="notranslate">  --- Physical volume ---
  PV Name               /dev/sda6
  VG Name               osvg
  PV Size               68.27 GiB / not usable 1.00 MiB
  Allocatable           yes 
  PE Size               4.00 MiB
  Total PE              17477
  Free PE               5821
  Allocated PE          11656
  PV UUID               qb8pns-Zj94-JFWl-HpQ6-BRBQ-V2RO-WPCeD9</pre></div><div class="section_3"><h4 id="Informationen-ueber-Volume-Groups-abfragen">Informationen über Volume Groups abfragen<a class="headerlink" href="#Informationen-ueber-Volume-Groups-abfragen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo vgs </pre></div></div><p>
Das sieht aus wie z.B.:</p><pre class="notranslate">VG   #PV #LV #SN Attr   VSize   VFree
main   1   6   0 wz--n- 465,57G 311,57G</pre><p>Für jede Volume Group gibt es eine Zeile. Unter #PV steht die Anzahl der Physical Volumes, unter #LV die Anzahl der Logcial Volumes und unter dem Feld #SN die Anzahl der "Snapshots", die es in dieser Volume Group gibt. VSize bezeichnet die gesamte Größe der VG, wohingegen VFree für den noch nicht zugeordneten Platz in der VG steht.</p><p>Die Alternative <code class="notranslate">vgdisplay</code>:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo vgdisplay </pre></div></div><p>
listet die Volume-Group auf, z.B.:</p><pre class="notranslate">  --- Volume group ---
  VG Name               osvg
  System ID             
  Format                lvm2
  Metadata Areas        1
  Metadata Sequence No  7
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                3
  Open LV               3
  Max PV                0
  Cur PV                1
  Act PV                1
  VG Size               68.27 GiB
  PE Size               4.00 MiB
  Total PE              17477
  Alloc PE / Size       11656 / 45.53 GiB
  Free  PE / Size       5821 / 22.74 GiB
  VG UUID               GY8Uou-MFzC-JkWf-ZP1g-JATj-9NUd-mlHcqK</pre></div><div class="section_3"><h4 id="Informationen-ueber-Logical-Volumes-abfragen">Informationen über Logical Volumes abfragen<a class="headerlink" href="#Informationen-ueber-Logical-Volumes-abfragen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvs </pre></div></div><p>
Die Ausgabe sieht z.B. so aus:</p><pre class="notranslate">LV         VG   Attr   LSize  Origin Snap%  Move Log Copy%
home       main -wi-ao 70,00G
music      main -wi-ao 20,00G
root       main -wi-ao 20,00G
swap       main -wi-ao  2,00G
tmp        main -wi-ao  2,00G
virtualbox main -wi-ao 40,00G</pre><p>
Für jedes Logical Volume (LV) gibt es eine Zeile, unter LV selbst steht der Name des Volumes, VG steht für die Volume Group und LSize für die Größe des Volumes.</p><p>Auch hier gibt es die Alternative <code class="notranslate">lvdisplay</code>:
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvdisplay </pre></div></div><p>Die Ausgabe sieht in etwa so aus:
</p><pre class="notranslate">  --- Logical volume ---
  LV Name                /dev/osvg/lvroot
  VG Name                osvg
  LV UUID                F9hXgF-gj8B-Rdgh-efVD-p1Er-SkKN-qWx18U
  LV Write Access        read/write
  LV Status              available
  # open                 1
  LV Size                18.62 GiB
  Current LE             4768
  Segments               1
  Allocation             inherit
  Read ahead sectors     auto
  - currently set to     256
  Block device           252:1</pre></div></div><div class="section_2"><h3 id="Verwaltung-von-Physical-Volumes">Verwaltung von Physical Volumes<a class="headerlink" href="#Verwaltung-von-Physical-Volumes">¶</a></h3><p>
</p><div class="section_3"><h4 id="Physical-Volume-initialisieren">Physical Volume initialisieren<a class="headerlink" href="#Physical-Volume-initialisieren">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo pvcreate /dev/&lt;Partition&gt; </pre></div></div><p>
Dies erstellt ein Physical Volume auf der Partition <code class="notranslate">/dev/&lt;Partition&gt;</code>. Diese kann dann einer Volume Group zugewiesen werden.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Dieser Befehl löscht die Daten auf dem angegebenen Gerät ohne Nachfrage!
</p></div></div></div><div class="section_3"><h4 id="Physical-Volume-leeren-oder-verschieben">Physical Volume leeren oder verschieben<a class="headerlink" href="#Physical-Volume-leeren-oder-verschieben">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe dm-mirror # Lädt den "mirror"-Treiber welcher für pvmove notwendig ist
sudo pvmove /dev/&lt;Partition&gt; </pre></div></div><p>
Mit <code class="notranslate">pvmove /dev/&lt;Partition&gt;</code> wird der Inhalt des Physical Volumes auf die restlichen Volumes verschoben. Dies ist nötig, um z.B. das Physical Volume aus einer Volume Group zu entfernen.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Um ein Physical Volume mit <code class="notranslate">pvmove</code> zu leeren, muss genügend Platz auf den restlichen Physical Volumes vorhanden sein!
</p></div></div></div></div><div class="section_2"><h3 id="Verwaltung-von-Volume-Groups">Verwaltung von Volume Groups<a class="headerlink" href="#Verwaltung-von-Volume-Groups">¶</a></h3><p>
</p><div class="section_3"><h4 id="Volume-Groups-erstellen">Volume Groups erstellen<a class="headerlink" href="#Volume-Groups-erstellen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo vgcreate &lt;group&gt; /dev/&lt;Partition1&gt; /dev/&lt;Partition2&gt; </pre></div></div><p>
Hier wird eine Volume Group mit dem Namen <code class="notranslate">&lt;group&gt;</code> erstellt. Diese bekommt die Physical Volumes <code class="notranslate">&lt;Partition1&gt;</code> und <code class="notranslate">&lt;Partition2&gt;</code> zugewiesen.</p></div><div class="section_3"><h4 id="Volume-Groups-vergroessern">Volume Groups vergrößern<a class="headerlink" href="#Volume-Groups-vergroessern">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo vgextend &lt;group&gt; /dev/&lt;Partition&gt; </pre></div></div><p>
Das Physical Volume <code class="notranslate">&lt;Partition&gt;</code> wird der Volume Group <code class="notranslate">&lt;group&gt;</code> hinzugefügt.</p></div><div class="section_3"><h4 id="Volume-Groups-verkleinern">Volume Groups verkleinern<a class="headerlink" href="#Volume-Groups-verkleinern">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe dm-mirror
sudo pvmove /dev/&lt;Partition&gt;
sudo vgreduce &lt;group&gt; /dev/&lt;Partition&gt; </pre></div></div><p>
Lädt den Mirror-Treiber, verschiebt alle Daten von dem Physical Volume <code class="notranslate">&lt;Partition&gt;</code> und entfernt das Volume aus der Volume Group.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Um ein Physical Volume mit <code class="notranslate">pvmove</code> zu leeren, muss genügend Platz auf den restlichen Physical Volumes vorhanden sein!
</p></div></div></div><div class="section_3"><h4 id="Volume-Groups-loeschen">Volume Groups löschen<a class="headerlink" href="#Volume-Groups-loeschen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo vgremove &lt;group&gt; </pre></div></div><p>
Hier wird eine Volume Group mit dem Namen <code class="notranslate">&lt;group&gt;</code> gelöscht.</p></div></div><div class="section_2"><h3 id="Verwaltung-von-Logical-Volumes">Verwaltung von Logical Volumes<a class="headerlink" href="#Verwaltung-von-Logical-Volumes">¶</a></h3><p>
</p><div class="section_3"><h4 id="Logical-Volumes-erstellen">Logical Volumes erstellen<a class="headerlink" href="#Logical-Volumes-erstellen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvcreate -L 2G -n &lt;volume&gt; &lt;group&gt; </pre></div></div><p>
Erstellt ein Logical Volume der Größe 2 Gigabyte mit dem Namen <code class="notranslate">&lt;volume&gt;</code> in der Volume Group <code class="notranslate">&lt;group&gt;</code>. Im Anschluss daran kann mit z.B. 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo mkfs.ext4 /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
ein Dateisystem auf dem Volume erstellt werden (siehe <a class="internal" href="./formatieren.html">Formatieren</a>).</p></div><div class="section_3"><h4 id="Logical-Volumes-vergroessern">Logical Volumes vergrößern<a class="headerlink" href="#Logical-Volumes-vergroessern">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvextend --resizefs -L 5G /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
Vergrößert das Logical Volume <code class="notranslate">&lt;volume&gt;</code> der Volume Group <code class="notranslate">&lt;group&gt;</code> und das Dateisystem auf 5 Gigabyte. Als Alternative kann auch ein + vor den Wert hinter -L gestellt werden; in diesem Fall wird die Partition dann um diesen Wert vergrößert (relative Vergrößerung des Volumes, ausgehend von der aktuellen Größe).</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvextend --resizefs -l +100%FREE /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
Vergrößert das Logical Volume <code class="notranslate">&lt;volume&gt;</code> der Volume Group <code class="notranslate">&lt;group&gt;</code> und das Dateisystem auf die maximal mögliche Größe. Die Volume Group hat im Anschluss keinen freien Speicher mehr.</p></div><div class="section_3"><h4 id="Logical-Volumes-verkleinern">Logical Volumes verkleinern<a class="headerlink" href="#Logical-Volumes-verkleinern">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvreduce --resizefs -L 5G /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
Verkleinert das Logical Volume <code class="notranslate">&lt;volume&gt;</code> der Volume Group <code class="notranslate">&lt;group&gt;</code> und das Dateisystem auf 5 Gigabyte. Als Alternative kann auch ein - vor den Wert hinter -L gestellt werden; in diesem Fall wird die Partition dann um diesen Wert verkleinert (relative Verkleinerung des Volumes, ausgehend von der aktuellen Größe).</p></div><div class="section_3"><h4 id="Snapshots">Snapshots<a class="headerlink" href="#Snapshots">¶</a></h4><p>
Ein Snapshot eines Logical Volumes <code class="notranslate">&lt;volume&gt;</code> hält die Daten zum Zeitpunkt der Erstellung in einem neuen Logical Volume <code class="notranslate">&lt;name&gt;</code> fest:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvcreate --size 100M --snapshot --name &lt;name&gt; /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
Dies legt einen Snapshot <code class="notranslate">&lt;name&gt;</code> an, welcher auf <code class="notranslate">&lt;volume&gt;</code> der Volume Group <code class="notranslate">&lt;group&gt;</code> basiert. Finden Schreibvorgänge auf das originale LV <code class="notranslate">&lt;volume&gt;</code> statt, so werden die betroffenen Blöcke vorher physisch auf das LV <code class="notranslate">&lt;name&gt;</code> kopiert, erst danach werden die Änderungen auf <code class="notranslate">&lt;volume&gt;</code> durchgeführt. Deshalb ist der Snapshot so lange gültig, wie sich das Original um nicht mehr als den hinter <code class="notranslate">--size</code> angegebenen Wert verändert (hier 100 MB). Daraus resultiert auch, dass die Schreibrate auf <code class="notranslate">&lt;volume&gt;</code> geringer ist, solange ein Snapshot davon existiert.</p><p>Um das LV wieder auf den Stand bei der Erstellung des Snapshots zurückzusetzen, wird mit dem Befehl 
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvconvert --merge /dev/&lt;group&gt;/&lt;name&gt; </pre></div></div><p>
das originale LV und der Snapshot zusammengeführt. Gegebenenfalls erfolgt die Zusammenführung erst beim Neustarten des Computers (z.B. bei root). Nachdem der Vorgang erfolgreich abgeschlossen wurde, wird der Snapshot gelöscht.</p><p>Snapshots sind z.B. nützlich, wenn man etwas ausprobieren will mit der Möglichkeit, ohne größeren Aufwand zum vorherigen Stand eines Dateisystems zurückkehren zu können. Aber auch als Hilfsmittel zur Datensicherung dienen Snapshots, denn nachdem ein Snapshot erstellt wurde, kann ein Backuptool den eingehängten Snapshot in aller Ruhe klonen, ohne dass man sich um während des Sicherungsvorgangs stattfindende Dateiänderungen sorgen muss. Gerade hierfür ist ein read-only Snapshot geeignet, welches man über die Option <code class="notranslate">-p r</code> oder <code class="notranslate">-permission r</code> erstellt, wobei <code class="notranslate">r</code> für "read-only" und <code class="notranslate">rw</code> für "read-write" steht, die Standardeinstellung ist <code class="notranslate">rw</code>. Nach der Datensicherung auf eine externe Festplatte kann das Snapshot wieder verworfen werden.</p></div><div class="section_3"><h4 id="Logical-Volumes-loeschen">Logical Volumes löschen<a class="headerlink" href="#Logical-Volumes-loeschen">¶</a></h4><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">sudo lvremove /dev/&lt;group&gt;/&lt;volume&gt; </pre></div></div><p>
Hier wird ein Logical Volume mit dem Namen <code class="notranslate">&lt;volume&gt;</code> in der Gruppe <code class="notranslate">&lt;group&gt;</code> gelöscht.</p></div></div></div><div class="section_1"><h2 id="Problembehebung">Problembehebung<a class="headerlink" href="#Problembehebung">¶</a></h2><p>
</p><div class="section_2"><h3 id="Logical-Volume-Management-manuell-starten">Logical Volume Management manuell starten<a class="headerlink" href="#Logical-Volume-Management-manuell-starten">¶</a></h3><p>
Unter Ubuntu werden nach Installation der benötigten Pakete normalerweise alle Logical Volumes beim Systemstart mitgestartet. Dies ist jedoch bei vielen Live- bzw. Rescue-CDs nicht der Fall. Mit den nachfolgenden Befehlen können Logical Volumes manuell gestartet werden.</p><pre class="notranslate">modprobe dm-mod
pvscan
vgscan
lvscan
vgchange -a y</pre><p>
Mit</p><div class="bash"><div class="contents"><pre class="notranslate">vgchange -a n </pre></div></div><p>
können die Logical Volumes wieder deaktiviert werden. Dies geschieht bei Ubuntu automatisch während des Herunterfahrens des Rechners.</p></div><div class="section_2"><h3 id="LVs-anzulegen-oder-zu-vergroessern-bricht-wegen-zu-weniger-Extents-ab">LVs anzulegen oder zu vergrößern bricht wegen zu weniger Extents ab<a class="headerlink" href="#LVs-anzulegen-oder-zu-vergroessern-bricht-wegen-zu-weniger-Extents-ab">¶</a></h3><p>
Sollte beim Versuch, Logical Volumes mit <strong>lvcreate</strong> anzulegen oder mit <strong>lvextend</strong> zu vergrößern, die Fehlermeldung <code class="notranslate">xxxx extents needed, but only 0 available</code> erscheinen (xxxx=Anzahl), obwohl <strong>pvdisplay</strong> genügend freie Extents hinter <code class="notranslate">Free PE</code> meldet, kann es an der Option <code class="notranslate">Allocatable NO</code> liegen, welche ebenfalls von <strong>pvdisplay</strong> angezeigt wird. Um die PV für Änderungen freizuschalten, dient folgender Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">pvchange -x y /dev/&lt;partition&gt; </pre></div></div><p>
Nach Durchführung der Änderungen wird die PV wieder auf unveränderlich geschaltet:</p><div class="bash"><div class="contents"><pre class="notranslate">pvchange -x n /dev/&lt;partition&gt; </pre></div></div><p>Die betreffende <code class="notranslate">&lt;partition&gt;</code> wird mittels <strong>pvdisplay</strong> hinter <code class="notranslate">PV Name</code> angezeigt.</p></div><div class="section_2"><h3 id="Verschieben-einer-PV-mit-pvmove-funktioniert-nicht">Verschieben einer PV mit pvmove funktioniert nicht<a class="headerlink" href="#Verschieben-einer-PV-mit-pvmove-funktioniert-nicht">¶</a></h3><p>
Sollte beim Verschieben von Daten mit <strong>pvmove</strong> eine Fehlermeldung kommen, dass ein Kernel-Modul nicht vorhanden sei, so kann dies so behoben werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe dm-mirror </pre></div></div><p>
<a class="crosslink anchor" href="#lvm-modprobe-dm-snapshot" id="lvm-modprobe-dm-snapshot"></a></p></div><div class="section_2"><h3 id="Snapshot-laesst-sich-nicht-anlegen">Snapshot lässt sich nicht anlegen<a class="headerlink" href="#Snapshot-laesst-sich-nicht-anlegen">¶</a></h3><p>
Beim Anlegen eine Snapshots kann es passieren, dass dies wegen eines nicht geladenen Kernel-Moduls nicht möglich ist. Das notwendige Modul kann wie folgt nachgeladen werden:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo modprobe dm-snapshot </pre></div></div></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><div class="section_2"><h3 id="intern">intern<a class="headerlink" href="#intern">¶</a></h3><p>
</p><ul><li><p><a class="internal" href="./logical_volume_manager/alternate_installation.html">Alternate Installation mit LVM</a></p></li><li><p><a class="internal" href="./howto/lvm_nachträglich_einrichten.html">Howto/LVM nachträglich einrichten</a> - für fortgeschrittene Nutzer: nachträglich einen LVM einrichten</p></li></ul><p>
</p></div><div class="section_2"><h3 id="extern">extern<a class="headerlink" href="#extern">¶</a></h3><p>
</p><ul><li><p><a class="external" href="http://www.pro-linux.de/kurztipps/2/1562/linux-optimal-partitionieren.html" rel="nofollow">Linux optimal partitionieren</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Pro-Linux, 04/2012</p></li><li><p><a class="interwiki interwiki-youtube" href="https://www.youtube.com/watch?v=6uO5rXBk0pk">LVM Vortrag von Stefan Betz</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - Ubucon, 10/2014 </p></li></ul><p></p></div></div></div>
<p class="meta">
<a href="./logical_volume_manager/a/revision/915578.html">Diese Revision</a> wurde am 29. Oktober 2016 15:02 von <a href="https://ubuntuusers.de/user/Scarabol/">Scarabol</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./logical_volume_manager.html">Logical Volume Manager</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>