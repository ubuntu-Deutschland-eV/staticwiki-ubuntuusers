<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Cron › ubuntuusers statisches Wiki</title>
<link href="./_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="./_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="./_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="./_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="./_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="./_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="./startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="./cron.html">Cron</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/Cron">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="./wiki/index.html">Index</a></li>
<li><a href="./wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="./wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="./wiki.html">Übersicht</a></li>
<li><a href="./wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="./wiki/benutzung.html">Benutzung</a></li>
<li><a href="./kategorien.html">Kategorie</a></li>
<li><a href="./wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="./wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="./howto.html">Howto anlegen</a></li>
<li><a href="./wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="./wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="./baustelle.html">Baustellen</a></li>
<li><a href="./wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="./wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="./wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="./wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="./cron/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="./cron/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="./cron/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="./cron/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="./cron/a/backlinks.html">Cron</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="./terminal.html">Ein Terminal öffnen</a> </p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="./pakete_installieren.html">Pakete installieren</a>, <em>optional</em></p></li></ol></div></div><p>
</p><div class="toc toc-depth-2"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Installation">Installation
</a></li><li><a class="crosslink" href="#Cronjobs-ueber-eine-GUI-bearbeiten">Cronjobs über eine GUI bearbeiten
</a><ol class="arabic"><li><a class="crosslink" href="#KDE">KDE
</a></li></ol></li><li><a class="crosslink" href="#Cronjobs-manuell-einrichten">Cronjobs manuell einrichten
</a><ol class="arabic"><li><a class="crosslink" href="#Eine-Crontab-fuer-einen-Benutzer-einrichten">Eine Crontab für einen Benutzer einricht...</a></li><li><a class="crosslink" href="#Benachrichtigungen-fuer-bestimmte-Benutzer-versenden">Benachrichtigungen für bestimmte Benutze...</a></li><li><a class="crosslink" href="#Cron-Tabelle-des-Benutzers-Root">Cron-Tabelle des Benutzers Root
</a></li></ol></li><li><a class="crosslink" href="#Die-systemweite-Cron-Tabelle-etc-crontab">Die systemweite Cron-Tabelle /etc/crontab
</a></li><li><a class="crosslink" href="#Anacron-Anac-h-ronistic-Cron">Anacron - Anac(h)ronistic Cron
</a><ol class="arabic"><li><a class="crosslink" href="#Anacron-Konfiguration">Anacron-Konfiguration
</a></li></ol></li><li><a class="crosslink" href="#Tricks">Tricks
</a><ol class="arabic"><li><a class="crosslink" href="#Zugriff-auf-GNOME-Keyring-ermoeglichen">Zugriff auf GNOME-Keyring ermöglichen
</a></li></ol></li><li><a class="crosslink" href="#Haeufige-Fehler">Häufige Fehler
</a><ol class="arabic"><li><a class="crosslink" href="#Befehl-klappt-in-Skript-und-Shell-aber-nicht-im-Cronjob">Befehl klappt in Skript und Shell, aber ...</a></li><li><a class="crosslink" href="#date-Formate-z-B-date-Y-m-d-fuer-Dateinamen-oder-Log-Ausgaben">date-Formate (z.B. $(date +"%Y%m%d") für...</a></li><li><a class="crosslink" href="#Anacron">Anacron
</a></li><li><a class="crosslink" href="#Fenster-einer-Anwendung-oeffnet-sich-nicht">Fenster einer Anwendung öffnet sich nich...</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><p><img alt="Wiki/Icons/time.png" class="image-left" src="./_/32cf85a1e028582e495318c1e2b5ec63c4a14b4a.png"/>
Der <a class="interwiki interwiki-wikipedia" href="https://de.wikipedia.org/wiki/Cron">Cron-Daemon</a> ist ein Dienst, der automatisch Skripte und Programme zu vorgegebenen Zeiten  starten kann. Der auszuführende Befehl wird in einer Tabelle, der "crontab", gespeichert. Es gibt eine systemweite Datei <strong>/etc/crontab</strong>, die nur mit Root-Rechten bearbeitet werden kann. Zusätzlich kann jeder Benutzer eine eigene Crontab erstellen, die man dann im Verzeichnis <strong>/var/spool/cron/crontabs/</strong> findet.</p><p>Diese Tabelle besteht aus sieben bzw. sechs Spalten. Die ersten fünf dienen der Zeitangabe (Minute, Stunde, Tag, Monat, Wochentage) für einen Cronjob, dann folgt (nur in der systemweiten Crontab) der Benutzername, unter dem der Befehl ausgeführt werden soll, und die letzte enthält den Befehl. Die einzelnen Spalten werden durch Leerzeichen oder Tabulatoren getrennt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Sollte während der automatisierten Ausführung ein Fehler auftreten, so versucht Cron, diese Fehlermeldung per E-Mail an den Systemadministrator bzw. den Benutzer zu schicken. Dies ist allerdings nur möglich, wenn ein sogenannter "Mail Transfer Agent" oder kurz MTA - beispielsweise <a class="internal" href="./postfix.html">Postfix</a> - installiert ist. 
</p></div></div><div class="section_1"><h2 id="Installation">Installation<a class="headerlink" href="#Installation">¶</a></h2><p>
Der Dienst und seine Verwaltungswerkzeuge für die Kommandozeile ist in jeder Ubuntu-Installation bereits enthalten und ist im Paket</p><ul><li><p><strong>cron</strong></p></li></ul><p>
enthalten.</p></div><div class="section_1"><h2 id="Cronjobs-ueber-eine-GUI-bearbeiten">Cronjobs über eine GUI bearbeiten<a class="headerlink" href="#Cronjobs-ueber-eine-GUI-bearbeiten">¶</a></h2><p>
<img alt="./gnome-schedule.png" class="image-right" src="./_/f34621ad28a445f9d3726c10fc7e45a19b36848d.png"/></p><p>Für zahlreiche auf der Grafikbibliothek <a class="internal" href="./gtk.html">GTK</a> basierenden Desktop-Umgebungen gibt es das Programm <a class="internal" href="./gnome_schedule.html">GNOME Schedule</a>, um Cronjobs über eine grafische Oberfläche verwalten zu können. Nähere Informationen finden sich auf der Seite von <a class="internal" href="./gnome_schedule.html">GNOME Schedule</a>.</p><p><img alt="./Cron/kcron.png" class="image-right" src="./_/7ebfa665eef160a2227d55807d7d38dcc151120f.png"/></p><div class="section_2"><h3 id="KDE">KDE<a class="headerlink" href="#KDE">¶</a></h3><p>
Unter KDE gibt es für diese Aufgabe das Paket <strong>kde-config-cron</strong>. Das Programm ist Teil des <a class="internal" href="./kde_software_compilation.html#KDE-Komponenten">KDE Metapakets</a> <strong>kdeadmin</strong>. Nach der Installation findet man es unter</p><ul><li><p><em>"Systemeinstellungen -&gt; Systemverwaltung -&gt; Aufgabenplaner"</em></p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Cronjobs-manuell-einrichten">Cronjobs manuell einrichten<a class="headerlink" href="#Cronjobs-manuell-einrichten">¶</a></h2><p>
</p><div class="section_2"><h3 id="Eine-Crontab-fuer-einen-Benutzer-einrichten">Eine Crontab für einen Benutzer einrichten<a class="headerlink" href="#Eine-Crontab-fuer-einen-Benutzer-einrichten">¶</a></h3><p>
Um eine eigene Tabelle für einen Benutzer einzurichten, muss man ein Terminal-Fenster öffnen <sup><a href="#source-1">[1]</a></sup> und den Befehl zum Editieren der Tabelle eingeben:</p><div class="bash"><div class="contents"><pre class="notranslate">crontab -e </pre></div></div><p>Aus historischen Gründen wird eine Crontab mit einem Kommandozeileneditor bearbeitet. Wurde noch kein Editor festgelegt, erscheint folgende Auswahl:</p><pre class="notranslate">no crontab for BENUTZERNAME - using an empty one

Select an editor.  To change later, run 'select-editor'.
  1. /bin/ed
  2. /bin/nano        &lt;---- easiest
  3. /usr/bin/jmacs
  4. /usr/bin/joe
  5. /usr/bin/jpico
  6. /usr/bin/jstar
  7. /usr/bin/rjoe
  8. /usr/bin/vim.tiny

Choose 1-8 [2]: </pre><p>
Der ausgewählte Editor wird in der versteckten Datei <strong>~/.selected_editor</strong> im <a class="internal" href="./homeverzeichnis.html">Homeverzeichnis</a> gespeichert. Möchte man die getroffene Entscheidung später wieder ändern, löscht man diese Datei oder benutzt wie angegeben den Befehl:</p><div class="bash"><div class="contents"><pre class="notranslate">select-editor </pre></div></div><p>
Alternativ – falls man den Editor nur für die aktuelle Bearbeitung ändern möchte – kann dieser auch direkt angegeben werden (hier am Beispiel von <a class="internal" href="./vim.html">VIM</a>):</p><div class="bash"><div class="contents"><pre class="notranslate">EDITOR=vim.tiny crontab -e </pre></div></div><p>Besaß der Benutzer bisher noch keine Crontab, so enthält die Datei nur ein paar Kommentare. Hier ein Beispiel für eine Crontab:</p><pre class="notranslate">#-----------------------------------------------------------------
# Shell variable for cron
SHELL=/bin/bash
# PATH variable for cron
PATH=/usr/local/bin:/usr/local/sbin:/sbin:/usr/sbin:/bin:/usr/bin:/usr/bin/X11
#M   S     T M W   Befehl
#-----------------------------------------------------------------
5    9-20 * * *   /home/BENUTZERNAME/script/script1.sh &gt; /dev/null
*/10 *    * * *   /usr/bin/script2.sh &gt; /dev/null 2&gt;&amp;1
59   23   * * 0,4 cp QUELLDATEI ZIELDATEI
*    *    * * *   DISPLAY=:0 LANG=de_DE.UTF-8 zenity --info --text "Beispiel für das Starten eines Programms mit GUI"
0    0    * * *   backup
#-----------------------------------------------------------------</pre><p>Im ersten Abschnitt stehen die Angaben für die Variablen <code class="notranslate">$PATH</code> und <code class="notranslate">$SHELL</code>. Im unteren Teil dann die einzelnen Cronjobs. In einer Zeile kommen zuerst die fünf Felder für die Zeiten (Minute, Stunde, Tag, Monat, Wochentage) und danach der auszuführende Befehl. In diesem Beispiel werden die Befehle</p><ol class="arabic"><li><p>Fünf Minuten nach jeder vollen Stunde zwischen 9 und 20 Uhr (also 9:05, 10:05, ..., 20:05) </p></li><li><p>Alle 10 Minuten </p></li><li><p>Jeden Sonntag und Donnerstag um 23:59 </p></li><li><p>Jede Minute ein Programm mit GUI, das die Display- und die Sprach-Variable benötigt</p></li><li><p>Jeden Tag Punkt Mitternacht 00:00 Uhr </p></li></ol><p>ausgeführt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Wichtig ist, dass am Ende der Tabelle ein Kommentar oder eine Leerzeile stehen. Ähnlich wie die <a class="internal" href="./fstab.html">fstab</a> muss die <strong>crontab</strong> mit einer Leerzeile enden! 
</p></div></div><p>Erzeugt der durch den Cron-Daemon aufgerufene Befehl eine Ausgabe, so wird alles, was auf der Konsole ausgegeben wird, an den Benutzer per E-Mail geschickt, unter dessen Benutzerkonto der Befehl ausgeführt wurde. Möchte man dies nicht, so muss man die Ausgabe umleiten.</p><p>Als Beispiel soll ein Server daraufhin überprüft werden, ob dieser online ist. Hierzu wird alle fünf Minuten ein Ping an den Rechner geschickt. Ein erfolgreicher Ping ist uninteressant, im Falle eines Fehlers sollte jedoch der Cronjob eine E-Mail mit dem Ergebnis des gescheiterten Pings ausgeben. Dies erreicht man, indem die Standardausgabe an <strong>/dev/null</strong> umleitet. Fehlermeldungen werden dadurch - wie gewünscht - verschickt, das positive Ergebnis verworfen.</p><pre class="notranslate">*/5 * * * * ping -c 1 192.168.0.1 &gt; /dev/null</pre><p>Möchte man keinerlei Ausgaben des Cronjobs erhalten - z. B. bei einem regelmäßigen Ping an eine Internetadresse, um zu verhindern, dass die Dial-Up-Verbindung getrennt wird - so muss die Weiterleitung wie folgt aussehen:</p><pre class="notranslate">*/5 * * * * ping -c 1 www.google.de &gt; /dev/null 2&gt;&amp;1</pre><p>Dadurch wird jegliche Ausgabe des Cronjobs verworfen. 
Mehr Informationen zur Weiterleitung findet man im Artikel zu <a class="internal" href="./shell/umleitungen.html">Umleitungen</a>.</p><p>Hier ist noch kurz eine Übersicht, wie sich der Cronjob aufbaut:</p><pre class="notranslate">*     *     *     *     *  Befehl der ausgeführt werden soll
-     -     -     -     -
|     |     |     |     |
|     |     |     |     +----- Wochentag (0 - 7) (Sonntag ist 0 und 7; oder Namen, siehe unten)
|     |     |     +------- Monat (1 - 12)
|     |     +--------- Tag (1 - 31)
|     +----------- Stunde (0 - 23)
+------------- Minute (0 - 59; oder Namen, siehe unten)</pre><p>Für die Wochentage und die Monate können die drei ersten Buchstaben des englischen Namen benutzt werden, z. B. <code class="notranslate">Sun</code> für Sonntag. Groß-/Kleinschreibung spielt dabei keine Rolle, allerdings sind keine Angaben von Zeiträumen erlaubt, dazu müssen Ziffern verwendet werden.</p><p>Angaben von Zeiträumen und Schrittweiten innerhalb dieser Zeiträume sind erlaubt, sofern Ziffern benutzt werden. Setzt man beispielsweise für die Stunde <code class="notranslate">8-10</code>, wird der Befehl in den Stunden 8, 9 und 10 Uhr ausgeführt. Statt der Schreibweise <code class="notranslate">8-10</code> kann auch <code class="notranslate">8,9,10</code> geschrieben werden.</p><p>Setzt man hingegen <code class="notranslate">*/2</code> wird der Befehl jede zweite Stunde ausgeführt. Beides kann kombiniert werden, so bedeutet <code class="notranslate">1-9/2</code> dasselbe wie <code class="notranslate">1,3,5,7,9</code>.</p><p>Man sollte aber bedenken, dass <code class="notranslate">* */2 * * *</code> beispielsweise den Befehl 60 mal (also zu jeder Minute) jede zweite Stunde ausführt.</p><p>Zur Vereinfachung können die ersten fünf Felder auch durch eine einzelne Zeichenkette ersetzt werden. Hierfür sind acht Schlüsselwörter definiert:</p><p>
</p><table><tr class="kopf"><td> String </td><td> Bedeutung </td><td> cron-Schreibweise </td></tr><tr><td> <code class="notranslate">@reboot</code> </td><td> einmalig, beim Start </td><td> </td></tr><tr><td> <code class="notranslate">@daily</code> </td><td> einmal pro Tag </td><td> 0 0 * * * </td></tr><tr><td> <code class="notranslate">@midnight</code> </td><td> einmal pro Tag </td><td> 0 0 * * * </td></tr><tr><td> <code class="notranslate">@hourly</code> </td><td> einmal pro Stunde </td><td> 0 * * * * </td></tr><tr><td> <code class="notranslate">@weekly</code> </td><td> einmal pro Woche </td><td> 0 0 * * 0 </td></tr><tr><td> <code class="notranslate">@monthly</code> </td><td> einmal im Monat </td><td> 0 0 1 * * </td></tr><tr><td> <code class="notranslate">@annually</code> </td><td> einmal im Jahr </td><td> 0 0 1 1 * </td></tr><tr><td> <code class="notranslate">@yearly</code> </td><td> einmal im Jahr </td><td> 0 0 1 1 * </td></tr></table></div><div class="section_2"><h3 id="Benachrichtigungen-fuer-bestimmte-Benutzer-versenden">Benachrichtigungen für bestimmte Benutzer versenden<a class="headerlink" href="#Benachrichtigungen-fuer-bestimmte-Benutzer-versenden">¶</a></h3><p>
Mit der <code class="notranslate">MAILTO</code>-Variable kann ein Empfänger für die Benachrichtigungen unabhängig vom Besitzer der Cron-Tabelle festgelegt werden (<code class="notranslate">MAILTO=irgendwer</code>). Wird die Variable als inhaltsleer deklariert (<code class="notranslate">MAILTO=""</code>), so werden keine Benachrichtigungen versendet.</p></div><div class="section_2"><h3 id="Cron-Tabelle-des-Benutzers-Root">Cron-Tabelle des Benutzers Root<a class="headerlink" href="#Cron-Tabelle-des-Benutzers-Root">¶</a></h3><p>
Natürlich kann auch root eine Crontab anlegen. Alle Cronjobs, die in dieser Tabelle stehen, werden mit Root-Rechten ausgeführt:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo crontab -e </pre></div></div></div></div><div class="section_1"><h2 id="Die-systemweite-Cron-Tabelle-etc-crontab">Die systemweite Cron-Tabelle /etc/crontab<a class="headerlink" href="#Die-systemweite-Cron-Tabelle-etc-crontab">¶</a></h2><p>
Möchte man jedoch einen Cronjob erstellen, der mit speziellen Rechten ausgeführt werden soll, so bietet es sich an, diesen Job in die systemweite Cron-Tabelle einzutragen. Diese Tabelle unterscheidet sich nicht stark von einer normalen Cron-Tabelle, sie besitzt jedoch noch eine Spalte mehr, in der der Benutzer eingetragen wird, unter dem der jeweilige Befehl ausgeführt werden soll.</p><pre class="notranslate"># /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file.
# This file also has a username field, that none of the other crontabs do.
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
# m h dom mon dow user  command
17  *   * * *   root      run-parts --report /etc/cron.hourly
59 23   * * *   username  /pfad/zu/skript.sh</pre><p>Dies ist besonders nützlich, wenn Server, die ihren eigenen Benutzer haben, wie z.B. Apache mit <code class="notranslate">www-data</code>, über cronjobs gesteuert werden sollen. Oder wenn man für Benutzer Jobs anlegen möchte, die der Nutzer jedoch selber nicht verändern können soll.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Neben der <strong>/etc/crontab</strong> werden auch alle Dateien im Verzeichnis <strong>/etc/cron.d/</strong> von Cron gelesen. Dieses Verzeichnis ist dafür gedacht, dass Pakete, die eigene Cronjobs mitbringen, diese ablegen können. Es wird empfohlen, für eigene Cronjobs die <strong>/etc/crontab</strong> zu verwenden.
</p></div></div><p>Ruft man die <a class="internal" href="./man.html">manpage</a> für crontab mit <code class="notranslate">man crontab</code> auf, so wird die manpage für das Programm <code class="notranslate">crontab</code> angezeigt. Die manpage für die Struktur der Tabelle bekommt man zu Gesicht, wenn man <code class="notranslate">man 5 crontab</code> aufruft - 5 steht für die Gruppe der Konfigurationsdateien.</p><p><a class="crosslink anchor" href="#anacron" id="anacron"></a>
</p></div><div class="section_1"><h2 id="Anacron-Anac-h-ronistic-Cron">Anacron - Anac(h)ronistic Cron<a class="headerlink" href="#Anacron-Anac-h-ronistic-Cron">¶</a></h2><p>
Cron startet einzelne Cronjobs immer nur zu den eingetragenen Zeiten. Legt man also einen Cronjob an, der täglich um 18.00 Uhr ausgeführt wird, so wird der Job an diesem Tag nur ausgeführt, wenn der Rechner um Punkt 18 Uhr angeschaltet war. Für Jobs, die regelmäßig ausgeführt werden müssen, wobei der Rechner nicht durchgehend läuft, ist Cron daher nicht ideal. Wenn man Pech hat, wird z.B. eine wichtige Datensicherung ("backup") verpasst.</p><p>Als Ergänzung zu Cron bietet sich daher Anacron an. Anacron ist ein cron-ähnlicher Taskplaner, allerdings erfordert er nicht das kontinuierliche Laufen des Systems. Er kann zum Ausführen von täglich, wöchentlich oder monatlich (und ab Ubuntu 14.04 auch stündlich) anstehenden Aufträgen verwendet werden, die normalerweise von cron ausgeführt werden.</p><p>Anstatt einer Crontab muss nur das auszuführende Skript oder Programm in das entsprechende Verzeichnis des Anacron-Dienstes kopiert oder verlinkt werden.</p><ul><li><p><strong>/etc/cron.hourly/</strong> - stündlich auszuführen, erst ab Ubuntu 14.04</p></li><li><p><strong>/etc/cron.daily/</strong> - täglich auszuführen</p></li><li><p><strong>/etc/cron.weekly/</strong> - wöchentlich auszuführen</p></li><li><p><strong>/etc/cron.monthly/</strong> - monatlich auszuführen</p></li></ul><p>
Die Namen der Verzeichnisse sprechen für sich. Skripte, die dort abgelegt sind, werden auch durch den Anacron-Dienst ausgeführt. Am besten schaut man sich kurz die Skripte in diesen Verzeichnissen an, bevor man selber dort etwas ablegt.</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Der Skriptname darf nur große und kleine Buchstaben, Ziffern, Unterstriche und Bindestriche enthalten. Andernfalls wird das Skript nicht ausgeführt. Das exakte Zeichenalphabet wird durch folgenden regulären Ausdruck definiert: "^[a-zA-Z0-9_-]+$". Punkt und Umlaute sind also beispielsweise nicht erlaubt.
</p></div></div><p>Wenn ein Laptop ohne Netzstrom läuft, werden Anacron und alle ggf. laufenden Aufgaben beendet. Sobald der Laptop an die Stromversorgung angeschlossen wird, wird Anacron wieder gestartet. Zuständig dafür ist die Datei <strong>/usr/lib/pm-utils/power.d/anacron</strong>.</p><div class="section_2"><h3 id="Anacron-Konfiguration">Anacron-Konfiguration<a class="headerlink" href="#Anacron-Konfiguration">¶</a></h3><p>
Möchte man Jobs täglich, wöchentlich oder monatlich (oder stündlich ab Ubuntu 14.04) ausführen, muss keine Konfiguration für Anacron vorgenommen werden. Es ist aber möglich, die Perioden zu verändern. Dazu ändert man die Konfigurationsdatei <strong>/etc/anacrontab</strong>. Kürzere Perioden als täglich sind in anacrontab vor Ubuntu 14.04 nicht einstellbar (dafür verwendet man Cron), ab Ubuntu 14.04 gibt es das Verzeichnis <strong>/etc/cron.hourly/</strong>.</p><p>Die Datei erwartet folgendes Format:
</p><pre class="notranslate">*     *     *    Befehl der ausgeführt werden soll
|     |     |     
|     |     +--------- job-identifier (Datei für den Zeitstempel)
|     +----------- delay (Zeitverzögerung nach Systemstart in Minuten)
+------------- period (Zeit in Tagen)</pre><p>Beispiel für period-Angabe:
</p><ul><li><p>1 – täglich</p></li><li><p>7 – wöchentlich</p></li><li><p>30 – monatlich</p></li></ul><p>
Es ist jede andere Zahl möglich.</p><p>Für monatliche Jobs kann als Periode auch <code class="notranslate">@monthly</code> verwendet werden.</p><p>
</p><table><tr class="kopf"><td> Feld </td><td> Bedeutung </td></tr><tr><td> <code class="notranslate">period</code> </td><td> Periode der Jobausführung in Tagen </td></tr><tr><td> <code class="notranslate">delay</code> </td><td> Startverzögerung des Jobs nach Systemstart (in Minuten) </td></tr><tr><td> <code class="notranslate">job-identifier</code> </td><td> Zeitstempel Datei, in diese wird der Zeitstempel geschrieben, damit der Job innerhalb der Periode nur einmal ausgeführt wird. Z. B. Bei täglichen Aufgaben aber mehrmaligem Start des Systems an einem Tag. </td></tr><tr><td> <code class="notranslate">command</code> </td><td> Befehl oder auszuführendes Skript </td></tr></table><p>Die Standardeinstellungen in <strong>/etc/anacrontab</strong> am Beispiel von <a class="internal" href="./oneiric.html">Ubuntu 11.10</a>:</p><pre class="notranslate"># /etc/anacrontab: configuration file for anacron
# See anacron(8) and anacrontab(5) for details.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# These replace cron's entries
1	5	cron.daily	 nice run-parts --report /etc/cron.daily
7	10	cron.weekly	 nice run-parts --report /etc/cron.weekly
@monthly	15	cron.monthly nice run-parts --report /etc/cron.monthly</pre><p>Weitere Umgebungsvariablen, die in der Beispieldatei in den Block zu <code class="notranslate">SHELL</code> und <code class="notranslate">PATH</code> hinzugefügt werden können:</p><ul><li><p><code class="notranslate">MAILTO</code> - Wie auch in der <strong>/etc/crontab</strong> ist es in der <strong>/etc/anacrontab</strong> möglich, vom System automatisch E-Mails versenden zu lassen: </p><pre class="notranslate">MAILTO="user@localhost"</pre><p> Für den E-Mail-Versand muss ein MTA (Mail Transfer Agent) wie z.B. <a class="internal" href="./postfix.html">postfix</a> installiert sein.</p></li></ul><p>
</p></div></div><div class="section_1"><h2 id="Tricks">Tricks<a class="headerlink" href="#Tricks">¶</a></h2><p>
</p><div class="section_2"><h3 id="Zugriff-auf-GNOME-Keyring-ermoeglichen">Zugriff auf GNOME-Keyring ermöglichen<a class="headerlink" href="#Zugriff-auf-GNOME-Keyring-ermoeglichen">¶</a></h3><p>
Konfigurationen wie zum Beispiel Offlineimap benötigen je nach Einrichtung einen Zugriff auf den GNOME-Schlüsselring. Dazu muss die <code class="notranslate">DBUS_SESSION_BUS_ADDRESS</code> als Umgebungsvariable gesetzt sein. Ein mögliches Szenario besteht darin, nach der Anmeldung die Variable zu exportieren und die Adresse in einer versteckten Konfiguration im Homeverzeichnis zu hinterlegen. Der Cronjob kann dann auf die entsprechenden Werte zurückgreifen und so Zugriff auf den Schlüsselbund erlangen.</p><p>Dazu folgendes Startscript erstellen</p><div class="code"><table class="notranslate syntaxtable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="notranslate syntax"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># Exportiere die dbus session address, damit sie via Cron nutzbar ist</span>
<span class="c1"># Diese Datei muss via Autostart ausgeführt werden</span>

touch <span class="nv">$HOME</span>/.Xdbus
chmod <span class="m">600</span> <span class="nv">$HOME</span>/.Xdbus
env <span class="p">|</span> grep DBUS_SESSION_BUS_ADDRESS &gt; <span class="nv">$HOME</span>/.Xdbus
<span class="nb">echo</span> <span class="s1">'export DBUS_SESSION_BUS_ADDRESS'</span> &gt;&gt; <span class="nv">$HOME</span>/.Xdbus
</pre></div>
</td></tr></table></div><p>Danach muss das Script via  <a class="internal" href="./autostart.html">Autostart</a> ausgeführt werden. Nun können im Cronjob mit <code class="notranslate">source $HOME/.Xdbus; BEFEHL</code> die benötigten Angaben verfügbar gemacht werden.</p></div></div><div class="section_1"><h2 id="Haeufige-Fehler">Häufige Fehler<a class="headerlink" href="#Haeufige-Fehler">¶</a></h2><p>
</p><div class="section_2"><h3 id="Befehl-klappt-in-Skript-und-Shell-aber-nicht-im-Cronjob">Befehl klappt in Skript und Shell, aber nicht im Cronjob<a class="headerlink" href="#Befehl-klappt-in-Skript-und-Shell-aber-nicht-im-Cronjob">¶</a></h3><p>
Vermutlich wurde die <code class="notranslate">PATH</code>-Variable nicht, wie oben im Beispiel, gesetzt und Cron findet Kommandos nicht, die von der Konsole fehlerfrei funktionieren. Cron benutzt von sich aus nicht die <code class="notranslate">PATH</code>-Variable des Users, sondern <code class="notranslate">PATH="/usr/bin:/bin"</code>, sodass man entweder einen anderen <code class="notranslate">PATH</code> definieren oder die benutzten Programme mit vollem Pfad aufrufen muss.</p><p>Wenn ein Skript in der Konsole funktioniert, nicht aber wenn es über die systemweite Cron-Tabelle gestartet wird, kann das daran liegen, dass sich das Startverhalten einer Shell über eine Cron-Tabelle von dem einer Loginshell unterscheidet. In diesem Fall sollte man das Skript anpassen oder folgenden Befehl in die Cron-Tabelle eintragen:</p><pre class="notranslate">/bin/bash --login /PFAD/ZUM/SKRIPT.sh</pre></div><div class="section_2"><h3 id="date-Formate-z-B-date-Y-m-d-fuer-Dateinamen-oder-Log-Ausgaben">date-Formate (z.B. $(date +"%Y%m%d") für Dateinamen oder Log-Ausgaben<a class="headerlink" href="#date-Formate-z-B-date-Y-m-d-fuer-Dateinamen-oder-Log-Ausgaben">¶</a></h3><p>
Während in einem Skript und der Shell eine Formatierung wie:</p><div class="bash"><div class="contents"><pre class="notranslate">echo cron-test1-$(date +"%Y%m%d-%H_%M") &gt;&gt; /tmp/cron-test.txt </pre></div></div><p>problemlos Funktioniert, so werden die <code class="notranslate">%</code>-Zeichen in Cron als Zeilenumbruch interpretiert und es kommt somit zu Fehlern. Als Problemlösung bietet sich an, entweder die Befehle über eigene Skripte auszuführen, oder man setzt vor jedes %-Zeichen einen Backslash '\'. Für obiges Beispiel lautet der entsprechende Eintrag in der crontab dann:</p><pre class="notranslate">*/2 * * * * heinz echo cron-test1-$(date +"\%Y\%m\%d-\%H_\%M") &gt;&gt; /tmp/cron-test.txt</pre><p>Genauere Informationen dazu sind z.B. in der Anleitung <a class="external" href="http://www.hcidata.info/crontab.htm" rel="nofollow">Crontab and %</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> zu finden.</p></div><div class="section_2"><h3 id="Anacron">Anacron<a class="headerlink" href="#Anacron">¶</a></h3><p>
Wenn Anacron verwendet wird, darf im Dateinamen kein Punkt enthalten sein! Mehr zu den Dateinamen findet sich oben im Hinweiskasten von <a class="crosslink" href="#anacron">Anacron: Anac(h)ronistic Cron</a></p></div><div class="section_2"><h3 id="Fenster-einer-Anwendung-oeffnet-sich-nicht">Fenster einer Anwendung öffnet sich nicht<a class="headerlink" href="#Fenster-einer-Anwendung-oeffnet-sich-nicht">¶</a></h3><p>
Cron hat von Haus aus keinen Zugriff auf den Bildschirm. Cron ist in erster Linie für Server gedacht, die oftmals an gar keinen Bildschirm angeschlossen sind. Die Ausgabe der Kommandos wird auch nicht auf den Bildschirm geschrieben - das könnte auch sehr störend sein - sondern in Logdateien, bzw. in Mails, sofern eingerichtet, die an den Benutzer oder Administrator geschickt werden. Will man ausdrücklich ein Fenster öffnen, so muss man die Display-Variable setzen wie im zenity-Beispiel oben: <code class="notranslate">DISPLAY=:0</code></p><p>Manchmal muss auch noch die Lokalisation eingestellt werden, damit man z.B. deutsche Oberflächen erhält und Umlaute funktionieren. Zenity verweigert ohne diese Einstellung ggf. sogar komplett den Dienst (siehe auch diese Foren-Posts: <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2483133/">1</a>, <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2671061/">2</a>, <a class="crosslink post" href="https://forum.ubuntuusers.de/post/2781486/">3</a>): <code class="notranslate">LANG=de_DE.utf8</code></p><p>Unter bestimmten Desktopumgebungen wie <a class="internal" href="./lxde.html">LXDE</a> (Lubuntu) oder <a class="internal" href="./xfce.html">XFCE</a> (Xubuntu) ist es zusätzlich nötig, die <code class="notranslate">XAUTHORITY</code>-Variable auf einen "vernünftigen" Wert zu setzen, um Programme mit grafischer Oberfläche starten zu lassen. Dies könnte beispielsweise unterhalb der Zeile geschehen, in der die <code class="notranslate">PATH</code>-Variable gesetzt wird (<code class="notranslate">PATH=/usr/local/bin:/usr/local/sbin...</code>). Hierzu fügt man einfach folgende Zeile - mit angepasstem Benutzernamen - ein:</p><pre class="notranslate">XAUTHORITY=/home/BENUTZERNAME/.Xauthority</pre><p>Der Benutzername ist durch denjenigen zu ersetzen, der den Befehl <code class="notranslate">crontab -e</code> abgesetzt hat.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="./shell/umleitungen.html">Umleitungen</a> - die Ausgabe von Shell-Befehlen umlenken</p></li><li><p><a class="external" href="https://grinux.wordpress.com/2012/04/18/run-anacron-as-user/" rel="nofollow">Run anacron as user</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Blogbeitrag, 04/2012</p></li><li><p><a class="external" href="http://jason.the-graham.com/2011/01/16/gnome_keyring_with_msmtp_imapfilter_offlineimap/" rel="nofollow">Using Gnome Keyring With Msmtp, Offlineimap, and Imapfilter via Cron</a> <img alt="{en}" src="./_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> - Blogbeitrag, 01/2011</p></li><li><p><a class="external" href="http://www.linux-user.de/ausgabe/2006/02/094-zubefehl/index.html" rel="nofollow">Punktlandung – Cron, At</a> <img alt="{de}" src="./_/ffd333e1d59794eac31aea8b3e984e1b88473c33.png"/> - LinuxUser, 02/2006</p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="./cron/a/revision/932083.html">Diese Revision</a> wurde am 27. Januar 2017 17:23 von <a href="https://ubuntuusers.de/user/gerhardbeck/">gerhardbeck</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="./startseite.html">Wiki</a></li>
<li><a href="./cron.html">Cron</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="./_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="./_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="./_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="./_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>