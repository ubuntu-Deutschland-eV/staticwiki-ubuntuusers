<!DOCTYPE html>
<html lang="">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>ecryptfs/Nutzung › ubuntuusers statisches Wiki</title>
<link href="../_/34e5d78db234405457773cc26741aada99f7fff2.css" rel="stylesheet" type="text/css"/>
<link href="../_/61af784fc5c93e296fec3be63b8e0bb48443727c.css" rel="stylesheet" type="text/css"/>
<link href="../_/634e8d1015b02df998cdec7cb07c5aff61d068b5.css" rel="stylesheet" type="text/css"/>
<link href="../_/b583ff7e37147497a59224ccf54cfee812a1d21b.css" rel="stylesheet" type="text/css"/>
<link href="../_/a0d5775ed6f36f8cc5b12bcf2f1c1bd98a3eb225.css" rel="stylesheet" type="text/css"/>
<link href="../_/98de73bded109a634cbd1e924abdd8c8964b8df2.css" media="print" rel="stylesheet" type="text/css"/>

<meta content="#a87300" name="theme-color"/>

</head>
<body>
<div class="wrap">
<div class="header">
<h1><a href="http://ubuntuusers.de/"><span>ubuntuusers.de</span></a></h1>
<ul class="tabbar">
<li class="portal">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ubuntuusers.de/">Portal<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="forum">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://forum.ubuntuusers.de/">Forum<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="wiki active">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/">Wiki<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="ikhaya">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://ikhaya.ubuntuusers.de/">Ikhaya<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="planet">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://planet.ubuntuusers.de/">Planet<span></span></a></div>
<div class="tab_right"></div>
</li>
<li class="community">
<div class="tab_left"></div>
<div class="tab_center"><a href="http://wiki.ubuntuusers.de/Mitmachen">Mitmachen<span></span></a></div>
<div class="tab_right"></div>
</li>
</ul>
</div>
<div class="body">
<div class="appheader">

<div class="pagetitle">
<h1 class="breadcrumb_title">
<a class="separator" href="../startseite.html">
              Wiki
            </a>
</h1>
<h2 class="breadcrumb_subtitle"><a href="../ecryptfs/nutzung.html">Nutzung</a></h2>
</div>
</div><div class="message staticwikinote"><strong>Hinweis:</strong> Dies ist ein statischer Snapshot unseres Wikis vom Jan. 17, 2018 und kann daher nicht bearbeitet werden. Der aktuelle Artikel ist unter <a href="http://wiki.ubuntuusers.de/ecryptfs/Nutzung">wiki.ubuntuusers.de</a> zu finden.</div>

<!--[if lt IE 8]>
      <div class="message fail">Bitte installiere den Internet Explorer 8 oder neuer.</div>
      <![endif]-->
<div class="page_content">
<div class="navi_sidebar navigation">
<div class="container">
<h3 class="navi_wiki">Wiki</h3>
<ul>
<li><a href="../wiki/index.html">Index</a></li>
<li><a href="../wiki/recentchanges.html">Letzte Änderungen</a></li>
<li><a href="../wiki/neue_artikel.html">Liste neuer Artikel</a></li>
<li><a href="../wiki.html">Übersicht</a></li>
<li><a href="../wiki/faq_-_häufig_gestellte_fragen.html">FAQ</a></li>
<li><a href="../wiki/benutzung.html">Benutzung</a></li>
<li><a href="../kategorien.html">Kategorie</a></li>
<li><a href="../wiki/tagcloud.html">Wortwolke</a></li>
</ul>
<h3 class="navi_join">Mitmachen</h3>
<ul>
<li><a href="../wikiartikel_anlegen.html">Wikiartikel anlegen</a></li>
<li><a href="../howto.html">Howto anlegen</a></li>
<li><a href="../wiki/referenz.html">Wiki-Referenz</a></li>
<li><a href="../wiki/syntax.html">Wiki-Syntax</a></li>
<li><a href="../baustelle.html">Baustellen</a></li>
<li><a href="../wiki/artikelideen.html">Artikelideen</a></li>
<li><a href="../wiki/ungetestet.html">Ungetestete Artikel</a></li>
<li><a href="../wiki/vorlagen/ausbaufähig/a/backlinks.html">Ausbaufähige Artikel</a></li>
<li><a href="../wiki/vorlagen/fehlerhaft/a/backlinks.html">Fehlerhafte Artikel</a></li>
<li><a href="https://forum.ubuntuusers.de/forum/wiki/">Rund ums Wiki</a></li>
</ul>
<h3 class="navi_config">Konfiguration</h3>
<ul>
<li><a href="../ecryptfs/nutzung/a/backlinks.html">Backlinks anzeigen</a></li>
<li>
        Exportieren
        <ul>
<li><a href="../ecryptfs/nutzung/a/export/meta.html" rel="nofollow">Metadaten</a></li>
<li><a href="../ecryptfs/nutzung/a/export/raw.html" rel="nofollow">Rohformat</a></li>
<li><a href="../ecryptfs/nutzung/a/export/html.html" rel="nofollow">HTML</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content content_tabbar content_sidebar">
<h1 class="pagetitle"><a href="../ecryptfs/nutzung/a/backlinks.html">Nutzung</a></h1>
<div id="page"><p>
</p><div class="box tested_for"><h3 class="box tested_for">Dieser Artikel wurde für die folgenden
Ubuntu-Versionen getestet:</h3><div class="contents"><p> 
Dieser Artikel ist größtenteils für alle Ubuntu-Versionen gültig.
</p></div></div><p>
</p><p>
</p><div class="box knowledge"><h3 class="box knowledge">Zum Verständnis dieses Artikels sind folgende Seiten hilfreich:</h3><div class="contents"><p>
</p><ol class="arabic"><li><p><a class="crosslink anchor" href="#source-1" id="source-1"></a> <a class="internal" href="../rechte.html">Rechte für Dateien und Ordner verändern</a></p></li><li><p><a class="crosslink anchor" href="#source-2" id="source-2"></a> <a class="internal" href="../terminal.html">Ein Terminal öffnen</a></p></li></ol></div></div><div class="toc toc-depth-3"><div class="head">Inhaltsverzeichnis</div><ol class="arabic"><li><a class="crosslink" href="#Nutzung">Nutzung
</a><ol class="arabic"><li><a class="crosslink" href="#Automatisches-Login">Automatisches Login
</a></li><li><a class="crosslink" href="#Manuelles-Sperren-Entsperren">Manuelles Sperren Entsperren
</a></li><li><a class="crosslink" href="#Wechsel-Login-Passwort">Wechsel Login-Passwort
</a></li><li><a class="crosslink" href="#Passphrase-extern-auslagern">Passphrase extern auslagern
</a></li><li><a class="crosslink" href="#Beispiele-Nutzung">Beispiele Nutzung
</a></li><li><a class="crosslink" href="#Anwendung-Server">Anwendung Server
</a></li><li><a class="crosslink" href="#Trash-bereinigen">Trash bereinigen
</a></li><li><a class="crosslink" href="#Daten-sichern">Daten sichern
</a><ol class="arabic"><li><a class="crosslink" href="#Systemdateien-sichern">Systemdateien sichern
</a></li><li><a class="crosslink" href="#Daten-im-Klartext">Daten im Klartext
</a></li><li><a class="crosslink" href="#Daten-in-codierter-Form">Daten in codierter Form
</a></li><li><a class="crosslink" href="#Sicherung-einsetzen">Sicherung einsetzen
</a></li></ol></li><li><a class="crosslink" href="#Separate-Partition-einbinden">Separate Partition einbinden
</a></li><li><a class="crosslink" href="#Dateinamen-mit-locate-anzeigen">Dateinamen mit locate anzeigen
</a></li></ol></li><li><a class="crosslink" href="#Links">Links
</a></li></ol></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Daten im "verschlüsselten" Bereich sind, sobald der jeweilige Benutzer sich angemeldet hat, auch prinzipiell von anderen Nutzern oder Anwendungen lesbar. Falls dies nicht gewünscht ist, sind die Rechte <sup><a href="#source-1">[1]</a></sup> entsprechend zu setzen.
</p></div></div><div class="section_1"><h2 id="Nutzung">Nutzung<a class="headerlink" href="#Nutzung">¶</a></h2><p>
<a class="external" href="http://ecryptfs.sourceforge.net/" rel="nofollow">ecryptfs-utils</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/> bietet eine sehr einfache Möglichkeit
</p><ul><li><p>einen einzelnen Ordner (<strong>~/Private</strong>)</p></li></ul><p>innerhalb vom <a class="internal" href="../homeverzeichnis.html">Homeverzeichnis</a>, bzw.
</p><ul><li><p>das gesamte Homeverzeichnis</p></li></ul><p>eines Benutzers zu verschlüsseln. Die Verschlüsselung läuft transparent, das Verzeichnis wird beim Einloggen automatisch entschlüsselt und beim Ausloggen wieder verschlüsselt. In vielen Fällen reicht das für die Nutzung schon aus.</p><div class="box experts"><h3 class="box experts">Experten-Info:</h3><div class="contents"><p>Es kann vorkommen, dass Programme noch vor dem Einloggen  bzw. gleich danach auf das Homeverzeichnis zugreifen wollen, aber weil die <em>"Freigabe"</em> noch nicht abgeschlossen ist, einen Fehler melden. Dieses muss man gezielt behandeln und ggf. in den <strong>init</strong>-Dateien die Startsequenz verändern oder die Programme aus den Diensten heraus nehmen bzw. neu orientieren! Siehe u.a Beispiel unter <a class="crosslink" href="#Separate-Partition-einbinden">Separate Partition einbinden</a>.</p><p>Um das Volumen für die Codierung/Decodierung in Grenzen zu halten, sollte man auf Folgendes achten: Symbolische Links wirken nur von außen nach innen, d.h. Daten, die im codierbaren Bereichen liegen, können von außen mit einem symbolischen Link aufgerufen werden und werden codiert, Daten die außerhalb liegen und mit symbolischen Links vom inneren Bereich angesprochen werden, werden <span class="underline">nicht</span> codiert.</p><p>Mit diesem Wissen kann man nun dafür sorgen, das Daten, die nicht unbedingt codiert werden müssen oder ein sehr großes Volumen darstellen (z.B. ISOs, Videos), via symbolischen Link nach außerhalb zu verlegen und somit die Rechenarbeit (-zeit) zu verringern.
</p></div></div><div class="section_2"><h3 id="Automatisches-Login">Automatisches Login<a class="headerlink" href="#Automatisches-Login">¶</a></h3><p>
</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bei einem <a class="internal" href="../gdm.html#Benutzer-ohne-Passwort-einloggen">automatischen Login</a> ist eine direkte Nutzung des Verzeichnisses nicht möglich, weil sonst der Aspekt der Daten-Sicherheit unterlaufen würde.
</p></div></div><p>Um die Daten nach einem automatischen Login zugänglich zu machen, muss man das <a class="internal" href="../homeverzeichnis.html">Homeverzeichnis</a> des Benutzers oder das Verzeichnis <strong>~/Private</strong> öffnen und auf die Datei <strong>Access Your Private Data</strong> klicken. Es öffnet sich daraufhin ein Terminal <sup><a href="#source-2">[2]</a></sup>, in das man das Login-Passwort eingeben kann. Nach Schließen des Terminals und des Verzeichnisses sind die Daten wie oben beschrieben zugänglich. Oder benutzt das folgend beschriebene manuelle Entsperren.</p></div><div class="section_2"><h3 id="Manuelles-Sperren-Entsperren">Manuelles Sperren Entsperren<a class="headerlink" href="#Manuelles-Sperren-Entsperren">¶</a></h3><p>
Will man das Verzeichnis <strong>~/Private</strong> sperren, während man eingeloggt ist, gibt man im Terminal <sup><a href="#source-1">[1]</a></sup> ein:</p><div class="bash"><div class="contents"><pre class="notranslate">ecryptfs-umount-private </pre></div></div><p>Umgekehrt kann man das Verzeichnis <strong>~/Private</strong> auch wieder manuell entsperren und damit den Zugriff auf die Daten freigeben, indem man in einem Terminal <sup><a href="#source-1">[1]</a></sup> eingibt:</p><div class="bash"><div class="contents"><pre class="notranslate">ecryptfs-mount-private </pre></div></div></div><div class="section_2"><h3 id="Wechsel-Login-Passwort">Wechsel Login-Passwort<a class="headerlink" href="#Wechsel-Login-Passwort">¶</a></h3><p>
Bei einer Änderung des Benutzerpassworts wird automatisch im Verschlüsselungssystem die relevante Anpassung der Verschlüsselung durchgeführt. Dies geschieht unabhängig davon, ob die Passwortänderung mittels einer Desktop-Anwendung oder in einer Konsole mittels Befehl <code class="notranslate">passwd</code> durchgeführt wird. Allerdings greift dieser Mechanismus nicht, wenn der Administrator einem anderen Benutzer ein (neues) Passwort setzt. In diesem Fall können folgende Anweisungen weiterhin hilfreich sein.</p><p>Für den reibungslosen Ablauf der Ver- und Entschlüsselung der Daten ist es notwendig, dass das Benutzerpasswort mit dem Passwort übereinstimmt, welches zum Schutz des ecryptfs-Schlüssels verwendet wird. Normalerweise kümmert sich das System um diesen Aspekt. Sollte es dennoch vorkommen, dass das (aktuelle) Benutzerkennwort und Schutzkennwort nicht mehr übereinstimmen, kann dies auf folgende Weise korrigiert werden. Wahrscheinlich ist es in diesen Fällen so, dass das Schutzkennwort noch einem früheren Benutzerkennwort entspricht.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Bei allen folgenden Befehlen weder ein <code class="notranslate">sudo</code> einsetzen noch ein <code class="notranslate">Administrator-Terminal</code> benutzen!
</p></div></div><ol class="arabic"><li><p>Backup der wrapped-passphrase Datei erstellen </p><div class="bash"><div class="contents"><pre class="notranslate">cd /home/&lt;benutzername&gt;/.ecryptfs
cp -f wrapped-passphrase wrapped-passphrase.old </pre></div></div></li><li><p>Danach die Passphrase notieren </p><div class="bash"><div class="contents"><pre class="notranslate">ecryptfs-unwrap-passphrase wrapped-passphrase
passphrase: &lt; altes Benutzerpasswort &gt; </pre></div></div><p> Sollte dieser Befehl mit der Meldung "Error: Unwrapping passphrase failed" quittiert werden, so war das gewählte Passwort nicht das notwendige Schutzpasswort. Eventuell auch auf Probleme mit Umlauten oder Tastaturbelegung achten. Ansonsten die ausgegebene Text/Zahlenfolge (Passphrase) notieren. </p></li><li><p>Optional: Benutzerpasswort ändern </p><div class="bash"><div class="contents"><pre class="notranslate">passwd  </pre></div></div><p> Dieser Schritt kann auch alternativ über die grafische Oberfläche (Gnome, KDE, etc.) gemacht werden.</p></li><li><p>Passphrase mit aktuellem Benutzerpasswort schützen </p><div class="bash"><div class="contents"><pre class="notranslate">ecryptfs-wrap-passphrase wrapped-passphrase  </pre></div></div><p> Es kommen die Aufforderungen: </p><div class="bash"><div class="contents"><pre class="notranslate">Passphrase to wrap:  &lt; Hier die Passphrase eingeben, die oben notiert wurde
Wrapping passphrase: &lt; Eingabe des neuen (aktuellen) Benutzerpassworts </pre></div></div></li></ol><p>
Nun sollte man sich abmelden, wieder anmelden und den Erfolg obiger Maßnahme überprüfen.
Falls nicht erfolgreich, muss man sich in der Konsole (STRG-ALT-F5) mit seinem Benutzernamen einloggen und man mit passwd sein Passwort zurücksetzen. Falls der Login immer noch nicht klappt kann man versuchen wrapped-passphrase.old zurückzukopieren. (Dabei natürlich auch die neue wrapped-passphrase sichern)</p></div><div class="section_2"><h3 id="Passphrase-extern-auslagern">Passphrase extern auslagern<a class="headerlink" href="#Passphrase-extern-auslagern">¶</a></h3><p>
Es ist grundsätzlich möglich, die Passphrase und zugehörige Dateien getrennt auf ein externes Medium (USB-Stick, Smartcard oder ähnlichen Medien) zu verlagern. Wichtig dabei ist nur, dass dieses Speichermedium beim Booten eingesteckt/verbunden ist, vom System erkannt wird und in der <strong>/etc/fstab</strong> eingetragen wurde z.B.:</p><pre class="notranslate">UUID=xxxx /home/.ecryptfs/&lt;Benutzername&gt;/.ecryptfs ext2 defaults 0  0</pre><p>Hinweise zum korrekten Pfad (siehe <a class="internal" href="../ecryptfs/datenrettung.html#Systempfade-der-Schluesseldateien">Systempfade</a>) der Schlüsseldateien. Wird eine getrennte Partition für <strong>/home</strong> benutzt, so ist obiger Eintrag in der <strong>/etc/fstab</strong> <span class="underline">danach</span> anzuordnen!</p><p>Wurden die Benutzerdaten nun auf diesem Speichermedium abgelegt (durch Verschieben der jeweiligen Nutzerdaten), werden sie nun von dort beim Einloggen abgefragt.</p></div><div class="section_2"><h3 id="Beispiele-Nutzung">Beispiele Nutzung<a class="headerlink" href="#Beispiele-Nutzung">¶</a></h3><p>
<a class="internal" href="../ssh.html">SSH</a>-Keys oder <a class="internal" href="../gnupg.html">GnuPG</a>-Keys sowie andere persönliche Daten z.B. <a class="internal" href="../thunderbird.html">Thunderbird</a> sollte man möglichst sicher aufbewahren, damit diese nicht in die falschen Hände geraten. Um dies zu verhindern, sollte man diese verschlüsselt auf der Festplatte ablegen. Dazu kann man die Festplatte komplett verschlüsseln, hat aber dann den Nachteil, dass <span class="underline">sämtliche</span> Schreib- und Lesezugriffe auf die Festplatte erstmal ver-/entschlüsselt werden müssen. Dies kann für manche Anwendungen einen massiven Geschwindigkeitsverlust bedeuten.</p><p>Mit verschlüsselten Verzeichnissen kann man diese Schlüssel, Verzeichnisse bzw. Dateien in das Verzeichnis
</p><ul><li><p><strong>~/Private</strong></p></li></ul><p>verschieben. Die Basis-Programme suchen aber nach den Daten in der Regel in eigens angelegten Verzeichnissen. Das kann man dann einfach mit einen Link abfangen (siehe im Terminal, <code class="notranslate">man ln</code>).</p><ul><li><p>Beispiel: <strong>.ssh-</strong>Daten</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">cd /home/&lt;Benutzername&gt;
mv .ssh Private/
ln -s /home/&lt;Benutzername&gt;/Private/.ssh </pre></div></div><ul><li><p>Beispiel: Thunderbird (persönliche Daten)</p></li></ul><div class="bash"><div class="contents"><pre class="notranslate">cd /home/&lt;Benutzername&gt;/.thunderbird/ujfyk3gt.default
mv Mail /home/&lt;Benutzername&gt;/Private/
ln -s /home/&lt;Benutzername&gt;/Private/Mail </pre></div></div></div><div class="section_2"><h3 id="Anwendung-Server">Anwendung Server<a class="headerlink" href="#Anwendung-Server">¶</a></h3><p>
Hat man auf einem Server ein <em>"verschlüsseltes"</em> Verzeichnis mit
</p><ul><li><p><strong>/home/&lt;Benutzername&gt;</strong> bzw.</p></li><li><p><strong>/home/&lt;Benutzername&gt;/Private</strong></p></li></ul><p>angelegt, so kann man auf dieses auch über eine <a class="internal" href="../ssh.html">SSH</a>-Verbindung zugreifen. Dafür ist auf dem Server nach dem Hochfahren keine Anmeldung durch einen dort angelegten Benutzer erforderlich (wichtig: normal hochfahren <span class="underline">bis zum Login</span>, nicht den <a class="internal" href="../recovery_modus.html">Recovery Modus</a> verwenden). Die Freischaltung des Verzeichnisses erfolgt dabei über <a class="internal" href="../ssh.html">SSH</a>, indem man sich von einem entfernten Rechner im Terminal z.B. mit</p><div class="bash"><div class="contents"><pre class="notranslate">ssh &lt;Benutzername&gt;@192.168.1.88 -p 4711
&lt;Benutzername&gt;@192.168.1.88 passwort: &lt;&lt; Login-Passwort von &lt;Benutzername&gt; </pre></div></div><p>am Server anmeldet. Dabei wird analog zu einer normalen Anmeldung das <em>"verschlüsselte"</em> Verzeichnis und damit die Daten freigegeben und genau so wird nach der Eingabe im Terminal von</p><div class="bash"><div class="contents"><pre class="notranslate">&lt;Benutzername&gt;@SERVER-NAME:~$ exit </pre></div></div><p>das Verzeichnis wieder gesperrt und die Verbindung abgebrochen.</p></div><div class="section_2"><h3 id="Trash-bereinigen">Trash bereinigen<a class="headerlink" href="#Trash-bereinigen">¶</a></h3><p>
</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Das folgende gilt nur für das Verzeichnis <strong>~/Private:</strong>
</p></div></div><p>Will man Daten aus dem Verzeichnis <strong>~/Private</strong> löschen, so muss man die Funktion <em>"Löschen"</em> im Kontext-Menü (<img alt="rechte Maustaste" class="image-default" src="../_/aa516ca8be74ff7de9b706b8ffc7a88e87e17fb5.png"/>-Klick auf dem zu löschenden Objekt) des eingesetzten Datei-Browsers wählen. Das Löschen mittels Kontext-Menü und der Option <em>"In den Müll verschieben"</em> belässt die Daten im versteckten Verzeichnis
</p><ul><li><p><strong>~/Private/.Trash-&lt;User-ID&gt;</strong></p></li></ul><p>so dass sich auf diese Weise <em>"gelöschte"</em> Dateien mit der Zeit ansammeln und ggf. zu Speicherplatz-Problemen führen können. Ist diese Funktion bei den relevanten Datei-Browsern nicht aktiviert, so kann man das einstellen - Informationen geben die jeweilige WIKI-Seite.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Dieses ist kein Fehler im Programm, sondern so vorgesehen, damit keine Daten unbeabsichtigt nach außerhalb des Verzeichnisses gelangen.
</p></div></div></div><div class="section_2"><h3 id="Daten-sichern">Daten sichern<a class="headerlink" href="#Daten-sichern">¶</a></h3><p>
Man kann die Daten, sowohl verschlüsselt als auch im Klartext einem Backup zuführen - das ist nun ganz von den Gegebenheiten sowie eigenen Wünschen abhängig. Nachfolgend werden beide Möglichkeiten beschrieben. Es ist auf jeden Fall ausreichend (externer) Speicherplatz bereit zu halten.</p><p>Dieses lässt sich im Terminal <sup><a href="#source-1">[1]</a></sup> bewerkstelligen bzw. es eignet sich dazu jedes Backup-Programm. Es sind nur die jeweils relevanten Pfade zu beachten.</p><div class="section_3"><h4 id="Systemdateien-sichern">Systemdateien sichern<a class="headerlink" href="#Systemdateien-sichern">¶</a></h4><p>
Man sollte auf jeden Fall sich eine Kopie der Dateien
</p><ul><li><p><strong>Private.mnt</strong></p></li><li><p><strong>Private.sig</strong></p></li><li><p><strong>wrapped-passphrase</strong></p></li></ul><p>anfertigen und getrennt von den Daten des <em>"Backup"</em> aufbewahren. Das kann ggf. auch in schriftlicher Form geschehen, da der Inhalt dieser Dateien überschaubar ist. Siehe die Ausführungen unter <a class="internal" href="../ecryptfs/datenrettung.html#Daten-wieder-herstellen">Daten wieder herstellen</a>.</p></div><div class="section_3"><h4 id="Daten-im-Klartext">Daten im Klartext<a class="headerlink" href="#Daten-im-Klartext">¶</a></h4><p>
Dazu muss der Benutzer angemeldet sein.</p><p>* gesamtes Homeverzeichnis</p><div class="bash"><div class="contents"><pre class="notranslate">rsync -ap /home/&lt;Benutzername&gt; /Pfad_zum_Ziel/ --delete  </pre></div></div><p>* Verzeichnis <strong>~/Private</strong></p><div class="bash"><div class="contents"><pre class="notranslate">rsync -ap /home/&lt;Benutzername&gt;/Private /Pfad_zum_Ziel/ --delete
rsync -ap /home/&lt;Benutzername&gt;  /Pfad_zum_Ziel/ --delete --exclude='.Private' </pre></div></div><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Man sollte das Backup bei einem Verzeichnis <strong>~/Private</strong> auf dieses Verzeichnis beschränken (erste Befehlszeile). Wird ein gesamtes Backup vom <a class="internal" href="../homeverzeichnis.html">Homeverzeichnis</a> ausgeführt, so muss man die Daten aus dem versteckten Verzeichnis <strong>~/.Private</strong> ausklammern (zweite Befehlszeile)!
</p></div></div></div><div class="section_3"><h4 id="Daten-in-codierter-Form">Daten in codierter Form<a class="headerlink" href="#Daten-in-codierter-Form">¶</a></h4><p>
Dabei muss der Benutzer nicht eingeloggt sein - der Pfad zu den verschlüsselten Daten ist <span class="underline">immer</span> zugänglich.</p><ul><li><p>Verzeichnis Private</p></li></ul><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">rsync -ap /home/&lt;Benutzername&gt;/.Private /Pfad_zum_Ziel/&lt;Benutzername&gt;/ --delete  </pre></div></div><ul><li><p>gesamtes Homeverzeichnis</p></li></ul><p>
</p><div class="bash"><div class="contents"><pre class="notranslate">rsync -ap /home/.ecryptfs/&lt;Benutzername&gt;/.Private /Pfad_zum_Ziel/&lt;Benutzername&gt;/ --delete  </pre></div></div></div><div class="section_3"><h4 id="Sicherung-einsetzen">Sicherung einsetzen<a class="headerlink" href="#Sicherung-einsetzen">¶</a></h4><p>
Es sind die Daten mit umgekehrter Verzeichnisstruktur zurück zu sichern.</p></div></div><div class="section_2"><h3 id="Separate-Partition-einbinden">Separate Partition einbinden<a class="headerlink" href="#Separate-Partition-einbinden">¶</a></h3><p>
Hat man sich zum (insgesamt) verschlüsselten Homeverzeichnis auch noch eine separate Datenpartition angelegt bzw. will man eine beim Starten vorhandene externe Festplatte benutzen, so kann man diese auch <span class="underline">innerhalb</span> des verschlüsselten Bereiches fest zugeordnet einbinden.</p><p>Folgende Annahmen sollen realisiert werden:
</p><ul><li><p>Datenpartition mit folgendem Eintrag in der <strong>/etc/fstab</strong>:</p><ul><li><pre class="notranslate">UUID=d40fbac8-bd8a-44b2-a0c8-6801626cfa0d /media/daten  ext4  defaults  0  2</pre></li></ul></li><li><p><a class="internal" href="../homeverzeichnis.html">Homeverzeichnis</a> mit folgender Verzeichnisstruktur</p><ul><li><p><strong>/home/&lt;Benutzername&gt;/DATEN</strong></p></li></ul></li></ul><p>Das Verzeichnis <strong>/media/daten</strong> und das Zielverzeichnis <strong>~/DATEN</strong> (oder adäquate Bezeichnungen eigener Wahl) müssen parallel zum Eintrag in der <strong>/etc/fstab</strong> angelegt werden!</p><div class="box notice"><h3 class="box notice">Hinweis:</h3><div class="contents"><p>Ein <span class="underline">direktes</span> Einbinden über die <strong>/etc/fstab</strong> ist nicht möglich, weil das Zielverzeichnis zum Einbinden erst nach dem Login vorhanden ist.
</p></div></div><p>Um diesen Sachverhalt zu umgehen, wird das folgende Skript als z.B.: <strong>mount-daten</strong> erstellt, ausführbar gemacht und nach <strong>/etc/init.d</strong> kopiert:</p><pre class="notranslate">code bash
#! /bin/sh
### BEGIN INIT INFO
# Provides:          mount-daten
# Required-Start:    $remote_fs $syslog $all
# Required-Stop:
# Default-Start:     2 3 4 5
# Default-Stop:
# Short-Description: Run a mount-option after ecryptfs started and the directory exist
### END INIT INFO

PATH=/sbin:/usr/sbin:/bin:/usr/bin

. /lib/init/vars.sh
. /lib/lsb/init-functions

do_start() {
    while true; do
        sleep 2
        [ ! -d $HOME/DATEN ] &amp;&amp; continue
        mount -o bind /media/daten $HOME/DATEN
        break
    done
return
}

case "$1" in
    start)
	do_start
        ;;
    *)
        echo "Usage: $0 start" &gt;&amp;2
        exit 3
        ;;
esac</pre><p>Nun muss man nur noch im Terminal <sup><a href="#source-2">[2]</a></sup> eingeben:</p><div class="bash"><div class="contents"><pre class="notranslate">sudo update-rc.d mount-daten start 99 2 3 4 5 . </pre></div></div><p>Die erfolgreiche Verarbeitung wird danach im Terminal angezeigt - nach einem Reboot sollte die Datenpartition nach der Anmeldung an der vorgesehenen Stelle eingebunden und benutzbar sein. Ggf. sind die Benutzer- und Gruppenrechte <sup><a href="#source-1">[1]</a></sup> noch anzupassen.</p><div class="box warning"><h3 class="box warning">Achtung!</h3><div class="contents"><p>Die in diesem Verzeichnis abgelegten Daten werden <span class="underline"><strong>nicht</strong></span> verschlüsselt und sind jederzeit offen auslesbar!
</p></div></div></div><div class="section_2"><h3 id="Dateinamen-mit-locate-anzeigen">Dateinamen mit locate anzeigen<a class="headerlink" href="#Dateinamen-mit-locate-anzeigen">¶</a></h3><p>
Mit dem Kommando <a class="internal" href="../locate.html">locate</a> kann man sehr schnell Dateien finden. Hierfür werden alle Dateinamen in einer Datenbank indiziert.</p><p>Allerdings zeigt <code class="notranslate">locate</code> keine Dateinamen aus verschlüsselten Homeverzeichnissen an. Der Grund dafür ist, dass auch Root keinen Zugang zu diesen verschlüsselten Verzeichnissen hat. Da die Datenbank mit den Dateinamen durch einen regelmäßigen Root-Prozess aktualisiert wird, bleiben die verschlüsselten Verzeichnisse außen vor.</p><p>Um auch Dateien aus dem verschlüsselten Homeverzeichnis mit Hilfe von <code class="notranslate">locate</code> anzuzeigen braucht man eine eigene Datenbank im Homeverzeichnis, die für locate als zusätzliche Quelle angegeben wird. Zusätzliche Datenquellen können locate mit Hilfe der Umgebungsvariable <code class="notranslate">$LOCATE_PATH</code> zur Verfügung gestellt werden.</p><p>Erzeugung der Datenbank: 
</p><div class="bash"><div class="contents"><pre class="notranslate">updatedb -l 0 -o $HOME/.mlocate.db -U $HOME </pre></div></div><p>
Damit die Datenbank aktuell bleibt ist es empfehlenswert, dieses Kommando zur Aktualisierung auch in die Startprogramme aufzunehmen.</p><p>Dann muss noch die Umgebungsvariable in <strong>~/.xsessionrc</strong> ergänzt werden: 
</p><pre class="notranslate">echo export LOCATE_PATH="$HOME/.mlocate.db" &gt;&gt; ~/.xsessionrc</pre><p>Das Skript <strong>~/.xsessionrc</strong> wird beim Start der grafischen Oberfläche ausgeführt. Die Umgebungsvariable steht damit auch in Ubuntu / Unity zur Verfügung und die Ergebnisse von locate werden bei der Anzeige im Dash berücksichtigt.</p><p>Wenn nun <code class="notranslate">locate</code> ausgeführt wird, wird zuerst die Standard-Datenbank durchsucht und dann die Datenbank aus <code class="notranslate">$LOCATE_PATH</code>. Da die zusätzliche Datenbank Bestandteil des Homeverzeichnis ist, wird auch sie verschlüsselt und gibt die Namen der vorhandene Dateien nicht öffentlich preis.</p></div></div><div class="section_1"><h2 id="Links">Links<a class="headerlink" href="#Links">¶</a></h2><p>
</p><ul><li><p><a class="internal" href="../ecryptfs.html">ecryptfs</a> <img alt="{Übersicht}" src="../_/021d71c30babf2ce4dd27339ba3c55995610945b.png"/> Das <a class="internal" href="../homeverzeichnis.html">Homeverzeichnis</a> bzw. ein Verzeichnis darin verschlüsseln</p><ul><li><p><a class="internal" href="../ecryptfs/einrichten.html">Einrichten</a> - wie man eine Verschlüsselung installiert / entfernt</p></li><li><p><a class="internal" href="../ecryptfs/datenrettung.html">Datenrettung</a> - Struktur der Schlüsseldaten und Datenrettung </p></li></ul></li><li><p><a class="external" href="https://help.ubuntu.com/community/EncryptedPrivateDirectory" rel="nofollow">Weitere Hinweise</a> <img alt="{en}" src="../_/d5ecf89114b079f85d02099649c4ee617ffa34c7.png"/></p></li></ul><p>
</p></div></div>
<p class="meta">
<a href="../ecryptfs/nutzung/a/revision/907753.html">Diese Revision</a> wurde am 9. September 2016 20:48 von <a href="https://ubuntuusers.de/user/noisefloor/">noisefloor</a> erstellt.
    
  </p>
</div>
</div>
<div style="clear: both;"></div>
<div class="pathbar breadcrumb">
<div class="breadcrumb">
<ol>
<li><a href="../startseite.html">Wiki</a></li>
<li><a href="../ecryptfs.html">ecryptfs</a></li>
<li><a href="../ecryptfs/nutzung.html">Nutzung</a></li>
</ol>
</div>
</div>
</div>
<div class="footer" style="clear: both;">
<ul>
<li class="poweredby"><li class="poweredby">Erstellt mit <a href="http://inyokaproject.org/">Inyoka</a></li></li>
<li class="license">

<img alt="Copyleft" src="../_/65dad5b770326dbbe1bd26ee6363e366a76bd8b7.png"/>
          2004 – 2017 ubuntuusers.de • Einige Rechte vorbehalten<br/>
<a href="../_lizenz.html" rel="cc:morePermissions">Lizenz</a> •
          <a href="http://ubuntuusers.de/kontakt/">Kontakt</a> •
          <a href="http://ubuntuusers.de/datenschutz/">Datenschutz</a> •
          <a href="http://ubuntuusers.de/impressum/">Impressum</a> •
          <a href="https://ubuntuusers.statuspage.io">Serverstatus</a>
</li>
<li class="housing">
<span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br/>
<img alt="noris network" src="../_/e7d27e9081eec23a8a5a5fe9434d7b2f1532e1d9.png"/>
<img alt="anexia" src="../_/ad1b63a3fc35749344af0a03e8c3ce05a2a3ee7e.png"/>
</li>
</ul>
</div>
<div style="clear: both;"></div>
</div>






</body>
</html>